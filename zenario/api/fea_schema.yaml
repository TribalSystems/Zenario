---



common_definitions:
    stringy: &stringy
        - number
        - string
    variable: &variable
        - boolean
        - number
        - string
        - "null"
    css_class: &css_class
        type: string
        description: A CSS class name to add to this element.
    ord: &ord
        type: *stringy
        description: >
            This controls the order in which elements are drawn on the screen.
            
            If not set, it defaults to the order the CMS finds them in.
            
            From version 7.3 onwards, if you are inserting elements into another module's TUIX,
            you can use syntax of the form "name_of_other_element.001"
            to place an element after the named element in the order.
    hidden: &hidden
        type: boolean
        description: >
            The hidden property hides elements from view when <code>true</code>.
    visible_if: &visible_if
        type: string
        description: >
            A snippet of JavaScript code to be evaluated.
            
            The visible_if property hides elements from view if the code provided does not evaluate to <code>true</code>.
            
            See http://zenar.io/visibility-in-tuix for examples.
    disabled_if: &disabled_if
        type: string
        description: >
            A snippet of JavaScript code to be evaluated.
            
            If the code provided evaluates to <code>true</code> the button will be disabled.
            
            See http://zenar.io/visibility-in-tuix for examples.


$schema: 'http://json-schema.org/draft-04/schema#'
title: Front-end Administration Schema

type: object
additionalProperties:
    title: Front-end Administration
    type: object
    oneOf:
        -
            required:
                - columns
        -
            required:
                - key
                - tabs
    properties:
        title:
            type: string
            description: >
                The title for the plugin, to be placed in a h1 tag.
                If you do not specify this property the h1 will be hidden from view.
        
        title_for_existing_records:
            type: string
            description: >
                When showing a form, this property will be used instead of the title when editing an existing record.
                
                (The toolkit will consider that you are editing an existing record if the $tags['key']['id']
                 variable is set.)
                
                You can also use merge fields, e.g.: Editing the animal "[[name]]".
        no_items_message:
            type: string
            description: >
                When viewing a list, this mesage will be shown when there are no items.
        no_items_in_search_message:
            type: string
            description: >
                A message to display when there are no items in a search.
        
        key:
            type: object
            properties:
                id:
                    type: *variable
                    modified_by_cms: true
                    description: >
                        The id key for this form.
                        
                        If you are saving a newly created item, you should populate the id
                        yourself as soon as you know what it is.
            additionalProperties:
                type: *variable
                description: >
                    A variable or meta-information that you define about this form.
            description: >
                The key of an form lets you receive and/or store meta-information and variables.
        
        show_overlay_layer:
            type: boolean
            description: >
                Whether to show an overlay div under the form.
        
        css_class: *css_class
        
        tab:
            type: *stringy
            modified_by_cms: true
            description: >
                This would be the code-name of the current tab.
                
                However note that different tabs are not supported at the moment!
            default: (the first tab of the form)
        
        tabs:
            type: object
            description: >
                Forms are divided up into sections called "Tabs".
                
                Your form must have at least one tab, and only one tab, because multiple tabs are not yet supported!
                
                To place fields on your form, you must create at least one tab to put them on.
            
            additionalProperties:
                type: object
                required:
                    - label
                    - fields
                properties:
                    ord: *ord
                    
                    errors:
                        type: object
                        html_description: |
                            <p>You can set errors&nbsp;using your <code>validateAdminBox()</code> method to show that there are errors on a tab.</p>
                            <p>If edit mode is enabled for a tab, an Admin will not be able to leave that tab or save the form whilst there are errors on that tab.</p>
                            <p>The CMS will automatically initialise the <code>errors</code> property to an empty array each time the tab is validated. This means that any errors from a previous validation will be cleared and must be re-added if the error is still present.</p>
                        additionalProperties:
                            type: string
                            description: >
                                An error message to show.
                    notices:
                        type: object
                        html_description: |
                            <p>Notices display like errors, but do not have any special functionality.&nbsp;If visible, they are displayed one after the other just below the error messages on a tab.</p>
                            <p>The CMS never automatically sets or removes them, and a notice will not stop an Admin from leaving a tab or saving.</p>
                        additionalProperties:
                            type: object
                            required:
                                - type
                            dependencies_if_true:
                                show:
                                    - message
                            properties:
                                show:
                                    type: boolean
                                    description: >
                                        The notice will only be shown if this is set.
                                message:
                                    type: string
                                    description: >
                                        A message to show.
                                type:
                                    enum:
                                        - error
                                        - warning
                                        - question
                                        - success
                                    description: >
                                        The type of notice. A different styling will be applied for each different type.
                    
                    show_errors_after_field:
                        type: string
                        description: >
                            If you don't want the error messages displaying at the top of the tab,
                            you can set the name of a field here to display them below that field.
                            Note that the field after must start on a new line.
                    #disable_autofocus:
                    #    type: boolean
                    #    description: >
                    #        When a tab is displayed/redrawn/formatted, the CMS will try to focus on the
                    #        first field on that tab.
                    #        This is usually convenient, but can cause problems for tabs with scrollbars
                    #        as the browser will scroll to show the focused field.
                    #        You can disable this automatic focusing by setting this property.
                    
                    edit_mode:
                        type: object
                        description: >
                            The edit mode property controls whether the fields on a tab can be edited by an administrator.
                        properties:
                            enabled:
                                type: boolean
                                description: >
                                    Whether this tab can be edited.
                            on:
                                type: boolean
                                modified_by_cms: true
                                description: >
                                    The CMS will automatically set this property when this tab is in edit mode.
                            always_on:
                                type: boolean
                                description: >
                                    Include this property to lock a tab in edit mode, and not show the cancel
                                    button. 
                                    Note that if this property is not defined then it will default to true.
                                default: true
                    
                    # The fields property here will be array_merge_recursive() with the fields property
                    # from admin_box_schema.yaml by the dev tools when this file is loaded.
                    fields:
                        additionalProperties:
                            properties:
                                confirm: &confirm
                                    type: object
                                    description: >
                                        Use this to display a confirmation prompt before performing the button's action.
                                    properties:
                                        title:
                                            type: string
                                            description: >
                                                A title for the confirmation prompt.
                                        message:
                                            type: string
                                            description: >
                                                A message for the confirmation prompt.
                                        button_message:
                                            type: string
                                            description: >
                                                A message for the confirm button
                                        button_css_class:
                                            type: string
                                            description: >
                                                A css class for the confirm button
                                        cancel_button_message:
                                            type: string
                                            description: >
                                                A message for the cancel button
                        
        
        
        # The lovs property here will be array_merge_recursive() with the lovs property
        # from admin_box_schema.yaml by the dev tools when this file is loaded.
        lovs: {}
        
        
        
        search_bar_placeholder:
            type: string
            description: >
                Use this to set some placeholder text on the search box
        subtitle:
            type: string
            description: >
                Use this to set a subtitle just above the list and after the search box.
        hide_search_bar:
            type: boolean
            description: >
                Use this to hide the search box
        hide_column_headings:
            type: boolean
            description: >
                Use this to hide the column titles
        
        
        columns:
            type: object
            description: >
                If you are showing a list, you should define the columns you are using
                
            additionalProperties:
                type: object
                properties:
                    title:
                        type: string
                        description: >
                            A title for your column
                    #tooltip:
                    #    type: string
                    #    description: >
                    #        Lets you specify a tooltip for the column's header.
                    ord: *ord
                    #css_class: *css_class
                    hidden: *hidden
                    visible_if: *visible_if
                    values:
                        type: object
                        description: >
                            If you use the enum format for a column, you should provide a list of values
                            (with real values as keys and display values as values).
                        additionalProperties:
                            type: *variable
                    empty_value:
                        type: string
                        description: >
                            If a column is empty, show this text instead of a blank cell.
                    align_right: true
                        type: boolean
                        description: >
                            Set this to align the values in a column to the right
                    
                    parent:
                        type: string
                        description: >
                            Enter the code-name of another column button here to make your column's value appear
                            inside the column you specify.
                            
                            If you also specify a title, then your title will appear in each row as a label.
                            
                            There's a limit of 2 levels; you can't have a column inside a column inside another column.
        items:
            type: object
            description: >
                An array of data for the items in the list
            
            additionalProperties:
                type: object
                
                properties:
                    cell_css_classes:
                        type: object
                        description: >
                            You can use this to give individual cells a css class by creating elements here with
                            the same element name as the columns.
                        additionalProperties:
                            type: string
                            description: >
                                A css class name for the item in the column with this element's name.
                    cell_tooltip:
                        type: object
                        description: >
                            You can use this to give individual cells a tooltip by creating elements here with
                            the same element name as the columns.
                        additionalProperties:
                            type: string
                            description: >
                                A tooltip for the item in the column with this element's name.
        
        sort_by:
            type: string
            description: >
                The code name of a column to sort by. Defaults to "name".
        sort_desc:
            type: boolean
            description: >
                Whether to sort asending or descending
        
        
        
        collection_buttons:
            type: object
            description: >
                Collection buttons are intended to be for actions that apply to the form as a whole.
            
            additionalProperties:
                type: object
                oneOf:
                    -
                        required:
                            - ajax
                    -
                        required:
                            - go
                properties:
                    ord: *ord
                    css_class: *css_class
                    label:
                        type: string
                        description: >
                            A label for this button
                    tooltip:
                        type: string
                        description: >
                            A tooltip for this button
                    
                    icon_left:
                        type: string
                        description: >
                            This places a <i></> tag to the left of a button with the specified CSS class name(s).
                            Used for adding font-based icons to buttons, e.g. Font Awesome.
                    icon_right:
                        type: string
                        description: >
                            This places a <i></> tag to the right of a button with the specified CSS class name(s).
                            Used for adding font-based icons to buttons, e.g. Font Awesome.
                    
                    hidden: *hidden
                    visible_if: *visible_if
                    
                    disabled_if: *disabled_if
                    
                    disabled_tooltip:
                        type: string
                        default: (defaults to the tooltip property)
                        description: >
                            A tooltip for this button if it is disabled.
                    
                    location:
                        enum:
                            - top
                            - back
                            - search
                        description: >
                            Setting this properly lets you override the default location and put the button in a different position.
                    
                    confirm: *confirm
                    
                    onclick: &onclick
                        type: string
                        description: >
                            Some JavaScript code to run when your button is clicked.
                    
                    
                    ajax: &ajax
                        type: object
                        description: >
                            Send an AJAX request to your <code>handlePluginAJAX()</code> method.

                        properties:
                            request: &request
                                type: object
                                additionalProperties:
                                    type: *variable
                                    description: >
                                        A variable to put in the $_POST of the AJAX request.
                                description: >
                                    You can use the request property to add requests to the AJAX request.
                    
                    go:
                        type: object
                        required:
                            - mode
                        properties:
                            mode:
                                type: string
                                description: >
                                    A mode to go to when your button is pressed
                            command:
                                type: string
                                description: >
                                    If the nest conductor is running, issue this command.
                                    Note that this overrides the normal navigation.
                        additionalProperties:
                            type: *variable
                            description: >
                                A variable to add to the request/URL
                        description: >
                            You can use a "go" button to create navigation to another mode.
            
                          
        item_buttons:
            type: object
            description: >
                Item buttons appear next to each item, and are for actions on that item
            additionalProperties:
                type: object
                oneOf:
                    -
                        required:
                            - ajax
                    -
                        required:
                            - go
                properties:
                    ord: *ord
                    css_class: *css_class
                    label:
                        type: string
                        description: >
                            A label for this button
                    
                    icon_left:
                        type: string
                        description: >
                            This places a <i></> tag to the left of a button with the specified CSS class name(s).
                            Used for adding font-based icons to buttons, e.g. Font Awesome.
                    icon_right:
                        type: string
                        description: >
                            This places a <i></> tag to the right of a button with the specified CSS class name(s).
                            Used for adding font-based icons to buttons, e.g. Font Awesome.
                    
                    parent:
                        type: string
                        description: >
                            Enter the name of another item button here to make your button appear
                            under the named button as a dropdown.
                            
                            There's a limit of 2 levels; you can't have a dropdown inside another dropdown.
                    
                    hidden: *hidden
                    visible_if: *visible_if
                    
                    hide_when_children_are_not_visible:
                        type: boolean
                        description: >
                            If you set this property, the button will be hidden when it has no
                            visible children.
                    
                    confirm:
                        type: object
                        description: >
                            Use this to display a confirmation prompt before performing the button's action.
                        properties:
                            title:
                                type: string
                                description: >
                                    A title for the confirmation prompt.
                            message:
                                type: string
                                description: >
                                    A message for the confirmation prompt.
                
                                    If this is an item or inline button, your message may contain [[merge_field]]s
                                    which match up to the column names, and will be populated according to the item
                                    which is selected.
                            multiple_select_title:
                                type: string
                                description: >
                                    Use this property if you want to set a different title for item buttons when multiple items are selected.
                                    
                                    You can use the [[item_count]] merge field if you want to display the number of items in your message.
                            multiple_select_message:
                                type: string
                                description: >
                                    Use this property if you want to set a different message for item buttons when multiple items are selected.
                                    
                                    You can use the [[item_count]] merge field if you want to display the number of items in your message.
                            button_message:
                                type: string
                                description: >
                                    A message for the confirm button
                            button_css_class:
                                type: string
                                description: >
                                    A css class for the confirm button
                            cancel_button_message:
                                type: string
                                description: >
                                    A message for the cancel button
                    
                    onclick: *onclick
                    
                    ajax: *ajax
                    
                    go:
                        type: object
                        required:
                            - mode
                        properties:
                            mode:
                                type: string
                                description: >
                                    A mode to go to when your button is pressed
                        additionalProperties:
                            type: *variable
                            description: >
                                A variable to add to the request/URL.
                                
                                Alternately you can set the request to an object of the form
                                {replace_with_field_from_item: 'field_code_name'}
                                to automatically put the value of a field into this request.
                        description: >
                            You can use a "go" button to create navigation to another mode.
                            For an item button, the item's id will be automatically added to the requests.
                    
                    
                    
                    multiple_select:
                        type: boolean
                        description: >
                            This marks that this button is prepared to work on multiple items.
                    multiple_select_max_items:
                        type: number
                        description: >
                            Do not show this button if more than this number of items are selected.
                    
                            If you use this property you must also use the <code>multiple_select</code> property.
                    multiple_select_min_items:
                        type: number
                        description: >
                            Do not show this button if less than this number of items are selected.
                    
                            If you use this property you must also use the <code>multiple_select</code> property.
                    multiple_select_only:
                        type: boolean
                        description: >
                            Same as "multiple_select_min_items: 2"
                    visible_if_for_all_selected_items:
                        type: string
                        description: >
                            A snippet of JavaScript code to be evaluated for each selected item.
                            Each item must match for the button to be shown.
                            
                            See http://zenar.io/visibility-in-tuix for examples.
                    
                    visible_if_for_any_selected_items:
                        type: string
                        description: >
                            A snippet of JavaScript code to be evaluated for each selected item.
                            At least one item must match for the button to be shown.
                            
                            See http://zenar.io/visibility-in-tuix for examples.
                    
                    disabled:
                        type: boolean
                        description: >
                            If you set this property, the button will be disabled.
                    
                    disabled_if: *disabled_if
                    
                    disabled_if_for_all_selected_items:
                        type: string
                        description: >
                            A snippet of JavaScript code to be evaluated for each selected item.
                            If each item matches, the button will be disabled.
                    
                    disabled_if_for_any_selected_items:
                        type: string
                        description: >
                            A snippet of JavaScript code to be evaluated for each selected item.
                            If at least one item matches, the button will be disabled.
                            
                            See http://zenar.io/visibility-in-tuix for examples.
                    
                    disabled_tooltip:
                        type: string
                        default: (defaults to the tooltip property)
                        description: >
                            A tooltip for this button if it is disabled.
                            
                            From version 7.1 you can use merge fields in this tooltip when one item is selected.
                    
                    
        confirm_on_close: *confirm
        
        
        
        __page__:
            type: number
            description: >
                If pagination is being applied on the server, the CMS will put the current page number
                into this variable.
                
                This might be different than the page you asked for, e.g. if you ask for page three but
                there are only two pages.
                
        __page_size__:
            type: number
            description: >
                If pagination is being applied on the server, the CMS will put the page size
                into this variable.
                
        __item_count__:
            type: number
            description: >
                The CMS will put the count of the total number of items into this variable.
                
                This includes searches, filters and refiners, but does not include pagination.
                I.e. it's a count of all of the *matched* rows.
                
        __item_sort_order__:
            type:
                - array
                - object
            additionalProperties:
                type: *stringy
            description: >
                If sorting is being done on the server, the CMS will put an array of ids
                (sorted into the correct order) into this variable.

        close_popout:
            type: boolean
            description: >
                If this FEA plugin was opened in a popout, this sends a signal to close it.

        reload_parent:
            type: boolean
            description: >
                If this FEA plugin was opened in a popout from another FEA, this sends a signal to reload the parent FEA.