'use strict';zenario.lib(function(t,E,B,p,q,h,k,u,H,I,J,K,F,v,L,w,G,M,x,N,C,r,a){a.gridId="grid";a.globalName="zenarioSD";a.addToolbarId="grid_add_toolbar";a.mtPrefix="zenario_slide_designer_";a.gridId="grid";a.load=function(){var b=JSON.parse($("#data").val());a.init(b,"grid",b.layout_id,"L"+b.layout_id);a.drawOptions()};a.clearAddToolbar=function(){$("#"+a.addToolbarId).hide().html("")};a.drawAddToolbar=function(){$("#"+a.addToolbarId).show().html(a.microTemplate(a.mtPrefix+"add_toolbar",{}));$("#"+
a.addToolbarId+" a").draggable({connectToSortable:".zenario_grids",helper:"clone",revert:"invalid"});$("#"+a.addToolbarId).draggable({handle:"div.draggable"})};$(B).ready(function(){B.title=data&&null!=data.name?'Editing "'+data.name+'" with Slide Designer':"Editing with Slide Designer";$("#"+a.addToolbarId+" .draggable").hover(function(){$(this).css("cursor","move")},function(){$(this).css("cursor","pointer")})});a.save=function(b){a.layoutId||(b=!0);var c;if(confirm(x.gridSaveConfirmMessage)){if(b){var e=
["zenario_grid_box","zenario_grid_new_layout_box"];(c=k._nAA(a.ajaxURL(),{saveas:1,data:a.ajaxData(),layoutId:a.layoutId},!0))&&$.colorbox({transition:"none",html:a.microTemplate(a.mtPrefix+"save_prompt",{name:a.newLayoutName||c.oldLayoutName||""}),onOpen:function(){k._aCTC(e)},onClosed:function(){k._rCTC(e)},onComplete:function(){$("#zenario_grid_new_layout_save").click(function(){$("#zenario_grid_error").hide();(c=k._nAA(a.ajaxURL(),{saveas:1,confirm:1,data:a.ajaxData(),layoutId:a.layoutId,layoutName:a.newLayoutName=
w("zenario_grid_layout_name").value},!0))?c.error?$("#zenario_grid_error").html(G(c.error)).slideDown():($.colorbox.close(),a.layoutName=a.newLayoutName,a.markAsSaved(c)):$.colorbox.close()});w("zenario_grid_layout_name").focus()}})}else if(c=k._nAA(a.ajaxURL(),{save:1,data:a.ajaxData(),layoutId:a.layoutId},!0))c.success?a.markAsSaved(c,!0):(u._flBo(c.message,x.gridSave,"warning",!0,!0),$("#zenario_fbMessageButtons .submit_selected").click(function(){setTimeout(function(){var d;(d=k._nAA(a.ajaxURL(),
{save:1,data:a.ajaxData(),layoutId:a.layoutId,confirm:1},!0))&&a.markAsSaved(d)},50)}));toastr.success(x.gridSaveSuccessMessage);h&&h.zenario_conductor&&h.zenario_conductor.refreshAll&&h.zenario_conductor._rA()}};a.markAsSaved=function(b,c){a.savedAtPos=a.pos;v(b.layoutId)&&(a.layoutId=b.layoutId);a.rememberNames(a.data.cells);b.success&&(c&&u.floatingBox?u._flBo(b.success,!0,"success"):toastr.success(b.success));if(h&&h.zenarioO.init)switch(h.zenarioO.path){case "zenario__layouts/panels/layouts":b.layoutId&&
h.zenarioO._rTSI(b.layoutId)}};a.ajaxURL=function(){return E+"zenario/slide_designer/ajax.php?schemaId="+(a.data&&a.data.layout_for_id)};a.ajaxSrc=function(){var b=a.ajaxData();return a.ajaxURL()+"?data="+F(b)};a.drawOptions=function(){a.editing=!0;a.drawEditor()};a.cellLabel=function(b){return b.label};a.drawEditor=function(b,c,e,d,f,g,l,n,y,m,z){if(!e){var A=a.microTemplate(a.mtPrefix+"top",{formId:"settings"});$(".ui-tooltip").remove();w("settings").innerHTML=A;k._t("#settings");$("#settings .zenario_grid_setting_undo").click(function(){a.undo()});
$("#settings .zenario_grid_setting_redo").click(function(){a.redo()})}e&&(A=b+"__cell"+e.join("-"),$("#"+A+"s").on("click",function(){}));return C(zenarioG).drawEditor.call(this,b,c,e,d,f,g,l,n,y,m,z)};a.microTemplate=function(b,c,e){var d=k._aLP(c,a);b=k._mT(b,c,e,a.microTemplates);d&&k._tLP(c);return b};var D=p.zenarioSP=k._cZL("SP",zenarioFEA);q=C(D);a.editProperties=function(b){b=$(b).data("for");var c=$("#"+b);b=c.data("i");var e=c=thus.getLevels(c),d=a.data;if(c){c=c.s("-");for(var f in c)r(c,
f)&&(f*=1,d=d.cells[1*c[f]])}d=d.cells[b];d.class_name?a.openSlotSettingsBox(d,e,b):a.openSlotPluginAndModeBox(d,e,b)};a.openSlotPropertiesBox=function(b,c,e,d,f,g,l,n,y){var m,z={slideLayoutId:a.data.id,slideLayoutFor:a.data.layout_for,slideLayoutForId:a.data.layout_for_id,schemaId:a.data.layout_for_id};(m=p[l])||(m=p[l]=new D);m.cellProperties=JSON.stringify(b);m.slotLevels=n;m.slotI=y;m.showCloseButtonAtTopRight=!0;m.init(l,"fea",d,g,c,z,e,t,t,!0,t,!0,f);return!1};a.openSlotPluginAndModeBox=function(b,
c,e){return a.openSlotPropertiesBox(b,"slot_plugin_and_mode","slot_plugin_and_mode","zenario_common_features","slot_plugin_and_mode","slot_plugin_and_mode","slot_plugin_and_mode",c,e)};a.openSlotSettingsBox=function(b,c,e){var d=b.class_name,f=(b.settings||{}).mode;if(!d)return!1;var g="slot_settings_"+d;f&&(g+="_"+f);return a.openSlotPropertiesBox(b,g,g,d,"slot_settings","slot_settings","slot_settings",c,e)};q.typeOfLogic=function(){return"form"};q.modifyPostOnLoad=function(){var b=_._ex({},a.data);
delete b.cells;return{cellProperties:this.cellProperties,gridProperties:b,slotLevels:this.slotLevels,slotI:this.slotI}};q.closeAndUpdateSlot=function(b,c,e){var d=JSON.parse(this.cellProperties),f;if(b)for(f in _._ex(d,b),d)r(d,f)&&(b=d[f],v(b)||delete d[f]);d.settings=d.settings||{};if(c)for(f in _._ex(d.settings,c),d.settings)r(d.settings,f)&&(b=d.settings[f],v(b)||delete d.settings[f]);p.lastSlotProperties=d;var g=this.slotLevels,l=this.slotI;if(e)"slot_plugin_and_mode"==this.path?setTimeout(function(){a.openSlotSettingsBox(d,
g,l)},0):setTimeout(function(){a.openSlotPluginAndModeBox(d,g,l)},0);else{c=a.data;if(g){g=(""+g).s("-");for(var n in g)r(g,n)&&(n*=1,c=c.cells[1*g[n]])}c.cells[l]=d;a.change()}return!1};h&&h.$&&h.$.colorbox&&$("#close_button").click(function(){h.$.colorbox.close()})},window.zenarioSD=new zenarioG);
