zenario.lib(function(q,z,w,p,k,e,f,r,C,D,E,F,A,s,G,t,B,H,u,I,x,l,a){a.gridId="grid";a.globalName="zenarioSD";a.addToolbarId="grid_add_toolbar";a.mtPrefix="zenario_slide_designer_";a.gridId="grid";a.load=function(){var b=JSON.parse($("#data").val());a.init(b,"grid",b.layout_id,b.file_base_name);a.drawForm()};a.clearAddToolbar=function(){$("#"+a.addToolbarId).hide().html("")};a.drawAddToolbar=function(){$("#"+a.addToolbarId).show().html(a.microTemplate(a.mtPrefix+"add_toolbar",{}));$("#"+a.addToolbarId+
" a").draggable({connectToSortable:".zenario_grids",helper:"clone",revert:"invalid"});$("#"+a.addToolbarId).draggable({handle:"div.draggable"})};$(w).ready(function(){w.title=data&&null!=data.name?'Editing "'+data.name+'" with Slide Designer':"Editing with Slide Designer";$("#"+a.addToolbarId+" .draggable").hover(function(){$(this).css("cursor","move")},function(){$(this).css("cursor","pointer")})});a.save=function(b){a.layoutId||(b=!0);var c;if(confirm(u.gridSaveConfirmMessage)){if(b){var h=["zenario_grid_box",
"zenario_grid_new_layout_box"];(c=f._nAA(a.ajaxURL(),{saveas:1,data:a.ajaxData(),layoutId:a.layoutId},!0))&&$.colorbox({transition:"none",html:a.microTemplate(a.mtPrefix+"save_prompt",{name:a.newLayoutName||c.oldLayoutName||""}),onOpen:function(){f._aCTC(h)},onClosed:function(){f._rCTC(h)},onComplete:function(){$("#zenario_grid_new_layout_save").click(function(){$("#zenario_grid_error").hide();(c=f._nAA(a.ajaxURL(),{saveas:1,confirm:1,data:a.ajaxData(),layoutId:a.layoutId,layoutName:a.newLayoutName=
t("zenario_grid_layout_name").value},!0))?c.error?$("#zenario_grid_error").html(B(c.error)).slideDown():($.colorbox.close(),a.layoutName=a.newLayoutName,a.markAsSaved(c)):$.colorbox.close()});t("zenario_grid_layout_name").focus()}})}else if(c=f._nAA(a.ajaxURL(),{save:1,data:a.ajaxData(),layoutId:a.layoutId},!0))c.success?a.markAsSaved(c,!0):(r._flBo(c.message,u.gridSave,"warning",!0,!0),$("#zenario_fbMessageButtons .submit_selected").click(function(){setTimeout(function(){var b;(b=f._nAA(a.ajaxURL(),
{save:1,data:a.ajaxData(),layoutId:a.layoutId,confirm:1},!0))&&a.markAsSaved(b)},50)}));toastr.success(u.gridSaveSuccessMessage);e&&e.zenario_conductor&&e.zenario_conductor.refreshAll&&e.zenario_conductor._rA()}};a.markAsSaved=function(b,c){a.savedAtPos=a.pos;s(b.layoutId)&&(a.layoutId=b.layoutId);a.rememberNames(a.data.cells);b.success&&(c&&r.floatingBox?r._flBo(b.success,!0,"success"):toastr.success(b.success));if(e&&e.zenarioO.init)switch(e.zenarioO.path){case "zenario__layouts/panels/layouts":b.layoutId&&
e.zenarioO._rTSI(b.layoutId)}};a.ajaxURL=function(){return z+"zenario/slide_designer/ajax.php?schemaId="+(a.data&&a.data.layout_for_id)};a.ajaxSrc=function(){var b=a.ajaxData();return a.ajaxURL()+"?data="+A(b)};a.drawForm=function(){a.editing=!0;a.drawEditor()};a.cellLabel=function(a){return a.label};a.drawEditor=function(b,c,h,d,g,v,e,n,p,m,k){if(!h){var l=a.microTemplate(a.mtPrefix+"top",{formId:"settings"});$(".ui-tooltip").remove();t("settings").innerHTML=l;f._t("#settings");$("#settings .zenario_grid_setting_undo").click(function(){a.undo()});
$("#settings .zenario_grid_setting_redo").click(function(){a.redo()})}h&&(l=b+"__cell"+h.join("-"),$("#"+l+"s").on("click",function(){}));return x(zenarioG).drawEditor.call(this,b,c,h,d,g,v,e,n,p,m,k)};a.microTemplate=function(b,c,h){var d;d=f._aLP(c,a);b=f._mT(b,c,h,a.microTemplates);d&&f._tLP(c);return b};var y=p.zenarioSP=f._cZL("SP",zenarioFEA);k=x(y);a.editProperties=function(b){b=$(b).data("for");var c=$("#"+b);b=c.data("i");var h=c=thus.getLevels(c),d=a.data;if(c){var c=c.s("-"),g;for(g in c)l(c,
g)&&(g*=1,d=d.cells[1*c[g]])}d=d.cells[b];d.class_name?a.openSlotSettingsBox(d,h,b):a.openSlotPluginAndModeBox(d,h,b)};a.openSlotPropertiesBox=function(b,c,h,d,g,v,e,f,l){var m,k={slideLayoutId:a.data.id,slideLayoutFor:a.data.layout_for,slideLayoutForId:a.data.layout_for_id,schemaId:a.data.layout_for_id};(m=p[e])||(m=p[e]=new y);m.cellProperties=JSON.stringify(b);m.slotLevels=f;m.slotI=l;m.showCloseButtonAtTopRight=!0;m.init(e,"fea",d,v,c,k,h,q,q,!0,q,!0,g);return!1};a.openSlotPluginAndModeBox=function(b,
c,h){return a.openSlotPropertiesBox(b,"slot_plugin_and_mode","slot_plugin_and_mode","zenario_common_features","slot_plugin_and_mode","slot_plugin_and_mode","slot_plugin_and_mode",c,h)};a.openSlotSettingsBox=function(b,c,h){var d=b.class_name,g=(b.settings||{}).mode,e;if(!d)return!1;e="slot_settings_"+d;g&&(e+="_"+g);return a.openSlotPropertiesBox(b,e,e,d,"slot_settings","slot_settings","slot_settings",c,h)};k.typeOfLogic=function(){return"form"};k.modifyPostOnLoad=function(){var b=_._ex({},a.data);
delete b.cells;return{cellProperties:this.cellProperties,gridProperties:b,slotLevels:this.slotLevels,slotI:this.slotI}};k.closeAndUpdateSlot=function(b,c,e){var d=JSON.parse(this.cellProperties),g;if(b)for(g in _._ex(d,b),d)l(d,g)&&(b=d[g],s(b)||delete d[g]);d.settings=d.settings||{};if(c)for(g in _._ex(d.settings,c),d.settings)l(d.settings,g)&&(b=d.settings[g],s(b)||delete d.settings[g]);p.lastSlotProperties=d;var f=this.slotLevels,k=this.slotI;if(e)"slot_plugin_and_mode"==this.path?setTimeout(function(){a.openSlotSettingsBox(d,
f,k)},0):setTimeout(function(){a.openSlotPluginAndModeBox(d,f,k)},0);else{c=a.data;if(f){var f=(""+f).s("-"),n;for(n in f)l(f,n)&&(n*=1,c=c.cells[1*f[n]])}c.cells[k]=d;a.change()}return!1};e&&e.$&&e.$.colorbox&&$("#close_button").click(function(){e.$.colorbox.close()})},window.zenarioSD=new zenarioG);
