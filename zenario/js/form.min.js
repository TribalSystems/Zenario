zenario.lib(function(g,V,R,ca,sa,ta,s,H,I,ua,Ba,W,T,va,q,u,X,Q,Ca,wa,w,xa,Da,M,da,ga,Ea,Fa,O,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,ya,za){I.lib(function(Y,ha,f,ia,pa,la,sa,ta,Z,P,z,aa,J,ma,Aa){f=wa(xa);f.init=function(a,e,d){this.globalName=a;this.mtPrefix=e;this.containerId=d;this.baseCSSClass="";this.onKeyUpNum=0;ua.sizing=!1;this.cachedAJAXSnippets={};this.changed={};this.toggleLevelsPressed={};this.lastFieldInFocus=!1;this.editingPositions={}};f.get=function(a){return this.containerId&&$("#"+this.containerId+
" #"+s._cE(a))[0]||va(a)};f.microTemplate=function(a,e,d){return I._mT(a,e,d)};f.onThisRow=function(a,e){return a+e.replace(/(.*_|\D)/g,"")};f.valueOnThisRow=function(a,e){return this.value(this.onThisRow(a,e))};f.fieldOnThisRow=function(a,e){return this.field(this.onThisRow(a,e))};f.getKey=function(a){return this.tuix&&this.tuix.key};f.getKeyId=function(a){return this.tuix&&this.tuix.key&&this.tuix.key.id};f.getLastKeyId=function(a){return this.getKeyId(a)};f.getTitle=function(){var a,e;if(this.tuix.key&&
this.tuix.key.id&&(a=this.tuix.title_for_existing_records)){e=this.getValues1D(!1,g,!0);for(c in e)if(w(e,c)&&(v=e[c],-1!=a.indexOf("[["+c+"]]")))for(;a!=(string2=a.replace("[["+c+"]]",v));)a=string2;return a}return this.tuix.title};f.field=function(a,e){return _._isOb(a)?a:(tabs=this.tuix&&this.tuix.tabs)&&(e=e||this.tuix.tab)&&tabs[e]&&tabs[e].fields&&tabs[e].fields[a]};f.fields=function(a){var e;return(e=this.tuix&&this.tuix.tabs)&&(a=a||this.tuix.tab)&&e[a]&&e[a].fields};f.initFields=function(){var a=
this.tuix.tab,e,d,b,h,l,p=this.tuix.lovs||{};if(this.tuix.tabs)for(e in this.tuix.tabs)if(w(this.tuix.tabs,e)&&(b=this.fields(e))){l=!1;for(d in b)w(b,d)&&(h=b[d])&&(h.pick_items&&h.plugin_setting&&h.plugin_setting.use_value_for_plugin_name?this.pickedItemsArray(d,this.value(d,e,!1)):h.values&&_._iS(h.values)&&p[h.values]?h.values=p[h.values]:h.load_values_from_organizer_path&&!h.values&&this.loadValuesFromOrganizerPath(h),h.validation&&h.validation.required_if_not_hidden!==g&&(l=!0));l&&e!=a&&(this.tuix.tab=
e,this.drawFields(g,g,!0),this.tuix.tab=a)}};f.loadValuesFromOrganizerPath=function(a){var e,d,b;if(a.load_values_from_organizer_path&&!a.values&&(a.values={},(d=H._gIFO(a.load_values_from_organizer_path))&&d.items))for(e in d.items)w(d.items,e)&&(b=d.items[e],a.values[s._dIIFO(e)]={list_image:b.list_image,css_class:b.css_class||d.item&&d.item.css_class,label:H._fOIN(d,e)})};f.changeMode=function(){this.editCancelEnabled(this.tuix.tab)&&(this.editModeOn()?this.editCancelOrRevert("cancel",this.tuix.tab):
this.editCancelOrRevert("edit",this.tuix.tab))};f.revertTab=function(){this.changes(this.tuix.tab)&&this.revertEnabled(this.tuix.tab)&&this.editCancelOrRevert("revert",this.tuix.tab)};f.editCancelOrRevert=function(a,e){if(this.tuix.tabs[e].edit_mode){var d,b,h,l,p,f;"edit"==a?(p=q(this.tuix.tabs[e].edit_mode.format_on_edit),f=q(this.tuix.tabs[e].edit_mode.validate_on_edit)):"cancel"==a?(p=q(this.tuix.tabs[e].edit_mode.format_on_cancel_edit),f=q(this.tuix.tabs[e].edit_mode.validate_on_cancel_edit)):
"revert"==a&&(p=q(this.tuix.tabs[e].edit_mode.format_on_revert),f=this.errorOnTab(e)||q(this.tuix.tabs[e].edit_mode.validate_on_revert));if(!f&&(b=this.fields(e)))for(h in b)if(w(b,h))if(l=b[h],q(l.validate_onchange)&&(d=this.readField(h))!==g&&d!=l.value){f=!0;break}else!p&&q(l.format_onchange)&&(d=this.readField(h))!==g&&d!=l.value&&(p=!0);this.tuix.tabs[e].edit_mode.on="cancel"!=a;this.changed[e]=!1;f?this.validate(g,g,!0):p?this.format(!0):(this.wipeTab(),this.redrawTab(!0));this.tuix.tab==e&&
$(O+"abtab").removeClass(M+"abtab_changed")}};f.clickTab=function(a){this.loaded&&this.validate(a!=this.tuix.tab,a)};f.clickButton=function(a,e){var d;if(d=this.field(e))d.type==aa?(d.pressed=!0,this.validate(!0)):"toggle"==d.type?((d.pressed=!q(d.pressed))?$("#"+e).removeClass("not_pressed").addClass("pressed"):$("#"+e).removeClass("pressed").addClass("not_pressed"),this.validateFormatOrRedrawForField(d)):d.type==P&&(d.pressed=!0,this.validateFormatOrRedrawForField(d))};f.togglePressed=function(a,
e){var d;d=a?1<a?this.toggleLevelsPressed[a-1]:!0:this.toggleLevelsPressed.last;d===g&&(d=!0);e&&"toggle"==e.type&&(this.toggleLevelsPressed.last=d&&q(e.pressed),a&&(this.toggleLevelsPressed[a]=this.toggleLevelsPressed.last));return d};f.toggleLevel=function(a){return this.toggleLevelsPressed.last};f.retryAJAX=function(a,e,d,b,h,l){var p=function(){s._a(a,e,d,g,p,!0,g,g,g,g,l).after(b);h&&H.nowDoingSomething&&H._nDS(h)};p()};f.switchToATabWithErrors=function(){var a,e,d=this.tuix;if(d&&d.tabs&&!this.errorOnTab(d.tab))for(a in this.sortedTabs)if(w(this.sortedTabs,
a)&&(e=this.sortedTabs[a],d.tabs[e]&&!I._h(g,this,g,e,g,g,g,g,d.tabs[e])&&this.errorOnTab(e)))return d.tab=e,!0;return!1};f.applyMergeFields=function(a,e,d,b){return a};f.applyMergeFieldsToLabel=function(a,e,d,b){return a};f.hideTab=function(a){var e=this;a?($(O+"abtab input").add(O+"abtab select").add(O+"abtab textarea").attr("disabled","disabled"),$(O+"abtab").clearQueue().show().animate({opacity:0.8},200,function(){e.tabHidden=!0;e.draw()})):($(O+"abtab input").add(O+"abtab select").add(O+"abtab textarea").attr("disabled",
"disabled").animate({opacity:0.9},100),this.tabHidden=!0,this.draw())};f.draw=function(){this.loaded&&this.tabHidden&&this.draw2()};f.draw2=function(){};f.drawTabs=function(a){a||(a=this.mtPrefix+"_tab");var e,d,b=[],h,l;for(h in this.sortedTabs)if(w(this.sortedTabs,h)&&(l=this.sortedTabs[h],(e=this.tuix.tabs[l])&&!I._h(g,this,g,l,g,g,g,g,e))){d="";if(e.fields&&!_._isEm(e.fields)||e.fields&&!_._isEm(e.errors)||e.fields&&!_._isEm(e.notices))d=this.globalName+".clickTab('"+X(l)+"');";!this.tuix.tab&&
d&&(this.tuix.tab=l);b.push({id:l,tabId:l,tuix:e,onclick:d,current:this.tuix.tab==l,label:e.label})}I._sBK(b,M+"fab_tab_with_children");return this.microTemplate(a,b)};f.drawFields=function(a,e,d){var b,h,l,p=this.tuix.tab,f=this.tuix.tabs[p],n=this.groupings[p],m=this.sortedFields[p],r="",s=!1,x,u=this.fields(p),fa={},y={},F=!1,A,H,G,C=!1,B={},k={fields:{},rows:[],tabId:p,path:this.path,tuix:this.tuix,revert:"",errors:[],notices:{}};if(!d){this.ffoving=0;this.splitValues={};I._cHTML5UFDD();!this.savedAndContinued(p)&&
this.editCancelEnabled(p)&&(k.revert=ha(z,M+"editCancelButton",I._i(z,aa,Z,P,ma,this.globalName+".changeMode(); return false;",J,this.editModeOn()?Q.cancel:Q.edit)));if(this.editModeOn()){if(f.errors)for(x in f.errors)w(f.errors,x)&&(l=f.errors[x],k.errors.push({message:l}));if(u)for(x in u)w(u,x)&&(l=u[x],l.error&&k.errors.push({message:l.error}))}if(f.notices)for(x in f.notices)w(f.notices,x)&&(l=f.notices[x],q(l.show)&&{error:1,warning:1,question:1,success:1}[l.type]&&(k.notices[x]=l))}for(b in m)w(m,
b)&&(h=m[b],l=u[h],x=!1,A=l.grouping,H!==A&&(H=A,C=n[A]!==g&&u[n[A]],s=A&&(!C||I._h(g,this,g,n[A],g,g,C))),G!==A&&(x=!0),l._id=h,l._html=this.drawField(a,p,h,l,fa,y,d,s),d||s||!1===l._html||((x||l._startNewRow||!k.rows.length)&&k.rows.push({fields:[]}),x&&C&&(C.legend||C.snippet)&&(C=_._ex({grouping:A},C),C._id=A,C._html=this.drawField(a,p,A,C),C._hideOnOpen=!0,C._showOnOpen=!0,C._lastVisibleGrouping=G,G=A,k.rows[k.rows.length-1].fields.push(C),k.fields[A]=C,B[A]=C,k.rows.push({fields:[]})),F||f.show_errors_after_field!=
h||(k.rows[k.rows.length-1].errors=k.errors,k.rows[k.rows.length-1].notices=k.notices,F=!0),l._lastVisibleGrouping=G,G=A,k.rows[k.rows.length-1].fields.push(l),k.fields[h]=l));for(h in k.fields)w(k.fields,h)&&(l=k.fields[h],A=l.grouping)&&(C=B[A])&&(C._hideOnOpen&=l._hideOnOpen,C._showOnOpen&=l._showOnOpen);d||(k.rows.length&&(k.rows[k.rows.length-1].fields[0]._isLastRow=!0),F||k.rows.splice(0,0,{errors:k.errors,notices:k.notices}),e=e||f.template||this.mtPrefix+"_current_tab",r+=this.microTemplate(e,
k));for(b in m)w(m,b)&&(h=m[b],delete u[h]._lastVisibleGrouping,delete u[h]._startNewRow,delete u[h]._hideOnOpen,delete u[h]._showOnOpen,delete u[h]._isLastRow,delete u[h]._html,delete u[h]._id);return r};f.insertHTML=function(a,e,d){var b=this.get(M+"abtab"),h;b.innerHTML=a;this.tabHidden=!1;this.changes(this.tuix.tab)?$(b).addClass(M+"abtab_changed"):$(b).removeClass(M+"abtab_changed");e.call();!d&&this.lastFieldInFocus&&(h=this.get(this.lastFieldInFocus))&&h.focus()};f.hideShowFields=function(a){var e=
$(ga+"hide_on_open"),d=$(ga+"hide_row_on_open"),b=$(ga+"show_on_open"),h=function(a,b){b.style.display="none"};b.length&&!e.length?b.show("blind",200,a):!b.length&&e.length?e.hide("blind",200,function(){d.each(h)}):b.length&&e.length&&(e.each(h),d.each(h),b.show())};f.addJQueryElementsToTab=function(){s._aJQE(O+"abtab ",!0)};f.addJQueryElementsToTabAndFocusFirstField=function(){s._aJQE(O+"abtab ",!0);this.focusFirstField()};f.focusFirstField=function(){if(this.tuix&&!q(this.tuix.tabs[this.tuix.tab].disable_autofocus)){var a=
this,e=-1,d=[],b=g,h,l,p,f,n;for(h in this.sortedFields[this.tuix.tab])if(w(this.sortedFields[this.tuix.tab],h)&&(f=this.sortedFields[this.tuix.tab][h],(l=this.get(f))&&(p=this.field(f))&&((n=p.pick_items||p.upload)||$(l).is(":visible"))&&(d[++e]={id:f,type:p.type,empty:""==l.value,focusable:(n||s.IN(p.type,"password","checkbox","select","text","textarea"))&&!q(l.disabled)&&!q(l.readonly)&&!q(p.read_only)&&!q(p.readonly)},1<e)))break;if(d[0]&&!d[0].empty&&d[1]&&d[1].focusable&&d[1].empty&&"password"==
d[1].type)b=1;else if(d[0]&&d[0].focusable)b=0;else if(d[1]&&d[1].focusable)b=1;else return;setTimeout(function(){p=d[b];p.type?a.get(p.id).focus():a.$getPickItemsInput(p.id).focus()},50)}};f.$getPickItemsInput=function(a){return $(this.get("name_for_"+a)).find(".TokenSearch input")};f.focusField=function(){this.fieldToFocus&&this.get(this.fieldToFocus)&&$(this.get(this.fieldToFocus)).is(":visible")&&this.get(this.fieldToFocus).focus();delete this.fieldToFocus};f.errorOnBox=function(){if(this.tuix&&
this.tuix.tabs)for(tab in this.tuix.tabs)if(w(this.tuix.tabs,tab)&&this.errorOnTab(tab))return!0;return!1};f.errorOnTab=function(a){var e;if(this.tuix.tabs[a]&&this.editModeOn(a)){if(this.tuix.tabs[a].errors)for(e in this.tuix.tabs[a].errors)if(w(this.tuix.tabs[a].errors,e))return!0;if(a=this.fields(a))for(e in a)if(w(a,e)&&a[e].error)return!0}};f.checkValues=function(a){a?this.wipeTab():this.readTab();for(var e in this.tuix.tabs)if(w(this.tuix.tabs,e)){a=this.tuix.tabs[e];var d=this.editModeOn(e);
if(a.fields)for(var b in a.fields)if(w(a.fields,b)){var h=a.fields[b];this.isFormField(h)&&("code_editor"==h.type&&s._cAD("code_editor_"+b),h.current_value===g&&(h.current_value=this.value(b,e,!0)),d&&(h.value===g&&(h.value=this.value(b,e,!1)),h.multiple_edit&&h.multiple_edit._changed===g&&h.multiple_edit.changed!==g&&(h.multiple_edit._changed=h.multiple_edit.changed)))}}R&&R.activeElement&&(this.lastFieldInFocus=R.activeElement.id)};f.enableMicroTemplates=function(a,e){var d=this,b;for(b in e)if(w(e,
b))switch(typeof e[b]){case "object":"that"!==b&&"tuix"!==b&&this.enableMicroTemplates(a,e[b]);break;case "string":b===Z||b===J&&this.isFormField(e)||"current_value"===b||!e[b].match(/(\{\{|\{\%|\<\%)/)||function(a,b,e){e=s._gMT("<% "+d.defineLibVarBeforeCode()+" %>"+a[b],g);a[b]=function(){return e(a)}}(e,b)}};f.drawField=function(a,e,d,b,h,l,f,E,n,m,r,ea,x,ja,fa){b===g&&(b=this.field(d,e));b.id===g&&(b.id=d);q(b.enable_microtemplates_in_properties)&&this.enableMicroTemplates(b,b);r===g&&(r=!this.editModeOn(e)||
q(b.read_only)||q(b.readonly));var y=b.type;y&&"datetime"==y&&(r=!0);fa?fa.disabled_if!==g&&I._e(fa.disabled_if,this,fa,g,n,g,g,b)&&(r=!0):b.disabled_if!==g&&I._e(b.disabled_if,this,g,g,d,g,g,b)&&(r=!0);var F=this,A={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,onmouseover:!0,onmouseup:!0,onkeydown:!0,onkeypress:!0,
onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,max:!0,min:!0,pattern:!0,placeholder:!r,required:!0,step:!0},O,G,C,B,k="",N,L,K={},R=!1,t={"class":""},S={},T=!0,ba=!1,W,da=!1,ga=!1,ha=!1,oa=L=!1,ka,na;!b[z]&&b.css_class&&(b[z]=b.css_class);b.snippet||m!==g||(m=this.value(d,e,g,!0));m===g&&(m="");if(n===g){delete b.selected_option;if(m&&b.values)if(G=_._isOb(b.values)?b.values[m]:this.tuix.lovs&&this.tuix.lovs[b.values]&&this.tuix.lovs[b.values][m],_._isOb(G)&&I._h(G,this,g,m,g,g,b,g,this.tuix.tabs[e])&&
(G=!1),G)b.selected_option=G;else if("radio"==y||"select"==y)b.current_value=m="";(b.upload||b.pick_items)&&""!=m&&(K=this.pickedItemsArray(b,m));b.values&&_._iS(b.values)&&this.tuix.lovs&&this.tuix.lovs[b.values]?b.values=this.tuix.lovs[b.values]:b.load_values_from_organizer_path&&!b.values&&this.loadValuesFromOrganizerPath(b);for(C in b)w(b,C)&&(W=C.match(/^<(\/?)(\w+)/))&&(b[C]&&_._iS(b[C])&&(C+=b[C]),N={table:1,tr:2,td:3,th:4,div:5,p:6,span:7}[W[2]]||8,5>N&&(ha=!0),W[1]?(oa||(oa=!0,na="       ".split(" ")),
na[8-N]+=C):(L||(L=!0,ka="       ".split(" ")),ka[N-1]+=C,1==N&&(ga=!0)))}f||y!=P&&y!=aa||(b.pressed=!1);if(f||n===g){C=b.same_row===g?ga||!ha:!q(b.same_row);b._startNewRow=C;G=1*b.indent||0;E=E||I._h(g,this,g,d,g,g,b)||q(h&&h.last?b.hide_with_previous_field:b.hide_if_previous_field_is_not_hidden)||q(b.hide_with_previous_indented_field)&&h&&h[G]||q(b.hide_with_previous_outdented_field)&&0<G&&h&&h[G-1]||b.hide_if_previous_value_isnt!==g&&!s._iL(b.hide_if_previous_value_isnt,l&&l.last)||b.hide_if_previous_outdented_value_isnt!==
g&&0<G&&!s._iL(b.hide_if_previous_outdented_value_isnt,l&&l[G-1]);l&&(l.last=m,C&&(l[G]=m));h&&(h.last=E,C&&(h[G]=E));b._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=y&&"code_editor"!=y&&b._was_hidden_before&&!E?b._showOnOpen=!0:b._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=y&&"code_editor"!=y&&!b._was_hidden_before&&E&&(b._hideOnOpen=O=!0,b._was_hidden_before=!0);if(E){if(b._was_hidden_before=!0,!O)return!1}else delete b._was_hidden_before;
if(f)return;b.multiple_edit&&(h="",l=r||b.multiple_edit._changed===g?b.multiple_edit.changed:q(b.multiple_edit._changed),q(b.multiple_edit.disable_when_unchanged)&&!l&&(ea=!0),q(b.multiple_edit.hide_ui)||!b.multiple_edit.select_list?(f=q(b.multiple_edit.hide_ui),h+=ia(Z,"checkbox",z,"multiple_edit","id","multiple_edit__"+d,"checked",l,"style",f?"display: none;":"","disabled",r,"onchange",r||f?"":this.globalName+".meChange(this.checked, '"+u(d)+"');",">")):h+=pa(z,"multiple_edit","id","multiple_edit__"+
d,"disabled",r,"onchange",this.globalName+'.meChange(this.value == 1, "'+X(d)+'");',la(J,"","selected",!l,b.multiple_edit.select_list.not_changed_label||Q.notChanged)+la(J,1,"selected",l,b.multiple_edit.select_list.changed_label||Q.changed)),k+=h,h=g);L&&(k+=ka.join(""));b.pre_field_html!==g&&(k+=s._un(b.pre_field_html))}if(!(x&&ja||"object"!=typeof b.values))if(x=[],ja={},b.upload&&q(b.upload.reorder_items))for(N in L=m.split(","),L)w(L,N)&&(B=L[N],x.push(B));else{for(B in b.values)w(b.values,B)&&
(L=b.values[B],"object"==typeof L?(L.parent!==g&&(ba=!0,ja[L.parent]=!0),I._h(L,this,g,B,g,g,b,g,this.tuix.tabs[e])||(L.ord!==g?x.push([B,L.ord]):L.label!==g?x.push([B,L.label]):x.push([B,B]))):x.push([B,L]));x.sort(I.sortArray);for(N in x)w(x,N)&&(x[N]=x[N][0])}if(r||ea)t.readonly=!0,this.isButton(b)&&(t.disabled=!0,t[z]+="disabled ");if(r&&q(b.show_as_a_label_when_readonly)&&"checkboxes"!=y){x=u(m);if("select"==y||"radios"==y)b.values&&b.values[m]?x=u(b.values[m]):b.empty_value&&(x=u(b.empty_value));
k+=Y("label","id","label__"+d,z,b.css_class,x)}else if(B=b.snippet)B.separator&&(k+=Y("hr",z,"input_separator","style",B.separator.style)),B.label&&(k+=Y("label","id","label__"+d,z,B.label_class,u(B.label))),B.show_split_values_from&&this.splitValues&&this.splitValues[B.show_split_values_from]&&(k+=this.splitValues[B.show_split_values_from],delete this.splitValues[B.show_split_values_from]),B.html?k+=Y("span","id","snippet__"+d,s._un(B.html)):B.url&&(k=q(B.cache)?this.cachedAJAXSnippets[B.url]?k+
this.cachedAJAXSnippets[B.url]:k+(this.cachedAJAXSnippets[B.url]=s._nAA(s._aBP(B.url))):k+s._nAA(s._aBP(B.url)));else if(("checkboxes"==y||"radios"==y)&&n===g)b.values&&(K=this.pickedItemsArray(b,m),ba=_._ex({},b),ba.name=b.name||d,ba.type="checkboxes"==y?"checkbox":"radio",r&&(ba.disabled=!0),k=_._isEm(x)?k+Y("label",z,M+"no_values_message",u(b.no_values_message)):k+this.hierarchicalBoxes(a,e,d,m,b,ba,K,ea,x,ja));else if(b.upload||b.pick_items){var qa=b.pick_items&&q(b.pick_items.multiple_select)||
b.upload&&q(b.upload.multi);m={id:d,pickerHTML:"",wrappedId:"name_for_"+d,readOnly:r,tempReadOnly:ea};r||(b.pick_items&&(b.pick_items.target_path||b.pick_items.path)&&!q(b.pick_items.hide_select_button)&&(m.select={onclick:this.globalName+".pickItems('"+u(d)+"');",phrase:b.pick_items.select_phrase||Q.selectDotDotDot}),b.upload&&(m.upload={onclick:this.globalName+".upload('"+u(d)+"');",phrase:b.upload.upload_phrase||Q.uploadDotDotDot},q(b.upload.drag_and_drop)&&this.upload(d,!0),ca.Dropbox&&Dropbox.isBrowserSupported()&&
(m.dropbox={onclick:this.globalName+".chooseFromDropbox('"+u(d)+"');",phrase:b.upload.dropbox_phrase||Q.dropboxDotDotDot})));m.pickerHTML+=pa("id",d,"multiple",qa,">");b.values&&!_._isEm(K)&&(m.pickerHTML+=this.hierarchicalSelect(K,b,x,ba,ja));m.pickerHTML+="</select>";k+=this.microTemplate(this.mtPrefix+"_picked_items",m);a.after(function(){F.setupPickedItems(d,e,b,r,qa)})}else if(y){S.onchange=n?"lib.fieldChange('"+u(d)+"', '"+u(n)+"');":"lib.fieldChange('"+u(d)+"');";b.disabled&&(t[z]+="disabled ");
b.validation&&b.validation.numeric&&(t.onkeyup=(t.onkeyup||"")+"lib.keepNumeric(this)");b.return_key_presses_button&&!r&&(t.onkeyup=(t.onkeyup||"")+"if (event.keyCode == 13) {$('#"+u(b.return_key_presses_button)+"').click();}");q(b.multiple_edit)&&!r&&(t.onkeyup=(t.onkeyup||"")+"if (event && event.keyCode == 9) return true; lib.meMarkChanged('"+u(d)+"', this.value, '"+u(b.value)+"');");t[z]+="input_"+y;switch(y){case "select":b.slider&&(R=!0,k+=this.drawSlider(a,d,b,r,!0));r&&(t.disabled=!0);k+="<select";
break;case "code_editor":k+="<div";t[z]=" zenario_embedded_ace_editor";a.after(function(){var a=ace.edit(d),h=!1,l;a.session.setUseSoftTabs(!1);a.setShowPrintMargin(!1);r&&(a.setReadOnly(!0),a.setBehavioursEnabled(!1));q(b.wrap_text)&&a.session.setUseWrapMode(!0);a.session.setOption("useWorker",!1);a.on("blur",function(a){h&&s._aADINS("code_editor_"+d,function(){F.fieldChange(d)},0);h=!1});a.on("change",function(a){F.markAsChanged();h=!0;s._aADINS("code_editor_"+d,function(){F.fieldChange(d)},5E3)});
if(language=b.language)try{language=language.match(/\.twig\.html$/i)?"ace/mode/twig":language.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(language).mode:"ace/mode/"+language,a.session.setMode(language),a.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})}catch(k){console.log("Ace editor could not load that language",language)}a.$blockScrolling=Infinity;if(l=F.editingPositions[e+"/"+d])a.session.setScrollTop(l.top),a.session.setScrollLeft(l.left),a.selection.setSelectionRange(l.range)});
break;case "color_picker":case "colour_picker":k+="<input";t[z]=" zenario_color_picker";a.after(function(){var a=b.color_picker_options||b.colour_picker_options||{};a.disabled=r;a.preferredFormat=a.preferredFormat||"hex";$(F.get(d)).spectrum(a)});break;case "editor":k+="<textarea";H._gSD();var U,K={script_url:V+s.tinyMCEPath,inline:!1,menubar:!1,statusbar:!1,plugins:"autoresize",document_base_url:g,convert_urls:!1,readonly:!0,inline_styles:!1,allow_events:!0,allow_script_urls:!0,autoresize_max_height:Math.max(Math.floor(0.5*
$(ca).height()),300),autoresize_bottom_margin:10,onchange_callback:function(a){F.fieldChange(a.id)},init_instance_callback:function(a){H._eDDUITM(!1,g,F.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&H._eDDUITM(!1,g,b)}};ea=_._ex({},K,{plugins:["advlist autolink lists link image charmap hr anchor","searchreplace code fullscreen","nonbreaking table contextmenu directionality","paste autoresize"],image_advtab:!0,
visual_table_class:" ",browser_spellcheck:!0,paste_preprocess:H.tinyMCEPasteRreprocess,readonly:!1,convert_urls:!0,relative_urls:!1,content_css:g,toolbar:"undo redo | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code",style_formats:H.skinDesc.style_formats,oninit:g});B=_._ex({},ea,{toolbar:"undo redo | image link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code",file_browser_callback:H.fileBrowser,
init_instance_callback:function(a){H._eDDUITM(!0,V,F.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&H._eDDUITM(!0,V,b)}});L=_._ex({},B,{toolbar:"undo redo | image | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code"});ka=_._ex({},L,{toolbar:"undo redo | link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code"});
r?(U=K,t[z]=" tinymce_readonly"):b.insert_image_button?b.insert_link_button?(U=B,t[z]=" tinymce_with_images_and_links"):(U=L,t[z]=" tinymce_with_images"):b.insert_link_button?(U=ka,t[z]=" tinymce_with_links"):(U=ea,t[z]=" tinymce");t.style="visibility: hidden;";_._isOb(b.editor_options)&&(U=_._ex(U,b.editor_options));U.setup=function(a){a.on("change",function(a){F.fieldChange(a.id)})};a.after(function(){var a=$(F.get(d)),b=F.get(M+"abtab"),e=b.style.display;b.style.display="block";a.tinymce(U);b.style.display=
e});break;case P:case aa:case "toggle":q(b.use_button_tag)?(k+="<"+P,da=!0):(k+="<input",t.type=P);if(!r||q(b.can_be_pressed_in_view_mode))S.onclick="lib.clickButton(this, '"+d+"');",delete t.disabled;"toggle"==y&&(t[z]+=b.pressed?" pressed":" not_pressed");break;default:"textarea"==y?k+="<textarea":"date"==y||"datetime"==y?(k+="<input",t.type="text",t[z]+=" zenario_datepicker",q(b.change_month_and_year)&&(t[z]+=" zenario_datepicker_change_month_and_year"),t.readonly="readonly",r||(t.onkeyup=(t.onkeyup||
"")+"zenario._dFKU(this, event, '"+u(d)+"');")):"url"==y?(k+="<input",t.type="url",t.onfocus=(t.onfocus||"")+"if(!this.value) this.value = 'http://';",t.onblur=(t.onblur||"")+"if(this.value == 'http://') this.value = '';"):(b.slider&&(R=!0,k+=this.drawSlider(a,d,b,r,!0)),k+="<input",t.type=y,T=!0),this.addExtraAttsForTextFields(b,t)}if("checkbox"==y||"radio"==y)q(m)&&(t.checked="checked"),m=g,r&&(t.disabled=!0),q(b.indeterminate)&&a.after(function(){var a;if(a=this.get(d))a.indeterminate=!0});R&&
(t.onchange='$("#zenario_slider_for__'+X(d)+'").slider("value", $(this).val());',t.onkeyup=(t.onkeyup||"")+'$("#zenario_slider_for__'+X(d)+'").slider("value", $(this).val());');K=b;n===g?K.id=d:(K=$.extend({},K,fa),K.id=d+"___"+n,t[z]+=" control_for__"+d);"radio"==K.type&&K.name||(K.name=d);for(var D in K)if(w(K,D)&&A[D])if("disabled"==D||"readonly"==D){if(q(t[D])||q(K[D]))k+=" "+D+'="'+D+'"';delete t[D]}else k+=" "+D+'="'+this.defineLibVarBeforeCode(D),t[D]&&(k+=t[D]+" ",delete t[D]),k+=u(K[D]),
S[D]&&(k+=" "+S[D],delete S[D]),k+='"';for(D in t)w(t,D)&&("disabled"==D||"readonly"==D?q(t[D])&&(k+=" "+D+'="'+D+'"'):(k+=" "+D+'="'+this.defineLibVarBeforeCode(D)+u(t[D]),S[D]&&(k+=" "+S[D],delete S[D]),k+='"'));for(D in S)w(S,D)&&(k+=" "+D+'="'+this.defineLibVarBeforeCode(D)+u(S[D])+'"');"select"==y?k+=">":da?(k+=">",b.icon_left&&(k+='<i class="'+u(b.icon_left)+'" aria-hidden="true"></i>'),k+=u(m,!1,"asis"),b.icon_right&&(k+='<i class="'+u(b.icon_right)+'" aria-hidden="true"></i>'),k+="</button>"):
"textarea"==y||"editor"==y?k+=">"+u(m,!1,"asis")+"</textarea>":"code_editor"==y?k+=">"+u(m,!1,"asis")+"</div>":"date"==y||"datetime"==y?(k+=' value="'+u(s._fD(m,"datetime"==y))+'"/>',k+=ia(Z,"hidden","id","_value_for__"+d,J,m),r||(k+=ia(Z,P,z,M+"remove_date",J,"x",ma,this.globalName+'.blankField("'+X(d)+'"); $('+this.globalName+'.get("'+X(d)+'")).change();'))):k=m!==g?k+(' value="'+u(m,!1,"asis")+'"/>'):k+"/>";if("select"==y)b.empty_value&&(k+=la(J,"",u(b.empty_value))),b.values&&(K={},K[m]=!0,k+=
this.hierarchicalSelect(K,b,x,ba,ja)),k+="</select>",b.select_options&&a.after(function(){var a=$(F.get(d)),e=_._ex({},b.select_options,{width:a.css("width")||a.width(),inherit_select_classes:!0});b.empty_value&&e.dont_show_empty_value&&!e.placeholder_text_single&&(e.placeholder_text_single=b.empty_value);a.chosen(e)});else if(T&&b.values&&!r){var ra=[];for(N in x)w(x,N)&&(B=x[N],ra.push({label:b.values[B],value:B}));a.after(function(){var a=$(F.get(d)),e={source:ra,minLength:b.autocomplete_min_length||
0,appendTo:a.parent()};b.return_key_presses_button&&(e.select=function(){setTimeout(function(){$("#"+b.return_key_presses_button).click()},0)});a.autocomplete(e);a.focus(function(){a.autocomplete("widget").is(":visible")||a.autocomplete("search","")})})}}n===g&&("url"!=y||r||(k+="&nbsp; "+ia(Z,P,z,aa,J,Q.test,ma,this.globalName+'.testURL("'+X(d)+'");')),!b.label||"checkbox"!=y&&"radio"!=y&&"toggle"!=y||(k+=" "+Y("label",z,b.label_class,"for",d,"id","label_for__"+d,u(b.label))),b.post_field_label!==
g&&(k+=" "+Y("label","for",d,"id","label_for__"+d,u(b.post_field_label))),b.post_field_html!==g&&(k+=s._un(b.post_field_html)),oa&&(k+=na.join("")),R&&(k+=this.drawSlider(a,d,b,r,!1)));return k};f.addExtraAttsForTextFields=function(a,e){};f.defineLibVarBeforeCode=function(a){if(a===g||"on"==a.substr(0,2)){if(!this.globalName){for(a=1;ca[this.globalName="zenarioLib"+a];++a);ca[globalName]=this}return"var lib = "+u(this.globalName)+"; "}return""};f.testURL=function(a){var e=this.get(a).value;a=this.get(this.onThisRow("target_blank_",
a))||this.get(this.onThisRow("target_blank",a));if(e)if(a&&2==a.value)$[ya]({href:e,iframe:!0,width:"95%",height:"95%",className:M+"url_test_colorbox"});else ca.open(s._aBP(e))};f.keepNumeric=function(a){var e=a.value.replace(/[^\d\.]/g,"").replace(/\.(.*)\./g,".$1");a.value!=e&&(a.value=e)};f.hierarchicalSelect=function(a,e,d,b,h,l){var f="",E,n,m,r,s;for(r in d)if(w(d,r)){s=d[r];m=e.values[s];n=E=!1;if(_._iS(m))m={label:m};else if(q(m.disabled)||m.disabled_if!==g&&I._e(m.disabled_if,this,m,g,s,
g,g,e))E=!0;a[s]&&(n=!0);showWithoutChildren=!q(m.hide_when_children_are_not_visible);if(l===g&&b&&h[s]){if((childrenHTML=this.hierarchicalSelect(a,e,d,b,h,s))||showWithoutChildren)f+=Y("optgroup","label",m,"disabled",!childrenHTML,childrenHTML)}else showWithoutChildren&&l===m.parent&&(f+=la(J,s,"selected",n,"disabled",E,u(m,!1,!0)))}return f};f.setupPickedItems=function(a,e,d,b,h){var l=this,g=!1,f=!1,n,m,r,u,x=d.pick_items||{},z=d.upload||{};if(d.pick_items&&!q(x.hide_select_button)&&!q(x.disable_type_ahead_search)){n=
x.path&&W._cNPTTPAR(x.path);u=x.target_path&&W._cNPTTPAR(x.target_path);if(n=n&&u&&n.path==u.path?n:u||n)m=V+da+"admin/organizer.ajax.php?_typeahead_search=1&path="+T(n.path)+s._uR(n.request),r="_search";f=q(d.pick_items.allow_typing_anything)}d=$(this.get(a)).tokenize({datas:m,searchParam:r,debounce:200,sortable:q(z.reorder_items),placeholder:x.nothing_selected_phrase||z.nothing_selected_phrase||Q.nothing_selected,onAddToken:function(b,d,f){g||(h||(g=!0,l.addToPickedItems(b,a,e),g=!1),l.$getPickItemsInput(a).focus())},
maxElements:h?0:1,parseData:function(d){var h,g,f,p=[],m=l.tuix.tabs[e].fields[a];if(d.items)for(h in d.items)w(d.items,h)&&(g=d.items[h],f=H._fOIN(d,h),m.values=m.values||{},m.values[h]={list_image:g.list_image,css_class:g.css_class||d.item&&d.item.css_class,label:f},p.push({value:h,text:f,html:l.drawPickedItem(h,a,m,b)}));return p},formatTokenHTML:function(d,h){var g=l.tuix.tabs[e].fields[a];return g.values&&g.values[d]?l.drawPickedItem(d,a,g,b):f?(g.values=g.values||{},g.values[d]=h,l.drawPickedItem(d,
a,g,b)):!1},onRemoveToken:function(b,e){l.fieldChange(a)}});b?d.disable():m||f?(d.container.addClass(M+"picker_with_typeahead"),f&&this.$getPickItemsInput(a).blur(function(){var b,d;if(b=l.$getPickItemsInput(a).val())d={},d[b]=b,l.addToPickedItems(d,a,e)})):d.disableTypeAhead()};f.chooseFromDropbox=function(a){var e=this,d,b,h,l,f;if(!(d=this.field(a))||!d.upload)return!1;if(l=d.upload.extensions||d.upload.accept)l=_._iS(l)?l.split(","):_._tA(l);for(b in l)w(l,b)&&(h=l[b],f=h.split("/"),f[1]!==g?
l[b]="images"==f[0]?"image":f[0]:"text"!=h&&"documents"!=h&&"images"!=h&&"video"!=h&&"audio"!=h&&"."!=h.substr(0,1)&&(l[b]="."+h));d={cancel:function(){H._hAL()},linkType:"direct",multiselect:!!q(d.upload.multi),extensions:l,success:function(b){H._sAL();var d,h,l=new s.callback;for(d in b)w(b,d)&&(h=b[d],l.add(s._a(this.ajaxURL()+"&fetchFromDropbox=1",h,!0)));l.after(function(){var b,d,h,l="";if(!e.tuix.tabs[e.tuix.tab]||!(h=e.tuix.tabs[e.tuix.tab].fields[a])||!h.upload)return!1;for(b in arguments)w(arguments,
b)&&((d=arguments[b])&&d.id&&(l+=","+d.id),e.setFileDetails(h,d));""!==l&&e.addToPickedItems(l,a);H._hAL()})}};H._sAL();Dropbox.choose(d)};f.setFileDetails=function(a,e){a.values||(a.values={});a.values[e.id]||(a.values[e.id]={file:e,label:this.formatLabelFromFile(e)})};f.formatLabelFromFile=function(a){var e;a.filename!==g?(e=a.filename,q(a.width)&&q(a.height)&&(e+=" ["+a.width+" \u00d7 "+a.height+"px]")):(fileDetails=s._dIIFO(a.id))&&(fileDetails=fileDetails.split("/"))&&fileDetails[1]?(e=fileDetails[1],
q(fileDetails[2])&&q(fileDetails[3])&&(e+=" ["+fileDetails[2]+" \u00d7 "+fileDetails[3]+"px]")):e=a.id;return e};f.upload=function(a,e){var d=this,b;if(!(b=this.field(a))||!b.upload)return!1;b={class_name:b.class_name,upload:b.upload};this.uploadCallback=function(b){if(b){var e,g,f,n="";if(!d.tuix.tabs[d.tuix.tab]||!(f=d.tuix.tabs[d.tuix.tab].fields[a])||!f.upload)return!1;for(e in b)w(b,e)&&(g=b[e])&&g.id&&(n+=","+g.id,d.setFileDetails(f,g));""!==n&&d.addToPickedItems(n,a)}};e?I._sHTML5UFDD(d.ajaxURL(),
{fileUpload:1},!1,this.uploadCallback,d.get(M+"fbAdminInner")):I._a(this,b,g,g,g,{fileUpload:1},g,this.ajaxURL())};f.ajaxURL=function(){return V+za+"?method_call=handleAdminBoxAJAX&path="+T(this.path)};f.uploadComplete=function(a){this.uploadCallback!==g&&this.uploadCallback(a);delete this.uploadCallback};f.drawSlider=function(a,e,d,b,h){var l=this,f=_._cl(d.slider);d="";if(q(f.before_field)?h:!h)b&&(d+='<div class="ui-disabled">'),d+=ha("id",M+"slider_for__"+e,z,f[z],Aa,f.style),b&&(d+="</div>"),
a.after(function(){var a;if(a=l.get(M+"slider_for__"+e))f.min!==g&&(f.min=s.num(f.min)),f.max!==g&&(f.max=s.num(f.max)),f.step!==g&&(f.step=s.num(f.step)),f.disabled=!l.editModeOn(),f.value=$(l.get(e)).val(),f.slide=function(a,b){$(l.get(e)).val(b.value)},f.change=function(a,b){l.fieldChange(e)},$(a).slider(f)});return d};f.pickedItemsArray=function(a,e){if(!1===e||null===e||e===g||!(0!==e&&"0"!==e||a.values&&(a.values[0]||a.values["0"])))return{};var d=(e+"").split(","),b={},h,f,p,E,n,m,r;a._display_value=
!1;for(m in d)w(d,m)&&(r=d[m])&&(a.upload&&(n=s._dIIFO(r))&&(n=n.split("/"))&&n[1]?(b[r]=n[1],q(n[2])&&q(n[3])&&(b[r]+=" ["+n[2]+" \u00d7 "+n[3]+"px]")):a.values&&a.values[r]&&"string"==typeof a.values[r]?b[r]=a.values[r]:a.values&&a.values[r]&&a.values[r].label?b[r]=a.values[r].label:((p=a.pick_items&&a.pick_items.target_path)||(p=a.pick_items&&a.pick_items.path))&&(-1==p.indexOf("//")||W.map&&(p=W._cNPTTP(p)))&&(h=H._gIFO(p,r))?(a.values||(a.values={}),f=H._fOIN(h,r),E=h.items&&h.items[r]||{},b[r]=
f,a.values[r]={list_image:E.list_image,css_class:E.css_class||h.item&&h.item.css_class,label:f}):a.upload&&r==1*r&&(n=H._lFD(r))?(this.setFileDetails(a,n),b[r]=a.values[r]):b[r]=r,!1===a._display_value&&(a._display_value=b[r]));return b};f.pickedItemsValue=function(a){var e,d="";if(a)for(e in a)w(a,e)&&(d+=(""===d?"":",")+e);return d};f.hierarchicalBoxes=function(a,e,d,b,h,f,p,E,n,m,r,s,x){var H=1,I=0,y="",F,A,J,G,C=!1;if(!x)x=0,H=1*h.cols||1;else if(10<x)return"";s||(s={});r&&(s[r]=!0);x&&(y+=ha(z,
M+"hierarchical_box_children","id","children_for___"+d+"___"+r,">"));for(var B in n)if(w(n,B)&&(F={},A=n[B],A==1*A&&(A*=1),G=g,J="object"==typeof h.values[A]?h.values[A]:{label:h.values[A]},h.tag_colors&&(F.tag_color=h.tag_colors[A]||"blue"),G=J.parent,"0"===G&&(G=!1),!r&&!G||r==G)){if(F.newRow=++I>H)I=1;F.col=I;F.cols=H;G=b?!0===b||1===b||"1"===b?!0===A||1===A||"1"===A:p?p[A]!==g?!0:!1:A==b:!A;F.checked=G;if("checkboxes"==h.type&&q(h.checking_child_checks_parents)){var k="";r&&(k+="if (this.checked) { for (var cb in "+
JSON.stringify(s)+") { "+this.globalName+".get('"+u(d)+"___' + cb).checked = true; } } ");m[A]&&(k+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");k?f.onchange=h.onchange?k+" "+h.onchange:k:h.onchange?f.onchange=h.onchange:delete f.onchange}else"checkboxes"==h.type&&q(h.checking_parent_checks_children)&&(k="",m[A]&&(k+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),k?f.onchange=h.onchange?
k+" "+h.onchange:k:h.onchange?f.onchange=h.onchange:delete f.onchange);F.lovId=d+"___"+A;F.lovField=J;h.indeterminates&&q(h.indeterminates[A])&&function(b){a.after(function(){var a;if(a=this.get(b))a.indeterminate=!0})}(F.lovId);F.lovHTML=this.drawField(a,e,d,f,g,g,g,g,A,G,!1,E,n,m,J);F.childrenHTML="";m[A]&&(F.childrenHTML=this.hierarchicalBoxes(a,e,d,b,h,f,p,E,n,m,A,_._ex({},s),x+1),I=0);C?(this.splitValues||(this.splitValues={}),this.splitValues[d]||(this.splitValues[d]=""),this.splitValues[d]+=
this.microTemplate(this.mtPrefix+"_radio_or_checkbox",F)):y+=this.microTemplate(this.mtPrefix+"_radio_or_checkbox",F);G&&J.split_values_if_selected&&!x&&"radios"===h.type&&(C=!0)}x&&(y+="</div>");return y};f.drawPickedItem=function(a,e,d,b){d===g&&(d=this.field(e));var h={},f=d.values&&d.values[a];_._isOb(f)?(h=f,f=f.label):(f||(f=a),h.label=f);var p=a==1*a,E,n;e={id:e,item:a,label:f,readOnly:b,css_class:h.css_class,list_image:h.list_image};d.tag_colors&&(e.tag_color=d.tag_colors[a]||"blue");!d.pick_items||
q(d.pick_items.hide_info_button)||d.upload&&!p||!(E=d.pick_items.path)||E!=d.pick_items.target_path&&d.pick_items.min_path!=d.pick_items.target_path||(E="//"==s._rHSS(E,2)?E+a:"/"==s._rHSS(E,1)?E+("/"+a):E+("//"+a),e.organizerPath=E);d.upload&&(e.isUpload=!0,E=(E=(""+f).match(/(.*?)\.(\w+)$/)||(""+f).match(/(.*?)\.(\w+) \[.*\]$/))&&E[2]?E[2].toLowerCase():"unknown",e.extension=E,p?(n=d.values&&d.values[a]&&d.values[a].file)&&n.checksum?(a=V+da+"file.php?c="+T(n.checksum),n.usage&&(a+="&usage="+T(n.usage))):
a=V+da+"file.php?id="+a:a=V+da+"file.php?getUploadedFileInCacheDir="+T(a),E.match(/gif|jpg|jpeg|png|svg/)?(e.thumbnail={onclick:this.globalName+".showPickedItemInPopout('"+a+"&popout=1&dummy_filename="+T("image."+E)+"', '"+f+"');",src:a+"&og=1"},(f=(""+f).match(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&f[1]&&f[2]&&I._rI(f[1],f[2],180,120,e.thumbnail)):e.adminDownload=a+"&adminDownload=1");return this.microTemplate(this.mtPrefix+"_picked_item",e)};f.showPickedItemInPopout=function(a,e){I._a(this,
{popout:{href:a,title:e,css_class:M+"show_colobox_above_fab"}})};f.pickItems=function(a){var e,d,b;(e=this.field(a))&&(d=e.pick_items)&&(d.path||d.target_path)&&(e=d.path,q(d.multiple_select)||e!=d.target_path&&d.min_path!=d.target_path||!(b=this.readField(a))||-1!=b.indexOf(",")||(e="//"==s._rHSS(e,2)?e+b:"/"==s._rHSS(e,1)?e+("/"+b):e+("//"+b)),this.SKTarget=a,H._oS(this.globalName,"setPickedItems",d.multiple_select,e,d.target_path,d.min_path,d.max_path,d.disallow_refiners_looping_on_min_path,g,
d.one_to_one_choose_phrase,d.one_to_many_choose_phrase,g,!0,g,g,g,g,g,g,g,g,d))};f.setPickedItems=function(a,e,d,b){a=this.SKTarget;var f,g,p={};for(f in e._items)w(e._items,f)&&(d=s._dIIFO(f),g=b.items&&b.items[d]||{},p[d]={list_image:g.list_image,css_class:g.css_class||b.item&&b.item.css_class,label:H._fOIN(b,d)});this.addToPickedItems(p,a)};f.removeFromPickedItems=function(a,e,d){this.addToPickedItems(a,e,d,!0)};f.addToPickedItems=function(a,e,d,b){d=this.field(e,d);var f=this.readField(e),g=d.pick_items&&
q(d.pick_items.multiple_select)||d.upload&&q(d.upload.multi),p,s;a=I._cTO(a);s=g&&f?this.pickedItemsArray(d,f):{};for(p in a)if(w(a,p))if(f=a[p],d.values||(d.values={}),b)delete d.values[p];else if(d.values[p]||(d.values[p]=f),s[p]=!0,!g)break;this.redrawPickedItems(e,d,s)};f.redrawPickedItems=function(a,e,d){var b,f,g=this.pickedItemsValue(d),p={},q=$(this.get(a)).tokenize(),n=q.toArray();d=I._cTO(d);for(b in n)w(n,b)&&(f=n[b],d[f]?p[f]=!0:q.tokenRemove(f));for(f in d)w(d,f)&&!p[f]&&(b=e.values&&
e.values[f],_._isOb(b)?b=b.label:b||(b=f),q.tokenAdd(f,b));e.current_value=g;this.fieldChange(a)};f.changes=function(a){if(this.tuix&&this.tuix.tab){if(a==g){for(a in this.tuix.tabs)if(w(this.tuix.tabs,a)&&this.changed[a])return!0;return!1}return this.changed[a]}return!1};f.markAsChanged=function(a){this.tuix&&(a===g&&(a=this.tuix.tab),a&&!this.changed[a]&&(this.changed[a]=!0,this.tuix.tab==a&&$(O+"abtab").addClass(M+"abtab_changed")))};f.fieldChange=function(a,e){var d=this,b=this.field(a);b&&(b.indeterminate&&
(b.indeterminate=!1),e!==g&&b.indeterminates&&b.indeterminates[e]&&(b.indeterminates[e]=!1),this.markAsChanged(),q(b.multiple_edit)&&this.meMarkChanged(a),setTimeout(function(){d.validateFormatOrRedrawForField(b)},1))};f.validateFormatOrRedrawForField=function(a){a=this.field(a);var e=q(a.validate_onchange),d=q(a.format_onchange);a=q(a.redraw_onchange);if(e)return 3>this.ffoving&&(this.ffoving=3,this.validate()),!0;if(d)return 2>this.ffoving&&(this.ffoving=2,this.format()),!0;a&&1>this.ffoving&&(this.ffoving=
1,this.readTab(),this.redrawTab());return a};f.meMarkChanged=function(a,e,d){if(e===g||e!=d)this.field(a).multiple_edit._changed=!0,this.meSetCheckbox(a,!0)};f.meSetCheckbox=function(a,e){"checkbox"==this.get("multiple_edit__"+a).type?this.get("multiple_edit__"+a).checked=e:this.get("multiple_edit__"+a).value=e?1:""};f.meChange=function(a,e,d){var b=this.field(e);if(a)b.multiple_edit._changed=!0;else{if(!d&&q(b.multiple_edit.warn_when_abandoning_changes)&&b.multiple_edit.original_value!==g&&this.readField(e)!=
b.multiple_edit.original_value){b=ia(Z,P,z,"submit_selected",J,Q.abandonChanges,ma,this.globalName+'.meChange(false, "'+X(e)+'", true);')+ia(Z,P,z,aa,J,Q.cancel);H._flBo(Q.abandonChangesConfirm,b,"warning");this.meSetCheckbox(e,!0);return}b.multiple_edit._changed=!1;delete b.current_value;d=b.value;b.multiple_edit.original_value!==g&&(d=b.current_value=b.multiple_edit.original_value);if(this.get(e)&&!b.pick_items)"checkbox"==this.get(e).type?this.get(e).checked=d?!0:!1:$(this.get(e)).val(d||"");else{d=
new s.callback;var f=this.drawFields(d);this.insertHTML(f,d)}}q(b.multiple_edit.disable_when_unchanged)&&(this.get(e)&&(this.get(e).disabled=!a),$(".control_for__"+e).each(function(b,d){d.disabled=!a;d.type==P&&(a?$(d).removeClass("submit_disabled"):$(d).addClass("submit_disabled"))}));this.meSetCheckbox(e,a);this.validateFormatOrRedrawForField(e)};f.currentValue=function(a,e,d){return d||e!=this.tuix.tab?this.value(a,e,d):this.readField(a)};f.value=function(a,e,d,b){e||(e=this.tuix.tab);var f="";
a=this.field(a,e);if(!a)return"";d===g&&(d=!this.editModeOn(e)||a.read_only||a.readonly);a&&!a.snippet&&"grouping"!=a.type&&(!b&&this.isButton(a)?f=!!a.pressed:d||a.current_value===g?a.value!==g?f=a.value:a.multiple_edit&&a.multiple_edit.original_value!==g&&(f=a.multiple_edit.original_value):f=a.current_value);return"0"===f?0:f};f.keyIn=function(a){return _.contains(arguments,this.tuix.key[a],1)};f.keyIs=function(a,e){return this.tuix.key[a]==e};f.key=function(a){return this.tuix.key[a]};f.modeIn=
function(){return _.contains(arguments,this.value("mode"))};f.modeIs=function(a){return this.value("mode")==a};f.valueIn=function(a){return _.contains(arguments,this.value(a),1)};f.valueIs=function(a,e){return this.value(a)==e};f.valueIsNot=function(a,e){return this.value(a)!=e};f.isButton=function(a){return a&&(a.type==aa||"toggle"==a.type||a.type==P)};f.isFormField=function(a){return!(!a||a.snippet||"grouping"==a.type||a.type==aa||"toggle"==a.type||a.type==P)};f.readField=function(a){var e=g,d=
this.tuix.tab,b=this.field(a,d),f;if(!this.isFormField(b))return g;var l=!this.editModeOn()||q(b.read_only)||q(b.readonly),p=b._was_hidden_before;b.multiple_edit&&l&&delete b.multiple_edit._changed;if("checkboxes"==b.type||"radios"==b.type){if(!l&&!p&&b.values){var u,p="",n=!0;for(u in b.values)w(b.values,u)&&this.get(a+"___"+u)&&this.get(a+"___"+u).checked&&(p+=(n?"":",")+u,n=!1);b.current_value=p}p=!0}if(p)return l||b.current_value===g?b.value:b.current_value;if(this.get("_value_for__"+a))b.current_value=
e=this.get("_value_for__"+a).value;else if("editor"!=b.type&&"code_editor"!=b.type||l)if(!l&&(f=this.get(a))){if("checkbox"==b.type||"radio"==b.type)e=f.checked?!0:!1;else if("color_picker"==b.type||"colour_picker"==b.type)try{e=$(f).spectrum("get").toHexString()}catch(m){e=$(f).val()}else e=$(f).val();_._isAr(e)&&(e=e.join(","));b.current_value=e}else delete b.current_value,e=b.value;else if(e=g,"editor"==b.type?ca.tinyMCE&&tinyMCE.get(a)&&(e=s._tMGC(tinyMCE.get(a))):"code_editor"==b.type&&(f=ace.edit(a))&&
(e=f.getValue(),this.editingPositions[d+"/"+a]={top:f.session.getScrollTop(),left:f.session.getScrollLeft(),range:f.getSelectionRange()}),e!==g&&!1!==e)e=b.current_value=e;else return b.current_value===g?b.value:b.current_value;return e};f.blankField=function(a){this.setFieldValue(a,"")};f.setFieldValue=function(a,e){field=this.field(a,this.tuix.tab);this.get(a)&&$(this.get(a)).val(e);this.get("_value_for__"+a)&&(this.get("_value_for__"+a).value=e);field.current_value=e};f.readTab=function(){var a,
e={},d=this.fields(),b;this.lastScrollTop=$(O+"fbAdminInner").scrollTop();for(b in d)w(d,b)&&(a=this.readField(b))!==g&&(e[b]=a);R&&R.activeElement&&(this.lastFieldInFocus=R.activeElement.id);return e};f.wipeTab=function(){var a=this.fields(),e,d;for(e in a)w(a,e)&&(d=a[e],delete d.current_value,d.multiple_edit&&delete d.multiple_edit._changed)};f.redrawTab=function(){this.tuix.shake=!1;this.draw2()};f.getURL=function(a){++this.onKeyUpNum;return this.returnAJAXURL(a)};f.returnAJAXURL=function(a){return"..."};
f.editModeOn=function(a){return!0};f.editModeAlwaysOn=function(a){return!0};f.editCancelEnabled=function(a){return!1};f.revertEnabled=function(a){return!1};f.savedAndContinued=function(a){return!1};f.editModeOnBox=function(){return!0};f.sortTabs=function(){this.sortedTabs=[];if(this.tuix.tabs)for(var a in this.tuix.tabs)if(w(this.tuix.tabs,a)){var e=this.tuix.tabs[a];e&&this.sortedTabs.push([a,e.ord])}this.sortedTabs.sort(I.sortArray);this.groupings={};this.sortedFields={};for(a in this.sortedTabs)w(this.sortedTabs,
a)&&(e=this.sortedTabs[a]=this.sortedTabs[a][0],this.sortFields(e))};f.sortFields=function(a){var e,d,b,f,l={};this.groupings[a]={};this.sortedFields[a]=[];if(b=this.fields(a)){for(e in b)w(b,e)&&(d=b[e],d.type&&"grouping"==d.type&&(l[d.name||e]=1*d.ord,this.groupings[a][d.name||e]=e));for(e in b)w(b,e)&&(!(d=b[e])||d.type&&"grouping"==d.type||(f=d.grouping?l[d.grouping]:g,this.sortedFields[a].push([e,d.ord,f])));this.sortedFields[a].sort(I.sortArrayWithGrouping);for(e in this.sortedFields[a])w(this.sortedFields[a],
e)&&(this.sortedFields[a][e]=this.sortedFields[a][e][0])}};f.setData=function(a){this.tuix=a};f.setDataDiff=function(a){this.syncAdminBoxFromServerToClient(a,this.tuix)};f.syncAdminBoxFromServerToClient=function(a,e){var d,b;for(d in a)w(a,d)&&(b=a[d],null===b||b["[[__unset__]]"]?delete e[d]:e[d]===g||null===e[d]?e[d]=b:b["[[__replace__]]"]?(delete b["[[__replace__]]"],e[d]=b):"object"!=typeof e[d]?e[d]=b:"object"==typeof e[d]&&"object"!=typeof b?e[d]=b:this.syncAdminBoxFromServerToClient(b,e[d]))};
f.sendStateToServer=function(){return JSON.stringify(this.tuix)};f.sendStateToServerDiff=function(){var a={};this.syncAdminBoxFromClientToServerR(a,this.tuix);return JSON.stringify(a)};f.syncAdminBoxFromClientToServerR=function(a,e,d,b,f,l,p,q){if("object"==typeof e){var n,m;for(m in e)if(d===g&&s.IN(m,"download","path","shake","tab")&&(n=J)||d===g&&s.IN(m,"_sync","tabs")&&(n="array")||b===g&&"_sync"==d&&s.IN(m,"cache_dir","password","session","iv")&&(n=J)||b===g&&"tabs"==d&&(n="array")||f===g&&"tabs"==
b&&s.IN(m,"edit_mode","fields")&&(n="array")||l===g&&"tabs"==f&&"edit_mode"==d&&"on"==m&&(n=J)||l===g&&"tabs"==f&&"fields"==d&&(n="array")||p===g&&"tabs"==l&&"fields"==b&&s.IN(m,"_display_value","_was_hidden_before","current_value","pressed")&&(n=J)||p===g&&"tabs"==l&&"fields"==b&&"multiple_edit"==m&&(n="array")||q===g&&"tabs"==p&&"fields"==f&&"multiple_edit"==d&&"_changed"==m&&(n=J))n==J?"function"!=typeof e[m]&&"object"!=typeof e[m]&&(a[m]=e[m]):"array"==n&&"object"==typeof e[m]&&(a[m]={},this.syncAdminBoxFromClientToServerR(a[m],
e[m],m,d,b,f,l,p))}};f.getValueArrayofArrays=function(a){return s._nAA(this.getURL(),s._uR({_read_values:!0,_box:this.sendStateToServer()}),!a)};f.getValues1D=function(a,e,d,b,f){var l,p,s,n,m,r={};if(this.tuix&&this.tuix.tabs)for(l in this.tuix.tabs)if(w(this.tuix.tabs,l)&&(p=this.tuix.tabs[l],p.fields))for(s in p.fields)w(p.fields,s)&&(n=p.fields[s],m=s,this.isFormField(n)&&!(b&&(!this.editModeOn(l)||q(n.read_only)||q(n.readonly))||f&&(n._was_hidden_before||q(n.read_only)||q(n.readonly))||a&&!(m=
n.plugin_setting&&n.plugin_setting.name))&&(n=this.currentValue(s,l,d),e||(r[m]=n),e||e===g))&&(r[l+"/"+s]=n);return r};f.insertText=function(a,e){_._iS(a)&&(a=this.get(a));if(a){var d=$(a),b=a.selectionStart,f=a.selectionEnd,g=d.val();d.val(g.substring(0,b)+e+g.substring(f));a.selectionStart=a.selectionEnd=b+e.length;a.focus()}};f.callFunctionOnEditors=function(a){var e,d,b;if(ca.tinyMCE&&(e=this.fields()))for(d in e)if(w(e,d)&&(b=e[d],"editor"==b.type&&tinyMCE.get(d)))if("remove"==a)tinyMCE.get(d).remove();
else if("isDirty"==a&&tinyMCE.get(d).isDirty())return!0;return!1};f.format=function(a){var e;if(this.loaded&&(e=this.getURL("format"))){var d=this;this.loaded=!1;this.hideTab();this.checkValues(a);this.retryAJAX(e,{_format:!0,_box:this.sendStateToServer()},!0,function(a){d.load(a);d.sortTabs();d.draw()},"loading")}};f.validate=function(a,e,d,b){var f;if(this.loaded&&(f=this.getURL("validate"))){this.differentTab=a;this.loaded=!1;this.hideTab(a);this.checkValues(d);var l=this;this.retryAJAX(f,{_validate:!0,
_box:this.sendStateToServer()},!0,function(a){l.load(a)&&!l.errorOnTab(l.tuix.tab)&&e!==g&&(l.tuix.tab=e);l.sortTabs();l.switchToATabWithErrors();l.draw();b&&b()},"loading")}}})},zenarioF);
