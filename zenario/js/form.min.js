zenario.lib(function(h,L,I,Q,g,X,x,w,T,Y,M,s,p,r,C,R,D,Z,U,u,V){g=U(V);g.init=function(a,d){this.encapName=this.globalName=a;this.mtPrefix=d||"zenario_admin_box";this.baseCSSClass="";this.onKeyUpNum=0;T.sizing=!1;this.cachedAJAXSnippets={};this.changed={};this.toggleLevelsPressed={};this.lastFieldInFocus=!1;this.editingPositions={}};g.microTemplate=function(a,d,b){return w._mT(a,d,b)};g.onThisRow=function(a,d){return a+d.replace(/\D/g,"")};g.valueOnThisRow=function(a,d){return this.value(this.onThisRow(a,
d))};g.getKey=function(a){return this.tuix&&this.tuix.key};g.getKeyId=function(a){return this.tuix&&this.tuix.key&&this.tuix.key.id};g.getLastKeyId=function(a){return this.getKeyId(a)};g.getTitle=function(){var a,d;if(this.tuix.key&&this.tuix.key.id&&(a=this.tuix.title_for_existing_records)){d=this.getValues1D(!1,h,!0);for(c in d)if(u(d,c)&&(v=d[c],-1!=a.indexOf("[["+c+"]]")))for(;a!=(string2=a.replace("[["+c+"]]",v));)a=string2;return a}return this.tuix.title};g.field=function(a,d){return _._isOb(a)?
a:(tabs=this.tuix&&this.tuix.tabs)&&(d=d||this.tuix.tab)&&tabs[d]&&tabs[d].fields&&tabs[d].fields[a]};g.fields=function(a){var d;return(d=this.tuix&&this.tuix.tabs)&&(a=a||this.tuix.tab)&&d[a]&&d[a].fields};g.initFields=function(){var a,d,b,f;if(this.tuix.tabs)for(a in this.tuix.tabs)if(u(this.tuix.tabs,a)&&(b=this.fields(a)))for(d in b)u(b,d)&&(f=b[d])&&(f.pick_items&&f.plugin_setting&&f.plugin_setting.use_value_for_plugin_name?this.pickedItemsArray(d,this.value(d,a,!1)):f.values&&_._iS(f.values)&&
this.tuix.lovs[f.values]?f.values=this.tuix.lovs[f.values]:f.load_values_from_organizer_path&&!f.values&&this.loadValuesFromOrganizerPath(f))};g.loadValuesFromOrganizerPath=function(a){var d,b,f;if(a.load_values_from_organizer_path&&!a.values&&(a.values={},(b=w._gIFO(a.load_values_from_organizer_path))&&b.items))for(d in b.items)u(b.items,d)&&(f=b.items[d],a.values[x._dIIFO(d)]={list_image:f.list_image,css_class:f.css_class||b.item&&b.item.css_class,label:w._fOIN(b,d)})};g.changeMode=function(){this.editCancelEnabled(this.tuix.tab)&&
(this.editModeOn()?this.editCancelOrRevert("cancel",this.tuix.tab):this.editCancelOrRevert("edit",this.tuix.tab))};g.revertTab=function(){this.changes(this.tuix.tab)&&this.revertEnabled(this.tuix.tab)&&this.editCancelOrRevert("revert",this.tuix.tab)};g.editCancelOrRevert=function(a,d){if(this.tuix.tabs[d].edit_mode){var b,f,e,k,O,n;"edit"==a?(O=p(this.tuix.tabs[d].edit_mode.format_on_edit),n=p(this.tuix.tabs[d].edit_mode.validate_on_edit)):"cancel"==a?(O=p(this.tuix.tabs[d].edit_mode.format_on_cancel_edit),
n=p(this.tuix.tabs[d].edit_mode.validate_on_cancel_edit)):"revert"==a&&(O=p(this.tuix.tabs[d].edit_mode.format_on_revert),n=this.errorOnTab(d)||p(this.tuix.tabs[d].edit_mode.validate_on_revert));if(!n&&(f=this.fields(d)))for(e in f)if(u(f,e))if(k=f[e],p(k.validate_onchange)&&(b=this.readField(e))!==h&&b!=k.value){n=!0;break}else!O&&p(k.format_onchange)&&(b=this.readField(e))!==h&&b!=k.value&&(O=!0);this.tuix.tabs[d].edit_mode.on="cancel"!=a;this.changed[d]=!1;n?this.validate(h,h,!0):O?this.format(!0):
(this.wipeTab(),this.redrawTab(!0));this.tuix.tab==d&&$("#zenario_abtab").removeClass("zenario_abtab_changed")}};g.clickTab=function(a){this.loaded&&this.validate(a!=this.tuix.tab,a)};g.clickButton=function(a,d){var b=this.field(d);"submit"==b.type?(b.pressed=!0,this.validate(!0)):"toggle"==b.type?((b.pressed=!p(b.pressed))?$("#"+d).removeClass("not_pressed").addClass("pressed"):$("#"+d).removeClass("pressed").addClass("not_pressed"),this.validateFormatOrRedrawForField(b)):"button"==b.type&&(b.pressed=
!0,this.validateFormatOrRedrawForField(b))};g.togglePressed=function(a,d){var b;b=a?1<a?this.toggleLevelsPressed[a-1]:!0:this.toggleLevelsPressed.last;b===h&&(b=!0);d&&"toggle"==d.type&&(this.toggleLevelsPressed.last=b&&p(d.pressed),a&&(this.toggleLevelsPressed[a]=this.toggleLevelsPressed.last));return b};g.toggleLevel=function(a){return this.toggleLevelsPressed.last};g.retryAJAX=function(a,d,b,f){var e=function(){x._a(a,d,h,h,e).after(b);f&&w.nowDoingSomething&&w._nDS(f)};e()};g.switchToATabWithErrors=
function(){var a,d,b=this.tuix;if(b&&b.tabs&&!this.errorOnTab(b.tab))for(a in this.sortedTabs)if(u(this.sortedTabs,a)&&(d=this.sortedTabs[a],b.tabs[d]&&!w._h(h,h,d,b,h,h,h,h,b.tabs[d])&&this.errorOnTab(d)))return b.tab=d,!0;return!1};g.applyMergeFields=function(a,d,b,f){return a};g.applyMergeFieldsToLabel=function(a,d,b,f){return a};g.hideTab=function(a){var d=this;a?($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled","disabled"),$("#zenario_abtab").clearQueue().show().animate({opacity:0.8},
200,function(){d.tabHidden=!0;d.draw()})):($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled","disabled").animate({opacity:0.9},100),this.tabHidden=!0,this.draw())};g.draw=function(){this.loaded&&this.tabHidden&&this.draw2()};g.draw2=function(){};g.drawTabs=function(a){a||(a=this.mtPrefix+"_tab");var d,b,f=[],e,k;for(e in this.sortedTabs)if(u(this.sortedTabs,e)&&(k=this.sortedTabs[e],(d=this.tuix.tabs[k])&&!w._h(h,h,k,this.tuix,h,h,h,h,d))){b="";
if(d.fields&&!_._isEm(d.fields)||d.fields&&!_._isEm(d.errors)||d.fields&&!_._isEm(d.notices))b=this.globalName+".clickTab('"+R(k)+"');";!this.tuix.tab&&b&&(this.tuix.tab=k);f.push({id:k,tabId:k,tuix:d,onclick:b,current:this.tuix.tab==k,label:d.label})}w._sBK(f,"zenario_fab_tab_with_children");return this.microTemplate(a,f)};g.drawFields=function(a,d){w._cHTML5UFDD();this.splitValues={};var b=this.tuix.tab,f=this.tuix.tabs[b],e="",k="",h=this.fields(b),n=!1;!this.savedAndContinued(b)&&this.editCancelEnabled(b)&&
(k='<div class="zenario_editCancelButton"><input class="submit" type="button" onclick="'+this.globalName+'.changeMode(); return false;" value="'+(this.editModeOn()?D.cancel:D.edit)+'"></div>');var l=!1,m,g,s,k={fields:{},rows:[],tabId:b,path:this.path,tuix:this.tuix,revert:k,errors:[],notices:{}};if(this.editModeOn()){if(f.errors)for(m in f.errors)u(f.errors,m)&&(g=f.errors[m],k.errors.push({message:g}));if(h)for(m in h)u(h,m)&&(g=h[m],g.error&&k.errors.push({message:g.error}))}if(f.notices)for(m in f.notices)u(f.notices,
m)&&(g=f.notices[m],p(g.show)&&{error:1,warning:1,question:1,success:1}[g.type]&&(k.notices[m]=g));for(var r in this.sortedFields[b])u(this.sortedFields[b],r)&&(m=this.sortedFields[b][r],g=h[m],g._id=m,g._html=this.drawField(a,b,m,!0,g,n),n=g._was_hidden_before,!1!==g._html&&(g._lastGrouping=s,s!==g.grouping&&(s=g.grouping,g._startNewRow=!0),!g._startNewRow&&k.rows.length||k.rows.push({fields:[]}),l||f.show_errors_after_field!=m||(k.rows[k.rows.length-1].errors=k.errors,k.rows[k.rows.length-1].notices=
k.notices,l=!0),k.rows[k.rows.length-1].fields.push(g),k.fields[m]=g));k.rows.length&&(k.rows[k.rows.length-1].fields[0]._isLastRow=!0);l||k.rows.splice(0,0,{errors:k.errors,notices:k.notices});d=d||f.template||this.mtPrefix+"_current_tab";e+=this.microTemplate(d,k);for(r in this.sortedFields[b])u(this.sortedFields[b],r)&&(m=this.sortedFields[b][r],delete h[m]._lastGrouping,delete h[m]._startNewRow,delete h[m]._hideOnOpen,delete h[m]._showOnOpen,delete h[m]._isLastRow,delete h[m]._html,delete h[m]._id);
return e};g.insertHTML=function(a,d,b){var f=s("zenario_abtab"),e;f.innerHTML=a;this.tabHidden=!1;this.changes(this.tuix.tab)?$(f).addClass("zenario_abtab_changed"):$(f).removeClass("zenario_abtab_changed");d.call();!b&&this.lastFieldInFocus&&(e=s(this.lastFieldInFocus))&&e.focus()};g.hideShowFields=function(a){var d=$(".zenario_hide_on_open"),b=$(".zenario_hide_row_on_open"),f=$(".zenario_show_on_open"),e=function(a,b){b.style.display="none"};f.length&&!d.length?f.show("blind",200,a):!f.length&&
d.length?d.hide("blind",200,function(){b.each(e)}):f.length&&d.length&&(d.each(e),b.each(e),f.show())};g.addJQueryElementsToTab=function(){x._aJQE("#zenario_abtab ",!0)};g.addJQueryElementsToTabAndFocusFirstField=function(){x._aJQE("#zenario_abtab ",!0);this.focusFirstField()};g.focusFirstField=function(){if(this.tuix&&!p(this.tuix.tabs[this.tuix.tab].disable_autofocus)){var a=-1,d=[],b=h,f,e,k,g,n;for(f in this.sortedFields[this.tuix.tab])if(u(this.sortedFields[this.tuix.tab],f)&&(g=this.sortedFields[this.tuix.tab][f],
(e=s(g))&&(k=this.field(g))&&((n=k.pick_items||k.upload)||$(e).is(":visible"))&&(d[++a]={id:g,type:k.type,empty:""==e.value,focusable:(n||x._IN(k.type,"password","checkbox","select","text","textarea"))&&!p(e.disabled)&&!p(e.readonly)&&!p(k.read_only)},1<a)))break;if(d[0]&&!d[0].empty&&d[1]&&d[1].focusable&&d[1].empty&&"password"==d[1].type)b=1;else if(d[0]&&d[0].focusable)b=0;else if(d[1]&&d[1].focusable)b=1;else return;setTimeout(function(){k=d[b];k.type?s(k.id).focus():$(s("name_for_"+k.id)).find(".TokenSearch input").focus()},
50)}};g.focusField=function(){this.fieldToFocus&&s(this.fieldToFocus)&&$(s(this.fieldToFocus)).is(":visible")&&s(this.fieldToFocus).focus();delete this.fieldToFocus};g.errorOnBox=function(){if(this.tuix&&this.tuix.tabs)for(tab in this.tuix.tabs)if(u(this.tuix.tabs,tab)&&this.errorOnTab(tab))return!0;return!1};g.errorOnTab=function(a){var d;if(this.tuix.tabs[a]&&this.editModeOn(a)){if(this.tuix.tabs[a].errors)for(d in this.tuix.tabs[a].errors)if(u(this.tuix.tabs[a].errors,d))return!0;if(a=this.fields(a))for(d in a)if(u(a,
d)&&a[d].error)return!0}};g.checkValues=function(a){a?this.wipeTab():this.readTab();for(var d in this.tuix.tabs)if(u(this.tuix.tabs,d)){a=this.tuix.tabs[d];var b=this.editModeOn(d);if(a.fields)for(var f in a.fields)if(u(a.fields,f)){var e=a.fields[f];this.isFormField(e)&&("code_editor"==e.type&&x._cAD("code_editor_"+f),e.current_value===h&&(e.current_value=this.value(f,d,!0)),b&&(e.value===h&&(e.value=this.value(f,d,!1)),e.multiple_edit&&e.multiple_edit._changed===h&&e.multiple_edit.changed!==h&&
(e.multiple_edit._changed=e.multiple_edit.changed)))}}I&&I.activeElement&&(this.lastFieldInFocus=I.activeElement.id)};g.enableMicroTemplates=function(a,d){for(var b in d)if(u(d,b))switch(typeof d[b]){case "object":"that"!==b&&"tuix"!==b&&this.enableMicroTemplates(a,d[b]);break;case "string":"type"===b||"value"===b&&this.isFormField(d)||"current_value"===b||!d[b].match(/(\{\{|\{\%|\<\%)/)||function(a,b,d){d=x._gMT(a[b]);a[b]=function(){return d(a)}}(d,b)}};g.drawField=function(a,d,b,f,e,k,g,n,l,m,
q,P,J){e===h&&(e=this.field(b,d));e.id===h&&(e.id=b);p(e.enable_microtemplates_in_properties)&&this.enableMicroTemplates(e,e);l===h&&(l=!this.editModeOn()||p(e.read_only));e.type&&"datetime"==e.type&&(l=!0);J?J.disabled_if!==h&&w._e(J.disabled_if,J,h,g,this.tuix,h,h,e)&&(l=!0):e.disabled_if!==h&&w._e(e.disabled_if,h,h,b,this.tuix,h,h,e)&&(l=!0);if(e.type&&"grouping"==e.type)return"";var N=this,W={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,
tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,onmouseover:!0,onmouseup:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,max:!0,min:!0,pattern:!0,placeholder:!0,required:!0,step:!0},z;f="";var B,y,E={},G=!1,t={"class":""},H={},F=!0,I=!1;!e["class"]&&e.css_class&&(e["class"]=e.css_class);e.snippet||n!==h||(n=this.value(b,d,h,!0));n===h&&(n="");g===h&&((e.upload||e.pick_items)&&""!=
n&&(E=this.pickedItemsArray(e,n)),e.values&&_._iS(e.values)&&this.tuix.lovs[e.values]?e.values=this.tuix.lovs[e.values]:e.load_values_from_organizer_path&&!e.values&&this.loadValuesFromOrganizerPath(e));if(!(q&&P||"object"!=typeof e.values))if(q=[],P={},e.upload&&p(e.upload.reorder_items))for(B in y=n.split(","),y)u(y,B)&&(z=y[B],q.push(z));else{for(z in e.values)u(e.values,z)&&(y=e.values[z],"object"==typeof y?(y.parent!==h&&(I=!0,P[y.parent]=!0),w._h(y,h,z,this.tuix,h,h,e)||(y.ord!==h?q.push([z,
y.ord]):y.label!==h?q.push([z,y.label]):q.push([z,z]))):q.push([z,y]));q.sort(w.sortArray);for(B in q)u(q,B)&&(q[B]=q[B][0])}if(g===h){e._startNewRow=!p(e.same_row);z=w._h(h,h,b,this.tuix,h,h,e);k&&p(e.hide_with_field_above)&&(z=!0);if(e._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=e.type&&"code_editor"!=e.type&&e._was_hidden_before&&!z)e._showOnOpen=!0,delete e._was_hidden_before;else if(e._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=e.type&&
"code_editor"!=e.type&&!e._was_hidden_before&&z)e._hideOnOpen=!0,e._was_hidden_before=!0;else{if(z)return e._was_hidden_before=!0,!1;delete e._was_hidden_before}k="";z=!1;e.multiple_edit&&(z=l||e.multiple_edit._changed===h?e.multiple_edit.changed:p(e.multiple_edit._changed),p(e.multiple_edit.disable_when_unchanged)&&!z&&(m=!0),p(e.multiple_edit.hide_ui)||!e.multiple_edit.select_list?(k+='<input type="checkbox" class="multiple_edit" id="multiple_edit__'+r(b)+'"'+(z?' checked="checked"':""),k=p(e.multiple_edit.hide_ui)?
k+' style="display: none;"':l?k+' disabled="disabled"':k+(' onchange="'+this.globalName+".meChange(this.checked, '"+r(b)+"');\""),k+="/> "):(k+='<select class="multiple_edit" id="multiple_edit__'+r(b)+'"',k=l?k+' disabled="disabled"':k+(' onchange="'+this.globalName+".meChange(this.value == 1, '"+r(b)+"');\""),k+='><option value=""'+(z?"":' selected="selected"')+">"+C(e.multiple_edit.select_list.not_changed_label,D.notChanged)+'</option><option value="1"'+(z?' selected="selected"':"")+">"+C(e.multiple_edit.select_list.changed_label,
D.changed)+"</option></select> "));f+=k;k=h;e.pre_field_html!==h&&(f+=x._un(e.pre_field_html))}if(l||m)t.disabled="disabled";if(e.snippet){e.snippet.separator&&(f+='<hr class="input_separator"',e.snippet.separator.style&&(f+=' style="'+r(e.snippet.separator.style)+'"'),f+="/>");e.snippet.label&&(f+='<label id="label__'+r(b)+'">'+r(e.snippet.label)+"</label>");if(e.snippet.show_split_values_from)if(this.splitValues&&this.splitValues[e.snippet.show_split_values_from])f+=this.splitValues[e.snippet.show_split_values_from],
delete this.splitValues[e.snippet.show_split_values_from];else return!1;e.snippet.html?f+='<span id="snippet__'+r(b)+'">'+e.snippet.html+"</span>":e.snippet.url&&(f=p(e.snippet.cache)?this.cachedAJAXSnippets[e.snippet.url]?f+this.cachedAJAXSnippets[e.snippet.url]:f+(this.cachedAJAXSnippets[e.snippet.url]=x._nAA(x._aBP(e.snippet.url))):f+x._nAA(x._aBP(e.snippet.url)))}else if(("checkboxes"==e.type||"radios"==e.type)&&g===h)e.values&&(E=this.pickedItemsArray(e,n),J=_._ex({},e),J.name=C(e.name,b),J.type=
"checkboxes"==e.type?"checkbox":"radio",l&&(J.disabled=!0),f+=this.hierarchicalBoxes(a,d,b,n,e,J,E,m,q,P));else if(e.upload||e.pick_items){var S=e.pick_items&&p(e.pick_items.multiple_select)||e.upload&&p(e.upload.multi);n={id:b,pickerHTML:"",wrappedId:"name_for_"+b,readOnly:l,tempReadOnly:m};l||(e.pick_items&&(e.pick_items.target_path||e.pick_items.path)&&!p(e.pick_items.hide_select_button)&&(n.select={onclick:this.globalName+".pickItems('"+r(b)+"');",phrase:e.pick_items.select_phrase||D.selectDotDotDot}),
e.upload&&(n.upload={onclick:this.globalName+".upload('"+r(b)+"');",phrase:e.upload.upload_phrase||D.uploadDotDotDot},p(e.upload.drag_and_drop)&&this.upload(b,!0),Q.Dropbox&&Dropbox.isBrowserSupported()&&(n.dropbox={onclick:this.globalName+".chooseFromDropbox('"+r(b)+"');",phrase:e.upload.dropbox_phrase||D.dropboxDotDotDot})));n.pickerHTML+='<select id="'+r(b)+(S?'" multiple="multiple':"")+'">';e.values&&!_._isEm(E)&&(n.pickerHTML+=this.hierarchicalSelect(E,e,q,I,P));n.pickerHTML+="</select>";f+=
this.microTemplate(this.mtPrefix+"_picked_items",n);a.after(function(){N.setupPickedItems(b,d,e,l,S)})}else if(e.type){t.onchange=g?this.globalName+".fieldChange('"+r(b)+"', '"+r(g)+"');":this.globalName+".fieldChange('"+r(b)+"');";e.disabled&&(t["class"]+="disabled ");e.return_key_presses_button&&!l&&(t.onkeyup=C(t.onkeyup,"","")+"if (event.keyCode == 13) {$('#"+r(e.return_key_presses_button)+"').click();}");p(e.multiple_edit)&&!l&&(t.onkeyup=C(t.onkeyup,"","")+"if (event && event.keyCode == 9) return true; "+
this.globalName+".meMarkChanged('"+r(b)+"', this.value, '"+r(e.value)+"');");t["class"]+="input_"+e.type;switch(e.type){case "select":e.slider&&(G=!0,f+=this.drawSlider(a,b,e,l,!0));f+="<select";break;case "code_editor":f+="<div";t["class"]=" zenario_embedded_ace_editor";a.after(function(){var a=ace.edit(b),f=!1,k;a.session.setUseSoftTabs(!1);a.setShowPrintMargin(!1);l&&(a.setReadOnly(!0),a.setBehavioursEnabled(!1));p(e.wrap_text)&&a.session.setUseWrapMode(!0);a.session.setOption("useWorker",!1);
a.on("blur",function(a){f&&x._aADINS("code_editor_"+b,function(){N.fieldChange(b)},0);f=!1});a.on("change",function(a){N.markAsChanged();f=!0;x._aADINS("code_editor_"+b,function(){N.fieldChange(b)},5E3)});if(language=e.language)try{language=language.match(/\.twig\.html$/i)?"ace/mode/twig":language.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(language).mode:"ace/mode/"+language,a.session.setMode(language),a.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})}catch(h){console.log("Ace editor could not load that language",
language)}a.$blockScrolling=Infinity;if(k=N.editingPositions[d+"/"+b])a.session.setScrollTop(k.top),a.session.setScrollLeft(k.left),a.selection.setSelectionRange(k.range)});break;case "color_picker":case "colour_picker":f+="<input";t["class"]=" zenario_color_picker";a.after(function(){var a=e.color_picker_options||e.colour_picker_options||{};a.disabled=l;a.preferredFormat=a.preferredFormat||"hex";$(s(b)).spectrum(a)});break;case "editor":f+="<textarea";w._gSD();var K;m={script_url:L+x.tinyMCEPath,
inline:!1,menubar:!1,statusbar:!1,plugins:"autoresize",document_base_url:h,convert_urls:!1,readonly:!0,inline_styles:!1,allow_events:!0,allow_script_urls:!0,autoresize_max_height:Math.max(Math.floor(0.5*$(Q).height()),300),autoresize_bottom_margin:10,onchange_callback:function(a){N.fieldChange(a.id)},init_instance_callback:function(a){w._eDDUITM(!1,h,s("row__"+C(a.editorId,a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&w._eDDUITM(!1,
h,b)}};E=_._ex({},m,{plugins:["advlist autolink lists link image charmap hr anchor","searchreplace code fullscreen","nonbreaking table contextmenu directionality","paste autoresize"],image_advtab:!0,visual_table_class:" ",browser_spellcheck:!0,paste_preprocess:w.tinyMCEPasteRreprocess,readonly:!1,convert_urls:!0,relative_urls:!1,content_css:h,toolbar:"undo redo | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code",style_formats:w.skinDesc.style_formats,
oninit:h});k=_._ex({},E,{toolbar:"undo redo | image link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code",file_browser_callback:w.fileBrowser,init_instance_callback:function(a){w._eDDUITM(!0,L,s("row__"+C(a.editorId,a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&w._eDDUITM(!0,L,b)}});z=_._ex({},k,{toolbar:"undo redo | image | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code"});
y=_._ex({},z,{toolbar:"undo redo | link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code"});l?(K=m,t["class"]=" tinymce_readonly"):e.insert_image_button?e.insert_link_button?(K=k,t["class"]=" tinymce_with_images_and_links"):(K=z,t["class"]=" tinymce_with_images"):e.insert_link_button?(K=y,t["class"]=" tinymce_with_links"):(K=E,t["class"]=" tinymce");t.style="visibility: hidden;";_._isOb(e.editor_options)&&(K=_._ex(K,e.editor_options));K.setup=
function(a){a.on("change",function(a){N.fieldChange(a.id)})};a.after(function(){var a=$(s(b)),d=s("zenario_abtab"),e=d.style.display;d.style.display="block";a.tinymce(K);d.style.display=e});break;case "button":case "submit":e.pressed=!1;case "toggle":f+="<input";t.type="button";if(!l||p(e.can_be_pressed_in_view_mode))H.onclick=this.globalName+".clickButton(this, '"+b+"');",delete t.disabled;"toggle"==e.type&&(t["class"]+=e.pressed?" pressed":" not_pressed");break;default:"textarea"==e.type?f+="<textarea":
"date"==e.type||"datetime"==e.type?(f+="<input",t.type="text",t["class"]+=" zenario_datepicker",p(e.change_month_and_year)&&(t["class"]+=" zenario_datepicker_change_month_and_year"),t.readonly="readonly",l||(t.onkeyup=C(t.onkeyup,"","")+"zenario._dFKU(this, event, '"+r(b)+"');")):"url"==e.type?(f+="<input",t.type="url",t.onfocus=C(t.onfocus,"","")+"if(!this.value) this.value = 'http://';",t.onblur=C(t.onblur,"","")+"if(this.value == 'http://') this.value = '';"):(e.slider&&(G=!0,f+=this.drawSlider(a,
b,e,l,!0)),f+="<input",t.type=e.type,F=!0),this.addExtraAttsForTextFields(e,t)}if("checkbox"==e.type||"radio"==e.type)p(n)&&(t.checked="checked"),n=h,p(e.indeterminate)&&a.after(function(){var a;if(a=s(b))a.indeterminate=!0});G&&(t.onchange=C(t.onchange,"","")+"$('#zenario_slider_for__"+b+"').slider('value', $(this).val());",t.onkeyup=C(t.onkeyup,"","")+"$('#zenario_slider_for__"+b+"').slider('value', $(this).val());");m=e;g===h?m.id=b:(m=$.extend({},m,J),m.id=b+"___"+g,t["class"]+=" control_for__"+
b);"radio"==m.type&&m.name||(m.name=b);for(var A in m)if(u(m,A)&&W[A])if("disabled"==A||"readonly"==A){if(p(t[A])||p(m[A]))f+=" "+A+'="'+A+'"'}else f+=" "+A+'="',t[A]&&(f+=t[A]+" ",delete t[A]),f+=r(m[A]),H[A]&&(f+=" "+H[A],delete H[A]),f+='"';for(A in t)u(t,A)&&(f+=" "+A+'="'+r(t[A]),H[A]&&(f+=" "+H[A],delete H[A]),f+='"');for(A in H)u(H,A)&&(f+=" "+A+'="'+r(H[A])+'"');"select"==e.type?f+=">":"textarea"==e.type||"editor"==e.type?f+=">"+r(n,!1,"asis")+"</textarea>":"code_editor"==e.type?f+=">"+r(n,
!1,"asis")+"</div>":"date"==e.type||"datetime"==e.type?(f+=' value="'+r(x._fD(n,"datetime"==e.type))+'"/>',f+='<input type="hidden" id="_value_for__'+r(b)+'" value="'+r(n)+'"/>',l||(f+='<input type="button" class="zenario_remove_date" value="x" onclick="'+this.globalName+".blankField('"+r(b)+"'); $(zenario._g('"+r(b)+"')).change();\"/>")):f=n!==h?f+(' value="'+r(n,!1,"asis")+'"/>'):f+"/>";if("select"==e.type)e.empty_value&&(f+='<option value="">'+r(e.empty_value)+"</option>"),e.values&&(E={},E[n]=
!0,f+=this.hierarchicalSelect(E,e,q,I,P)),f+="</select>";else if(F&&e.values&&!l){var M=[];for(B in q)u(q,B)&&(z=q[B],M.push({label:e.values[z],value:z}));a.after(function(){var a=$(s(b)),d={source:M,minLength:e.autocomplete_min_length||0,appendTo:a.parent()};e.return_key_presses_button&&(d.select=function(){setTimeout(function(){$("#"+e.return_key_presses_button).click()},0)});a.autocomplete(d);a.focus(function(){a.autocomplete("widget").is(":visible")||a.autocomplete("search","")})})}}g===h&&("url"!=
e.type||l||(f+='&nbsp; <input type="button" class="submit" value="'+D.test+'" onclick="'+this.globalName+".testURL('"+R(b)+"');\" />"),e.post_field_label!==h&&(f+='<label for="'+r(b)+'" id="label_for__'+r(b)+'"> '+r(e.post_field_label)+"</label>"),e.post_field_html!==h&&(f+=x._un(e.post_field_html)),G&&(f+=this.drawSlider(a,b,e,l,!1)));return f};g.addExtraAttsForTextFields=function(a,d){};g.testURL=function(a){var d=s(a).value;a=s(this.onThisRow("target_blank_",a))||s(this.onThisRow("target_blank",
a));d&&(a&&2==a.value?$.colorbox({href:d,iframe:!0,width:"95%",height:"95%",className:"zenario_url_test_colorbox"}):Q.open(x._aBP(d)))};g.hierarchicalSelect=function(a,d,b,f,e,k){var g="",n,l,m,q,s;for(q in b)if(u(b,q)){s=b[q];m=d.values[s];l=n="";if(_._iS(m))m={label:m};else if(p(m.disabled)||m.disabled_if!==h&&w._e(m.disabled_if,m,h,s,this.tuix,h,h,d))n=' disabled="disabled"';a[s]&&(l=' selected="selected"');k===h&&f&&e[s]?g+='<optgroup label="'+r(m,!1,!0)+'"'+n+">"+this.hierarchicalSelect(a,d,
b,f,e,s)+"</optgroup>":k===m.parent&&(g+='<option value="'+r(s)+'"'+l+n+">"+r(m,!1,!0)+"</option>")}return g};g.setupPickedItems=function(a,d,b,f,e){var k=this,h=!1,g,l,m,q=b.pick_items||{},r=b.upload||{};b.pick_items&&!p(q.hide_select_button)&&!p(q.disable_type_ahead_search)&&(b=q.path&&M._cNPTTPAR(q.path),m=q.target_path&&M._cNPTTPAR(q.target_path),b=b&&m&&b.path==m.path?b:m||b)&&(g=L+"zenario/admin/organizer.ajax.php?_typeahead_search=1&path="+encodeURIComponent(b.path)+x._uR(b.request),l="_search");
l=$(s(a)).tokenize({datas:g,searchParam:l,debounce:200,sortable:p(r.reorder_items),placeholder:q.nothing_selected_phrase||r.nothing_selected_phrase||D.nothing_selected,onAddToken:function(b,f,g){h||e||(h=!0,k.addToPickedItems(b,a,d),h=!1)},maxElements:e?0:1,parseData:function(b){var e,h,g,l=[],m=k.tuix.tabs[d].fields[a];if(b.items)for(e in b.items)u(b.items,e)&&(h=b.items[e],g=w._fOIN(b,e),m.values=m.values||{},m.values[e]={list_image:h.list_image,css_class:h.css_class||b.item&&b.item.css_class,label:g},
l.push({value:e,text:g,html:k.drawPickedItem(e,a,m,f)}));return l},formatTokenHTML:function(b,e){var h=k.tuix.tabs[d].fields[a];return h.values&&h.values[b]?k.drawPickedItem(b,a,h,f):!1},onRemoveToken:function(b,d){k.fieldChange(a)}});f?l.disable():g?l.container.addClass("zenario_picker_with_typeahead"):l.disableTypeAhead()};g.chooseFromDropbox=function(a){var d=this,b,f,e,k,g;if(!(b=this.field(a))||!b.upload)return!1;if(k=b.upload.extensions||b.upload.accept)k=_._iS(k)?k.split(","):_._tA(k);for(f in k)u(k,
f)&&(e=k[f],g=e.split("/"),g[1]!==h?k[f]="images"==g[0]?"image":g[0]:"text"!=e&&"documents"!=e&&"images"!=e&&"video"!=e&&"audio"!=e&&"."!=e.substr(0,1)&&(k[f]="."+e));b={cancel:function(){w._hAL()},linkType:"direct",multiselect:!!p(b.upload.multi),extensions:k,success:function(b){w._sAL();var e,f,k=new x.callback;for(e in b)u(b,e)&&(f=b[e],k.add(x._a(this.ajaxURL()+"&fetchFromDropbox=1",f,!0)));k.after(function(){var b,e,f,k="";if(!d.tuix.tabs[d.tuix.tab]||!(f=d.tuix.tabs[d.tuix.tab].fields[a])||
!f.upload)return!1;for(b in arguments)u(arguments,b)&&((e=arguments[b])&&e.id&&(k+=","+e.id),d.setFileDetails(f,e));""!==k&&d.addToPickedItems(k,a);w._hAL()})}};w._sAL();Dropbox.choose(b)};g.setFileDetails=function(a,d){a.values||(a.values={});a.values[d.id]||(a.values[d.id]={file:d,label:this.formatLabelFromFile(d)})};g.formatLabelFromFile=function(a){var d;a.filename!==h?(d=a.filename,p(a.width)&&p(a.height)&&(d+=" ["+a.width+" \u00d7 "+a.height+"px]")):(fileDetails=x._dIIFO(a.id))&&(fileDetails=
fileDetails.split("/"))&&fileDetails[1]?(d=fileDetails[1],p(fileDetails[2])&&p(fileDetails[3])&&(d+=" ["+fileDetails[2]+" \u00d7 "+fileDetails[3]+"px]")):d=a.id;return d};g.upload=function(a,d){var b=this,f;if(!(f=this.field(a))||!f.upload)return!1;f={class_name:f.class_name,upload:f.upload};this.uploadCallback=function(d){if(d){var f,h,g,l="";if(!b.tuix.tabs[b.tuix.tab]||!(g=b.tuix.tabs[b.tuix.tab].fields[a])||!g.upload)return!1;for(f in d)u(d,f)&&(h=d[f])&&h.id&&(l+=","+h.id,b.setFileDetails(g,
h));""!==l&&b.addToPickedItems(l,a)}};d?w._sHTML5UFDD(b.ajaxURL(),{fileUpload:1},!1,this.uploadCallback,s("zenario_fbAdminInner")):w._a(this,f,h,h,h,{fileUpload:1},h,this.ajaxURL())};g.ajaxURL=function(){return L+"zenario/ajax.php?method_call=handleAdminBoxAJAX&path="+encodeURIComponent(this.path)};g.uploadComplete=function(a){this.uploadCallback!==h&&this.uploadCallback(a);delete this.uploadCallback};g.drawSlider=function(a,d,b,f,e){var k=this,g=_._cl(b.slider);b="";if(p(g.before_field)?e:!e)f&&
(b+='<div class="ui-disabled">'),b+='<div id="zenario_slider_for__'+r(d)+'" class="'+r(g["class"])+'" style="'+r(g.style)+'"></div>',f&&(b+="</div>"),a.after(function(){var a;if(a=s("zenario_slider_for__"+d))g.min!==h&&(g.min=x._nu(g.min)),g.max!==h&&(g.max=x._nu(g.max)),g.step!==h&&(g.step=x._nu(g.step)),g.disabled=!k.editModeOn(),g.value=$(s(d)).val(),g.slide=function(a,b){$(s(d)).val(b.value)},g.change=function(a,b){k.fieldChange(d)},$(a).slider(g)});return b};g.pickedItemsArray=function(a,d){if(!1===
d||null===d||d===h||!(0!==d&&"0"!==d||a.values&&(a.values[0]||a.values["0"])))return{};var b=(d+"").split(","),f={},e,k,g,n,l,m,q;a._display_value=!1;for(m in b)u(b,m)&&(q=b[m])&&(a.upload&&(l=x._dIIFO(q))&&(l=l.split("/"))&&l[1]?(f[q]=l[1],p(l[2])&&p(l[3])&&(f[q]+=" ["+l[2]+" \u00d7 "+l[3]+"px]")):a.values&&a.values[q]&&"string"==typeof a.values[q]?f[q]=a.values[q]:a.values&&a.values[q]&&a.values[q].label?f[q]=a.values[q].label:((g=a.pick_items&&a.pick_items.target_path)||(g=a.pick_items&&a.pick_items.path))&&
(-1==g.indexOf("//")||M.map&&(g=M._cNPTTP(g)))&&(e=w._gIFO(g,q))?(a.values||(a.values={}),k=w._fOIN(e,q),n=e.items&&e.items[q]||{},f[q]=k,a.values[q]={list_image:n.list_image,css_class:n.css_class||e.item&&e.item.css_class,label:k}):a.upload&&q==1*q&&(l=w._lFD(q))?(this.setFileDetails(a,l),f[q]=a.values[q]):f[q]=q,!1===a._display_value&&(a._display_value=f[q]));return f};g.pickedItemsValue=function(a){var d,b="";if(a)for(d in a)u(a,d)&&(b+=(""===b?"":",")+d);return b};g.hierarchicalBoxes=function(a,
d,b,f,e,k,g,n,l,m,q,w,x){var C=1,D=0,z="",B,y,E,G,t=!1;if(!x)x=0,C=1*e.cols||1;else if(10<x)return"";w||(w={});q&&(w[q]=!0);x&&(z+='<div class="zenario_hierarchical_box_children" id="'+r("children_for___"+b+"___"+q)+'">');for(var H in l)if(u(l,H)&&(B={},y=l[H],y==1*y&&(y*=1),G=h,E="object"==typeof e.values[y]?e.values[y]:{label:e.values[y]},e.tag_colors&&(B.tag_color=e.tag_colors[y]||"blue"),G=E.parent,"0"===G&&(G=!1),!q&&!G||q==G)){if(B.newRow=++D>C)D=1;B.col=D;B.cols=C;G=f?!0===f||1===f||"1"===
f?!0===y||1===y||"1"===y:g?g[y]!==h?!0:!1:y==f:!y;B.checked=G;if("checkboxes"==e.type&&p(e.checking_child_checks_parents)){var F="";q&&(F+="if (this.checked) { for (var cb in "+JSON.stringify(w)+") { get('"+r(b)+"___' + cb).checked = true; } } ");m[y]&&(F+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");F?k.onchange=e.onchange?F+" "+e.onchange:F:e.onchange?k.onchange=e.onchange:delete k.onchange}else"checkboxes"==e.type&&p(e.checking_parent_checks_children)&&
(F="",m[y]&&(F+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),F?k.onchange=e.onchange?F+" "+e.onchange:F:e.onchange?k.onchange=e.onchange:delete k.onchange);B.lovId=b+"___"+y;B.lovField=E;e.indeterminates&&p(e.indeterminates[y])&&function(b){a.after(function(){var a;if(a=s(b))a.indeterminate=!0})}(B.lovId);B.lovHTML=this.drawField(a,d,b,!0,k,h,y,G,!1,n,l,m,E);B.childrenHTML="";m[y]&&(B.childrenHTML=this.hierarchicalBoxes(a,d,b,f,e,
k,g,n,l,m,y,_._ex({},w),x+1),D=0);t?(this.splitValues||(this.splitValues={}),this.splitValues[b]||(this.splitValues[b]=""),this.splitValues[b]+=this.microTemplate(this.mtPrefix+"_radio_or_checkbox",B)):z+=this.microTemplate(this.mtPrefix+"_radio_or_checkbox",B);G&&E.split_values_if_selected&&!x&&"radios"===e.type&&(t=!0)}x&&(z+="</div>");return z};g.drawPickedItem=function(a,d,b,f){b===h&&(b=this.field(d));var e={},g=b.values&&b.values[a];_._isOb(g)?(e=g,g=g.label):(g||(g=a),e.label=g);var s=a==1*
a,n,l;d={id:d,item:a,label:g,readOnly:f,css_class:e.css_class,list_image:e.list_image};b.tag_colors&&(d.tag_color=b.tag_colors[a]||"blue");!b.pick_items||p(b.pick_items.hide_info_button)||b.upload&&!s||!(n=b.pick_items.path)||n!=b.pick_items.target_path&&b.pick_items.min_path!=b.pick_items.target_path||(n="//"==x._rHSS(n,2)?n+a:"/"==x._rHSS(n,1)?n+("/"+a):n+("//"+a),d.organizerPath=n);b.upload&&(d.isUpload=!0,n=(n=(""+g).match(/(.*?)\.(\w+)$/)||(""+g).match(/(.*?)\.(\w+) \[.*\]$/))&&n[2]?n[2].toLowerCase():
"unknown",d.extension=n,s?(l=b.values&&b.values[a]&&b.values[a].file)&&l.checksum?(a=L+"zenario/file.php?c="+encodeURIComponent(l.checksum),l.usage&&(a+="&usage="+encodeURIComponent(l.usage))):a=L+"zenario/file.php?id="+a:a=L+"zenario/file.php?getUploadedFileInCacheDir="+encodeURIComponent(a),n.match(/gif|jpg|jpeg|png|svg/)?(d.thumbnail={onclick:this.globalName+".showPickedItemInPopout('"+a+"&popout=1&dummy_filename="+encodeURIComponent("image."+n)+"', '"+g+"');",src:a+"&og=1"},(g=(""+g).match(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&
g[1]&&g[2]&&w._rI(g[1],g[2],180,120,d.thumbnail)):d.adminDownload=a+"&adminDownload=1");return this.microTemplate(this.mtPrefix+"_picked_item",d)};g.showPickedItemInPopout=function(a,d){w._a(this,{popout:{href:a,title:d,css_class:"zenario_show_colobox_above_fab"}})};g.pickItems=function(a){var d,b,f;(d=this.field(a))&&(b=d.pick_items)&&(b.path||b.target_path)&&(d=b.path,p(b.multiple_select)||d!=b.target_path&&b.min_path!=b.target_path||!(f=this.readField(a))||-1!=f.indexOf(",")||(d="//"==x._rHSS(d,
2)?d+f:"/"==x._rHSS(d,1)?d+("/"+f):d+("//"+f)),this.SKTarget=a,w._oS(this.globalName,"setPickedItems",b.multiple_select,d,b.target_path,b.min_path,b.max_path,b.disallow_refiners_looping_on_min_path,h,b.one_to_one_choose_phrase,b.one_to_many_choose_phrase,h,!0,h,h,h,h,h,h,h,h,b))};g.setPickedItems=function(a,d,b,f){a=this.SKTarget;var e,g,h={};for(e in d._items)u(d._items,e)&&(b=x._dIIFO(e),g=f.items&&f.items[b]||{},h[b]={list_image:g.list_image,css_class:g.css_class||f.item&&f.item.css_class,label:w._fOIN(f,
b)});this.addToPickedItems(h,a)};g.removeFromPickedItems=function(a,d,b){this.addToPickedItems(a,d,b,!0)};g.addToPickedItems=function(a,d,b,f){b=this.field(d,b);var e=this.readField(d),g=b.pick_items&&p(b.pick_items.multiple_select)||b.upload&&p(b.upload.multi),h,n;a=w._cTO(a);n=g&&e?this.pickedItemsArray(b,e):{};for(h in a)if(u(a,h))if(e=a[h],b.values||(b.values={}),f)delete b.values[h];else if(b.values[h]||(b.values[h]=e),n[h]=!0,!g)break;this.redrawPickedItems(d,b,n)};g.redrawPickedItems=function(a,
d,b){var f,e,g=this.pickedItemsValue(b),h={},n=$(s(a)).tokenize(),l=n.toArray();b=w._cTO(b);for(f in l)u(l,f)&&(e=l[f],b[e]?h[e]=!0:n.tokenRemove(e));for(e in b)u(b,e)&&!h[e]&&(f=d.values&&d.values[e],_._isOb(f)?f=f.label:f||(f=e),n.tokenAdd(e,f));d.current_value=g;this.fieldChange(a)};g.changes=function(a){if(this.tuix&&this.tuix.tab){if(a==h){for(a in this.tuix.tabs)if(u(this.tuix.tabs,a)&&this.changed[a])return!0;return!1}return this.changed[a]}return!1};g.markAsChanged=function(a){this.tuix&&
(a===h&&(a=this.tuix.tab),a&&!this.changed[a]&&(this.changed[a]=!0,this.tuix.tab==a&&$("#zenario_abtab").addClass("zenario_abtab_changed")))};g.fieldChange=function(a,d){var b=this,f=this.field(a);f&&(f.indeterminate&&(f.indeterminate=!1),d!==h&&f.indeterminates&&f.indeterminates[d]&&(f.indeterminates[d]=!1),this.markAsChanged(),p(f.multiple_edit)&&this.meMarkChanged(a),setTimeout(function(){b.validateFormatOrRedrawForField(f)},1))};g.validateFormatOrRedrawForField=function(a){a=this.field(a);var d=
p(a.validate_onchange),b=p(a.format_onchange);a=p(a.redraw_onchange);if(d=d||this.errorOnTab(this.tuix.tab)&&b)return this.validate(),!0;if(b)return this.format(),!0;a&&(this.readTab(),this.redrawTab());return a};g.meMarkChanged=function(a,d,b){if(d===h||d!=b)this.field(a).multiple_edit._changed=!0,this.meSetCheckbox(a,!0)};g.meSetCheckbox=function(a,d){"checkbox"==s("multiple_edit__"+a).type?s("multiple_edit__"+a).checked=d:s("multiple_edit__"+a).value=d?1:""};g.meChange=function(a,d,b){var f=this.field(d);
if(a)f.multiple_edit._changed=!0;else{if(!b&&p(f.multiple_edit.warn_when_abandoning_changes)&&f.multiple_edit.original_value!==h&&this.readField(d)!=f.multiple_edit.original_value){f='<input type="button" class="submit_selected" value="'+D.abandonChanges+'" onclick="'+this.globalName+".meChange(false, '"+r(d)+'\', true);"/><input type="button" class="submit" value="'+D.cancel+'"/>';w._flBo(D.abandonChangesConfirm,f,"warning");this.meSetCheckbox(d,!0);return}f.multiple_edit._changed=!1;delete f.current_value;
b=f.value;f.multiple_edit.original_value!==h&&(b=f.current_value=f.multiple_edit.original_value);if(s(d)&&!f.pick_items)"checkbox"==s(d).type?s(d).checked=b?!0:!1:$(s(d)).val(C(b,"",""));else{b=new x.callback;var e=this.drawFields(b);this.insertHTML(e,b)}}p(f.multiple_edit.disable_when_unchanged)&&(s(d)&&(s(d).disabled=!a),$(".control_for__"+d).each(function(b,d){d.disabled=!a;"button"==d.type&&(a?$(d).removeClass("submit_disabled"):$(d).addClass("submit_disabled"))}));this.meSetCheckbox(d,a);this.validateFormatOrRedrawForField(d)};
g.currentValue=function(a,d,b){return b||d!=this.tuix.tab?this.value(a,d,b):this.readField(a)};g.value=function(a,d,b,f){d||(d=this.tuix.tab);var e="";a=this.field(a,d);b===h&&(b=!this.editModeOn(d));a&&!a.snippet&&"grouping"!=a.type&&(f||"submit"!=a.type&&"toggle"!=a.type&&"button"!=a.type?b||a.current_value===h?a.value!==h?e=a.value:a.multiple_edit&&a.multiple_edit.original_value!==h&&(e=a.multiple_edit.original_value):e=a.current_value:e=!!a.pressed);return"0"===e?0:e};g.isFormField=function(a){return!(!a||
a.snippet||"grouping"==a.type||"submit"==a.type||"toggle"==a.type||"button"==a.type)};g.readField=function(a){var d=h,b=this.tuix.tab,f=this.field(a,b),e;if(!this.isFormField(f))return h;var g=!this.editModeOn()||p(f.read_only),r=f._was_hidden_before;f.multiple_edit&&g&&delete f.multiple_edit._changed;if("checkboxes"==f.type||"radios"==f.type){if(!g&&!r&&f.values){var n,r="",l=!0;for(n in f.values)u(f.values,n)&&s(a+"___"+n)&&s(a+"___"+n).checked&&(r+=(l?"":",")+n,l=!1);f.current_value=r}r=!0}if(r)return g||
f.current_value===h?f.value:f.current_value;if(s("_value_for__"+a))f.current_value=d=s("_value_for__"+a).value;else if("editor"!=f.type&&"code_editor"!=f.type||g)if(!g&&(e=s(a))){if("checkbox"==f.type||"radio"==f.type)d=e.checked?!0:!1;else if("color_picker"==f.type||"colour_picker"==f.type)try{d=$(e).spectrum("get").toHexString()}catch(m){d=$(e).val()}else d=$(e).val();_._isAr(d)&&(d=d.join(","));f.current_value=d}else delete f.current_value,d=f.value;else if(d=h,"editor"==f.type?Q.tinyMCE&&tinyMCE.get(a)&&
(d=x._tMGC(tinyMCE.get(a))):"code_editor"==f.type&&(e=ace.edit(a))&&(d=e.getValue(),this.editingPositions[b+"/"+a]={top:e.session.getScrollTop(),left:e.session.getScrollLeft(),range:e.getSelectionRange()}),d!==h&&!1!==d)d=f.current_value=d;else return f.current_value===h?f.value:f.current_value;return d};g.blankField=function(a){s(a)&&$(s(a)).val("");s("_value_for__"+a)&&(s("_value_for__"+a).value="");field.current_value=""};g.readTab=function(){var a,d={},b=this.fields(),f;this.lastScrollTop=$("#zenario_fbAdminInner").scrollTop();
for(f in b)u(b,f)&&(a=this.readField(f))!==h&&(d[f]=a);I&&I.activeElement&&(this.lastFieldInFocus=I.activeElement.id);return d};g.wipeTab=function(){var a=this.fields(),d,b;for(d in a)u(a,d)&&(b=a[d],delete b.current_value,b.multiple_edit&&delete b.multiple_edit._changed)};g.redrawTab=function(){this.tuix.shake=!1;this.draw2()};g.getURL=function(a){++this.onKeyUpNum;return this.returnAJAXURL(a)};g.returnAJAXURL=function(a){return"..."};g.editModeOn=function(a){return!0};g.editModeAlwaysOn=function(a){return!0};
g.editCancelEnabled=function(a){return!1};g.revertEnabled=function(a){return!1};g.savedAndContinued=function(a){return!1};g.editModeOnBox=function(){return!0};g.sortTabs=function(){this.sortedTabs=[];if(this.tuix.tabs)for(var a in this.tuix.tabs)if(u(this.tuix.tabs,a)){var d=this.tuix.tabs[a];d&&this.sortedTabs.push([a,d.ord])}this.sortedTabs.sort(w.sortArray);this.sortedFields={};for(a in this.sortedTabs)u(this.sortedTabs,a)&&(d=this.sortedTabs[a]=this.sortedTabs[a][0],this.sortFields(d))};g.sortFields=
function(a){var d,b,f,e,g={};this.sortedFields[a]=[];if(f=this.fields(a)){for(d in f)u(f,d)&&(b=f[d],b.type&&"grouping"==b.type&&(g[b.name||d]=1*b.ord));for(d in f)u(f,d)&&(!(b=f[d])||b.type&&"grouping"==b.type||(e=b.grouping?g[b.grouping]:h,this.sortedFields[a].push([d,b.ord,e])));this.sortedFields[a].sort(w.sortArrayWithGrouping);for(d in this.sortedFields[a])u(this.sortedFields[a],d)&&(this.sortedFields[a][d]=this.sortedFields[a][d][0])}};g.setData=function(a){this.tuix=a};g.setDataDiff=function(a){this.syncAdminBoxFromServerToClient(a,
this.tuix)};g.syncAdminBoxFromServerToClient=function(a,d){for(var b in a)a[b]["[[__unset__]]"]?delete d[b]:d[b]===h||null===d[b]?d[b]=a[b]:a[b]["[[__replace__]]"]?(delete a[b]["[[__replace__]]"],d[b]=a[b]):"object"!=typeof d[b]?d[b]=a[b]:"object"==typeof d[b]&&"object"!=typeof a[b]?d[b]=a[b]:this.syncAdminBoxFromServerToClient(a[b],d[b])};g.sendStateToServer=function(){return JSON.stringify(this.tuix)};g.sendStateToServerDiff=function(){var a={};this.syncAdminBoxFromClientToServerR(a,this.tuix);
return JSON.stringify(a)};g.syncAdminBoxFromClientToServerR=function(a,d,b,f,e,g,p,n){if("object"==typeof d){var l,m;for(m in d)if((l="array")&&b===h&&"_sync"==m||(l="value")&&f===h&&"_sync"==b&&"session"==m||(l="value")&&f===h&&"_sync"==b&&"cache_dir"==m||(l="value")&&f===h&&"_sync"==b&&"password"==m||(l="value")&&f===h&&"_sync"==b&&"iv"==m||(l="array")&&b===h&&"key"==m||(l="value")&&f===h&&"key"==b||(l="value")&&b===h&&"shake"==m||(l="value")&&b===h&&"download"==m||(l="array")&&b===h&&"tabs"==m||
(l="array")&&f===h&&"tabs"==b||(l="array")&&e===h&&"tabs"==f&&"edit_mode"==m||(l="value")&&g===h&&"tabs"==e&&"edit_mode"==b&&"on"==m||(l="array")&&e===h&&"tabs"==f&&"fields"==m||(l="array")&&g===h&&"tabs"==e&&"fields"==b||(l="value")&&p===h&&"tabs"==g&&"fields"==f&&"current_value"==m||(l="value")&&p===h&&"tabs"==g&&"fields"==f&&"_display_value"==m||(l="value")&&p===h&&"tabs"==g&&"fields"==f&&"_was_hidden_before"==m||(l="value")&&p===h&&"tabs"==g&&"fields"==f&&"pressed"==m||(l="array")&&p===h&&"tabs"==
g&&"fields"==f&&"multiple_edit"==m||(l="value")&&n===h&&"tabs"==p&&"fields"==e&&"multiple_edit"==b&&"_changed"==m)"value"==l?"function"!=typeof d[m]&&"object"!=typeof d[m]&&(a[m]=d[m]):"array"==l&&"object"==typeof d[m]&&(a[m]={},this.syncAdminBoxFromClientToServerR(a[m],d[m],m,b,f,e,g,p))}};g.getValueArrayofArrays=function(a){return x._nAA(this.getURL(),x._uR({_read_values:!0,_box:this.sendStateToServer()}),!a)};g.getValues1D=function(a,d,b,f,e){var g,r,n,l,m,q={};if(this.tuix&&this.tuix.tabs)for(g in this.tuix.tabs)if(u(this.tuix.tabs,
g)&&(r=this.tuix.tabs[g],r.fields))for(n in r.fields)u(r.fields,n)&&(l=r.fields[n],m=n,this.isFormField(l)&&!(f&&(!this.editModeOn(g)||p(l.read_only))||e&&(l._was_hidden_before||p(l.read_only))||a&&!(m=l.plugin_setting&&l.plugin_setting.name))&&(l=this.currentValue(n,g,b),d||(q[m]=l),d||d===h))&&(q[g+"/"+n]=l);return q};g.callFunctionOnEditors=function(a){var d,b,f;if(Q.tinyMCE&&(d=this.fields()))for(b in d)if(u(d,b)&&(f=d[b],"editor"==f.type&&tinyMCE.get(b)))if("remove"==a)tinyMCE.get(b).remove();
else if("isDirty"==a&&tinyMCE.get(b).isDirty())return!0;return!1};g.format=function(a){var d;if(this.loaded&&(d=this.getURL("format"))){var b=this;this.loaded=!1;this.hideTab();this.checkValues(a);this.retryAJAX(d,{_format:!0,_box:this.sendStateToServer()},function(a){b.load(a);b.sortTabs();b.draw()},"loading")}};g.validate=function(a,d,b,f){var e;if(this.loaded&&(e=this.getURL("validate"))){this.differentTab=a;this.loaded=!1;this.hideTab(a);this.checkValues(b);var g=this;this.retryAJAX(e,{_validate:!0,
_box:this.sendStateToServer()},function(a){g.load(a)&&!g.errorOnTab(g.tuix.tab)&&d!==h&&(g.tuix.tab=d);g.sortTabs();g.switchToATabWithErrors();g.draw();f&&f()},"loading")}}},zenarioF);
