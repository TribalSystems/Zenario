zenario.lib(function(h,U,P,Z,qa,ra,w,t,sa,xa,V,A,S,ta,q,J,W,N,ya,ua,s,va){t.lib(function(aa,ca,g,da,ma,ha,qa,ra,X,O,B,Y,H,ia,wa){g=ua(va);g.init=function(a,e,b){this.globalName=a;this.mtPrefix=e;this.containerId=b;this.baseCSSClass="";this.onKeyUpNum=0;sa.sizing=!1;this.cachedAJAXSnippets={};this.changed={};this.toggleLevelsPressed={};this.lastFieldInFocus=!1;this.editingPositions={}};g.get=function(a){return this.containerId&&$("#"+this.containerId+" #"+w._cE(a))[0]||ta(a)};g.microTemplate=function(a,
e,b){return t._mT(a,e,b)};g.onThisRow=function(a,e){return a+e.replace(/(.*_|\D)/g,"")};g.valueOnThisRow=function(a,e){return this.value(this.onThisRow(a,e))};g.fieldOnThisRow=function(a,e){return this.field(this.onThisRow(a,e))};g.getKey=function(a){return this.tuix&&this.tuix.key};g.getKeyId=function(a){return this.tuix&&this.tuix.key&&this.tuix.key.id};g.getLastKeyId=function(a){return this.getKeyId(a)};g.getTitle=function(){var a,e;if(this.tuix.key&&this.tuix.key.id&&(a=this.tuix.title_for_existing_records)){e=
this.getValues1D(!1,h,!0);for(c in e)if(s(e,c)&&(v=e[c],-1!=a.indexOf("[["+c+"]]")))for(;a!=(string2=a.replace("[["+c+"]]",v));)a=string2;return a}return this.tuix.title};g.field=function(a,e){return _._isOb(a)?a:(tabs=this.tuix&&this.tuix.tabs)&&(e=e||this.tuix.tab)&&tabs[e]&&tabs[e].fields&&tabs[e].fields[a]};g.fields=function(a){var e;return(e=this.tuix&&this.tuix.tabs)&&(a=a||this.tuix.tab)&&e[a]&&e[a].fields};g.initFields=function(){var a=this.tuix.tab,e,b,f,d,l,p=this.tuix.lovs||{};if(this.tuix.tabs)for(e in this.tuix.tabs)if(s(this.tuix.tabs,
e)&&(f=this.fields(e))){l=!1;for(b in f)s(f,b)&&(d=f[b])&&(d.pick_items&&d.plugin_setting&&d.plugin_setting.use_value_for_plugin_name?this.pickedItemsArray(b,this.value(b,e,!1)):d.values&&_._iS(d.values)&&p[d.values]?d.values=p[d.values]:d.load_values_from_organizer_path&&!d.values&&this.loadValuesFromOrganizerPath(d),d.validation&&d.validation.required_if_not_hidden!==h&&(l=!0));l&&e!=a&&(this.tuix.tab=e,this.drawFields(h,h,!0),this.tuix.tab=a)}};g.loadValuesFromOrganizerPath=function(a){var e,b,
f;if(a.load_values_from_organizer_path&&!a.values&&(a.values={},(b=t._gIFO(a.load_values_from_organizer_path))&&b.items))for(e in b.items)s(b.items,e)&&(f=b.items[e],a.values[w._dIIFO(e)]={list_image:f.list_image,css_class:f.css_class||b.item&&b.item.css_class,label:t._fOIN(b,e)})};g.changeMode=function(){this.editCancelEnabled(this.tuix.tab)&&(this.editModeOn()?this.editCancelOrRevert("cancel",this.tuix.tab):this.editCancelOrRevert("edit",this.tuix.tab))};g.revertTab=function(){this.changes(this.tuix.tab)&&
this.revertEnabled(this.tuix.tab)&&this.editCancelOrRevert("revert",this.tuix.tab)};g.editCancelOrRevert=function(a,e){if(this.tuix.tabs[e].edit_mode){var b,f,d,l,p,g;"edit"==a?(p=q(this.tuix.tabs[e].edit_mode.format_on_edit),g=q(this.tuix.tabs[e].edit_mode.validate_on_edit)):"cancel"==a?(p=q(this.tuix.tabs[e].edit_mode.format_on_cancel_edit),g=q(this.tuix.tabs[e].edit_mode.validate_on_cancel_edit)):"revert"==a&&(p=q(this.tuix.tabs[e].edit_mode.format_on_revert),g=this.errorOnTab(e)||q(this.tuix.tabs[e].edit_mode.validate_on_revert));
if(!g&&(f=this.fields(e)))for(d in f)if(s(f,d))if(l=f[d],q(l.validate_onchange)&&(b=this.readField(d))!==h&&b!=l.value){g=!0;break}else!p&&q(l.format_onchange)&&(b=this.readField(d))!==h&&b!=l.value&&(p=!0);this.tuix.tabs[e].edit_mode.on="cancel"!=a;this.changed[e]=!1;g?this.validate(h,h,!0):p?this.format(!0):(this.wipeTab(),this.redrawTab(!0));this.tuix.tab==e&&$(A.h+"abtab").removeClass(A.z+"abtab_changed")}};g.clickTab=function(a){this.loaded&&this.validate(a!=this.tuix.tab,a)};g.clickButton=function(a,
e){var b;if(b=this.field(e))b.type==Y?(b.pressed=!0,this.validate(!0)):"toggle"==b.type?((b.pressed=!q(b.pressed))?$("#"+e).removeClass("not_pressed").addClass("pressed"):$("#"+e).removeClass("pressed").addClass("not_pressed"),this.validateFormatOrRedrawForField(b)):b.type==O&&(b.pressed=!0,this.validateFormatOrRedrawForField(b))};g.togglePressed=function(a,e){var b;b=a?1<a?this.toggleLevelsPressed[a-1]:!0:this.toggleLevelsPressed.last;b===h&&(b=!0);e&&"toggle"==e.type&&(this.toggleLevelsPressed.last=
b&&q(e.pressed),a&&(this.toggleLevelsPressed[a]=this.toggleLevelsPressed.last));return b};g.toggleLevel=function(a){return this.toggleLevelsPressed.last};g.retryAJAX=function(a,e,b,f,d,l){var p=function(){w._a(a,e,b,h,p,!0,h,h,h,h,l).after(f);d&&t.nowDoingSomething&&t._nDS(d)};p()};g.switchToATabWithErrors=function(){var a,e,b=this.tuix;if(b&&b.tabs&&!this.errorOnTab(b.tab))for(a in this.sortedTabs)if(s(this.sortedTabs,a)&&(e=this.sortedTabs[a],b.tabs[e]&&!t._h(h,this,h,e,h,h,h,h,b.tabs[e])&&this.errorOnTab(e)))return b.tab=
e,!0;return!1};g.applyMergeFields=function(a,e,b,f){return a};g.applyMergeFieldsToLabel=function(a,e,b,f){return a};g.hideTab=function(a){var e=this;a?($(A.h+"abtab input").add(A.h+"abtab select").add(A.h+"abtab textarea").attr("disabled","disabled"),$(A.h+"abtab").clearQueue().show().animate({opacity:0.8},200,function(){e.tabHidden=!0;e.draw()})):($(A.h+"abtab input").add(A.h+"abtab select").add(A.h+"abtab textarea").attr("disabled","disabled").animate({opacity:0.9},100),this.tabHidden=!0,this.draw())};
g.draw=function(){this.loaded&&this.tabHidden&&this.draw2()};g.draw2=function(){};g.drawTabs=function(a){a||(a=this.mtPrefix+"_tab");var e,b,f=[],d,l;for(d in this.sortedTabs)if(s(this.sortedTabs,d)&&(l=this.sortedTabs[d],(e=this.tuix.tabs[l])&&!t._h(h,this,h,l,h,h,h,h,e))){b="";if(e.fields&&!_._isEm(e.fields)||e.fields&&!_._isEm(e.errors)||e.fields&&!_._isEm(e.notices))b=this.globalName+".clickTab('"+W(l)+"');";!this.tuix.tab&&b&&(this.tuix.tab=l);f.push({id:l,tabId:l,tuix:e,onclick:b,current:this.tuix.tab==
l,label:e.label})}t._sBK(f,A.z+"fab_tab_with_children");return this.microTemplate(a,f)};g.drawFields=function(a,e,b){var f,d,l,p=this.tuix.tab,g=this.tuix.tabs[p],m=this.groupings[p],r=this.sortedFields[p],n="",x=!1,F,y=this.fields(p),w={},L={},D=!1,E,G={fields:{},rows:[],tabId:p,path:this.path,tuix:this.tuix,revert:"",errors:[],notices:{}};if(!b){this.splitValues={};t._cHTML5UFDD();!this.savedAndContinued(p)&&this.editCancelEnabled(p)&&(G.revert=ca(B,A.z+"editCancelButton",t._i(B,Y,X,O,ia,this.globalName+
".changeMode(); return false;",H,this.editModeOn()?N.cancel:N.edit)));if(this.editModeOn()){if(g.errors)for(d in g.errors)s(g.errors,d)&&(l=g.errors[d],G.errors.push({message:l}));if(y)for(d in y)s(y,d)&&(l=y[d],l.error&&G.errors.push({message:l.error}))}if(g.notices)for(d in g.notices)s(g.notices,d)&&(l=g.notices[d],q(l.show)&&{error:1,warning:1,question:1,success:1}[l.type]&&(G.notices[d]=l))}for(f in r)s(r,f)&&(d=r[f],l=y[d],F=!1,l._lastGrouping=E,E!==l.grouping&&(x=(E=l.grouping)&&(m[E]===h||
!y[m[E]]||t._h(h,this,h,m[E],h,h,y[m[E]])),F=!0),l._id=d,l._html=this.drawField(a,p,d,!0,l,w,L,b,x),b||x||!1===l._html||((F||l._startNewRow||!G.rows.length)&&G.rows.push({fields:[]}),D||g.show_errors_after_field!=d||(G.rows[G.rows.length-1].errors=G.errors,G.rows[G.rows.length-1].notices=G.notices,D=!0),G.rows[G.rows.length-1].fields.push(l),G.fields[d]=l));b||(G.rows.length&&(G.rows[G.rows.length-1].fields[0]._isLastRow=!0),D||G.rows.splice(0,0,{errors:G.errors,notices:G.notices}),e=e||g.template||
this.mtPrefix+"_current_tab",n+=this.microTemplate(e,G));for(f in r)s(r,f)&&(d=r[f],delete y[d]._lastGrouping,delete y[d]._startNewRow,delete y[d]._hideOnOpen,delete y[d]._showOnOpen,delete y[d]._isLastRow,delete y[d]._html,delete y[d]._id);return n};g.insertHTML=function(a,e,b){var f=this.get(A.z+"abtab"),d;f.innerHTML=a;this.tabHidden=!1;this.changes(this.tuix.tab)?$(f).addClass(A.z+"abtab_changed"):$(f).removeClass(A.z+"abtab_changed");e.call();!b&&this.lastFieldInFocus&&(d=this.get(this.lastFieldInFocus))&&
d.focus()};g.hideShowFields=function(a){var e=$(A.d+"hide_on_open"),b=$(A.d+"hide_row_on_open"),f=$(A.d+"show_on_open"),d=function(a,d){d.style.display="none"};f.length&&!e.length?f.show("blind",200,a):!f.length&&e.length?e.hide("blind",200,function(){b.each(d)}):f.length&&e.length&&(e.each(d),b.each(d),f.show())};g.addJQueryElementsToTab=function(){w._aJQE(A.h+"abtab ",!0)};g.addJQueryElementsToTabAndFocusFirstField=function(){w._aJQE(A.h+"abtab ",!0);this.focusFirstField()};g.focusFirstField=function(){if(this.tuix&&
!q(this.tuix.tabs[this.tuix.tab].disable_autofocus)){var a=this,e=-1,b=[],f=h,d,l,p,g,m;for(d in this.sortedFields[this.tuix.tab])if(s(this.sortedFields[this.tuix.tab],d)&&(g=this.sortedFields[this.tuix.tab][d],(l=this.get(g))&&(p=this.field(g))&&((m=p.pick_items||p.upload)||$(l).is(":visible"))&&(b[++e]={id:g,type:p.type,empty:""==l.value,focusable:(m||w.IN(p.type,"password","checkbox","select","text","textarea"))&&!q(l.disabled)&&!q(l.readonly)&&!q(p.read_only)&&!q(p.readonly)},1<e)))break;if(b[0]&&
!b[0].empty&&b[1]&&b[1].focusable&&b[1].empty&&"password"==b[1].type)f=1;else if(b[0]&&b[0].focusable)f=0;else if(b[1]&&b[1].focusable)f=1;else return;setTimeout(function(){p=b[f];p.type?a.get(p.id).focus():a.$getPickItemsInput(p.id).focus()},50)}};g.$getPickItemsInput=function(a){return $(this.get("name_for_"+a)).find(".TokenSearch input")};g.focusField=function(){this.fieldToFocus&&this.get(this.fieldToFocus)&&$(this.get(this.fieldToFocus)).is(":visible")&&this.get(this.fieldToFocus).focus();delete this.fieldToFocus};
g.errorOnBox=function(){if(this.tuix&&this.tuix.tabs)for(tab in this.tuix.tabs)if(s(this.tuix.tabs,tab)&&this.errorOnTab(tab))return!0;return!1};g.errorOnTab=function(a){var e;if(this.tuix.tabs[a]&&this.editModeOn(a)){if(this.tuix.tabs[a].errors)for(e in this.tuix.tabs[a].errors)if(s(this.tuix.tabs[a].errors,e))return!0;if(a=this.fields(a))for(e in a)if(s(a,e)&&a[e].error)return!0}};g.checkValues=function(a){a?this.wipeTab():this.readTab();for(var e in this.tuix.tabs)if(s(this.tuix.tabs,e)){a=this.tuix.tabs[e];
var b=this.editModeOn(e);if(a.fields)for(var f in a.fields)if(s(a.fields,f)){var d=a.fields[f];this.isFormField(d)&&("code_editor"==d.type&&w._cAD("code_editor_"+f),d.current_value===h&&(d.current_value=this.value(f,e,!0)),b&&(d.value===h&&(d.value=this.value(f,e,!1)),d.multiple_edit&&d.multiple_edit._changed===h&&d.multiple_edit.changed!==h&&(d.multiple_edit._changed=d.multiple_edit.changed)))}}P&&P.activeElement&&(this.lastFieldInFocus=P.activeElement.id)};g.enableMicroTemplates=function(a,e){var b=
this,f;for(f in e)if(s(e,f))switch(typeof e[f]){case "object":"that"!==f&&"tuix"!==f&&this.enableMicroTemplates(a,e[f]);break;case "string":f===X||f===H&&this.isFormField(e)||"current_value"===f||!e[f].match(/(\{\{|\{\%|\<\%)/)||function(a,e,f){f=w._gMT("<% "+b.defineLibVarBeforeCode()+" %>"+a[e],h);a[e]=function(){return f(a)}}(e,f)}};g.drawField=function(a,e,b,f,d,l,p,g,m,r,n,x,F,y,ea,L){d===h&&(d=this.field(b,e));d.id===h&&(d.id=b);q(d.enable_microtemplates_in_properties)&&this.enableMicroTemplates(d,
d);x===h&&(x=!this.editModeOn(e)||q(d.read_only)||q(d.readonly));(f=d.type)&&"datetime"==f&&(x=!0);L?L.disabled_if!==h&&t._e(L.disabled_if,this,L,h,r,h,h,d)&&(x=!0):d.disabled_if!==h&&t._e(d.disabled_if,this,h,h,b,h,h,d)&&(x=!0);if(f&&"grouping"==f)return"";var D=this,E={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,
onmouseover:!0,onmouseup:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,max:!0,min:!0,pattern:!0,placeholder:!0,required:!0,step:!0},G,I,ba,z,k="",M,K,Q={},P=!1,u={"class":""},R={},S=!0,V=!1,fa,ca=!1,na=!1,ga=!1,la=!1,ja;!d[B]&&d.css_class&&(d[B]=d.css_class);d.snippet||n!==h||(n=this.value(b,e,h,!0));n===h&&(n="");if(r===h){delete d.selected_option;if(n&&d.values)if(fa=_._isOb(d.values)?d.values[n]:this.tuix.lovs&&this.tuix.lovs[d.values]&&this.tuix.lovs[d.values][n],
_._isOb(fa)&&t._h(fa,this,h,n,h,h,d,h,this.tuix.tabs[e])&&(fa=!1),fa)d.selected_option=fa;else if("radio"==f||"select"==f)d.current_value=n="";(d.upload||d.pick_items)&&""!=n&&(Q=this.pickedItemsArray(d,n));d.values&&_._iS(d.values)&&this.tuix.lovs&&this.tuix.lovs[d.values]?d.values=this.tuix.lovs[d.values]:d.load_values_from_organizer_path&&!d.values&&this.loadValuesFromOrganizerPath(d);for(I in d)s(d,I)&&(ba=I.match(/^<(\/?)(\w+)/))&&(d[I]&&_._iS(d[I])&&(I+=d[I]),M={table:1,tr:2,td:3,th:4,div:5,
p:6,span:7}[ba[2]]||8,5>M&&(na=!0),ba[1]?(la||(la=!0,ja="       ".split(" ")),ja[8-M]+=I):(ga||(ga=!0,K="       ".split(" ")),K[M-1]+=I,1==M&&(ca=!0)))}g||f!=O&&f!=Y||(d.pressed=!1);if(g||r===h){ba=d.same_row===h?ca||!na:!q(d.same_row);d._startNewRow=ba;I=1*d.indent||0;m=m||t._h(h,this,h,b,h,h,d)||q(l&&l.last?d.hide_with_previous_field:d.hide_if_previous_field_is_not_hidden)||q(d.hide_with_previous_indented_field)&&l&&l[I]||q(d.hide_with_previous_outdented_field)&&0<I&&l&&l[I-1]||d.hide_if_previous_value_isnt!==
h&&!w._iL(d.hide_if_previous_value_isnt,p&&p.last)||d.hide_if_previous_outdented_value_isnt!==h&&0<I&&!w._iL(d.hide_if_previous_outdented_value_isnt,p&&p[I-1]);p&&(p.last=n,ba&&(p[I]=n));l&&(l.last=m,ba&&(l[I]=m));d._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=f&&"code_editor"!=f&&d._was_hidden_before&&!m?d._showOnOpen=!0:d._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=f&&"code_editor"!=f&&!d._was_hidden_before&&m&&(d._hideOnOpen=G=!0,d._was_hidden_before=
!0);if(m){if(d._was_hidden_before=!0,!G)return!1}else delete d._was_hidden_before;if(g)return;d.multiple_edit&&(l="",p=x||d.multiple_edit._changed===h?d.multiple_edit.changed:q(d.multiple_edit._changed),q(d.multiple_edit.disable_when_unchanged)&&!p&&(F=!0),q(d.multiple_edit.hide_ui)||!d.multiple_edit.select_list?(g=q(d.multiple_edit.hide_ui),l+=da(X,"checkbox",B,"multiple_edit","id","multiple_edit__"+b,"checked",p,"style",g?"display: none;":"","disabled",x,"onchange",x||g?"":this.globalName+".meChange(this.checked, '"+
J(b)+"');",">")):l+=ma(B,"multiple_edit","id","multiple_edit__"+b,"disabled",x,"onchange",this.globalName+'.meChange(this.value == 1, "'+W(b)+'");',ha(H,"","selected",!p,d.multiple_edit.select_list.not_changed_label||N.notChanged)+ha(H,1,"selected",p,d.multiple_edit.select_list.changed_label||N.changed)),k+=l,l=h);ga&&(k+=K.join(""));d.pre_field_html!==h&&(k+=w._un(d.pre_field_html))}if(!(y&&ea||"object"!=typeof d.values))if(y=[],ea={},d.upload&&q(d.upload.reorder_items))for(M in K=n.split(","),K)s(K,
M)&&(z=K[M],y.push(z));else{for(z in d.values)s(d.values,z)&&(K=d.values[z],"object"==typeof K?(K.parent!==h&&(V=!0,ea[K.parent]=!0),t._h(K,this,h,z,h,h,d,h,this.tuix.tabs[e])||(K.ord!==h?y.push([z,K.ord]):K.label!==h?y.push([z,K.label]):y.push([z,z]))):y.push([z,K]));y.sort(t.sortArray);for(M in y)s(y,M)&&(y[M]=y[M][0])}if(x||F)u.readonly=!0,this.isButton(d)&&(u.disabled=!0,u[B]+="disabled ");if(x&&q(d.show_as_a_label_when_readonly)&&"checkboxes"!=f){y=J(n);if("select"==f||"radios"==f)d.values&&
d.values[n]?y=J(d.values[n]):d.empty_value&&(y=J(d.empty_value));k+=aa("label","id","label__"+b,y)}else if(z=d.snippet)z.separator&&(k+=aa("hr",B,"input_separator","style",z.separator.style)),z.label&&(k+=aa("label","id","label__"+b,B,z.label_class,J(z.label))),z.show_split_values_from&&this.splitValues&&this.splitValues[z.show_split_values_from]&&(k+=this.splitValues[z.show_split_values_from],delete this.splitValues[z.show_split_values_from]),z.html?k+=aa("span","id","snippet__"+b,w._un(z.html)):
z.url&&(k=q(z.cache)?this.cachedAJAXSnippets[z.url]?k+this.cachedAJAXSnippets[z.url]:k+(this.cachedAJAXSnippets[z.url]=w._nAA(w._aBP(z.url))):k+w._nAA(w._aBP(z.url)));else if(("checkboxes"==f||"radios"==f)&&r===h)d.values&&(Q=this.pickedItemsArray(d,n),L=_._ex({},d),L.name=d.name||b,L.type="checkboxes"==f?"checkbox":"radio",x&&(L.disabled=!0),k+=this.hierarchicalBoxes(a,e,b,n,d,L,Q,F,y,ea));else if(d.upload||d.pick_items){var oa=d.pick_items&&q(d.pick_items.multiple_select)||d.upload&&q(d.upload.multi);
n={id:b,pickerHTML:"",wrappedId:"name_for_"+b,readOnly:x,tempReadOnly:F};x||(d.pick_items&&(d.pick_items.target_path||d.pick_items.path)&&!q(d.pick_items.hide_select_button)&&(n.select={onclick:this.globalName+".pickItems('"+J(b)+"');",phrase:d.pick_items.select_phrase||N.selectDotDotDot}),d.upload&&(n.upload={onclick:this.globalName+".upload('"+J(b)+"');",phrase:d.upload.upload_phrase||N.uploadDotDotDot},q(d.upload.drag_and_drop)&&this.upload(b,!0),Z.Dropbox&&Dropbox.isBrowserSupported()&&(n.dropbox=
{onclick:this.globalName+".chooseFromDropbox('"+J(b)+"');",phrase:d.upload.dropbox_phrase||N.dropboxDotDotDot})));n.pickerHTML+=ma("id",b,"multiple",oa,">");d.values&&!_._isEm(Q)&&(n.pickerHTML+=this.hierarchicalSelect(Q,d,y,V,ea));n.pickerHTML+="</select>";k+=this.microTemplate(this.mtPrefix+"_picked_items",n);a.after(function(){D.setupPickedItems(b,e,d,x,oa)})}else if(f){R.onchange=r?"lib.fieldChange('"+J(b)+"', '"+J(r)+"');":"lib.fieldChange('"+J(b)+"');";d.disabled&&(u[B]+="disabled ");d.validation&&
d.validation.numeric&&(u.onkeyup=(u.onkeyup||"")+"lib.keepNumeric(this)");d.return_key_presses_button&&!x&&(u.onkeyup=(u.onkeyup||"")+"if (event.keyCode == 13) {$('#"+J(d.return_key_presses_button)+"').click();}");q(d.multiple_edit)&&!x&&(u.onkeyup=(u.onkeyup||"")+"if (event && event.keyCode == 9) return true; lib.meMarkChanged('"+J(b)+"', this.value, '"+J(d.value)+"');");u[B]+="input_"+f;switch(f){case "select":d.slider&&(P=!0,k+=this.drawSlider(a,b,d,x,!0));x&&(u.disabled=!0);k+="<select";break;
case "code_editor":k+="<div";u[B]=" zenario_embedded_ace_editor";a.after(function(){var a=ace.edit(b),f=!1,l;a.session.setUseSoftTabs(!1);a.setShowPrintMargin(!1);x&&(a.setReadOnly(!0),a.setBehavioursEnabled(!1));q(d.wrap_text)&&a.session.setUseWrapMode(!0);a.session.setOption("useWorker",!1);a.on("blur",function(a){f&&w._aADINS("code_editor_"+b,function(){D.fieldChange(b)},0);f=!1});a.on("change",function(a){D.markAsChanged();f=!0;w._aADINS("code_editor_"+b,function(){D.fieldChange(b)},5E3)});if(language=
d.language)try{language=language.match(/\.twig\.html$/i)?"ace/mode/twig":language.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(language).mode:"ace/mode/"+language,a.session.setMode(language),a.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})}catch(h){console.log("Ace editor could not load that language",language)}a.$blockScrolling=Infinity;if(l=D.editingPositions[e+"/"+b])a.session.setScrollTop(l.top),a.session.setScrollLeft(l.left),a.selection.setSelectionRange(l.range)});
break;case "color_picker":case "colour_picker":k+="<input";u[B]=" zenario_color_picker";a.after(function(){var a=d.color_picker_options||d.colour_picker_options||{};a.disabled=x;a.preferredFormat=a.preferredFormat||"hex";$(D.get(b)).spectrum(a)});break;case "editor":k+="<textarea";t._gSD();var T;F={script_url:U+w.tinyMCEPath,inline:!1,menubar:!1,statusbar:!1,plugins:"autoresize",document_base_url:h,convert_urls:!1,readonly:!0,inline_styles:!1,allow_events:!0,allow_script_urls:!0,autoresize_max_height:Math.max(Math.floor(0.5*
$(Z).height()),300),autoresize_bottom_margin:10,onchange_callback:function(a){D.fieldChange(a.id)},init_instance_callback:function(a){t._eDDUITM(!1,h,D.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&t._eDDUITM(!1,h,b)}};Q=_._ex({},F,{plugins:["advlist autolink lists link image charmap hr anchor","searchreplace code fullscreen","nonbreaking table contextmenu directionality","paste autoresize"],image_advtab:!0,
visual_table_class:" ",browser_spellcheck:!0,paste_preprocess:t.tinyMCEPasteRreprocess,readonly:!1,convert_urls:!0,relative_urls:!1,content_css:h,toolbar:"undo redo | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code",style_formats:t.skinDesc.style_formats,oninit:h});z=_._ex({},Q,{toolbar:"undo redo | image link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code",file_browser_callback:t.fileBrowser,
init_instance_callback:function(a){t._eDDUITM(!0,U,D.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&t._eDDUITM(!0,U,b)}});K=_._ex({},z,{toolbar:"undo redo | image | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code"});ga=_._ex({},K,{toolbar:"undo redo | link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | outdent indent | code"});
x?(T=F,u[B]=" tinymce_readonly"):d.insert_image_button?d.insert_link_button?(T=z,u[B]=" tinymce_with_images_and_links"):(T=K,u[B]=" tinymce_with_images"):d.insert_link_button?(T=ga,u[B]=" tinymce_with_links"):(T=Q,u[B]=" tinymce");u.style="visibility: hidden;";_._isOb(d.editor_options)&&(T=_._ex(T,d.editor_options));T.setup=function(a){a.on("change",function(a){D.fieldChange(a.id)})};a.after(function(){var a=$(D.get(b)),d=D.get(A.z+"abtab"),e=d.style.display;d.style.display="block";a.tinymce(T);d.style.display=
e});break;case O:case Y:case "toggle":k+="<input";u.type=O;if(!x||q(d.can_be_pressed_in_view_mode))R.onclick="lib.clickButton(this, '"+b+"');",delete u.disabled;"toggle"==f&&(u[B]+=d.pressed?" pressed":" not_pressed");break;default:"textarea"==f?k+="<textarea":"date"==f||"datetime"==f?(k+="<input",u.type="text",u[B]+=" zenario_datepicker",q(d.change_month_and_year)&&(u[B]+=" zenario_datepicker_change_month_and_year"),u.readonly="readonly",x||(u.onkeyup=(u.onkeyup||"")+"zenario._dFKU(this, event, '"+
J(b)+"');")):"url"==f?(k+="<input",u.type="url",u.onfocus=(u.onfocus||"")+"if(!this.value) this.value = 'http://';",u.onblur=(u.onblur||"")+"if(this.value == 'http://') this.value = '';"):(d.slider&&(P=!0,k+=this.drawSlider(a,b,d,x,!0)),k+="<input",u.type=f,S=!0),this.addExtraAttsForTextFields(d,u)}if("checkbox"==f||"radio"==f)q(n)&&(u.checked="checked"),n=h,x&&(u.disabled=!0),q(d.indeterminate)&&a.after(function(){var a;if(a=this.get(b))a.indeterminate=!0});P&&(u.onchange='$("#zenario_slider_for__'+
W(b)+'").slider("value", $(this).val());',u.onkeyup=(u.onkeyup||"")+'$("#zenario_slider_for__'+W(b)+'").slider("value", $(this).val());');F=d;r===h?F.id=b:(F=$.extend({},F,L),F.id=b+"___"+r,u[B]+=" control_for__"+b);"radio"==F.type&&F.name||(F.name=b);for(var C in F)if(s(F,C)&&E[C])if("disabled"==C||"readonly"==C){if(q(u[C])||q(F[C]))k+=" "+C+'="'+C+'"';delete u[C]}else k+=" "+C+'="'+this.defineLibVarBeforeCode(C),u[C]&&(k+=u[C]+" ",delete u[C]),k+=J(F[C]),R[C]&&(k+=" "+R[C],delete R[C]),k+='"';for(C in u)s(u,
C)&&("disabled"==C||"readonly"==C?q(u[C])&&(k+=" "+C+'="'+C+'"'):(k+=" "+C+'="'+this.defineLibVarBeforeCode(C)+J(u[C]),R[C]&&(k+=" "+R[C],delete R[C]),k+='"'));for(C in R)s(R,C)&&(k+=" "+C+'="'+this.defineLibVarBeforeCode(C)+J(R[C])+'"');"select"==f?k+=">":"textarea"==f||"editor"==f?k+=">"+J(n,!1,"asis")+"</textarea>":"code_editor"==f?k+=">"+J(n,!1,"asis")+"</div>":"date"==f||"datetime"==f?(k+=' value="'+J(w._fD(n,"datetime"==f))+'"/>',k+=da(X,"hidden","id","_value_for__"+b,H,n),x||(k+=da(X,O,B,A.z+
"remove_date",H,"x",ia,this.globalName+'.blankField("'+W(b)+'"); $('+this.globalName+'.get("'+W(b)+'")).change();'))):k=n!==h?k+(' value="'+J(n,!1,"asis")+'"/>'):k+"/>";if("select"==f)d.empty_value&&(k+=ha(H,"",J(d.empty_value))),d.values&&(Q={},Q[n]=!0,k+=this.hierarchicalSelect(Q,d,y,V,ea)),k+="</select>";else if(S&&d.values&&!x){var pa=[];for(M in y)s(y,M)&&(z=y[M],pa.push({label:d.values[z],value:z}));a.after(function(){var a=$(D.get(b)),e={source:pa,minLength:d.autocomplete_min_length||0,appendTo:a.parent()};
d.return_key_presses_button&&(e.select=function(){setTimeout(function(){$("#"+d.return_key_presses_button).click()},0)});a.autocomplete(e);a.focus(function(){a.autocomplete("widget").is(":visible")||a.autocomplete("search","")})})}}r===h&&("url"!=f||x||(k+="&nbsp; "+da(X,O,B,Y,H,N.test,ia,this.globalName+'.testURL("'+W(b)+'");')),!d.label||"checkbox"!=f&&"radio"!=f&&"toggle"!=f||(k+=" "+aa("label",B,d.label_class,"for",b,"id","label_for__"+b,J(d.label))),d.post_field_label!==h&&(k+=" "+aa("label",
"for",b,"id","label_for__"+b,J(d.post_field_label))),d.post_field_html!==h&&(k+=w._un(d.post_field_html)),la&&(k+=ja.join("")),P&&(k+=this.drawSlider(a,b,d,x,!1)));return k};g.addExtraAttsForTextFields=function(a,e){};g.defineLibVarBeforeCode=function(a){if(a===h||"on"==a.substr(0,2)){if(!this.globalName){for(a=1;Z[this.globalName="zenarioLib"+a];++a);Z[globalName]=this}return"var lib = "+J(this.globalName)+"; "}return""};g.testURL=function(a){var e=this.get(a).value;a=this.get(this.onThisRow("target_blank_",
a))||this.get(this.onThisRow("target_blank",a));if(e)if(a&&2==a.value)$[A.x]({href:e,iframe:!0,width:"95%",height:"95%",className:A.z+"url_test_colorbox"});else Z.open(w._aBP(e))};g.keepNumeric=function(a){var e=a.value.replace(/[^\d\.]/g,"").replace(/\.(.*)\./g,".$1");a.value!=e&&(a.value=e)};g.hierarchicalSelect=function(a,e,b,f,d,l){var p="",g,m,r,n,x;for(n in b)if(s(b,n)){x=b[n];r=e.values[x];m=g=!1;if(_._iS(r))r={label:r};else if(q(r.disabled)||r.disabled_if!==h&&t._e(r.disabled_if,this,r,h,
x,h,h,e))g=!0;a[x]&&(m=!0);showWithoutChildren=!q(r.hide_when_children_are_not_visible);if(l===h&&f&&d[x]){if((childrenHTML=this.hierarchicalSelect(a,e,b,f,d,x))||showWithoutChildren)p+=aa("optgroup","label",r,"disabled",!childrenHTML,childrenHTML)}else showWithoutChildren&&l===r.parent&&(p+=ha(H,x,"selected",m,"disabled",g,J(r,!1,!0)))}return p};g.setupPickedItems=function(a,e,b,f,d){var l=this,h=!1,g=!1,m,r,n,x,F=b.pick_items||{},y=b.upload||{};if(b.pick_items&&!q(F.hide_select_button)&&!q(F.disable_type_ahead_search)){m=
F.path&&V._cNPTTPAR(F.path);x=F.target_path&&V._cNPTTPAR(F.target_path);if(m=m&&x&&m.path==x.path?m:x||m)r=U+A.s+"admin/organizer.ajax.php?_typeahead_search=1&path="+S(m.path)+w._uR(m.request),n="_search";g=q(b.pick_items.allow_typing_anything)}b=$(this.get(a)).tokenize({datas:r,searchParam:n,debounce:200,sortable:q(y.reorder_items),placeholder:F.nothing_selected_phrase||y.nothing_selected_phrase||N.nothing_selected,onAddToken:function(b,f,g){h||(d||(h=!0,l.addToPickedItems(b,a,e),h=!1),l.$getPickItemsInput(a).focus())},
maxElements:d?0:1,parseData:function(b){var d,h,g,p=[],m=l.tuix.tabs[e].fields[a];if(b.items)for(d in b.items)s(b.items,d)&&(h=b.items[d],g=t._fOIN(b,d),m.values=m.values||{},m.values[d]={list_image:h.list_image,css_class:h.css_class||b.item&&b.item.css_class,label:g},p.push({value:d,text:g,html:l.drawPickedItem(d,a,m,f)}));return p},formatTokenHTML:function(b,d){var h=l.tuix.tabs[e].fields[a];return h.values&&h.values[b]?l.drawPickedItem(b,a,h,f):g?(h.values=h.values||{},h.values[b]=d,l.drawPickedItem(b,
a,h,f)):!1},onRemoveToken:function(b,d){l.fieldChange(a)}});f?b.disable():r||g?(b.container.addClass(A.z+"picker_with_typeahead"),g&&this.$getPickItemsInput(a).blur(function(){var b,d;if(b=l.$getPickItemsInput(a).val())d={},d[b]=b,l.addToPickedItems(d,a,e)})):b.disableTypeAhead()};g.chooseFromDropbox=function(a){var e=this,b,f,d,l,g;if(!(b=this.field(a))||!b.upload)return!1;if(l=b.upload.extensions||b.upload.accept)l=_._iS(l)?l.split(","):_._tA(l);for(f in l)s(l,f)&&(d=l[f],g=d.split("/"),g[1]!==
h?l[f]="images"==g[0]?"image":g[0]:"text"!=d&&"documents"!=d&&"images"!=d&&"video"!=d&&"audio"!=d&&"."!=d.substr(0,1)&&(l[f]="."+d));b={cancel:function(){t._hAL()},linkType:"direct",multiselect:!!q(b.upload.multi),extensions:l,success:function(b){t._sAL();var d,f,l=new w.callback;for(d in b)s(b,d)&&(f=b[d],l.add(w._a(this.ajaxURL()+"&fetchFromDropbox=1",f,!0)));l.after(function(){var b,d,f,l="";if(!e.tuix.tabs[e.tuix.tab]||!(f=e.tuix.tabs[e.tuix.tab].fields[a])||!f.upload)return!1;for(b in arguments)s(arguments,
b)&&((d=arguments[b])&&d.id&&(l+=","+d.id),e.setFileDetails(f,d));""!==l&&e.addToPickedItems(l,a);t._hAL()})}};t._sAL();Dropbox.choose(b)};g.setFileDetails=function(a,e){a.values||(a.values={});a.values[e.id]||(a.values[e.id]={file:e,label:this.formatLabelFromFile(e)})};g.formatLabelFromFile=function(a){var e;a.filename!==h?(e=a.filename,q(a.width)&&q(a.height)&&(e+=" ["+a.width+" \u00d7 "+a.height+"px]")):(fileDetails=w._dIIFO(a.id))&&(fileDetails=fileDetails.split("/"))&&fileDetails[1]?(e=fileDetails[1],
q(fileDetails[2])&&q(fileDetails[3])&&(e+=" ["+fileDetails[2]+" \u00d7 "+fileDetails[3]+"px]")):e=a.id;return e};g.upload=function(a,e){var b=this,f;if(!(f=this.field(a))||!f.upload)return!1;f={class_name:f.class_name,upload:f.upload};this.uploadCallback=function(d){if(d){var e,f,h,g="";if(!b.tuix.tabs[b.tuix.tab]||!(h=b.tuix.tabs[b.tuix.tab].fields[a])||!h.upload)return!1;for(e in d)s(d,e)&&(f=d[e])&&f.id&&(g+=","+f.id,b.setFileDetails(h,f));""!==g&&b.addToPickedItems(g,a)}};e?t._sHTML5UFDD(b.ajaxURL(),
{fileUpload:1},!1,this.uploadCallback,b.get(A.z+"fbAdminInner")):t._a(this,f,h,h,h,{fileUpload:1},h,this.ajaxURL())};g.ajaxURL=function(){return U+A.a+"?method_call=handleAdminBoxAJAX&path="+S(this.path)};g.uploadComplete=function(a){this.uploadCallback!==h&&this.uploadCallback(a);delete this.uploadCallback};g.drawSlider=function(a,e,b,f,d){var l=this,g=_._cl(b.slider);b="";if(q(g.before_field)?d:!d)f&&(b+='<div class="ui-disabled">'),b+=ca("id",A.z+"slider_for__"+e,B,g[B],wa,g.style),f&&(b+="</div>"),
a.after(function(){var a;if(a=l.get(A.z+"slider_for__"+e))g.min!==h&&(g.min=w.num(g.min)),g.max!==h&&(g.max=w.num(g.max)),g.step!==h&&(g.step=w.num(g.step)),g.disabled=!l.editModeOn(),g.value=$(l.get(e)).val(),g.slide=function(a,b){$(l.get(e)).val(b.value)},g.change=function(a,b){l.fieldChange(e)},$(a).slider(g)});return b};g.pickedItemsArray=function(a,e){if(!1===e||null===e||e===h||!(0!==e&&"0"!==e||a.values&&(a.values[0]||a.values["0"])))return{};var b=(e+"").split(","),f={},d,l,g,ka,m,r,n;a._display_value=
!1;for(r in b)s(b,r)&&(n=b[r])&&(a.upload&&(m=w._dIIFO(n))&&(m=m.split("/"))&&m[1]?(f[n]=m[1],q(m[2])&&q(m[3])&&(f[n]+=" ["+m[2]+" \u00d7 "+m[3]+"px]")):a.values&&a.values[n]&&"string"==typeof a.values[n]?f[n]=a.values[n]:a.values&&a.values[n]&&a.values[n].label?f[n]=a.values[n].label:((g=a.pick_items&&a.pick_items.target_path)||(g=a.pick_items&&a.pick_items.path))&&(-1==g.indexOf("//")||V.map&&(g=V._cNPTTP(g)))&&(d=t._gIFO(g,n))?(a.values||(a.values={}),l=t._fOIN(d,n),ka=d.items&&d.items[n]||{},
f[n]=l,a.values[n]={list_image:ka.list_image,css_class:ka.css_class||d.item&&d.item.css_class,label:l}):a.upload&&n==1*n&&(m=t._lFD(n))?(this.setFileDetails(a,m),f[n]=a.values[n]):f[n]=n,!1===a._display_value&&(a._display_value=f[n]));return f};g.pickedItemsValue=function(a){var e,b="";if(a)for(e in a)s(a,e)&&(b+=(""===b?"":",")+e);return b};g.hierarchicalBoxes=function(a,e,b,f,d,g,p,t,m,r,n,x,w){var y=1,H=0,L="",D,E,G,I,N=!1;if(!w)w=0,y=1*d.cols||1;else if(10<w)return"";x||(x={});n&&(x[n]=!0);w&&
(L+=ca(B,A.z+"hierarchical_box_children","id","children_for___"+b+"___"+n,">"));for(var z in m)if(s(m,z)&&(D={},E=m[z],E==1*E&&(E*=1),I=h,G="object"==typeof d.values[E]?d.values[E]:{label:d.values[E]},d.tag_colors&&(D.tag_color=d.tag_colors[E]||"blue"),I=G.parent,"0"===I&&(I=!1),!n&&!I||n==I)){if(D.newRow=++H>y)H=1;D.col=H;D.cols=y;I=f?!0===f||1===f||"1"===f?!0===E||1===E||"1"===E:p?p[E]!==h?!0:!1:E==f:!E;D.checked=I;if("checkboxes"==d.type&&q(d.checking_child_checks_parents)){var k="";n&&(k+="if (this.checked) { for (var cb in "+
JSON.stringify(x)+") { "+this.globalName+".get('"+J(b)+"___' + cb).checked = true; } } ");r[E]&&(k+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");k?g.onchange=d.onchange?k+" "+d.onchange:k:d.onchange?g.onchange=d.onchange:delete g.onchange}else"checkboxes"==d.type&&q(d.checking_parent_checks_children)&&(k="",r[E]&&(k+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),k?g.onchange=d.onchange?
k+" "+d.onchange:k:d.onchange?g.onchange=d.onchange:delete g.onchange);D.lovId=b+"___"+E;D.lovField=G;d.indeterminates&&q(d.indeterminates[E])&&function(b){a.after(function(){var a;if(a=this.get(b))a.indeterminate=!0})}(D.lovId);D.lovHTML=this.drawField(a,e,b,!0,g,h,h,h,h,E,I,!1,t,m,r,G);D.childrenHTML="";r[E]&&(D.childrenHTML=this.hierarchicalBoxes(a,e,b,f,d,g,p,t,m,r,E,_._ex({},x),w+1),H=0);N?(this.splitValues||(this.splitValues={}),this.splitValues[b]||(this.splitValues[b]=""),this.splitValues[b]+=
this.microTemplate(this.mtPrefix+"_radio_or_checkbox",D)):L+=this.microTemplate(this.mtPrefix+"_radio_or_checkbox",D);I&&G.split_values_if_selected&&!w&&"radios"===d.type&&(N=!0)}w&&(L+="</div>");return L};g.drawPickedItem=function(a,e,b,f){b===h&&(b=this.field(e));var d={},g=b.values&&b.values[a];_._isOb(g)?(d=g,g=g.label):(g||(g=a),d.label=g);var p=a==1*a,s,m;e={id:e,item:a,label:g,readOnly:f,css_class:d.css_class,list_image:d.list_image};b.tag_colors&&(e.tag_color=b.tag_colors[a]||"blue");!b.pick_items||
q(b.pick_items.hide_info_button)||b.upload&&!p||!(s=b.pick_items.path)||s!=b.pick_items.target_path&&b.pick_items.min_path!=b.pick_items.target_path||(s="//"==w._rHSS(s,2)?s+a:"/"==w._rHSS(s,1)?s+("/"+a):s+("//"+a),e.organizerPath=s);b.upload&&(e.isUpload=!0,s=(s=(""+g).match(/(.*?)\.(\w+)$/)||(""+g).match(/(.*?)\.(\w+) \[.*\]$/))&&s[2]?s[2].toLowerCase():"unknown",e.extension=s,p?(m=b.values&&b.values[a]&&b.values[a].file)&&m.checksum?(a=U+A.s+"file.php?c="+S(m.checksum),m.usage&&(a+="&usage="+S(m.usage))):
a=U+A.s+"file.php?id="+a:a=U+A.s+"file.php?getUploadedFileInCacheDir="+S(a),s.match(/gif|jpg|jpeg|png|svg/)?(e.thumbnail={onclick:this.globalName+".showPickedItemInPopout('"+a+"&popout=1&dummy_filename="+S("image."+s)+"', '"+g+"');",src:a+"&og=1"},(g=(""+g).match(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&g[1]&&g[2]&&t._rI(g[1],g[2],180,120,e.thumbnail)):e.adminDownload=a+"&adminDownload=1");return this.microTemplate(this.mtPrefix+"_picked_item",e)};g.showPickedItemInPopout=function(a,e){t._a(this,
{popout:{href:a,title:e,css_class:A.z+"show_colobox_above_fab"}})};g.pickItems=function(a){var e,b,f;(e=this.field(a))&&(b=e.pick_items)&&(b.path||b.target_path)&&(e=b.path,q(b.multiple_select)||e!=b.target_path&&b.min_path!=b.target_path||!(f=this.readField(a))||-1!=f.indexOf(",")||(e="//"==w._rHSS(e,2)?e+f:"/"==w._rHSS(e,1)?e+("/"+f):e+("//"+f)),this.SKTarget=a,t._oS(this.globalName,"setPickedItems",b.multiple_select,e,b.target_path,b.min_path,b.max_path,b.disallow_refiners_looping_on_min_path,
h,b.one_to_one_choose_phrase,b.one_to_many_choose_phrase,h,!0,h,h,h,h,h,h,h,h,b))};g.setPickedItems=function(a,e,b,f){a=this.SKTarget;var d,g,h={};for(d in e._items)s(e._items,d)&&(b=w._dIIFO(d),g=f.items&&f.items[b]||{},h[b]={list_image:g.list_image,css_class:g.css_class||f.item&&f.item.css_class,label:t._fOIN(f,b)});this.addToPickedItems(h,a)};g.removeFromPickedItems=function(a,e,b){this.addToPickedItems(a,e,b,!0)};g.addToPickedItems=function(a,e,b,f){b=this.field(e,b);var d=this.readField(e),g=
b.pick_items&&q(b.pick_items.multiple_select)||b.upload&&q(b.upload.multi),h,w;a=t._cTO(a);w=g&&d?this.pickedItemsArray(b,d):{};for(h in a)if(s(a,h))if(d=a[h],b.values||(b.values={}),f)delete b.values[h];else if(b.values[h]||(b.values[h]=d),w[h]=!0,!g)break;this.redrawPickedItems(e,b,w)};g.redrawPickedItems=function(a,e,b){var f,d,g=this.pickedItemsValue(b),h={},q=$(this.get(a)).tokenize(),m=q.toArray();b=t._cTO(b);for(f in m)s(m,f)&&(d=m[f],b[d]?h[d]=!0:q.tokenRemove(d));for(d in b)s(b,d)&&!h[d]&&
(f=e.values&&e.values[d],_._isOb(f)?f=f.label:f||(f=d),q.tokenAdd(d,f));e.current_value=g;this.fieldChange(a)};g.changes=function(a){if(this.tuix&&this.tuix.tab){if(a==h){for(a in this.tuix.tabs)if(s(this.tuix.tabs,a)&&this.changed[a])return!0;return!1}return this.changed[a]}return!1};g.markAsChanged=function(a){this.tuix&&(a===h&&(a=this.tuix.tab),a&&!this.changed[a]&&(this.changed[a]=!0,this.tuix.tab==a&&$(A.h+"abtab").addClass(A.z+"abtab_changed")))};g.fieldChange=function(a,e){var b=this,f=this.field(a);
f&&(f.indeterminate&&(f.indeterminate=!1),e!==h&&f.indeterminates&&f.indeterminates[e]&&(f.indeterminates[e]=!1),this.markAsChanged(),q(f.multiple_edit)&&this.meMarkChanged(a),setTimeout(function(){b.validateFormatOrRedrawForField(f)},1))};g.validateFormatOrRedrawForField=function(a){a=this.field(a);var e=q(a.validate_onchange),b=q(a.format_onchange);a=q(a.redraw_onchange);if(e)return this.validate(),!0;if(b)return this.format(),!0;a&&(this.readTab(),this.redrawTab());return a};g.meMarkChanged=function(a,
e,b){if(e===h||e!=b)this.field(a).multiple_edit._changed=!0,this.meSetCheckbox(a,!0)};g.meSetCheckbox=function(a,e){"checkbox"==this.get("multiple_edit__"+a).type?this.get("multiple_edit__"+a).checked=e:this.get("multiple_edit__"+a).value=e?1:""};g.meChange=function(a,e,b){var f=this.field(e);if(a)f.multiple_edit._changed=!0;else{if(!b&&q(f.multiple_edit.warn_when_abandoning_changes)&&f.multiple_edit.original_value!==h&&this.readField(e)!=f.multiple_edit.original_value){f=da(X,O,B,"submit_selected",
H,N.abandonChanges,ia,this.globalName+'.meChange(false, "'+W(e)+'", true);')+da(X,O,B,Y,H,N.cancel);t._flBo(N.abandonChangesConfirm,f,"warning");this.meSetCheckbox(e,!0);return}f.multiple_edit._changed=!1;delete f.current_value;b=f.value;f.multiple_edit.original_value!==h&&(b=f.current_value=f.multiple_edit.original_value);if(this.get(e)&&!f.pick_items)"checkbox"==this.get(e).type?this.get(e).checked=b?!0:!1:$(this.get(e)).val(b||"");else{b=new w.callback;var d=this.drawFields(b);this.insertHTML(d,
b)}}q(f.multiple_edit.disable_when_unchanged)&&(this.get(e)&&(this.get(e).disabled=!a),$(".control_for__"+e).each(function(b,d){d.disabled=!a;d.type==O&&(a?$(d).removeClass("submit_disabled"):$(d).addClass("submit_disabled"))}));this.meSetCheckbox(e,a);this.validateFormatOrRedrawForField(e)};g.currentValue=function(a,e,b){return b||e!=this.tuix.tab?this.value(a,e,b):this.readField(a)};g.value=function(a,e,b,f){e||(e=this.tuix.tab);var d="";a=this.field(a,e);if(!a)return"";b===h&&(b=!this.editModeOn(e)||
a.read_only||a.readonly);a&&!a.snippet&&"grouping"!=a.type&&(!f&&this.isButton(a)?d=!!a.pressed:b||a.current_value===h?a.value!==h?d=a.value:a.multiple_edit&&a.multiple_edit.original_value!==h&&(d=a.multiple_edit.original_value):d=a.current_value);return"0"===d?0:d};g.valueIn=function(a){return _.contains(arguments,this.value(a),1)};g.modeIn=function(){return _.contains(arguments,this.value("mode"))};g.isButton=function(a){return a&&(a.type==Y||"toggle"==a.type||a.type==O)};g.isFormField=function(a){return!(!a||
a.snippet||"grouping"==a.type||a.type==Y||"toggle"==a.type||a.type==O)};g.readField=function(a){var e=h,b=this.tuix.tab,f=this.field(a,b),d;if(!this.isFormField(f))return h;var g=!this.editModeOn()||q(f.read_only)||q(f.readonly),p=f._was_hidden_before;f.multiple_edit&&g&&delete f.multiple_edit._changed;if("checkboxes"==f.type||"radios"==f.type){if(!g&&!p&&f.values){var t,p="",m=!0;for(t in f.values)s(f.values,t)&&this.get(a+"___"+t)&&this.get(a+"___"+t).checked&&(p+=(m?"":",")+t,m=!1);f.current_value=
p}p=!0}if(p)return g||f.current_value===h?f.value:f.current_value;if(this.get("_value_for__"+a))f.current_value=e=this.get("_value_for__"+a).value;else if("editor"!=f.type&&"code_editor"!=f.type||g)if(!g&&(d=this.get(a))){if("checkbox"==f.type||"radio"==f.type)e=d.checked?!0:!1;else if("color_picker"==f.type||"colour_picker"==f.type)try{e=$(d).spectrum("get").toHexString()}catch(r){e=$(d).val()}else e=$(d).val();_._isAr(e)&&(e=e.join(","));f.current_value=e}else delete f.current_value,e=f.value;else if(e=
h,"editor"==f.type?Z.tinyMCE&&tinyMCE.get(a)&&(e=w._tMGC(tinyMCE.get(a))):"code_editor"==f.type&&(d=ace.edit(a))&&(e=d.getValue(),this.editingPositions[b+"/"+a]={top:d.session.getScrollTop(),left:d.session.getScrollLeft(),range:d.getSelectionRange()}),e!==h&&!1!==e)e=f.current_value=e;else return f.current_value===h?f.value:f.current_value;return e};g.blankField=function(a){this.setFieldValue(a,"")};g.setFieldValue=function(a,e){field=this.field(a,this.tuix.tab);this.get(a)&&$(this.get(a)).val(e);
this.get("_value_for__"+a)&&(this.get("_value_for__"+a).value=e);field.current_value=e};g.readTab=function(){var a,e={},b=this.fields(),f;this.lastScrollTop=$(A.h+"fbAdminInner").scrollTop();for(f in b)s(b,f)&&(a=this.readField(f))!==h&&(e[f]=a);P&&P.activeElement&&(this.lastFieldInFocus=P.activeElement.id);return e};g.wipeTab=function(){var a=this.fields(),e,b;for(e in a)s(a,e)&&(b=a[e],delete b.current_value,b.multiple_edit&&delete b.multiple_edit._changed)};g.redrawTab=function(){this.tuix.shake=
!1;this.draw2()};g.getURL=function(a){++this.onKeyUpNum;return this.returnAJAXURL(a)};g.returnAJAXURL=function(a){return"..."};g.editModeOn=function(a){return!0};g.editModeAlwaysOn=function(a){return!0};g.editCancelEnabled=function(a){return!1};g.revertEnabled=function(a){return!1};g.savedAndContinued=function(a){return!1};g.editModeOnBox=function(){return!0};g.sortTabs=function(){this.sortedTabs=[];if(this.tuix.tabs)for(var a in this.tuix.tabs)if(s(this.tuix.tabs,a)){var e=this.tuix.tabs[a];e&&this.sortedTabs.push([a,
e.ord])}this.sortedTabs.sort(t.sortArray);this.groupings={};this.sortedFields={};for(a in this.sortedTabs)s(this.sortedTabs,a)&&(e=this.sortedTabs[a]=this.sortedTabs[a][0],this.sortFields(e))};g.sortFields=function(a){var e,b,f,d,g={};this.groupings[a]={};this.sortedFields[a]=[];if(f=this.fields(a)){for(e in f)s(f,e)&&(b=f[e],b.type&&"grouping"==b.type&&(g[b.name||e]=1*b.ord,this.groupings[a][b.name||e]=e));for(e in f)s(f,e)&&(!(b=f[e])||b.type&&"grouping"==b.type||(d=b.grouping?g[b.grouping]:h,this.sortedFields[a].push([e,
b.ord,d])));this.sortedFields[a].sort(t.sortArrayWithGrouping);for(e in this.sortedFields[a])s(this.sortedFields[a],e)&&(this.sortedFields[a][e]=this.sortedFields[a][e][0])}};g.setData=function(a){this.tuix=a};g.setDataDiff=function(a){this.syncAdminBoxFromServerToClient(a,this.tuix)};g.syncAdminBoxFromServerToClient=function(a,e){var b,f;for(b in a)s(a,b)&&(f=a[b],null===f||f["[[__unset__]]"]?delete e[b]:e[b]===h||null===e[b]?e[b]=f:f["[[__replace__]]"]?(delete f["[[__replace__]]"],e[b]=f):"object"!=
typeof e[b]?e[b]=f:"object"==typeof e[b]&&"object"!=typeof f?e[b]=f:this.syncAdminBoxFromServerToClient(f,e[b]))};g.sendStateToServer=function(){return JSON.stringify(this.tuix)};g.sendStateToServerDiff=function(){var a={};this.syncAdminBoxFromClientToServerR(a,this.tuix);return JSON.stringify(a)};g.syncAdminBoxFromClientToServerR=function(a,e,b,f,d,g,p,q){if("object"==typeof e){var m,r;for(r in e)if((m="array")&&b===h&&"_sync"==r||(m=H)&&f===h&&"_sync"==b&&"session"==r||(m=H)&&f===h&&"_sync"==b&&
"cache_dir"==r||(m=H)&&f===h&&"_sync"==b&&"password"==r||(m=H)&&f===h&&"_sync"==b&&"iv"==r||(m="array")&&b===h&&"key"==r||(m=H)&&f===h&&"key"==b||(m=H)&&b===h&&"shake"==r||(m=H)&&b===h&&"download"==r||(m="array")&&b===h&&"tabs"==r||(m="array")&&f===h&&"tabs"==b||(m="array")&&d===h&&"tabs"==f&&"edit_mode"==r||(m=H)&&g===h&&"tabs"==d&&"edit_mode"==b&&"on"==r||(m="array")&&d===h&&"tabs"==f&&"fields"==r||(m="array")&&g===h&&"tabs"==d&&"fields"==b||(m=H)&&p===h&&"tabs"==g&&"fields"==f&&"current_value"==
r||(m=H)&&p===h&&"tabs"==g&&"fields"==f&&"_display_value"==r||(m=H)&&p===h&&"tabs"==g&&"fields"==f&&"_was_hidden_before"==r||(m=H)&&p===h&&"tabs"==g&&"fields"==f&&"pressed"==r||(m="array")&&p===h&&"tabs"==g&&"fields"==f&&"multiple_edit"==r||(m=H)&&q===h&&"tabs"==p&&"fields"==d&&"multiple_edit"==b&&"_changed"==r)m==H?"function"!=typeof e[r]&&"object"!=typeof e[r]&&(a[r]=e[r]):"array"==m&&"object"==typeof e[r]&&(a[r]={},this.syncAdminBoxFromClientToServerR(a[r],e[r],r,b,f,d,g,p))}};g.getValueArrayofArrays=
function(a){return w._nAA(this.getURL(),w._uR({_read_values:!0,_box:this.sendStateToServer()}),!a)};g.getValues1D=function(a,e,b,f,d){var g,p,t,m,r,n={};if(this.tuix&&this.tuix.tabs)for(g in this.tuix.tabs)if(s(this.tuix.tabs,g)&&(p=this.tuix.tabs[g],p.fields))for(t in p.fields)s(p.fields,t)&&(m=p.fields[t],r=t,this.isFormField(m)&&!(f&&(!this.editModeOn(g)||q(m.read_only)||q(m.readonly))||d&&(m._was_hidden_before||q(m.read_only)||q(m.readonly))||a&&!(r=m.plugin_setting&&m.plugin_setting.name))&&
(m=this.currentValue(t,g,b),e||(n[r]=m),e||e===h))&&(n[g+"/"+t]=m);return n};g.insertText=function(a,e){_._iS(a)&&(a=this.get(a));if(a){var b=$(a),f=a.selectionStart,d=a.selectionEnd,g=b.val();b.val(g.substring(0,f)+e+g.substring(d));a.selectionStart=a.selectionEnd=f+e.length;a.focus()}};g.callFunctionOnEditors=function(a){var e,b,f;if(Z.tinyMCE&&(e=this.fields()))for(b in e)if(s(e,b)&&(f=e[b],"editor"==f.type&&tinyMCE.get(b)))if("remove"==a)tinyMCE.get(b).remove();else if("isDirty"==a&&tinyMCE.get(b).isDirty())return!0;
return!1};g.format=function(a){var e;if(this.loaded&&(e=this.getURL("format"))){var b=this;this.loaded=!1;this.hideTab();this.checkValues(a);this.retryAJAX(e,{_format:!0,_box:this.sendStateToServer()},!0,function(a){b.load(a);b.sortTabs();b.draw()},"loading")}};g.validate=function(a,e,b,f){var d;if(this.loaded&&(d=this.getURL("validate"))){this.differentTab=a;this.loaded=!1;this.hideTab(a);this.checkValues(b);var g=this;this.retryAJAX(d,{_validate:!0,_box:this.sendStateToServer()},!0,function(a){g.load(a)&&
!g.errorOnTab(g.tuix.tab)&&e!==h&&(g.tuix.tab=e);g.sortTabs();g.switchToATabWithErrors();g.draw();f&&f()},"loading")}}})},zenarioF);
