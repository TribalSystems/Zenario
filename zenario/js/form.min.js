zenario.lib(function(h,Z,S,ea,za,Aa,q,F,K,Ba,Ha,aa,U,Ca,p,H,W,Q,Ia,Da,u,Ea,Ja,M,fa,ia,Ka,La,N,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Fa,Ga){K.lib(function(ga,ja,f,ha,ta,qa,za,Aa,X,R,C,ba,I,la,ua){f=Da(Ea);f.init=function(a,e,d){this.globalName=a;this.mtPrefix=e;this.containerId=d;this.baseCSSClass="";this.onKeyUpNum=0;Ba.sizing=!1;this.cachedAJAXSnippets={};this.changed={};this.toggleLevelsPressed={};this.fieldThatTriggeredRedraw=this.lastFieldInFocus=!1;this.editingPositions={}};f.get=function(a){return this.containerId&&
$("#"+this.containerId+" #"+q._cE(a))[0]||Ca(a)};f.microTemplate=function(a,e,d){return K._mT(a,e,d)};f.onThisRow=function(a,e){return a+e.replace(/(.*_|\D)/g,"")};f.valueOnThisRow=function(a,e){return this.value(this.onThisRow(a,e))};f.fieldOnThisRow=function(a,e){return this.field(this.onThisRow(a,e))};f.getKey=function(a){return this.tuix&&this.tuix.key};f.getKeyId=function(a){return this.tuix&&this.tuix.key&&this.tuix.key.id};f.getLastKeyId=function(a){return this.getKeyId(a)};f.getTitle=function(){var a,
e;if(this.tuix.key&&this.tuix.key.id&&(a=this.tuix.title_for_existing_records)){e=this.getValues1D(!1,h,!0);for(c in e)if(u(e,c)&&(v=e[c],-1!=a.indexOf("[["+c+"]]")))for(;a!=(string2=a.replace("[["+c+"]]",v));)a=string2;return a}return this.tuix.title};f.field=function(a,e){return _._isOb(a)?a:(tabs=this.tuix&&this.tuix.tabs)&&(e=e||this.tuix.tab)&&tabs[e]&&tabs[e].fields&&tabs[e].fields[a]};f.fields=function(a){var e;return(e=this.tuix&&this.tuix.tabs)&&(a=a||this.tuix.tab)&&e[a]&&e[a].fields};f.initFields=
function(){var a=this.tuix.tab,e,d,b,k,g,y=this.tuix.lovs||{};if(this.tuix.tabs)for(e in this.tuix.tabs)if(u(this.tuix.tabs,e)&&(b=this.fields(e))){g=!1;for(d in b)u(b,d)&&(k=b[d])&&(k.pick_items&&k.plugin_setting&&k.plugin_setting.use_value_for_plugin_name?this.pickedItemsArray(d,this.value(d,e,!1)):k.values&&_._iS(k.values)&&y[k.values]?k.values=y[k.values]:k.load_values_from_organizer_path&&!k.values&&this.loadValuesFromOrganizerPath(k),k.validation&&k.validation.required_if_not_hidden!==h&&(g=
!0));g&&e!=a&&(this.tuix.tab=e,this.drawFields(h,h,!0),this.tuix.tab=a)}};f.loadValuesFromOrganizerPath=function(a){var e,d,b;if(a.load_values_from_organizer_path&&!a.values&&(a.values={},(d=F._gIFO(a.load_values_from_organizer_path))&&d.items))for(e in d.items)u(d.items,e)&&(b=d.items[e],a.values[q._dIIFO(e)]={list_image:b.list_image,css_class:b.css_class||d.item&&d.item.css_class,label:F._fOIN(d,e)})};f.changeMode=function(){this.editCancelEnabled(this.tuix.tab)&&(this.editModeOn()?this.editCancelOrRevert("cancel",
this.tuix.tab):this.editCancelOrRevert("edit",this.tuix.tab))};f.revertTab=function(){this.changes(this.tuix.tab)&&this.revertEnabled(this.tuix.tab)&&this.editCancelOrRevert("revert",this.tuix.tab)};f.editCancelOrRevert=function(a,e){if(this.tuix.tabs[e].edit_mode){var d,b,k,g,y,f;"edit"==a?(y=p(this.tuix.tabs[e].edit_mode.format_on_edit),f=p(this.tuix.tabs[e].edit_mode.validate_on_edit)):"cancel"==a?(y=p(this.tuix.tabs[e].edit_mode.format_on_cancel_edit),f=p(this.tuix.tabs[e].edit_mode.validate_on_cancel_edit)):
"revert"==a&&(y=p(this.tuix.tabs[e].edit_mode.format_on_revert),f=this.errorOnTab(e)||p(this.tuix.tabs[e].edit_mode.validate_on_revert));if(!f&&(b=this.fields(e)))for(k in b)if(u(b,k))if(g=b[k],p(g.validate_onchange)&&(d=this.readField(k))!==h&&d!=g.value){f=!0;break}else!y&&p(g.format_onchange)&&(d=this.readField(k))!==h&&d!=g.value&&(y=!0);this.tuix.tabs[e].edit_mode.on="cancel"!=a;this.changed[e]=!1;f?this.validate(h,h,!0):y?this.format(!0):(this.wipeTab(),this.redrawTab(!0));this.tuix.tab==e&&
$(N+"abtab").removeClass(M+"abtab_changed")}};f.clickTab=function(a){this.loaded&&this.validate(a!=this.tuix.tab,a)};f.clickButton=function(a,e){var d;if(d=this.field(e))if(d.type==ba)d.pressed=!0,this.validate(!0);else if("toggle"==d.type){var b=$(this.get(e)),k=$(this.get("row__"+e));(d.pressed=!p(d.pressed))?(b.removeClass("not_pressed").addClass("pressed"),k.addClass("zfea_row_pressed")):(b.removeClass("pressed").addClass("not_pressed"),k.removeClass("zfea_row_pressed"));this.markAsChanged();
this.validateFormatOrRedrawForField(d,!0)}else d.type==R&&(d.pressed=!0,this.validateFormatOrRedrawForField(d))};f.togglePressed=function(a,e){var d;d=a?1<a?this.toggleLevelsPressed[a-1]:!0:this.toggleLevelsPressed.last;d===h&&(d=!0);e&&"toggle"==e.type&&(this.toggleLevelsPressed.last=d&&p(e.pressed),a&&(this.toggleLevelsPressed[a]=this.toggleLevelsPressed.last));return d};f.toggleLevel=function(a){return this.toggleLevelsPressed.last};f.retryAJAX=function(a,e,d,b,k,g){var y=function(){q._a(a,e,d,
h,y,!0,h,h,h,h,g).after(b);k&&F.nowDoingSomething&&F._nDS(k)};y()};f.switchToATabWithErrors=function(){var a,e,d=this.tuix;if(d&&d.tabs&&!this.errorOnTab(d.tab))for(a in this.sortedTabs)if(u(this.sortedTabs,a)&&(e=this.sortedTabs[a],d.tabs[e]&&!K._h(h,this,h,e,h,h,h,h,d.tabs[e])&&this.errorOnTab(e)))return d.tab=e,!0;return!1};f.applyMergeFields=function(a,e,d,b){return a};f.applyMergeFieldsToLabel=function(a,e,d,b){return a};f.hideTab=function(a){var e=this;a?($(N+"abtab input").add(N+"abtab select").add(N+
"abtab textarea").attr("disabled","disabled"),$(N+"abtab").clearQueue().show().animate({opacity:0.8},200,function(){e.tabHidden=!0;e.draw()})):($(N+"abtab input").add(N+"abtab select").add(N+"abtab textarea").attr("disabled","disabled").animate({opacity:0.9},100),this.tabHidden=!0,this.draw())};f.draw=function(){this.loaded&&this.tabHidden&&this.draw2()};f.draw2=function(){};f.drawTabs=function(a){a||(a=this.mtPrefix+"_tab");var e,d,b=[],k,g;for(k in this.sortedTabs)if(u(this.sortedTabs,k)&&(g=this.sortedTabs[k],
(e=this.tuix.tabs[g])&&!K._h(h,this,h,g,h,h,h,h,e))){d="";if(e.fields&&!_._isEm(e.fields)||e.fields&&!_._isEm(e.errors)||e.fields&&!_._isEm(e.notices))d=this.globalName+".clickTab('"+W(g)+"');";!this.tuix.tab&&d&&(this.tuix.tab=g);b.push({id:g,tabId:g,tuix:e,onclick:d,current:this.tuix.tab==g,label:e.label})}K._sBK(b,M+"fab_tab_with_children");return this.microTemplate(a,b)};f.drawFields=function(a,e,d){var b,k,g,y=this.tuix.tab,f=this.tuix.tabs[y],n=this.groupings[y],r=this.sortedFields[y],l="",
s=!1,w,q=this.fields(y),T={},L={},t={},A=!1,D,H,F,J=!1,B={},E={fields:{},rows:[],tabId:y,path:this.path,tuix:this.tuix,revert:"",errors:[],notices:{}};if(!d){this.ffoving=0;this.splitValues={};K._cHTML5UFDD();!this.savedAndContinued(y)&&this.editCancelEnabled(y)&&(E.revert=ja(C,M+"editCancelButton",K._i(C,ba,X,R,la,this.globalName+".changeMode(); return false;",I,this.editModeOn()?Q.cancel:Q.edit)));if(this.editModeOn()){if(f.errors)for(w in f.errors)u(f.errors,w)&&(g=f.errors[w],E.errors.push({message:g}));
if(q)for(w in q)u(q,w)&&(g=q[w],g.error&&E.errors.push({message:g.error}))}if(f.notices)for(w in f.notices)u(f.notices,w)&&(g=f.notices[w],p(g.show)&&{error:1,warning:1,question:1,success:1}[g.type]&&(E.notices[w]=g));this.setPhiVariables()}for(b in r)u(r,b)&&(k=r[b],g=q[k],w=!1,D=g.grouping,H!==D&&(H=D,J=n[D]!==h&&q[n[D]],s=D&&(!J||K._h(h,this,h,n[D],h,h,J))),F!==D&&(w=!0),g._id=k,g._html=this.drawField(a,y,k,g,T,L,t,d,s),d||s||!1===g._html||((w||g._startNewRow||!E.rows.length)&&E.rows.push({fields:[],
grouping:J}),w&&J&&(J.legend||J.snippet)&&(J=_._ex({grouping:D},J),J._id=D,J._html=this.drawField(a,y,D,J),J._hideOnOpen=!0,J._showOnOpen=!0,J._lastVisibleGrouping=F,F=D,E.rows[E.rows.length-1].fields.push(J),E.fields[D]=J,B[D]=J,E.rows.push({fields:[]})),A||f.show_errors_after_field!=k||(E.rows[E.rows.length-1].errors=E.errors,E.rows[E.rows.length-1].notices=E.notices,A=!0),g._lastVisibleGrouping=F,F=D,E.rows[E.rows.length-1].fields.push(g),E.fields[k]=g));for(k in E.fields)u(E.fields,k)&&(g=E.fields[k],
D=g.grouping)&&(J=B[D])&&(J._hideOnOpen&=g._hideOnOpen,J._showOnOpen&=g._showOnOpen);d||(E.rows.length&&(E.rows[E.rows.length-1].fields[0]._isLastRow=!0),A||E.rows.splice(0,0,{errors:E.errors,notices:E.notices}),e=e||f.template||this.mtPrefix+"_current_tab",l+=this.microTemplate(e,E));for(b in r)u(r,b)&&(k=r[b],delete q[k]._lastVisibleGrouping,delete q[k]._startNewRow,delete q[k]._hideOnOpen,delete q[k]._showOnOpen,delete q[k]._isLastRow,delete q[k]._html,delete q[k]._id);return l};f.insertHTML=function(a,
e,d){var b=this.get(M+"abtab"),k=this.lastFieldInFocus||this.fieldThatTriggeredRedraw,g;b.innerHTML=a;this.tabHidden=!1;this.changes(this.tuix.tab)?$(b).addClass(M+"abtab_changed"):$(b).removeClass(M+"abtab_changed");e.call();(g=!d&&k&&this.field(k))&&this.focusField(g);this.fieldThatTriggeredRedraw=!1};f.hideShowFields=function(a){var e=$(ia+"hide_on_open"),d=$(ia+"hide_row_on_open"),b=$(ia+"show_on_open"),k=function(a,b){b.style.display="none"};b.length&&!e.length?b.show("blind",200,a):!b.length&&
e.length?e.hide("blind",200,function(){d.each(k)}):b.length&&e.length&&(e.each(k),d.each(k),b.show())};f.addJQueryElements=function(a){q._aJQE(a+" ",!0);$(a+" select.iconselectmenu").iconselectmenu({width:"auto",change:function(){$(this).change()}})};f.addJQueryElementsToTab=function(){this.addJQueryElements(N+"abtab")};f.addJQueryElementsToTabAndFocusFirstField=function(){this.addJQueryElementsToTab();this.focusFirstField()};f.focusFirstField=function(){if(this.tuix&&!p(this.tuix.tabs[this.tuix.tab].disable_autofocus)){var a=
this,e=-1,d=[],b=h,k,g,y,f,n;for(k in this.sortedFields[this.tuix.tab])if(u(this.sortedFields[this.tuix.tab],k)&&(f=this.sortedFields[this.tuix.tab][k],(g=this.get(f))&&(y=this.field(f))&&((n=y.pick_items||y.upload)||$(g).is(":visible"))&&(d[++e]={id:f,type:y.type,empty:""==g.value,focusable:(n||q.IN(y.type,"password","checkbox","select","text","textarea"))&&!p(g.disabled)&&!p(g.readonly)&&!p(y.read_only)&&!p(y.readonly)},1<e)))break;if(d[0]&&!d[0].empty&&d[1]&&d[1].focusable&&d[1].empty&&"password"==
d[1].type)b=1;else if(d[0]&&d[0].focusable)b=0;else if(d[1]&&d[1].focusable)b=1;else return;setTimeout(function(){a.focusField(d[b])},50)}};f.focusField=function(a){(a=a.type?this.get(a.id):this.$getPickItemsInput(a.id))&&a.focus()};f.$getPickItemsInput=function(a){return $(this.get("name_for_"+a)).find(".TokenSearch input")};f.setPhiVariables=function(){q.phiVariables=h};f.errorOnBox=function(){if(this.tuix&&this.tuix.tabs)for(tab in this.tuix.tabs)if(u(this.tuix.tabs,tab)&&this.errorOnTab(tab))return!0;
return!1};f.errorOnTab=function(a){var e;if(this.tuix.tabs[a]&&this.editModeOn(a)){if(this.tuix.tabs[a].errors)for(e in this.tuix.tabs[a].errors)if(u(this.tuix.tabs[a].errors,e))return!0;if(a=this.fields(a))for(e in a)if(u(a,e)&&a[e].error)return!0}};f.checkValues=function(a){a?this.wipeTab():this.readTab();for(var e in this.tuix.tabs)if(u(this.tuix.tabs,e)){a=this.tuix.tabs[e];var d=this.editModeOn(e);if(a.fields)for(var b in a.fields)if(u(a.fields,b)){var k=a.fields[b];this.isFormField(k)&&("code_editor"==
k.type&&q._cAD("code_editor_"+b),k.current_value===h&&(k.current_value=this.value(b,e,!0)),d&&(k.value===h&&(k.value=this.value(b,e,!1)),k.multiple_edit&&k.multiple_edit._changed===h&&k.multiple_edit.changed!==h&&(k.multiple_edit._changed=k.multiple_edit.changed)))}}S&&S.activeElement&&(this.lastFieldInFocus=S.activeElement.id)};f.enableMicroTemplates=function(a,e){var d=this,b;for(b in e)if(u(e,b))switch(typeof e[b]){case "object":"that"!==b&&"tuix"!==b&&this.enableMicroTemplates(a,e[b]);break;case "string":b===
X||b===I&&this.isFormField(e)||"current_value"===b||!e[b].match(/(\{\{|\{\%|\<\%)/)||function(a,b,e){e=q._gMT("<% "+d.defineLibVarBeforeCode()+" %>"+a[b],h);a[b]=function(){return e(a)}}(e,b)}};f.drawField=function(a,e,d,b,k,g,f,z,n,r,l,s,w,ka,T){b===h&&(b=this.field(d,e));b.id===h&&(b.id=d);p(b.enable_microtemplates_in_properties)&&this.enableMicroTemplates(b,b);var L=this,t=b.type,A=b.upload,D=b.pick_items,ra=b.disabled,N="date"==t||"datetime"==t,J,B,E,G,m="",P,O,V={},S="multiselect"==t,U=!1,x=
{"class":""},ca={},ma={},aa=!1,da=!1,fa=!1,ia=!1,ja=!1,va=!1,sa=O=!1,na,oa;s===h&&(s=!this.editModeOn(e)||p(b.read_only)||p(b.readonly));D&&ra&&(s=!0);t&&"datetime"==t&&(s=!0);T?T.disabled_if!==h&&K._e(T.disabled_if,this,T,h,r,h,h,b)&&(s=!0):b.disabled_if!==h&&K._e(b.disabled_if,this,h,h,d,h,h,b)&&(s=!0);!b[C]&&b.css_class&&(b[C]=b.css_class);b.snippet||l!==h||(l=this.value(d,e));l===h&&(l="");if(r===h){delete b.selected_option;if(l&&b.values)if(T=_._isOb(b.values)?b.values[l]:this.tuix.lovs&&this.tuix.lovs[b.values]&&
this.tuix.lovs[b.values][l],_._isOb(T)&&K._h(T,this,h,l,h,h,b,h,this.tuix.tabs[e])&&(T=!1),T)b.selected_option=T;else if("radio"==t||"select"==t)b.current_value=l="";(A||D||S)&&""!=l&&(V=this.pickedItemsArray(b,l));b.values&&_._iS(b.values)&&this.tuix.lovs&&this.tuix.lovs[b.values]?b.values=this.tuix.lovs[b.values]:b.load_values_from_organizer_path&&!b.values&&this.loadValuesFromOrganizerPath(b);for(B in b)u(b,B)&&(E=B.match(/^<(\/?)(\w+)/))&&(b[B]&&_._iS(b[B])&&(B+=b[B]),P={table:1,tr:2,td:3,th:4,
div:5,p:6,span:7}[E[2]]||8,5>P&&(va=!0),E[1]?(sa||(sa=!0,oa="       ".split(" ")),oa[8-P]+=B):(O||(O=!0,na="       ".split(" ")),na[P-1]+=B,1==P&&(ja=!0)))}z||t!=R&&t!=ba||(b.pressed=!1);if(z||r===h){E=b.same_row===h?ja||!va:!p(b.same_row);b._startNewRow=E;B=1*b.indent||0;n=n||K._h(h,this,h,d,h,h,b)||p(g&&g.last?b.hide_with_previous_field:b.hide_if_previous_field_is_not_hidden)||p(g&&g.beforeLast?b.hide_with_previous_previous_field:b.hide_if_previous_previous_field_is_not_hidden)||p(b.hide_with_previous_indented_field)&&
g&&g[B]||p(b.hide_with_previous_outdented_field)&&0<B&&g&&g[B-1]||p(b.hide_with_previous_indented_fields)&&!k[B]||b.hide_if_previous_value_isnt!==h&&!q._iL(b.hide_if_previous_value_isnt,f&&f.last)||b.hide_if_previous_outdented_value_isnt!==h&&0<B&&!q._iL(b.hide_if_previous_outdented_value_isnt,f&&f[B-1]);f&&(f.last=l,E&&(f[B]=l));if(g){g.beforeLast=g.last;g.last=n;E&&(g[B]=n);if(k.last===h||k.last!==B)k.last<B&&(k[B]=!1),k.last=B;n||(k[B]=!0)}b._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&
"editor"!=t&&"code_editor"!=t&&b._was_hidden_before&&!n?b._showOnOpen=!0:b._startNewRow&&!1!==this.shownTab&&this.shownTab==this.tuix.tab&&"editor"!=t&&"code_editor"!=t&&!b._was_hidden_before&&n&&(b._hideOnOpen=J=!0,b._was_hidden_before=!0);if(n){if(b._was_hidden_before=!0,!J)return!1}else delete b._was_hidden_before;if(z)return;b.multiple_edit&&(k="",g=s||b.multiple_edit._changed===h?b.multiple_edit.changed:p(b.multiple_edit._changed),p(b.multiple_edit.hide_ui)||!b.multiple_edit.select_list?(f=p(b.multiple_edit.hide_ui),
k+=ha(X,"checkbox",C,"multiple_edit","id","multiple_edit__"+d,"checked",g,"style",f?"display: none;":"","disabled",s,"onchange",s||f?"":this.globalName+".meChange(this.checked, '"+H(d)+"');",">")):k+=ta(C,"multiple_edit","id","multiple_edit__"+d,"disabled",s,"onchange",this.globalName+'.meChange(this.value == 1, "'+W(d)+'");',qa(I,"","selected",!g,b.multiple_edit.select_list.not_changed_label||Q.notChanged)+qa(I,1,"selected",g,b.multiple_edit.select_list.changed_label||Q.changed)),m+=k,k=h);O&&(m+=
na.join(""));b.pre_field_html!==h&&(m+=q._un(b.pre_field_html))}if(!(w&&ka||"object"!=typeof b.values))if(w=[],ka={},A&&p(A.reorder_items))for(P in O=l.split(","),O)u(O,P)&&(G=O[P],w.push(G));else{for(G in b.values)u(b.values,G)&&(O=b.values[G],"object"==typeof O?(O.parent!==h&&(da=!0,ka[O.parent]=!0),K._h(O,this,h,G,h,h,b,h,this.tuix.tabs[e])||(O.ord!==h?w.push([G,O.ord]):O.label!==h?w.push([G,O.label]):w.push([G,G]))):w.push([G,O]));w.sort(K.sortArray);for(P in w)u(w,P)&&(w[P]=w[P][0])}s&&(x.readonly=
!0,this.isButton(b)&&(x.disabled=!0,x[C]+="disabled "));if(s&&p(b.show_as_a_label_when_readonly)&&"checkboxes"!=t){w=H(l);if("select"==t||"radios"==t)b.values&&b.values[l]?w=H(b.values[l]):b.empty_value&&(w=H(b.empty_value));m+=ga("label","id","label__"+d,C,b.css_class,w)}else if(G=b.snippet){for(var pa in wa)l=wa[pa],G[l]&&(m+=ga(l,"id",l+"__"+d,C,G[l+"_class"],ua,G[l+"_style"],H(G[l])));G.show_split_values_from&&this.splitValues&&this.splitValues[G.show_split_values_from]&&(m+=this.splitValues[G.show_split_values_from],
delete this.splitValues[G.show_split_values_from]);G.html?m+=ga("span","id","snippet__"+d,q._un(G.html)):G.url&&(m=p(G.cache)?this.cachedAJAXSnippets[G.url]?m+this.cachedAJAXSnippets[G.url]:m+(this.cachedAJAXSnippets[G.url]=q._nAA(q._aBP(G.url))):m+q._nAA(q._aBP(G.url)))}else if(("checkboxes"==t||"radios"==t)&&r===h)b.values&&(V=this.pickedItemsArray(b,l),da=_._ex({},b),da.name=b.name||d,da.type="checkboxes"==t?"checkbox":"radio",s&&(da.disabled=!0),m=_._isEm(w)?m+ga("label",C,M+"no_values_message",
H(b.no_values_message)):m+this.hierarchicalBoxes(a,e,d,l,b,da,s,V,w,ka));else if(A||D||S){var xa=S||D&&p(D.multiple_select)||A&&p(A.multi);l={id:d,pickerHTML:"",wrappedId:"name_for_"+d,readOnly:s};s||(D&&(D.target_path||D.path)&&!p(D.hide_select_button)&&(l.select={onclick:this.globalName+".pickItems('"+H(d)+"');",phrase:D.select_phrase||Q.selectDotDotDot}),A&&(l.upload={onclick:this.globalName+".upload('"+H(d)+"');",phrase:A.upload_phrase||Q.uploadDotDotDot},p(A.drag_and_drop)&&this.upload(d,!0),
ea.Dropbox&&Dropbox.isBrowserSupported()&&(l.dropbox={onclick:this.globalName+".chooseFromDropbox('"+H(d)+"');",phrase:A.dropbox_phrase||Q.dropboxDotDotDot})));l.pickerHTML+=ta("id",d,"multiple",xa,"class",b.css_class,"style",b.style,">");!b.values||_._isEm(V)&&!S||(l.pickerHTML+=this.hierarchicalSelect(V,b,w,da,ka));l.pickerHTML+="</select>";m+=this.microTemplate(this.mtPrefix+"_picked_items",l);a.after(function(){S?L.setupMultipleSelect(d,e,b,s||ra):L.setupPickedItems(d,e,b,s,xa)})}else if(t){ca.onchange=
r?"lib.fieldChange('"+H(d)+"', '"+H(r)+"');":"lib.fieldChange('"+H(d)+"');";ra&&(x[C]+="disabled ");b.validation&&b.validation.numeric&&(x.onkeyup=(x.onkeyup||"")+"lib.keepNumeric(this)");b.return_key_presses_button&&!s&&(x.onkeyup=(x.onkeyup||"")+"if (event.keyCode == 13) {$('#"+H(b.return_key_presses_button)+"').click();}");p(b.multiple_edit)&&!s&&(x.onkeyup=(x.onkeyup||"")+"if (event && event.keyCode == 9) return true; lib.meMarkChanged('"+H(d)+"', this.value, '"+H(b.value)+"');");x[C]+="input_"+
t;switch(t){case "select":b.slider&&(U=!0,m+=this.drawSlider(a,d,b,s,!0));s&&(x.disabled=!0);m+="<select";break;case "code_editor":m+="<div";x[C]=" zenario_embedded_ace_editor";a.after(function(){var a=ace.edit(d),g=!1;a.session.setUseSoftTabs(!1);a.setShowPrintMargin(!1);s&&(a.setReadOnly(!0),a.setBehavioursEnabled(!1));p(b.wrap_text)&&a.session.setUseWrapMode(!0);a.session.setOption("useWorker",!1);a.on("blur",function(a){g&&q._aADINS("code_editor_"+d,function(){L.fieldChange(d)},0);g=!1});a.on("change",
function(a){L.markAsChanged();g=!0;q._aADINS("code_editor_"+d,function(){L.fieldChange(d)},5E3)});if(language=b.language)try{language=language.match(/\.twig\.html$/i)?"ace/mode/twig":language.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(language).mode:"ace/mode/"+language,a.session.setMode(language),a.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})}catch(k){console.log("Ace editor could not load that language",language)}a.$blockScrolling=Infinity;L.setCodeEditorPosition(a,
L.editingPositions[e+"/"+d])});break;case "color_picker":case "colour_picker":m+="<input";x[C]=" zenario_color_picker";a.after(function(){var a=b.color_picker_options||b.colour_picker_options||{};a.disabled=s;a.preferredFormat=a.preferredFormat||"hex";$(L.get(d)).spectrum(a)});break;case "editor":m+="<textarea";F._gSD();var Y,V={script_url:Z+q.tinyMCEPath,inline:!1,menubar:!1,statusbar:!1,plugins:"autoresize",document_base_url:h,convert_urls:!1,readonly:!0,inline_styles:!1,allow_events:!0,allow_script_urls:!0,
autoresize_max_height:Math.max(Math.floor(0.5*$(ea).height()),300),autoresize_bottom_margin:10,onchange_callback:function(a){L.fieldChange(a.id)},init_instance_callback:function(a){F._eDDUITM(!1,h,L.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&F._eDDUITM(!1,h,b)}},A=_._ex({},V,{plugins:["advlist autolink lists link image charmap hr anchor","searchreplace code fullscreen","nonbreaking table contextmenu directionality",
"paste autoresize"],image_advtab:!0,visual_table_class:" ",browser_spellcheck:!0,paste_preprocess:F.tinyMCEPasteRreprocess,readonly:!1,convert_urls:!0,relative_urls:!1,content_css:h,toolbar:"undo redo | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code",style_formats:F.skinDesc.style_formats,oninit:h}),D=_._ex({},A,{toolbar:"undo redo | image link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code",
file_browser_callback:F.fileBrowser,init_instance_callback:function(a){F._eDDUITM(!0,Z,L.get("row__"+(a.editorId||a.id)));var b;(b=a.editorContainer)&&(b=$("#"+a.editorContainer.id+" iframe"))&&(b=b[0])&&(b=b.contentWindow)&&F._eDDUITM(!0,Z,b)}});pa=_._ex({},D,{toolbar:"undo redo | image | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code"});G=_._ex({},pa,{toolbar:"undo redo | link unlink | bold italic | removeformat | fontsizeselect | formatselect | numlist bullist | blockquote outdent indent | code"});
s?(Y=V,x[C]=" tinymce_readonly"):b.insert_image_button?b.insert_link_button?(Y=D,x[C]=" tinymce_with_images_and_links"):(Y=pa,x[C]=" tinymce_with_images"):b.insert_link_button?(Y=G,x[C]=" tinymce_with_links"):(Y=A,x[C]=" tinymce");x.style="visibility: hidden;";_._isOb(b.editor_options)&&(Y=_._ex(Y,b.editor_options));Y.setup=function(a){a.on("change",function(a){L.fieldChange(a.id)})};a.after(function(){var a=$(L.get(d)),b=L.get(M+"abtab"),e=b.style.display;b.style.display="block";a.tinymce(Y);b.style.display=
e});break;case R:case ba:case "toggle":fa=!0;p(b.use_button_tag)?(m+="<"+R,ia=!0):(m+="<input",x.type=R);if(!s||p(b.can_be_pressed_in_view_mode))ca.onclick="lib.clickButton(this, '"+d+"');",delete x.disabled;"toggle"==t&&(x[C]+=b.pressed?" pressed":" not_pressed");break;default:"textarea"==t?m+="<textarea":N?(m+='<span class="zenario_datepicker_wrap"><input',x.type="text",x[C]+=" zenario_datepicker",x.readonly="readonly",s||(x.onkeyup=(x.onkeyup||"")+"zenario._dFKU(this, event, '"+H(d)+"');"),a.after(function(){var a=
$(L.get(d)),e=!!p(b.change_month_and_year);a.datepicker({changeMonth:e,changeYear:e,dateFormat:F.siteSettings&&F.siteSettings.organizer_date_format||q.dpf,altField:"#_value_for__"+d,altFormat:"yy-mm-dd",showOn:"focus",disabled:s,onSelect:function(b,e){a.change()}})})):"url"==t?(m+="<input",x.type="url",x.onfocus=(x.onfocus||"")+"if(!this.value) this.value = 'http://';",x.onblur=(x.onblur||"")+"if(this.value == 'http://') this.value = '';"):(b.slider&&(U=!0,m+=this.drawSlider(a,d,b,s,!0)),"text"==
t&&b.values&&!s&&(m+='<span class="zenario_textbox_with_autocomplete">',aa=!0),m+="<input",x.type=t),this.addExtraAttsForTextFields(b,x)}if("checkbox"==t||"radio"==t)p(l)&&(x.checked="checked"),l=h,s&&(x.disabled=!0),p(b.indeterminate)&&a.after(function(){var a;if(a=this.get(d))a.indeterminate=!0});U&&(x.onchange='$("#zenario_slider_for__'+W(d)+'").slider("value", $(this).val());',x.onkeyup=(x.onkeyup||"")+'$("#zenario_slider_for__'+W(d)+'").slider("value", $(this).val());');r===h?ma.id=d:(ma.id=
d+"___"+r,x[C]+=" control_for__"+d);"radio"==t&&b.name||(ma.name=d);s&&(ma.placeholder="");m+=this.outputAtts(b,x,ca,ma);ca=H(fa?b.value:l,!1,"asis");x="";"select"==t?m+=">":ia?(m+=">",b.icon_left&&(m+='<i class="'+H(b.icon_left)+'" aria-hidden="true"></i>'),m+=ca,b.icon_right&&(m+='<i class="'+H(b.icon_right)+'" aria-hidden="true"></i>'),m+="</button>"):"textarea"==t||"editor"==t?m+=">"+ca+"</textarea>":"code_editor"==t?m+=">"+ca+"</div>":N?(m+=' value="'+H(q._fD(l,"datetime"==t))+'"/>',m+=ha(X,
"hidden","id","_value_for__"+d,I,l),s||(m+=ha(X,R,C,M+"remove_date",I,"x",la,this.globalName+'.blankField("'+W(d)+'"); $('+this.globalName+'.get("'+W(d)+'")).change();'))):m=l!==h?m+(' value="'+ca+'"/>'):m+"/>";"select"==t&&(b.empty_value&&(x=qa(I,"","data-hide_in_iconselectmenu",1,"selected",!l,H(b.empty_value)),b.show_empty_value_at_end||(m+=x,x="")),b.values&&(V={},V[l]=!0,m+=this.hierarchicalSelect(V,b,w,da,ka)),m+=x+"</select>");if(aa){var ya=[];for(P in w)u(w,P)&&(G=w[P],ya.push({label:b.values[G],
value:G}));a.after(function(){var a=$(L.get(d)),e={source:ya,minLength:b.autocomplete_min_length||0,appendTo:a.parent()};b.return_key_presses_button&&(e.select=function(){setTimeout(function(){$("#"+b.return_key_presses_button).click()},0)});a.autocomplete(e);a.focus(function(){a.autocomplete("widget").is(":visible")||a.autocomplete("search","")})});m+=ha(X,R,C,M+"open_autocomplete",I,"\u25be",la,"$("+this.globalName+'.get("'+W(d)+'")).autocomplete("search", "");')}if(N||aa)m+="</span>"}r===h&&("url"!=
t||s||(m+="&nbsp; "+ha(X,R,C,ba,I,Q.test,la,this.globalName+'.testURL("'+W(d)+'");')),!b.label||"checkbox"!=t&&"radio"!=t&&"toggle"!=t||(m+=" "+ga("label",C,b.label_class,"for",d,"id","label_for__"+d,H(b.label))),b.post_field_label!==h&&(m+=" "+ga("label","for",d,"id","label_for__"+d,H(b.post_field_label))),b.post_field_html!==h&&(m+=q._un(b.post_field_html)),sa&&(m+=oa.join("")),U&&(m+=this.drawSlider(a,d,b,s,!1)));return m};f.addExtraAttsForTextFields=function(a,e){};var wa="hr h1 h2 h3 h4 label".split(" ");
f.outputAtts=function(a,e,d,b,k){var g,f="",z={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,onmouseover:!0,onmouseup:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,max:!0,min:!0,pattern:!0,placeholder:!0,required:!0,step:!0};for(g in a)if(u(a,g)&&(!b||b[g]==h)&&(k||z[g]||"data-"==
g.substr(0,5)))if("disabled"==g||"readonly"==g||"selected"==g){if(p(a[g])||e&&p(e[g])&&delete e[g])f+=" "+g+'="'+g+'"'}else f+=" "+g+'="'+this.defineLibVarBeforeCode(g),e&&e[g]&&(f+=e[g]+" ",delete e[g]),f+=H(a[g]),d&&d[g]&&(f+=" "+d[g],delete d[g]),f+='"';b&&(f+=this.outputAtts(b,!1,!1,!1,!0));e&&(f+=this.outputAtts(e,!1,!1,!1,!0));d&&(f+=this.outputAtts(d,!1,!1,!1,!0));return f};f.defineLibVarBeforeCode=function(a){if(a===h||"on"==a.substr(0,2)){if(!this.globalName){for(a=1;ea[this.globalName="zenarioLib"+
a];++a);ea[globalName]=this}return"var lib = "+H(this.globalName)+"; "}return""};f.testURL=function(a){var e=this.get(a).value;a=this.get(this.onThisRow("target_blank_",a))||this.get(this.onThisRow("target_blank",a));if(e)if(a&&2==a.value)$[Fa]({href:e,iframe:!0,width:"95%",height:"95%",className:M+"url_test_colorbox"});else ea.open(q._aBP(e))};f.keepNumeric=function(a){var e=a.value.replace(/[^\d\.]/g,"").replace(/\.(.*)\./g,".$1");a.value!=e&&(a.value=e)};f.hierarchicalSelect=function(a,e,d,b,k,
g){var f="",z,n,r,l,s;for(l in d)if(u(d,l)){s=d[l];r=e.values[s];n=z=!1;if(_._iS(r))r={label:r};else if(p(r.disabled)||r.disabled_if!==h&&K._e(r.disabled_if,this,r,h,s,h,h,e))z=!0;a[s]&&(n=!0);showWithoutChildren=!p(r.hide_when_children_are_not_visible);if(g===h&&b&&k[s]){if((childrenHTML=this.hierarchicalSelect(a,e,d,b,k,s))||showWithoutChildren)f+=ga("optgroup","label",r,"disabled",!childrenHTML,childrenHTML)}else showWithoutChildren&&g===r.parent&&(f+="<option "+this.outputAtts(r,!1,!1,{disabled:z,
selected:n,value:s})+">"+H(r,!1,!0)+"</option>")}return f};f.setupMultipleSelect=function(a,e,d,b){var k=this,g=!1;e=$(this.get(a));e.multiselect({columns:d.cols,texts:{placeholder:d.empty_value||Q.selectListSelect,overridePlaceholder:d.placeholder},onOptionClick:function(){g=!0},onControlClose:function(){g&&k.fieldChange(a)}});b&&e.multiselect("disable")};f.setupPickedItems=function(a,e,d,b,k){var g=this,f=!1,h=!1,n,r,l,s,w=d.pick_items||{},C=d.upload||{};if(d.pick_items&&!p(w.disable_type_ahead_search)){n=
w.path&&aa._cNPTTPAR(w.path);s=w.target_path&&aa._cNPTTPAR(w.target_path);if(n=n&&s&&n.path==s.path?n:s||n)r=Z+fa+"admin/organizer.ajax.php?_typeahead_search=1&path="+U(n.path)+q._uR(n.request),l="_search";h=p(d.pick_items.allow_typing_anything)}d=$(this.get(a)).tokenize({datas:r,searchParam:l,debounce:200,sortable:p(C.reorder_items),placeholder:w.nothing_selected_phrase||C.nothing_selected_phrase||Q.nothing_selected,onAddToken:function(b,d,h){f||(k||(f=!0,g.addToPickedItems(b,a,e),f=!1),g.$getPickItemsInput(a).focus())},
maxElements:k?0:1,parseData:function(d){var k,f,h,y=[],l=g.tuix.tabs[e].fields[a];if(d.items)for(k in d.items)u(d.items,k)&&(f=d.items[k],h=F._fOIN(d,k),l.values=l.values||{},l.values[k]={list_image:f.list_image,css_class:f.css_class||d.item&&d.item.css_class,label:h},y.push({value:k,text:h,html:g.drawPickedItem(k,a,l,b)}));return y},formatTokenHTML:function(d,k){var f=g.tuix.tabs[e].fields[a];return f.values&&f.values[d]?g.drawPickedItem(d,a,f,b):h?(f.values=f.values||{},f.values[d]=k,g.drawPickedItem(d,
a,f,b)):!1},onRemoveToken:function(b,e){g.fieldChange(a)}});b?d.disable():r||h?(d.container.addClass(M+"picker_with_typeahead"),h&&this.$getPickItemsInput(a).blur(function(){var b,d;if(b=g.$getPickItemsInput(a).val())d={},d[b]=b,g.addToPickedItems(d,a,e)})):d.disableTypeAhead()};f.chooseFromDropbox=function(a){var e=this,d,b,k,g,f;if(!(d=this.field(a))||!d.upload)return!1;if(g=d.upload.extensions||d.upload.accept)g=_._iS(g)?g.split(","):_._tA(g);for(b in g)u(g,b)&&(k=g[b],f=k.split("/"),f[1]!==h?
g[b]="images"==f[0]?"image":f[0]:"text"!=k&&"documents"!=k&&"images"!=k&&"video"!=k&&"audio"!=k&&"."!=k.substr(0,1)&&(g[b]="."+k));d={cancel:function(){F._hAL()},linkType:"direct",multiselect:!!p(d.upload.multi),extensions:g,success:function(b){F._sAL();var d,k,g=new q.callback;for(d in b)u(b,d)&&(k=b[d],g.add(q._a(this.ajaxURL()+"&fetchFromDropbox=1",k,!0)));g.after(function(){var b,d,k,g="";if(!e.tuix.tabs[e.tuix.tab]||!(k=e.tuix.tabs[e.tuix.tab].fields[a])||!k.upload)return!1;for(b in arguments)u(arguments,
b)&&((d=arguments[b])&&d.id&&(g+=","+d.id),e.setFileDetails(k,d));""!==g&&e.addToPickedItems(g,a);F._hAL()})}};F._sAL();Dropbox.choose(d)};f.setFileDetails=function(a,e){a.values||(a.values={});a.values[e.id]||(a.values[e.id]={file:e,label:this.formatLabelFromFile(e)})};f.formatLabelFromFile=function(a){var e;a.filename!==h?(e=a.filename,p(a.width)&&p(a.height)&&(e+=" ["+a.width+" \u00d7 "+a.height+"px]")):(fileDetails=q._dIIFO(a.id))&&(fileDetails=fileDetails.split("/"))&&fileDetails[1]?(e=fileDetails[1],
p(fileDetails[2])&&p(fileDetails[3])&&(e+=" ["+fileDetails[2]+" \u00d7 "+fileDetails[3]+"px]")):e=a.id;return e};f.upload=function(a,e){var d=this,b;if(!(b=this.field(a))||!b.upload)return!1;b={class_name:b.class_name,upload:b.upload};this.uploadCallback=function(b){if(b){var e,f,h,n="";if(!d.tuix.tabs[d.tuix.tab]||!(h=d.tuix.tabs[d.tuix.tab].fields[a])||!h.upload)return!1;for(e in b)u(b,e)&&(f=b[e])&&f.id&&(n+=","+f.id,d.setFileDetails(h,f));""!==n&&d.addToPickedItems(n,a)}};e?K._sHTML5UFDD(d.ajaxURL(),
{fileUpload:1},!1,this.uploadCallback,d.get(M+"fbAdminInner")):K._a(this,b,h,h,h,{fileUpload:1},h,this.ajaxURL())};f.ajaxURL=function(){return Z+Ga+"?method_call=handleAdminBoxAJAX&path="+U(this.path)};f.uploadComplete=function(a){this.uploadCallback!==h&&this.uploadCallback(a);delete this.uploadCallback};f.drawSlider=function(a,e,d,b,k){var g=this,f=_._cl(d.slider);d="";if(p(f.before_field)?k:!k)b&&(d+='<div class="ui-disabled">'),d+=ja("id",M+"slider_for__"+e,C,f[C],ua,f.style),b&&(d+="</div>"),
a.after(function(){var a;if(a=g.get(M+"slider_for__"+e))f.min!==h&&(f.min=q.num(f.min)),f.max!==h&&(f.max=q.num(f.max)),f.step!==h&&(f.step=q.num(f.step)),f.disabled=!g.editModeOn(),f.value=$(g.get(e)).val(),f.slide=function(a,b){$(g.get(e)).val(b.value)},f.change=function(a,b){g.fieldChange(e)},$(a).slider(f)});return d};f.pickedItemsArray=function(a,e){if(!1===e||null===e||e===h||!(0!==e&&"0"!==e||a.values&&(a.values[0]||a.values["0"])))return{};var d=(e+"").split(","),b={},f,g,y,z,n,r,l;a._display_value=
!1;for(r in d)u(d,r)&&(l=d[r])&&(a.upload&&(n=q._dIIFO(l))&&(n=n.split("/"))&&n[1]?(b[l]=n[1],p(n[2])&&p(n[3])&&(b[l]+=" ["+n[2]+" \u00d7 "+n[3]+"px]")):a.values&&a.values[l]&&"string"==typeof a.values[l]?b[l]=a.values[l]:a.values&&a.values[l]&&a.values[l].label?b[l]=a.values[l].label:((y=a.pick_items&&a.pick_items.target_path)||(y=a.pick_items&&a.pick_items.path))&&(f=F._gIFO(y,l))?(a.values||(a.values={}),g=F._fOIN(f,l),z=f.items&&f.items[l]||{},b[l]=g,a.values[l]={list_image:z.list_image,css_class:z.css_class||
f.item&&f.item.css_class,label:g}):a.upload&&l==1*l&&(n=F._lFD(l))?(this.setFileDetails(a,n),b[l]=a.values[l]):b[l]=l,!1===a._display_value&&(a._display_value=b[l]));return b};f.pickedItemsValue=function(a){var e,d="";if(a)for(e in a)u(a,e)&&(d+=(""===d?"":",")+e);return d};f.hierarchicalBoxes=function(a,e,d,b,f,g,y,q,n,r,l,s,w){var F=1,K=0,L="",t,A,D,I,N=!1;if(!w)w=0,F=1*f.cols||1;else if(10<w)return"";s||(s={});l&&(s[l]=!0);w&&(L+=ja(C,M+"hierarchical_box_children","id","children_for___"+d+"___"+
l,">"));for(var J in n)if(u(n,J)&&(t={},A=n[J],A==1*A&&(A*=1),I=h,D="object"==typeof f.values[A]?f.values[A]:{label:f.values[A]},f.tag_colors&&(t.tag_color=f.tag_colors[A]||"blue"),I=D.parent,"0"===I&&(I=!1),!l&&!I||l==I)){I=b?!0===b||1===b||"1"===b?!0===A||1===A||"1"===A:q?q[A]!==h?!0:!1:A==b:!A;if(!y||I||!f.hide_unselected_values_when_readonly||r[A]){t.checked=I;if(t.newRow=++K>F)K=1;t.col=K;t.cols=F;if("checkboxes"==f.type&&p(f.checking_child_checks_parents)){var B="";l&&(B+="if (this.checked) { for (var cb in "+
JSON.stringify(s)+") { "+this.globalName+".get('"+H(d)+"___' + cb).checked = true; } } ");r[A]&&(B+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");B?g.onchange=f.onchange?B+" "+f.onchange:B:f.onchange?g.onchange=f.onchange:delete g.onchange}else"checkboxes"==f.type&&p(f.checking_parent_checks_children)&&(B="",r[A]&&(B+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),B?g.onchange=f.onchange?
B+" "+f.onchange:B:f.onchange?g.onchange=f.onchange:delete g.onchange);t.lovId=d+"___"+A;t.lovField=D;f.indeterminates&&p(f.indeterminates[A])&&function(b){a.after(function(){var a;if(a=this.get(b))a.indeterminate=!0})}(t.lovId);t.lovHTML=this.drawField(a,e,d,g,h,h,h,h,h,A,I,!1,n,r,D);t.childrenHTML="";r[A]&&(t.childrenHTML=this.hierarchicalBoxes(a,e,d,b,f,g,y,q,n,r,A,_._ex({},s),w+1),K=0);N?(this.splitValues||(this.splitValues={}),this.splitValues[d]||(this.splitValues[d]=""),this.splitValues[d]+=
this.microTemplate(this.mtPrefix+"_radio_or_checkbox",t)):L+=this.microTemplate(this.mtPrefix+"_radio_or_checkbox",t)}I&&D.split_values_if_selected&&!w&&"radios"===f.type&&(N=!0)}w&&(L+="</div>");return L};f.drawPickedItem=function(a,e,d,b){d===h&&(d=this.field(e));var f={},g=d.values&&d.values[a];_._isOb(g)?(f=g,g=g.label):(g||(g=a),f.label=g);var y=a==1*a,z,n;e={id:e,item:a,label:g,readOnly:b,css_class:f.css_class,list_image:f.list_image};d.tag_colors&&(e.tag_color=d.tag_colors[a]||"blue");!d.pick_items||
p(d.pick_items.hide_info_button)||d.upload&&!y||!(z=d.pick_items.path)||z!=d.pick_items.target_path&&d.pick_items.min_path!=d.pick_items.target_path||(z="//"==q._rHSS(z,2)?z+a:"/"==q._rHSS(z,1)?z+("/"+a):z+("//"+a),e.organizerPath=z);d.upload&&(e.isUpload=!0,z=(z=(""+g).match(/(.*?)\.(\w+)$/)||(""+g).match(/(.*?)\.(\w+) \[.*\]$/))&&z[2]?z[2].toLowerCase():"unknown",e.extension=z,y?(n=d.values&&d.values[a]&&d.values[a].file)&&n.checksum?(a=Z+fa+"file.php?c="+U(n.checksum),n.usage&&(a+="&usage="+U(n.usage))):
a=Z+fa+"file.php?id="+a:a=Z+fa+"file.php?getUploadedFileInCacheDir="+U(a),z.match(/gif|jpg|jpeg|png|svg/)?(e.thumbnail={onclick:this.globalName+".showPickedItemInPopout('"+a+"&popout=1&dummy_filename="+U("image."+z)+"', '"+g+"');",src:a+"&og=1"},(g=(""+g).match(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&g[1]&&g[2]&&K._rI(g[1],g[2],180,120,e.thumbnail)):e.adminDownload=a+"&adminDownload=1");return this.microTemplate(this.mtPrefix+"_picked_item",e)};f.showPickedItemInPopout=function(a,e){K._a(this,
{popout:{href:a,title:e,css_class:M+"show_colobox_above_fab"}})};f.pickItems=function(a){var e,d,b,f;(e=this.field(a))&&(d=e.pick_items)&&(d.path||d.target_path)&&(e=f=d.path,aa.map&&(f=aa._cNPTTP(d.path).path),p(d.multiple_select)||d.target_path&&d.target_path!=f||!(b=this.readField(a))||-1!=b.indexOf(",")||(e="//"==q._rHSS(e,2)?e+b:"/"==q._rHSS(e,1)?e+("/"+b):e+("//"+b)),this.SKTarget=a,F._oS(this.globalName,"setPickedItems",d.multiple_select,e,d.target_path,d.min_path,d.max_path,d.disallow_refiners_looping_on_min_path,
h,d.one_to_one_choose_phrase,d.one_to_many_choose_phrase,h,!0,h,h,h,h,h,h,h,h,d))};f.setPickedItems=function(a,e,d,b){a=this.SKTarget;var f,g,h={};for(f in e._items)u(e._items,f)&&(d=q._dIIFO(f),g=b.items&&b.items[d]||{},h[d]={list_image:g.list_image,css_class:g.css_class||b.item&&b.item.css_class,label:F._fOIN(b,d)});this.addToPickedItems(h,a)};f.removeFromPickedItems=function(a,e,d){this.addToPickedItems(a,e,d,!0)};f.addToPickedItems=function(a,e,d,b){d=this.field(e,d);var f=this.readField(e),g=
d.pick_items&&p(d.pick_items.multiple_select)||d.upload&&p(d.upload.multi),h,q;a=K._cTO(a);q=g&&f?this.pickedItemsArray(d,f):{};for(h in a)if(u(a,h))if(f=a[h],d.values||(d.values={}),b)delete d.values[h];else if(d.values[h]||(d.values[h]=f),q[h]=!0,!g)break;this.redrawPickedItems(e,d,q)};f.redrawPickedItems=function(a,e,d){var b,f,g=this.pickedItemsValue(d),h={},p=$(this.get(a)).tokenize(),n=p.toArray();d=K._cTO(d);for(b in n)u(n,b)&&(f=n[b],d[f]?h[f]=!0:p.tokenRemove(f));for(f in d)u(d,f)&&!h[f]&&
(b=e.values&&e.values[f],_._isOb(b)?b=b.label:b||(b=f),p.tokenAdd(f,b));e.current_value=g;this.fieldChange(a)};f.changes=function(a){if(this.tuix&&this.tuix.tab){if(a==h){for(a in this.tuix.tabs)if(u(this.tuix.tabs,a)&&this.changed[a])return!0;return!1}return this.changed[a]}return!1};f.markAsChanged=function(a){this.tuix&&(a===h&&(a=this.tuix.tab),a&&!this.changed[a]&&(this.changed[a]=!0,this.tuix.tab==a&&$(N+"abtab").addClass(M+"abtab_changed")))};f.fieldChange=function(a,e){var d=this,b=this.field(a);
b&&(b.indeterminate&&(b.indeterminate=!1),e!==h&&b.indeterminates&&b.indeterminates[e]&&(b.indeterminates[e]=!1),this.markAsChanged(),p(b.multiple_edit)&&this.meMarkChanged(a),setTimeout(function(){d.validateFormatOrRedrawForField(b)},1))};f.validateFormatOrRedrawForField=function(a,e){"string"==typeof a?(this.fieldThatTriggeredRedraw=a,a=this.field(a)):a.id&&(this.fieldThatTriggeredRedraw=a.id);var d=p(a.validate_onchange),b=p(a.format_onchange)||e&&(a.pressed?a.format_on_toggle_on:a.format_on_toggle_off),
f=p(a.redraw_onchange);if(d)return 3>this.ffoving&&(this.ffoving=3,this.validate()),!0;if(b)return 2>this.ffoving&&(this.ffoving=2,this.format()),!0;f&&1>this.ffoving&&(this.ffoving=1,this.readTab(),this.redrawTab());return f};f.meMarkChanged=function(a,e,d){if(e===h||e!=d)this.field(a).multiple_edit._changed=!0,this.meSetCheckbox(a,!0)};f.meSetCheckbox=function(a,e){"checkbox"==this.get("multiple_edit__"+a).type?this.get("multiple_edit__"+a).checked=e:this.get("multiple_edit__"+a).value=e?1:""};
f.meChange=function(a,e,d){var b=this.field(e);if(a)b.multiple_edit._changed=!0;else{if(!d&&p(b.multiple_edit.warn_when_abandoning_changes)&&b.multiple_edit.original_value!==h&&this.readField(e)!=b.multiple_edit.original_value){a=ha(X,R,C,"submit_selected",I,Q.abandonChanges,la,this.globalName+'.meChange(false, "'+W(e)+'", true);')+ha(X,R,C,ba,I,Q.cancel);F._flBo(Q.abandonChangesConfirm,a,"warning");this.meSetCheckbox(e,!0);return}b.multiple_edit._changed=!1;delete b.current_value;d=b.value;b.multiple_edit.original_value!==
h&&(d=b.current_value=b.multiple_edit.original_value);this.get(e)&&!b.pick_items?"checkbox"==this.get(e).type?this.get(e).checked=d?!0:!1:$(this.get(e)).val(d||""):(b=new q.callback,d=this.drawFields(b),this.insertHTML(d,b))}this.meSetCheckbox(e,a);this.validateFormatOrRedrawForField(e)};f.currentValue=function(a,e,d){return d||e!=this.tuix.tab?this.value(a,e,d):this.readField(a)};f.value=function(a,e,d){e||(e=this.tuix.tab);var b="";a=this.field(a,e);if(!a)return"";d===h&&(d=!this.editModeOn(e)||
a.read_only||a.readonly);a&&!a.snippet&&"grouping"!=a.type&&(this.isButton(a)?b=!!a.pressed:d||a.current_value===h?a.value!==h?b=a.value:a.multiple_edit&&a.multiple_edit.original_value!==h&&(b=a.multiple_edit.original_value):b=a.current_value);return"0"===b?0:b===h||null===b?"":b};f.mode=function(a){return this.value("mode")};f.keyIn=function(a){return _.contains(arguments,this.tuix.key[a],1)};f.keyIs=function(a,e){return this.tuix.key[a]==e};f.key=function(a){return this.tuix.key[a]};f.modeIn=function(){return _.contains(arguments,
this.mode())};f.modeIs=function(a){return this.mode()==a};f.valueIn=function(a){return _.contains(arguments,this.value(a),1)};f.valueIs=function(a,e){return this.value(a)==e};f.valueIsNot=function(a,e){return this.value(a)!=e};f.isButton=function(a){return a&&(a.type==ba||"toggle"==a.type||a.type==R)};f.isFormField=function(a){return!(!a||a.snippet||"grouping"==a.type||a.type==ba||"toggle"==a.type||a.type==R)};f.getCodeEditorPosition=function(a){return{top:a.session.getScrollTop(),left:a.session.getScrollLeft(),
range:a.getSelectionRange()}};f.setCodeEditorPosition=function(a,e){e&&(a.session.setScrollTop(e.top),a.session.setScrollLeft(e.left),a.selection.setSelectionRange(e.range))};f.appendCodeEditorValue=function(a,e){var d=ace.edit(a),b=this.getCodeEditorPosition(d);d.setValue(d.getValue()+e);this.setCodeEditorPosition(d,b)};f.readField=function(a){var e=h,d=this.tuix.tab,b=this.field(a,d),f;if(!this.isFormField(b))return h;var g=!this.editModeOn()||p(b.read_only)||p(b.readonly),y=b._was_hidden_before;
b.multiple_edit&&g&&delete b.multiple_edit._changed;if("checkboxes"==b.type||"radios"==b.type){if(!g&&!y&&b.values){var z,y="",n=!0;for(z in b.values)u(b.values,z)&&this.get(a+"___"+z)&&this.get(a+"___"+z).checked&&(y+=(n?"":",")+z,n=!1);b.current_value=y}y=!0}if(y)return g||b.current_value===h?b.value:b.current_value;if(this.get("_value_for__"+a))b.current_value=e=this.get("_value_for__"+a).value;else if("editor"!=b.type&&"code_editor"!=b.type||g)if(!g&&(f=this.get(a))){if("checkbox"==b.type||"radio"==
b.type)e=f.checked?!0:!1;else if("color_picker"==b.type||"colour_picker"==b.type)try{e=$(f).spectrum("get").toHexString()}catch(r){e=$(f).val()}else e=$(f).val();_._isAr(e)&&(e=e.join(","));b.current_value=e}else delete b.current_value,e=b.value;else if(e=h,"editor"==b.type?ea.tinyMCE&&tinyMCE.get(a)&&(e=q._tMGC(tinyMCE.get(a))):"code_editor"==b.type&&(f=ace.edit(a))&&(e=f.getValue(),this.editingPositions[d+"/"+a]=this.getCodeEditorPosition(f)),e!==h&&!1!==e)e=b.current_value=e;else return b.current_value===
h?b.value:b.current_value;return e};f.blankField=function(a){this.setFieldValue(a,"")};f.setFieldValue=function(a,e){field=this.field(a,this.tuix.tab);this.get(a)&&$(this.get(a)).val(e);this.get("_value_for__"+a)&&(this.get("_value_for__"+a).value=e);field.current_value=e};f.readTab=function(){var a,e={},d=this.fields(),b;this.lastScrollTop=$(N+"fbAdminInner").scrollTop();for(b in d)u(d,b)&&(a=this.readField(b))!==h&&(e[b]=a);S&&S.activeElement&&(this.lastFieldInFocus=S.activeElement.id);return e};
f.wipeTab=function(){var a=this.fields(),e,d;for(e in a)u(a,e)&&(d=a[e],delete d.current_value,d.multiple_edit&&delete d.multiple_edit._changed)};f.redrawTab=function(){this.tuix.shake=!1;this.draw2()};f.getURL=function(a){++this.onKeyUpNum;return this.returnAJAXURL(a)};f.returnAJAXURL=function(a){return"..."};f.editModeOn=function(a){return!0};f.editModeAlwaysOn=function(a){return!0};f.editCancelEnabled=function(a){return!1};f.revertEnabled=function(a){return!1};f.savedAndContinued=function(a){return!1};
f.editModeOnBox=function(){return!0};f.sortTabs=function(){this.sortedTabs=[];if(this.tuix.tabs)for(var a in this.tuix.tabs)if(u(this.tuix.tabs,a)){var e=this.tuix.tabs[a];e&&this.sortedTabs.push([a,e.ord])}this.sortedTabs.sort(K.sortArray);this.groupings={};this.sortedFields={};for(a in this.sortedTabs)u(this.sortedTabs,a)&&(e=this.sortedTabs[a]=this.sortedTabs[a][0],this.sortFields(e))};f.sortFields=function(a){var e,d,b,f,g={};this.groupings[a]={};this.sortedFields[a]=[];if(b=this.fields(a)){for(e in b)u(b,
e)&&(d=b[e],d.type&&"grouping"==d.type&&(g[d.name||e]=1*d.ord,this.groupings[a][d.name||e]=e));for(e in b)u(b,e)&&(!(d=b[e])||d.type&&"grouping"==d.type||(f=d.grouping?g[d.grouping]:h,this.sortedFields[a].push([e,d.ord,f])));this.sortedFields[a].sort(K.sortArrayWithGrouping);for(e in this.sortedFields[a])u(this.sortedFields[a],e)&&(this.sortedFields[a][e]=this.sortedFields[a][e][0])}};f.setData=function(a){this.tuix=a};f.setDataDiff=function(a){this.syncAdminBoxFromServerToClient(a,this.tuix)};f.syncAdminBoxFromServerToClient=
function(a,e){var d,b;for(d in a)u(a,d)&&(b=a[d],null===b||b["[[__unset__]]"]?delete e[d]:e[d]===h||null===e[d]?e[d]=b:b["[[__replace__]]"]?(delete b["[[__replace__]]"],e[d]=b):"object"!=typeof e[d]?e[d]=b:"object"==typeof e[d]&&"object"!=typeof b?e[d]=b:this.syncAdminBoxFromServerToClient(b,e[d]))};f.sendStateToServer=function(){return JSON.stringify(this.tuix)};f.sendStateToServerDiff=function(){var a={};this.syncAdminBoxFromClientToServerR(a,this.tuix);return JSON.stringify(a)};f.syncAdminBoxFromClientToServerR=
function(a,e,d,b,f,g,p,u){if("object"==typeof e){var n,r;for(r in e)if(d===h&&q.IN(r,"download","path","shake","tab","switchToTab")&&(n=I)||d===h&&q.IN(r,"_sync","tabs")&&(n="array")||b===h&&"_sync"==d&&q.IN(r,"cache_dir","password","session","iv")&&(n=I)||b===h&&"tabs"==d&&(n="array")||f===h&&"tabs"==b&&q.IN(r,"edit_mode","fields")&&(n="array")||g===h&&"tabs"==f&&"edit_mode"==d&&"on"==r&&(n=I)||g===h&&"tabs"==f&&"fields"==d&&(n="array")||p===h&&"tabs"==g&&"fields"==b&&q.IN(r,"_display_value","_was_hidden_before",
"current_value","pressed")&&(n=I)||p===h&&"tabs"==g&&"fields"==b&&"multiple_edit"==r&&(n="array")||u===h&&"tabs"==p&&"fields"==f&&"multiple_edit"==d&&"_changed"==r&&(n=I))n==I?"function"!=typeof e[r]&&"object"!=typeof e[r]&&(a[r]=e[r]):"array"==n&&"object"==typeof e[r]&&(a[r]={},this.syncAdminBoxFromClientToServerR(a[r],e[r],r,d,b,f,g,p))}};f.getValueArrayofArrays=function(a){return q._nAA(this.getURL(),q._uR({_read_values:!0,_box:this.sendStateToServer()}),!a)};f.getValues1D=function(a,e,d,b,f){var g,
q,z,n,r,l={};if(this.tuix&&this.tuix.tabs)for(g in this.tuix.tabs)if(u(this.tuix.tabs,g)&&(q=this.tuix.tabs[g],q.fields))for(z in q.fields)u(q.fields,z)&&(n=q.fields[z],r=z,this.isFormField(n)&&!(b&&(!this.editModeOn(g)||p(n.read_only)||p(n.readonly))||f&&(n._was_hidden_before||p(n.read_only)||p(n.readonly))||a&&!(r=n.plugin_setting&&n.plugin_setting.name))&&(n=this.currentValue(z,g,d),e||(l[r]=n),e||e===h))&&(l[g+"/"+z]=n);return l};f.insertText=function(a,e){_._iS(a)&&(a=this.get(a));if(a){var d=
$(a),b=a.selectionStart,f=a.selectionEnd,g=d.val();d.val(g.substring(0,b)+e+g.substring(f));a.selectionStart=a.selectionEnd=b+e.length;a.focus()}};f.callFunctionOnEditors=function(a){var e,d,b;if(ea.tinyMCE&&(e=this.fields()))for(d in e)if(u(e,d)&&(b=e[d],"editor"==b.type&&tinyMCE.get(d)))if("remove"==a)tinyMCE.get(d).remove();else if("isDirty"==a&&tinyMCE.get(d).isDirty())return!0;return!1};f.format=function(a){var e;if(this.loaded&&(e=this.getURL("format"))){var d=this,b=this.tuix&&this.tuix.tab;
this.loaded=!1;this.hideTab();this.checkValues(a);this.retryAJAX(e,{_format:!0,_box:this.sendStateToServer()},!0,function(a){d.load(a);d.switchTabIfRequested(b);d.sortTabs();d.draw()},"loading")}};f.validate=function(a,e,d,b){var f;if(this.loaded&&(f=this.getURL("validate"))){this.differentTab=a;this.loaded=!1;this.hideTab(a);this.checkValues(d);var g=this,h=this.tuix&&this.tuix.tab;a&&(g.tuix.switchToTab=e);this.retryAJAX(f,{_validate:!0,_box:this.sendStateToServer()},!0,function(a){g.load(a)&&g.switchTabIfRequested(h);
g.sortTabs();g.switchToATabWithErrors();g.draw();b&&b()},"loading")}};f.switchTabIfRequested=function(a){this.tuix.switchToTab&&(a=a||this.tuix&&this.tuix.tab,this.errorOnTab(a)?this.tuix.tab=a:this.tuix.tab=this.tuix.switchToTab,delete this.tuix.switchToTab)}})},zenarioF);
