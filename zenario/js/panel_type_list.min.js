zenario.lib(function(s,v,d,w,A,B,x,t,C,D,b,l,y,E,F,G,H,z,u,r,m){d=u(m.list=z(m.grid));d.showPanel=function(a,b,c){this.setHeader(a);this.showViewOptions(a);this.drawItems(b);this.setupListViewColumns(b);this.setScroll(b);this.setTooltips(a,b,c);this.setupReordering(b)};d.returnPageSize=function(){return this.ordinalColumn()?!1:u(m.grid).returnPageSize.call(this)};d.drawItems=function(a){this.items=this.getMergeFieldsForItemsAndColumns();a.html(t.microTemplate("zenario_organizer_list",this.items));
a.show()};d.drawPagination=function(a){this.ordinalColumn()?a.html(t.microTemplate("zenario_organizer_pagination",this.items)).show():u(m.grid).drawPagination.apply(this,arguments)};d.returnInspectionViewEnabled=function(){return!!this.tuix.slidedown_view_microtemplate};d.openInspectionView=function(a){var g=b.inspectionViewItemId();g&&this.closeInspectionView(g);b.selectItems(a);b.setButtons();var g=$(l("organizer_slidedown_view_toggle_"+a)),c=$(l("organizer_slidedown_"+a));c.is(":visible")||(g.removeClass("organizer_slidedown_view_toggle_closed").addClass("organizer_slidedown_view_toggle_open"),
c.clearQueue().removeClass("organizer_slidedown_view_closed").addClass("organizer_slidedown_view_open").html(t.microTemplate(b.tuix.slidedown_view_microtemplate,{id:a})).slideDown());b.inInspectionView(a)};d.closeInspectionView=function(a){a===s&&(a=b.inspectionViewItemId());if(a){var g=$(l("organizer_slidedown_view_toggle_"+a)),c=$(l("organizer_slidedown_"+a));c.is(":visible")&&(g.removeClass("organizer_slidedown_view_toggle_open").addClass("organizer_slidedown_view_toggle_closed"),c.clearQueue().slideUp(400,
function(){c.removeClass("organizer_slidedown_view_open").addClass("organizer_slidedown_view_closed").html("")}));b.inInspectionView(!1)}};d.addExtraMergeFieldsForColumns=function(a,g){var c=g.id,d=b.prefs[this.path]||{};(c=d.colSizes&&d.colSizes[c]?Math.max(d.colSizes[c],b.columnWidths.xxsmall):this.tuix.columns[c].width)&&b.columnWidths[c]?c=b.columnWidths[c]:(c*=1)||(c=b.defaultColumnWidth);a.totalWidth&&(a.totalWidth+=b.columnSpacing);a.totalWidth+=c+b.columnPadding;g.width=c};d.addExtraMergeFieldsForCells=
function(a,b,c,d){d.width=b.width};d.addExtraMergeFields=function(a){y(this.tuix.use_tall_rows)&&(a.useTallRows=!0)};d.setupListViewColumns=function(a){var d=a.find(".organizer_header");d.length&&a.scroll(function(){d.css("top",a.scrollTop())});var c=this,l=a.find(".organizer_sort_and_resize_wrapper"),m=a.find(".organizer_sort_and_resize_wrapper .organizer_sortable"),e=a.find(".organizer_sort_and_resize_wrapper .organizer_resizable"),f={},n={},h=function(){var a,b=$("#organizer_non_sortable_resizeable_cols").width();
e.each(function(c,d){if(a=$(d).outerWidth())b+=a});$("#organizer_list_view").css("min-width",b+"px");$("#organizer_list_view .organizer_row").css("min-width",b+"px")},p=function(b,d){c.saveScrollPosition(a);m.each(function(a,b){var c=b.id;if(c){f[c]||(f[c]=$("."+c+"__cell"));var d=1*$(b).position().left-n[c];f[c].css("left",d+"px")}});c.restoreScrollPosition(a)},q=function(d,e,g){c.saveScrollPosition(a);if(d=$(e.element).attr("id"))f[d]||(f[d]=$("."+d+"__cell")),g?b.resizeColumn(d.replace("organizer_column__",
""),e.element.width()):(l.css("width","auto"),f[d].width(e.element.width()),h());c.restoreScrollPosition(a)};e.resizable({handles:"e",minWidth:b.columnWidths.xxsmall,start:function(a,c){b.resizingColumn=!0},resize:q,stop:function(a,c){q(a,c,!0);setTimeout(function(){delete b.resizingColumn},50)}});l.sortable({containment:"parent",items:".organizer_sortable",start:function(a,c){b.sortingColumn=!0},sort:p,stop:function(d,e){c.saveScrollPosition(a);p(d,e);setTimeout(function(){delete b.sortingColumn},
50);var f=l.sortable("toArray"),g;for(g in f)r(f,g)&&(f[g]=f[g].replace("organizer_column__",""));b.switchColumnOrder(f);c.restoreScrollPosition(a)}});h();m.each(function(a,b){b.id&&(n[b.id]=1*$(b).position().left)})};d.setupReordering=function(a){var d=this,c=d.ordinalColumn();c&&this.searchTerm===s&&a.find("#organizer_items_wrapper").sortable({opacity:0.8,cancel:".organizer_slidedown_view,input,textarea,button,select,option",start:function(){d.closeInspectionView();b.disableInteraction()},stop:function(l,
m){b.enableInteraction();var e,f,n="",h={},p=[],q=[],k=a.find("#organizer_items_wrapper").sortable("toArray",{attribute:"data-id"});for(e=k.length;0<=e;--e)""!==k[e]&&k[e]!==s||k.splice(e,1);for(f in k)r(k,f)&&(e=k[f],h[e]=!0);for(f in b.searchedItems)r(b.searchedItems,f)&&(e=b.searchedItems[f],h[e]&&(q.push(e),p.push(d.tuix.items[e][c])));h=b.getKey();h.ordinals={};for(f in k)r(k,f)&&(e=k[f],e!=q[f]&&(n+=(n?",":"")+e,h.ordinals[e]=p[f]));h.reorder=!0;h.id=n;h.dropped_item=$(m.item).data("id");e=
"zenario/ajax.php?__pluginClassName__="+d.tuix.reorder.class_name+"&__path__="+b.path+"&method_call=handleOrganizerPanelAJAX";delete x.rev;$.post(v+e,h,function(){b.reload()})}})};d.ordinalColumn=function(){return!w.zenarioOSelectMode&&this.tuix.reorder&&this.tuix.reorder.column}},zenarioO.panelTypes);
