zenario.lib(function(r,n,m,u,w,x,h,d,y,a,z,v,p,A,s,t,B,C,D){d.toolbar="preview";a.runOnInit=[];a.init=function(b){b&&a.loadedBefore||(a.loadedBefore=!0,a.loaded=!1,b=n+"zenario/admin/ajax.php?_at=1&_json=1&get="+encodeURIComponent(JSON.stringify(d.importantGetRequests))+h.urlRequest(a.getKey()),a.url=b,h.ajax(b,!1,!0,!0,!0,7500).after(a.init2))};a.init2=function(b){a.tuix=b;a.sort();a.draw();a.loaded=!0;for(var g in a.runOnInit)if(h.has(a.runOnInit,g))a.runOnInit[g]();a.runOnInit=[]};$(m).ready(function(){a.init(!0)});
a.clickTab=function(b){if(d.checkForEdits()&&a.tuix&&a.tuix.toolbars&&a.tuix.toolbars[b]){d.closeSlotControls();d.cancelMovePlugin();a.action(a.tuix.toolbars[b]);var g=s(a.tuix.toolbars[d.toolbar]?a.tuix.toolbars[d.toolbar].page_mode:!1,d.toolbar),f=s(a.tuix.toolbars[b].page_mode,b),c=b.substr(0,4);$("body").removeClass("zenario_pageMode_"+g).addClass("zenario_pageMode_"+f);"menu"==c&&d.menuWandOn?$("body").addClass("zenario_menuWand_on").removeClass("zenario_menuWand_off"):$("body").addClass("zenario_menuWand_off").removeClass("zenario_menuWand_on");
"edit"!=c&&"temp"!=c||!d.slotWandOn?$("body").addClass("zenario_slotWand_off").removeClass("zenario_slotWand_on"):$("body").addClass("zenario_slotWand_on").removeClass("zenario_slotWand_off");"edit"!=c&&"temp"!=c||!d.showGridOn?a.showGridOnOff(!1):a.showGridOnOff(!0);d.toolbar=b;d.pageMode=f;d.savePageMode(!0);a.draw()}};a.gridOverlayDiv=null;a.showGridOnOff=function(b){if(b){if(!a.gridOverlayDiv){var g=!1;$(".container").each(function(a,b){g=b});if(g){b=g.className;for(var f=b.match(/container_(\d+)/),
f=f?f[1]:0,c=m.getElementById("zenario_citem"),e=c.firstElementChild,d=(e=e?e.firstElementChild:!1)&&"row"==e.className?!0:!1,e=d?'<div class="row">':"",h=1;h<=f;++h)e+='<div class="span span1 span1_'+f,1==h?e+=" alpha":h==f&&(e+=" omega"),e+=' slot"></div>';e+=d?"</div>":"";f=m.createElement("div");f.innerHTML=e;f.style.position="relative";f.className="zenario_grid_overlay_view "+b;f.style.top="-"+c.offsetHeight+"px";f.style.height=c.offsetHeight+"px";c.style.position="relative";c.appendChild(f);
c.offsetHeight=f.offsetHeight+"px";a.gridOverlayDiv=f}}}else a.gridOverlayDiv&&(a.gridOverlayDiv.remove(),delete a.gridOverlayDiv)};a.clickButton=function(b,g){d.checkForEdits()&&a.action(a.tuix.sections[b].buttons[g])};a.action=function(b){d.closeSlotControls();d.cancelMovePlugin();if(!d.checkActionUnique(b))return!1;if(b.organizer_quick){var g="",f={},c=!1;b.organizer_quick.reload_slot&&h.slots[b.organizer_quick.reload_slot]&&h.slots[b.organizer_quick.reload_slot].instanceId&&(c=b.organizer_quick.reload_slot,
g+=h.slots[b.organizer_quick.reload_slot].instanceId,f[h.slots[b.organizer_quick.reload_slot].instanceId]=!0);p(b.organizer_quick.reload_menu_slots)&&$(".zenario_slotShownInMenuMode .zenario_slot").each(function(a,b){if(b.id&&"plgslt_"==b.id.substr(0,7)){var d=b.id.substr(7);h.slots[d]&&h.slots[d].instanceId&&!f[h.slots[d].instanceId]&&(c?g+=",":c=d,g+=h.slots[d].instanceId,f[h.slots[d].instanceId]=!0)}});d.organizerQuick(b.organizer_quick.path,b.organizer_quick.target_path,b.organizer_quick.min_path,
b.organizer_quick.max_path,p(b.organizer_quick.disallow_refiners_looping_on_min_path),c,g,p(b.organizer_quick.reload_admin_toolbar)?"zenarioAT":!1)}else d.action(a,b)};a.getKey=function(a){return{id:h.cType+"_"+h.cID,cID:h.cID,cType:h.cType,cVersion:h.cVersion}};a.getKeyId=function(a){return h.cType+"_"+h.cID};a.getLastKeyId=function(b){return a.getKeyId(b)};a.applyMergeFields=function(a,d,f,c){return a};a.applyMergeFieldsToLabel=function(a,d,f,c){return a};a.pickItems=function(b,g,f){b={};for(var c in g)h.has(g,
c)&&("id"==c?b[c]=g[c]:"parent__"!=c.substr(0,8)&&(b["child__"+c]=g[c]));if(a.postPickItemsObject)d.action(a,a.postPickItemsObject,!0,r,r,b);else if(a.actionTarget){for(var e in b)h.has(b,e)&&(a.actionRequests[e]=b[e]);a.action2()}a.postPickItemsObject=!1};a.goNum=0;a.action2=function(){if(a.actionTarget){var b=++a.goNum;d.nowDoingSomething("saving");h.ajax(n+a.actionTarget,a.actionRequests,!1,!1,!0).after(function(g){b==a.goNum&&(d.nowDoingSomething(!1),g?d.showMessage(g):h.goToURL(h.linkToItem(h.cID,
h.cType,d.importantGetRequests)))})}a.actionTarget=!1;delete a.actionRequests};a.uploadComplete=function(){};a.draw=function(){var b={tabs:[],sections:{}},g=-1,f;for(f in a.sortedToolbars)if(h.has(a.sortedToolbars,f)){var c=a.sortedToolbars[f],e=a.tuix.toolbars[c];d.hidden(e,!0)||(b.tabs[++g]={id:c,css_class:e.css_class,label:e.label,tooltip:e.tooltip,toolbar_microtemplate:e.toolbar_microtemplate,selected:c==d.toolbar},c==d.toolbar&&(b.toolbar_microtemplate=e.toolbar_microtemplate))}for(var l in a.tuix.sections)if(h.has(a.tuix.sections,
l)&&(g=a.tuix.sections[l])){var c=-1,e=[],q={},m;if(!d.hidden(g)&&a.sortedButtons[l]){for(var n in a.sortedButtons[l])if(h.has(a.sortedButtons[l],n)){f=a.sortedButtons[l][n];var k=g.buttons[f];d.hidden(k,!0)||k.appears_in_toolbars&&!p(k.appears_in_toolbars[d.toolbar])||(e[++c]={id:f,css_class:s(k.css_class,"label_without_icon"),label:s(k.label,k.name),parent:k.parent},q[f]=c,e[c].tooltip=k.tooltip,k.navigation_path?e[c].href=h.addBasePath(u.zenarioATLinks.organizer+"#"+k.navigation_path):k.frontend_link&&
(e[c].href=h.addBasePath(k.frontend_link)),e[c].href||(e[c].onclick="zenarioAT.clickButton('"+t(l)+"', '"+t(f)+"'); return false;"))}for(f in q)h.has(q,f)&&(m=g.buttons[f].parent)&&(c=q[m])!==r&&(e[c].children||(e[c].children=[],e[c].css_class+=" zenario_at_button_with_children"),e[c].children[e[c].children.length]=e[q[f]]);for(c=e.length-1;0<=c;--c)k=g.buttons[e[c].id],(k.parent||p(k.hide_when_children_are_not_visible)&&!e[c].children)&&e.splice(c,1)}b.sections[l]=e}v("zenario_at_wrap").innerHTML=
d.microTemplate("zenario_toolbar",b);d.tooltips("#zenario_at_wrap a[title]");d.tooltips("#zenario_at_wrap div[title]");d.tooltips("#zenario_at_wrap ul ul a[title]",{position:{my:"left+2 center",at:"right center",collision:"flipfit"}});d.setTooltipIfTooLarge("#zenario_at_lower_section .zenario_at_infobar",r,d.tooltipLengthThresholds.adminToolbarTitle)};a.sort=function(){a.sortedToolbars=[];if(a.tuix.toolbars)for(var b in a.tuix.toolbars)if(h.has(a.tuix.toolbars,b)){var g=a.tuix.toolbars[b];g&&a.sortedToolbars.push([b,
g.ord])}a.sortedToolbars.sort(d.sortArray);for(b in a.sortedToolbars)h.has(a.sortedToolbars,b)&&(a.sortedToolbars[b]=a.sortedToolbars[b][0]);a.sortedButtons={};for(var f in a.tuix.sections)h.has(a.tuix.sections,f)&&a.tuix.sections[f]&&a.sortButtons(f)};a.sortButtons=function(b){a.sortedButtons[b]=[];if(a.tuix.sections[b].buttons)for(var g in a.tuix.sections[b].buttons)if(h.has(a.tuix.sections[b].buttons,g)){var f=a.tuix.sections[b].buttons[g];f&&a.sortedButtons[b].push([g,f.ord])}a.sortedButtons[b].sort(d.sortArray);
for(g in a.sortedButtons[b])h.has(a.sortedButtons[b],g)&&(a.sortedButtons[b][g]=a.sortedButtons[b][g][0])}});
