zenario.lib(function(r,n,m,u,w,x,h,d,y,a,z,v,p,A,s,t,B,C,D){d.toolbar="preview";a.runOnInit=[];a.init=function(b){if(!b||!a.loadedBefore){a.loadedBefore=!0;a.loaded=!1;var f=n+"zenario/admin/ajax.php?_at=1&_json=1&get="+encodeURIComponent(JSON.stringify(d.importantGetRequests));a.url=f+h.urlRequest(a.getKey());(a.tuix=h.checkSessionStorage(f,a.getKey(),!0))?(a.focus=a.tuix,a.init2()):d.keepTrying(function(b){$.get(a.url,function(c){d.stopTrying(b)&&(a.tuix=d.readData(c,f,a.getKey()))&&(a.focus=a.tuix,
a.init2())},"text")})}};a.init2=function(){a.sort();a.draw();a.loaded=!0;for(var b in a.runOnInit)if(h.has(a.runOnInit,b))a.runOnInit[b]();a.runOnInit=[]};$(m).ready(function(){a.init(!0)});a.clickTab=function(b){if(d.checkForEdits()&&a.tuix&&a.tuix.toolbars&&a.tuix.toolbars[b]){d.closeSlotControls();d.cancelMovePlugin();a.action(a.tuix.toolbars[b]);var f=s(a.tuix.toolbars[d.toolbar]?a.tuix.toolbars[d.toolbar].page_mode:!1,d.toolbar),g=s(a.tuix.toolbars[b].page_mode,b),c=b.substr(0,4);$("body").removeClass("zenario_pageMode_"+
f).addClass("zenario_pageMode_"+g);"menu"==c&&d.menuWandOn?$("body").addClass("zenario_menuWand_on").removeClass("zenario_menuWand_off"):$("body").addClass("zenario_menuWand_off").removeClass("zenario_menuWand_on");"edit"!=c&&"temp"!=c||!d.slotWandOn?$("body").addClass("zenario_slotWand_off").removeClass("zenario_slotWand_on"):$("body").addClass("zenario_slotWand_on").removeClass("zenario_slotWand_off");"edit"!=c&&"temp"!=c||!d.showGridOn?a.showGridOnOff(!1):a.showGridOnOff(!0);d.toolbar=b;d.pageMode=
g;d.savePageMode(!0);a.draw()}};a.gridOverlayDiv=null;a.showGridOnOff=function(b){if(b){if(!a.gridOverlayDiv){var f=!1;$(".container").each(function(a,b){f=b});if(f){b=f.className;for(var g=b.match(/container_(\d+)/),g=g?g[1]:0,c=m.getElementById("zenario_citem"),e=c.firstElementChild,d=(e=e?e.firstElementChild:!1)&&"row"==e.className?!0:!1,e=d?'<div class="row">':"",h=1;h<=g;++h)e+='<div class="span span1 span1_'+g,1==h?e+=" alpha":h==g&&(e+=" omega"),e+=' slot"></div>';e+=d?"</div>":"";g=m.createElement("div");
g.innerHTML=e;g.style.position="relative";g.className="zenario_grid_overlay_view "+b;g.style.top="-"+c.offsetHeight+"px";g.style.height=c.offsetHeight+"px";c.style.position="relative";c.appendChild(g);c.offsetHeight=g.offsetHeight+"px";a.gridOverlayDiv=g}}}else a.gridOverlayDiv&&(a.gridOverlayDiv.remove(),delete a.gridOverlayDiv)};a.clickButton=function(b,f){d.checkForEdits()&&a.action(a.tuix.sections[b].buttons[f])};a.action=function(b){d.closeSlotControls();d.cancelMovePlugin();if(!d.checkActionUnique(b))return!1;
if(b.organizer_quick){var f="",g={},c=!1;b.organizer_quick.reload_slot&&h.slots[b.organizer_quick.reload_slot]&&h.slots[b.organizer_quick.reload_slot].instanceId&&(c=b.organizer_quick.reload_slot,f+=h.slots[b.organizer_quick.reload_slot].instanceId,g[h.slots[b.organizer_quick.reload_slot].instanceId]=!0);p(b.organizer_quick.reload_menu_slots)&&$(".zenario_slotShownInMenuMode .zenario_slot").each(function(a,b){if(b.id&&"plgslt_"==b.id.substr(0,7)){var d=b.id.substr(7);h.slots[d]&&h.slots[d].instanceId&&
!g[h.slots[d].instanceId]&&(c?f+=",":c=d,f+=h.slots[d].instanceId,g[h.slots[d].instanceId]=!0)}});d.organizerQuick(b.organizer_quick.path,b.organizer_quick.target_path,b.organizer_quick.min_path,b.organizer_quick.max_path,p(b.organizer_quick.disallow_refiners_looping_on_min_path),c,f,p(b.organizer_quick.reload_admin_toolbar)?"zenarioAT":!1)}else d.action(a,b)};a.getKey=function(a){return{id:h.cType+"_"+h.cID,cID:h.cID,cType:h.cType,cVersion:h.cVersion}};a.getKeyId=function(a){return h.cType+"_"+h.cID};
a.getLastKeyId=function(b){return a.getKeyId(b)};a.applyMergeFields=function(a,d,g,c){return a};a.pickItems=function(b,f,g){b={};for(var c in f)h.has(f,c)&&("id"==c?b[c]=f[c]:"parent__"!=c.substr(0,8)&&(b["child__"+c]=f[c]));if(a.postPickItemsObject)d.action(a,a.postPickItemsObject,!0,r,r,b);else if(a.actionTarget){for(var e in b)h.has(b,e)&&(a.actionRequests[e]=b[e]);a.action2()}a.postPickItemsObject=!1};a.goNum=0;a.action2=function(){if(a.actionTarget){var b=++a.goNum;d.nowDoingSomething("saving");
$.post(n+a.actionTarget,a.actionRequests,function(f){b==a.goNum&&(d.nowDoingSomething(!1),f?d.showMessage(f):h.goToURL(h.linkToItem(h.cID,h.cType,d.importantGetRequests)))},"text")}a.actionTarget=!1;delete a.actionRequests};a.uploadComplete=function(){};a.draw=function(){var b={tabs:[],sections:{}},f=-1,g;for(g in a.sortedToolbars)if(h.has(a.sortedToolbars,g)){var c=a.sortedToolbars[g],e=a.tuix.toolbars[c];d.hidden(e,!0)||(b.tabs[++f]={id:c,css_class:e.css_class,label:e.label,tooltip:e.tooltip,toolbar_microtemplate:e.toolbar_microtemplate,
selected:c==d.toolbar},c==d.toolbar&&(b.toolbar_microtemplate=e.toolbar_microtemplate))}for(var l in a.tuix.sections)if(h.has(a.tuix.sections,l)&&(f=a.tuix.sections[l])){var c=-1,e=[],q={},m;if(!d.hidden(f)&&a.sortedButtons[l]){for(var n in a.sortedButtons[l])if(h.has(a.sortedButtons[l],n)){g=a.sortedButtons[l][n];var k=f.buttons[g];d.hidden(k,!0)||k.appears_in_toolbars&&!p(k.appears_in_toolbars[d.toolbar])||(e[++c]={id:g,css_class:s(k.css_class,"label_without_icon"),label:s(k.label,k.name),parent:k.parent},
q[g]=c,e[c].tooltip=k.tooltip,k.navigation_path?e[c].href=h.addBasePath(u.zenarioATLinks.organizer+"#"+k.navigation_path):k.frontend_link&&(e[c].href=h.addBasePath(k.frontend_link)),e[c].href||(e[c].onclick="zenarioAT.clickButton('"+t(l)+"', '"+t(g)+"'); return false;"))}for(g in q)h.has(q,g)&&(m=f.buttons[g].parent)&&(c=q[m])!==r&&(e[c].children||(e[c].children=[],e[c].css_class+=" zenario_at_button_with_children"),e[c].children[e[c].children.length]=e[q[g]]);for(c=e.length-1;0<=c;--c)k=f.buttons[e[c].id],
(k.parent||p(k.hide_when_children_are_not_visible)&&!e[c].children)&&e.splice(c,1)}b.sections[l]=e}v("zenario_at_wrap").innerHTML=d.microTemplate("zenario_toolbar",b);d.tooltips("#zenario_at_wrap a[title]");d.tooltips("#zenario_at_wrap div[title]");d.tooltips("#zenario_at_wrap ul ul a[title]",{position:{my:"left+2 center",at:"right center",collision:"flipfit"}});d.setTooltipIfTooLarge("#zenario_at_lower_section .zenario_at_infobar",r,d.tooltipLengthThresholds.adminToolbarTitle)};a.sort=function(){a.sortedToolbars=
[];if(a.tuix.toolbars)for(var b in a.tuix.toolbars)if(h.has(a.tuix.toolbars,b)){var f=a.tuix.toolbars[b];f&&a.sortedToolbars.push([b,f.ord])}a.sortedToolbars.sort(d.sortArray);for(b in a.sortedToolbars)h.has(a.sortedToolbars,b)&&(a.sortedToolbars[b]=a.sortedToolbars[b][0]);a.sortedButtons={};for(var g in a.tuix.sections)h.has(a.tuix.sections,g)&&a.tuix.sections[g]&&a.sortButtons(g)};a.sortButtons=function(b){a.sortedButtons[b]=[];if(a.tuix.sections[b].buttons)for(var f in a.tuix.sections[b].buttons)if(h.has(a.tuix.sections[b].buttons,
f)){var g=a.tuix.sections[b].buttons[f];g&&a.sortedButtons[b].push([f,g.ord])}a.sortedButtons[b].sort(d.sortArray);for(f in a.sortedButtons[b])h.has(a.sortedButtons[b],f)&&(a.sortedButtons[b][f]=a.sortedButtons[b][f][0])}});
