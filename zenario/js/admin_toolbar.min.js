zenario.lib(function(r,n,m,v,w,x,h,d,y,a,z,u,p,A,s,t,B,C,D){d.toolbar="preview";a.runOnInit=[];a.init=function(b){if(!b||!a.loadedBefore){a.loadedBefore=!0;a.loaded=!1;var e=n+"zenario/admin/ajax.php?_at=1&_json=1";a.url=e+h.urlRequest(a.getKey());(a.tuix=h.checkSessionStorage(e,a.getKey(),!0))?(a.focus=a.tuix,a.init2()):d.keepTrying(function(b){$.get(a.url,function(c){d.stopTrying(b)&&(a.tuix=d.readData(c,e,a.getKey()))&&(a.focus=a.tuix,a.init2())},"text")})}};a.init2=function(){a.sort();a.draw();
a.loaded=!0;for(var b in a.runOnInit)if(h.has(a.runOnInit,b))a.runOnInit[b]();a.runOnInit=[]};$(m).ready(function(){a.init(!0)});a.clickTab=function(b){if(d.checkForEdits()&&a.tuix&&a.tuix.toolbars&&a.tuix.toolbars[b]){d.closeSlotControls();d.cancelMovePlugin();a.action(a.tuix.toolbars[b]);var e=s(a.tuix.toolbars[d.toolbar]?a.tuix.toolbars[d.toolbar].page_mode:!1,d.toolbar),g=s(a.tuix.toolbars[b].page_mode,b),c=b.substr(0,4);$("body").removeClass("zenario_pageMode_"+e).addClass("zenario_pageMode_"+
g);"menu"==c&&d.menuWandOn?$("body").addClass("zenario_menuWand_on").removeClass("zenario_menuWand_off"):$("body").addClass("zenario_menuWand_off").removeClass("zenario_menuWand_on");"edit"!=c&&"temp"!=c||!d.slotWandOn?$("body").addClass("zenario_slotWand_off").removeClass("zenario_slotWand_on"):$("body").addClass("zenario_slotWand_on").removeClass("zenario_slotWand_off");"edit"!=c&&"temp"!=c||!d.showGridOn?a.showGridOnOff(!1):a.showGridOnOff(!0);d.toolbar=b;d.pageMode=g;d.savePageMode(!0);a.draw()}};
a.gridOverlayDiv=null;a.showGridOnOff=function(b){if(b){if(!a.gridOverlayDiv){var e=!1;$(".container").each(function(a,b){e=b});if(e){b=e.className;for(var g=b.match(/container_(\d+)/),g=g?g[1]:0,c=m.getElementById("zenario_citem"),f=c.firstElementChild,d=(f=f?f.firstElementChild:!1)&&"row"==f.className?!0:!1,f=d?'<div class="row">':"",h=1;h<=g;++h)f+='<div class="span span1 span1_'+g,1==h?f+=" alpha":h==g&&(f+=" omega"),f+=' slot"></div>';f+=d?"</div>":"";g=m.createElement("div");g.innerHTML=f;g.style.position=
"relative";g.className="zenario_grid_overlay_view "+b;g.style.top="-"+c.offsetHeight+"px";g.style.height=c.offsetHeight+"px";c.style.position="relative";c.appendChild(g);c.offsetHeight=g.offsetHeight+"px";a.gridOverlayDiv=g}}}else a.gridOverlayDiv&&(a.gridOverlayDiv.remove(),delete a.gridOverlayDiv)};a.clickButton=function(b,e){d.checkForEdits()&&a.action(a.tuix.sections[b].buttons[e])};a.action=function(b){d.closeSlotControls();d.cancelMovePlugin();if(!d.checkActionUnique(b))return!1;if(b.organizer_quick){var e=
"",g={},c=!1;b.organizer_quick.reload_slot&&h.slots[b.organizer_quick.reload_slot]&&h.slots[b.organizer_quick.reload_slot].instanceId&&(c=b.organizer_quick.reload_slot,e+=h.slots[b.organizer_quick.reload_slot].instanceId,g[h.slots[b.organizer_quick.reload_slot].instanceId]=!0);p(b.organizer_quick.reload_menu_slots)&&$(".zenario_slotShownInMenuMode .zenario_slot").each(function(a,b){if(b.id&&"plgslt_"==b.id.substr(0,7)){var d=b.id.substr(7);h.slots[d]&&h.slots[d].instanceId&&!g[h.slots[d].instanceId]&&
(c?e+=",":c=d,e+=h.slots[d].instanceId,g[h.slots[d].instanceId]=!0)}});d.organizerQuick(b.organizer_quick.path,b.organizer_quick.target_path,b.organizer_quick.min_path,b.organizer_quick.max_path,p(b.organizer_quick.disallow_refiners_looping_on_min_path),c,e,p(b.organizer_quick.reload_admin_toolbar)?"zenarioAT":!1)}else d.action(a,b)};a.getKey=function(a){return{id:h.cType+"_"+h.cID,cID:h.cID,cType:h.cType,cVersion:h.cVersion}};a.getKeyId=function(a){return h.cType+"_"+h.cID};a.getLastKeyId=function(b){return a.getKeyId(b)};
a.applyMergeFields=function(a,d,g,c){return a};a.pickItems=function(b,e,g){b={};for(var c in e)h.has(e,c)&&("id"==c?b[c]=e[c]:"parent__"!=c.substr(0,8)&&(b["child__"+c]=e[c]));if(a.postPickItemsObject)d.action(a,a.postPickItemsObject,!0,r,r,b);else if(a.actionTarget){for(var f in b)h.has(b,f)&&(a.actionRequests[f]=b[f]);a.action2()}a.postPickItemsObject=!1};a.goNum=0;a.action2=function(){if(a.actionTarget){var b=++a.goNum;d.nowDoingSomething("saving");$.post(n+a.actionTarget,a.actionRequests,function(e){b==
a.goNum&&(d.nowDoingSomething(!1),e?d.showMessage(e):h.goToURL(h.linkToItem(h.cID,h.cType,d.importantGetRequests)))},"text")}a.actionTarget=!1;delete a.actionRequests};a.uploadComplete=function(){};a.draw=function(){var b={tabs:[],sections:{}},e=-1,g;for(g in a.sortedToolbars)if(h.has(a.sortedToolbars,g)){var c=a.sortedToolbars[g],f=a.tuix.toolbars[c];d.hidden(f,!0)||(b.tabs[++e]={id:c,css_class:f.css_class,label:f.label,tooltip:f.tooltip,toolbar_microtemplate:f.toolbar_microtemplate,selected:c==
d.toolbar},c==d.toolbar&&(b.toolbar_microtemplate=f.toolbar_microtemplate))}for(var l in a.tuix.sections)if(h.has(a.tuix.sections,l)&&(e=a.tuix.sections[l])){var c=-1,f=[],q={},m;if(!d.hidden(e)&&a.sortedButtons[l]){for(var n in a.sortedButtons[l])if(h.has(a.sortedButtons[l],n)){g=a.sortedButtons[l][n];var k=e.buttons[g];d.hidden(k,!0)||k.appears_in_toolbars&&!p(k.appears_in_toolbars[d.toolbar])||(f[++c]={id:g,css_class:s(k.css_class,"label_without_icon"),label:s(k.label,k.name),parent:k.parent},
q[g]=c,f[c].tooltip=k.tooltip,!k.navigation_path&&k.frontend_link&&(f[c].href=h.addBasePath(k.frontend_link)),f[c].href&&k.navigation_path||(f[c].onclick="zenarioAT.clickButton('"+t(l)+"', '"+t(g)+"'); return false;"))}for(g in q)h.has(q,g)&&(m=e.buttons[g].parent)&&(c=q[m])!==r&&(f[c].children||(f[c].children=[],f[c].css_class+=" zenario_at_button_with_children"),f[c].children[f[c].children.length]=f[q[g]]);for(c=f.length-1;0<=c;--c)k=e.buttons[f[c].id],(k.parent||p(k.hide_when_children_are_not_visible)&&
!f[c].children)&&f.splice(c,1)}b.sections[l]=f}u("zenario_at").innerHTML=d.microTemplate("zenario_toolbar",b);d.tooltips("#zenario_at a[title]");d.tooltips("#zenario_at div[title]");d.tooltips("#zenario_at ul ul a[title]",{position:{my:"left+2 center",at:"right center",collision:"flipfit"}});d.setTooltipIfTooLarge("#zenario_at_lower_section .zenario_at_infobar",r,d.tooltipLengthThresholds.adminToolbarTitle)};a.sort=function(){a.sortedToolbars=[];if(a.tuix.toolbars)for(var b in a.tuix.toolbars)if(h.has(a.tuix.toolbars,
b)){var e=a.tuix.toolbars[b];e&&a.sortedToolbars.push([b,e.ord])}a.sortedToolbars.sort(d.sortArray);for(b in a.sortedToolbars)h.has(a.sortedToolbars,b)&&(a.sortedToolbars[b]=a.sortedToolbars[b][0]);a.sortedButtons={};for(var g in a.tuix.sections)h.has(a.tuix.sections,g)&&a.tuix.sections[g]&&a.sortButtons(g)};a.sortButtons=function(b){a.sortedButtons[b]=[];if(a.tuix.sections[b].buttons)for(var e in a.tuix.sections[b].buttons)if(h.has(a.tuix.sections[b].buttons,e)){var g=a.tuix.sections[b].buttons[e];
g&&a.sortedButtons[b].push([e,g.ord])}a.sortedButtons[b].sort(d.sortArray);for(e in a.sortedButtons[b])h.has(a.sortedButtons[b],e)&&(a.sortedButtons[b][e]=a.sortedButtons[b][e][0])}});
