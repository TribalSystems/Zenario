zenario.lib(function(J,G,K,r,L,M,p,n,N,O,a,v,w,P,Q,R,A,H,I,t){var d=I(t.grid=H(t.base));d.returnPanelTitle=function(){var e=this.tuix.title;!r.zenarioOSelectMode||this.path!=r.zenarioOTargetPath&&!1!==r.zenarioOTargetPath||(r.zenarioOMultipleSelect&&this.tuix.multiple_select_mode_title?e=this.tuix.multiple_select_mode_title:this.tuix.select_mode_title&&(e=this.tuix.select_mode_title));a.filteredView&&(e+=A.refined);return e};d.showPanel=function(a,h,c){this.setHeader(a);this.showViewOptions(a);this.drawItems(h);
this.setScroll(h);this.setTooltips(a,h,c)};d.drawItems=function(a){this.items=this.getMergeFieldsForItemsAndColumns(!0);a.html(n.microTemplate("zenario_organizer_grid",this.items));a.show()};d.showViewOptions=function(a){a.find("#organizer_viewOptions").show()};d.showButtons=function(e){var h,c={itemButtons:!1,collectionButtons:!1};0<a.itemsSelected?c.itemButtons=a.getItemButtons():c.collectionButtons=a.getCollectionButtons();h=n.microTemplate("zenario_organizer_panel_buttons",c);e.html(h).show();
this.enableDragDropUpload(c.collectionButtons,c.itemButtons);n.tooltips(e.find("a[title]"));n.tooltips(e.find(".toolbarButtons ul ul a[title]"),{position:{my:"left+2 center",at:"right center",collision:"flipfit"}})};d.setScroll=function(e){d.restoreScrollPosition(e);var h,c,b;(h=a.getKeyId(!0))&&setTimeout(function(){if(c=$(v("organizer_item_"+h)).position())b=Math.max(0,c.top+e.scrollTop()-Math.floor(e.height()/4)),e.stop().animate({scrollTop:b},250)},1)};d.enableDragDropUpload=function(e,h){n.canDoHTML5Upload()||
this.disableDragDropUpload();var c,b,k,m=!1;do{if(h)for(c in h)if(p.has(h,c)&&(k=h[c],!k.disabled&&k.tuix.upload&&w(k.tuix.upload.drag_and_drop))){m=k.tuix;break}if(e)for(c in e){if(p.has(e,c)&&(k=e[c],!k.disabled&&k.tuix.upload&&w(k.tuix.upload.drag_and_drop))){m=k.tuix;break}}else for(b in this.tuix.collection_buttons)if(p.has(this.tuix.collection_buttons,b)&&(k=this.tuix.collection_buttons[b])&&k.upload&&w(k.upload.drag_and_drop)&&!a.checkButtonHidden(k)&&!a.checkDisabled(k)){m=k;break}}while(0);
if(m){var f;c=a.getKey(a.uploadIsItemLevel);if(m.upload&&m.upload.request)for(f in m.upload.request)p.has(m.upload.request,f)&&(c[f]=m.upload.request[f]);c.__pluginClassName__=m.class_name;c.__path__=this.path;c.method_call="handleOrganizerPanelAJAX";n.setHTML5UploadFromDragDrop(G+"zenario/ajax.php",c,function(){a.disableInteraction()},function(){a.enableInteraction();a.selectCreatedIds()},v("organizer_rightColumn"));$("#organizer_rightColumn").addClass("upload_enabled").removeClass("dragover")}else this.disableDragDropUpload()};
d.disableDragDropUpload=function(){n.clearHTML5UploadFromDragDrop();$("#organizer_rightColumn").removeClass("upload_enabled").removeClass("dragover")};d.setHeader=function(e){var h={quickFilters:a.getQuickFilters()};e.html(n.microTemplate("zenario_organizer_panel_header",h));e.show()};d.sizePanel=function(a,h,c,b){this.items&&this.drawPagination(c)};d.drawPagination=function(e){e.html(n.microTemplate("zenario_organizer_pagination",this.items)).show();var h=a.getPageCount(),c=e.find("#organizer_pagination");
1<h&&c.size()&&setTimeout(function(){var b=890>=$(r).width()?5:10;c.jPaginator({nbPages:a.getPageCount(),selectedPage:a.getCurrentPage(),nbVisible:b,widthPx:24,marginPx:1,overBtnLeft:"#organizer_page_left",overBtnRight:"#organizer_page_right",withSlider:!0,minSlidesForSlider:2,withAcceleration:!0,speed:2,coeffAcceleration:2,onPageClicked:function(b,e){a.goToPage(e)}})},0)};d.setTooltips=function(a,h,c){n.tooltips(h.find("[title]"));n.tooltips(a.find("a[title]"));n.tooltips(a.find("#organizer_quickFilter ul ul"),
{position:{my:"left+2 center",at:"right center",collision:"flipfit"}})};d.getMergeFieldsForItemsAndColumns=function(e){var h=!1,c=!1,b,k,m,f,d,n=-1,x=-1,B=!1;d="firstcell ";var C=0,D={},y,q,l={items:[],columns:[],totalWidth:0,canClickThrough:!1,maxNumberOfInlineButtons:0,allItemsSelected:a.allItemsSelected()};(y=this.tuix.label_format_for_grid_view)||(y="[["+a.defaultSortColumn+"]]");q=this.tuix.bold_columns_in_list_view||this.tuix.label_format_for_picked_items||y;a.popoutLabelFormat=this.tuix.label_format_for_popouts;
if(this.tuix.item_buttons)for(k in this.tuix.item_buttons)if(p.has(this.tuix.item_buttons,k)){c=!0;break}for(m in a.sortedColumns)p.has(a.sortedColumns,m)&&(b=a.sortedColumns[m],a.isShowableColumn(b,!0)&&(B=b));for(m in a.sortedColumns)if(p.has(a.sortedColumns,m)){b=a.sortedColumns[m];if(q==b||-1!==q.indexOf("[["+b+"]]"))D[b]=!0;a.isShowableColumn(b,!0)&&(k={id:b,tuix:this.tuix.columns[b],htmlId:"organizer_column__"+b,css_class:d+(B==b?"lastcell":"")+(D[b]?" label_column":"")+a.columnCssClass(b),
title:this.tuix.columns[b].title,tooltip:this.tuix.columns[b].tooltip},this.addExtraMergeFieldsForColumns(l,k),l.columns[++n]=k,d="")}l.totalWidth+=a.columnsExtraSpacing;a.shownItems={};a.shownItemsLength=0;if(this.tuix.items){var s,E;a.thisPageSize&&(s=a.page*a.thisPageSize,E=s-a.thisPageSize,s=Math.min(s,a.searchMatches),l.pageStart=E+1,l.pageStop=s);l.page=a.page;l.pageCount=a.pageCount;l.itemCount=a.searchMatches;q="firstrow ";for(var z in a.searchedItems)if(p.has(a.searchedItems,z)){var g=a.searchedItems[z],
h=!0;if(a.thisPageSize)if(z>=s)break;else if(z<E)continue;if(this.tuix.items[g]){if(n=!!a.itemClickThroughLink(g))l.canClickThrough=!0;f={id:g,cells:[],tuix:this.tuix.items[g],open_in_inspection_view:a.inspectionView&&g==a.inspectionViewItem,canClickThrough:n,showCheckbox:r.zenarioOSelectMode||c,label:a.applySmallSpaces($.trim(a.applyMergeFields(y,!1,g,!0))).replace(/\n/g,"<br/>"),selected:!!this.selectedItems[g],css_class:a.rowCssClass(g)+" "+q};f.image_css_class=a.getItemCSSClass(g);!e&&this.tuix.items[g].list_image?
(f.image_css_class+=" organiser_item_with_image",f.image=p.addBasePath(this.tuix.items[g].list_image)):e&&this.tuix.items[g].image&&(f.image_css_class+=" organiser_item_with_image",f.image=p.addBasePath(this.tuix.items[g].image));f.tooltip=this.tuix.items[g].tooltip;!f.tooltip&&this.tuix.item&&(this.tuix.item.tooltip_when_link_is_active&&a.itemClickThroughLink(g)?f.tooltip=a.applyMergeFields(this.tuix.item.tooltip_when_link_is_active,!0,g):this.tuix.item.tooltip&&(f.tooltip=a.applyMergeFields(this.tuix.item.tooltip,
!0,g)));f.inline_buttons=a.getInlineButtons(g);f.inline_buttons&&(C=f.inline_buttons.length)&&C>l.maxNumberOfInlineButtons&&(l.maxNumberOfInlineButtons=C);this.addExtraMergeFieldsForRows(l,f);var v=-1;d="firstcell ";var F=!1,t=!1,u,n=-1;for(m in a.sortedColumns)p.has(a.sortedColumns,m)&&(b=a.sortedColumns[m],a.isShowableColumn(b,!0)&&(k=l.columns[++n],u=a.columnValue(g,b),F=!(""==u&&0!==u),d={id:b,first:!!d,css_class:"organizer_column__"+b+"__cell "+q+d+(B==b?"lastcell":"")+(w(this.tuix.columns[b].align_right)?
" right":"")+(D[b]?" label_column":"")+a.columnCssClass(b,g),value:u,needsComma:F&&t},this.addExtraMergeFieldsForCells(l,k,f,d),f.cells[++v]=d,d="",t=F&&!(u+"").match(/\W\s*$/)));l.items[++x]=f;a.shownItems[g]=!0;++a.shownItemsLength;q=""}}for(x in l.items)p.has(l.items,x)&&(f=l.items[x],f.maxNumberOfInlineButtons=l.maxNumberOfInlineButtons)}for(g in this.selectedItems)p.has(this.selectedItems,g)&&(a.shownItems[g]||delete this.selectedItems[g]);h||(l.no_items_message=a.filteredView?this.tuix.no_items_in_search_message?
this.tuix.no_items_in_search_message:A.noItemsInSearch:this.tuix.no_items_message?this.tuix.no_items_message:A.noItems);this.addExtraMergeFields(l);return l};d.addExtraMergeFields=function(a){};d.addExtraMergeFieldsForColumns=function(a,d){};d.addExtraMergeFieldsForRows=function(a,d){};d.addExtraMergeFieldsForCells=function(a,d,c,b){}},zenarioO.panelTypes);
