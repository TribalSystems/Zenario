zenario.lib(function(K,H,L,s,M,q,B,n,N,O,a,w,x,P,Q,R,C,I,J,p,u){var c=J(u.grid=I(u.base));c.returnAJAXRequests=function(){return{skinId:B.skinId||q&&q.zenario&&q.zenario.skinId}};c.returnPanelTitle=function(){var d=this.tuix.title;!s.zenarioOSelectMode||this.path!=s.zenarioOTargetPath&&!1!==s.zenarioOTargetPath||(s.zenarioOMultipleSelect&&this.tuix.multiple_select_mode_title?d=this.tuix.multiple_select_mode_title:this.tuix.select_mode_title&&(d=this.tuix.select_mode_title));a.filteredView&&(d+=C.refined);
return d};c.showPanel=function(a,b,f){this.setHeader(a);this.showViewOptions(a);this.drawItems(b);this.setScroll(b);this.setTooltips(a,b,f)};c.drawItems=function(a){this.items=this.getMergeFieldsForItemsAndColumns(!0);a.html(this.microTemplate("zenario_organizer_grid",this.items));a.show()};c.showViewOptions=function(a){a.find("#organizer_viewOptions").show()};c.showButtons=function(d){var b,f={itemButtons:!1,collectionButtons:!1};0<a.itemsSelected?f.itemButtons=a.getItemButtons():f.collectionButtons=
a.getCollectionButtons();b=this.microTemplate("zenario_organizer_panel_buttons",f);d.html(b).show();this.enableDragDropUpload(f.collectionButtons,f.itemButtons);n.tooltips(d.find("a[title]"));n.tooltips(d.find(".toolbarButtons ul ul a[title]"),{position:{my:"left+2 center",at:"right center",collision:"flipfit"}})};c.setScroll=function(d){var b;if(b=a.getKeyId(!0)){if(b=$(w("organizer_item_"+b)).position())b=Math.max(0,b.top+d.scrollTop()-Math.floor(d.height()/4)),d.scrollTop(b).trigger("scroll")}else c.restoreScrollPosition(d)};
c.enableDragDropUpload=function(d,b){n.canDoHTML5Upload()||this.disableDragDropUpload();var f,e,k,m=!1;do{if(b)for(f in b)if(p(b,f)&&(k=b[f],!k.disabled&&k.tuix.upload&&x(k.tuix.upload.drag_and_drop))){m=k.tuix;break}if(d)for(f in d){if(p(d,f)&&(k=d[f],!k.disabled&&k.tuix.upload&&x(k.tuix.upload.drag_and_drop))){m=k.tuix;break}}else for(e in this.tuix.collection_buttons)if(p(this.tuix.collection_buttons,e)&&(k=this.tuix.collection_buttons[e])&&k.upload&&x(k.upload.drag_and_drop)&&!a.checkButtonHidden(k)&&
!a.checkDisabled(k)){m=k;break}}while(0);if(m){var g;f=a.getKey(a.uploadIsItemLevel);if(m.upload&&m.upload.request)for(g in m.upload.request)p(m.upload.request,g)&&(f[g]=m.upload.request[g]);f.__pluginClassName__=m.class_name;f.__path__=this.path;f.method_call="handleOrganizerPanelAJAX";n.setHTML5UploadFromDragDrop(H+"zenario/ajax.php",f,function(){a.disableInteraction()},function(){a.enableInteraction();a.selectCreatedIds()},w("organizer_rightColumn"));$("#organizer_rightColumn").addClass("upload_enabled").removeClass("dragover")}else this.disableDragDropUpload()};
c.disableDragDropUpload=function(){n.clearHTML5UploadFromDragDrop();$("#organizer_rightColumn").removeClass("upload_enabled").removeClass("dragover")};c.setHeader=function(d){var b={quickFilters:a.getQuickFilters()};d.html(this.microTemplate("zenario_organizer_panel_header",b));d.show()};c.sizePanel=function(a,b,f,e){this.items&&this.drawPagination(f)};c.drawPagination=function(d){d.html(this.microTemplate("zenario_organizer_pagination",this.items)).show();var b=a.getPageCount(),f=d.find("#organizer_pagination");
1<b&&f.size()&&setTimeout(function(){var d=890>=$(s).width()?5:10;f.jPaginator({nbPages:a.getPageCount(),selectedPage:a.getCurrentPage(),nbVisible:d,widthPx:24,marginPx:1,overBtnLeft:"#organizer_page_left",overBtnRight:"#organizer_page_right",withSlider:!0,minSlidesForSlider:2,withAcceleration:!0,speed:2,coeffAcceleration:2,onPageClicked:function(d,b){a.goToPage(b)}})},0)};c.setTooltips=function(a,b,f){n.tooltips(b.find("[title]"));n.tooltips(a.find("a[title]"));n.tooltips(a.find("#organizer_quickFilter ul ul"),
{position:{my:"left+2 center",at:"right center",collision:"flipfit"}})};c.getMergeFieldsForItemsAndColumns=function(d){var b=!1,f=!1,e,k,m,g,c,n=-1,y=-1,q=!1;c="firstcell ";var D=0,E={},z,r,l={items:[],columns:[],totalWidth:0,canClickThrough:!1,maxNumberOfInlineButtons:0,allItemsSelected:a.allItemsSelected()};(z=this.tuix.label_format_for_grid_view)||(z="[["+a.defaultSortColumn+"]]");r=this.tuix.bold_columns_in_list_view||this.tuix.label_format_for_picked_items||z;a.popoutLabelFormat=this.tuix.label_format_for_popouts;
if(this.tuix.item_buttons)for(k in this.tuix.item_buttons)if(p(this.tuix.item_buttons,k)){f=!0;break}for(m in a.sortedColumns)p(a.sortedColumns,m)&&(e=a.sortedColumns[m],a.isShowableColumn(e,!0)&&(q=e));for(m in a.sortedColumns)if(p(a.sortedColumns,m)){e=a.sortedColumns[m];if(r==e||-1!==r.indexOf("[["+e+"]]"))E[e]=!0;a.isShowableColumn(e,!0)&&(k={id:e,tuix:this.tuix.columns[e],htmlId:"organizer_column__"+e,css_class:c+(q==e?"lastcell":"")+(E[e]?" label_column":"")+a.columnCssClass(e),title:this.tuix.columns[e].title,
tooltip:this.tuix.columns[e].tooltip},this.addExtraMergeFieldsForColumns(l,k),l.columns[++n]=k,c="")}l.totalWidth+=a.columnsExtraSpacing;a.shownItems={};a.shownItemsLength=0;if(this.tuix.items){var t,F;a.thisPageSize&&(t=a.page*a.thisPageSize,F=t-a.thisPageSize,t=Math.min(t,a.searchMatches),l.pageStart=F+1,l.pageStop=t);l.page=a.page;l.pageCount=a.pageCount;l.itemCount=a.searchMatches;r="firstrow ";for(var A in a.searchedItems)if(p(a.searchedItems,A)){var h=a.searchedItems[A],b=!0;if(a.thisPageSize)if(A>=
t)break;else if(A<F)continue;if(this.tuix.items[h]){if(n=!!a.itemClickThroughLink(h))l.canClickThrough=!0;g={id:h,cells:[],tuix:this.tuix.items[h],open_in_inspection_view:a.inspectionView&&h==a.inspectionViewItem,canClickThrough:n,showCheckbox:s.zenarioOSelectMode||f,label:a.applySmallSpaces($.trim(a.applyMergeFields(z,!1,h,!0))).replace(/\n/g,"<br/>"),selected:!!this.selectedItems[h],css_class:a.rowCssClass(h)+" "+r};g.image_css_class=a.getItemCSSClass(h);!d&&this.tuix.items[h].list_image?(g.image_css_class+=
" organiser_item_with_image",g.image=B.addBasePath(this.tuix.items[h].list_image)):d&&this.tuix.items[h].image&&(g.image_css_class+=" organiser_item_with_image",g.image=B.addBasePath(this.tuix.items[h].image));g.tooltip=this.tuix.items[h].tooltip;!g.tooltip&&this.tuix.item&&(this.tuix.item.tooltip_when_link_is_active&&a.itemClickThroughLink(h)?g.tooltip=a.applyMergeFields(this.tuix.item.tooltip_when_link_is_active,!0,h):this.tuix.item.tooltip&&(g.tooltip=a.applyMergeFields(this.tuix.item.tooltip,
!0,h)));g.inline_buttons=a.getInlineButtons(h);g.inline_buttons&&(D=g.inline_buttons.length)&&D>l.maxNumberOfInlineButtons&&(l.maxNumberOfInlineButtons=D);this.addExtraMergeFieldsForRows(l,g);var w=-1;c="firstcell ";var G=!1,u=!1,v,n=-1;for(m in a.sortedColumns)p(a.sortedColumns,m)&&(e=a.sortedColumns[m],a.isShowableColumn(e,!0)&&(k=l.columns[++n],v=a.columnValue(h,e),G=!(""==v&&0!==v),c={id:e,first:!!c,css_class:"organizer_column__"+e+"__cell "+r+c+(q==e?"lastcell":"")+(x(this.tuix.columns[e].align_right)?
" right":"")+(E[e]?" label_column":"")+a.columnCssClass(e,h),value:v,needsComma:G&&u},this.addExtraMergeFieldsForCells(l,k,g,c),g.cells[++w]=c,c="",u=G&&!(v+"").match(/\W\s*$/)));l.items[++y]=g;a.shownItems[h]=!0;++a.shownItemsLength;r=""}}for(y in l.items)p(l.items,y)&&(g=l.items[y],g.maxNumberOfInlineButtons=l.maxNumberOfInlineButtons)}for(h in this.selectedItems)p(this.selectedItems,h)&&(a.shownItems[h]||delete this.selectedItems[h]);b||(l.no_items_message=a.filteredView?this.tuix.no_items_in_search_message||
C.noItemsInSearch:this.tuix.no_items_message||C.noItems);this.addExtraMergeFields(l);return l};c.addExtraMergeFields=function(a){};c.addExtraMergeFieldsForColumns=function(a,b){};c.addExtraMergeFieldsForRows=function(a,b){};c.addExtraMergeFieldsForCells=function(a,b,c,e){}},zenarioO.panelTypes);
