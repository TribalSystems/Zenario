zenario.lib(function(h,t,b,u,B,C,e,g,x,q,n,f,r,D,k,p,E,v,F,w,s,y,z){b=w(z);b.open=function(a,d,A,c,b,l,m,h){if(g._cIBIO("AdminOrganizer"))return!1;e._dS(this.globalName);d||(d={});a=(""+a).split("//",2);a[1]&&!d.id&&(d.id=a[1]);a=a[0];this.isOpen=!0;this.callBack=b;this.passMatchedIds=h;this.createAnotherObject=l;this.getRequestKey=d;this.changed={};this.isSlidUp=this.heightBeforeSlideUp=this.hasPreviewWindow=this.lastPreviewValues=this.previewValues=this.previewSlotWidth=!1;this.previewSlotWidthInfo=
"";this.previewHidden=!0;this.baseCSSClass=f.z+"fbAdmin zenario_admin_box zenario_fab_"+a;m||(b=this.microTemplate(this.mtPrefix,{}),this.openBox(b));u.onbeforeunload=g.onbeforeunload;this.start(a,d,A,c);return this.cb=new e.callback};b.openBox=function(a){};b.closeBox=function(){};b.initFields=function(){this.hasPreviewWindow=!!this.pluginPreviewDetails();w(y).initFields.call(this)};b.refreshParentAndClose=function(a,d,b){g._nDS(!1);var c={};d||(this.isOpen=!1);if(this.callBack&&!d){var k;(k=this.getValueArrayofArrays())&&
this.callBack(this.tuix.key,k)}else if(n.init&&(g.isFullOrganizerWindow||g._cIBIO("og"))){a=!1;if(this.tuix.key.id!==h)a=this.tuix.key.id;else for(var l in this.tuix.key)if(s(this.tuix.key,l)){a=this.tuix.key[l];break}n._rTSI(a,b&&v.createdAnother,!d&&v.savedButNotShown)}else e.cID&&this.tuix.key.slotName?(e._rPS(this.tuix.key.slotName,"",g.importantGetRequests),q.init&&q._i()):!e.cID||this.path!=f.z+"menu"&&this.path!=f.z+"menu_text"?a||d||(this.tuix.key.cID?(this.tuix.key.cID==e.cID&&this.tuix.key.cType==
e.cType&&(c=g.importantGetRequests),e._gTU(e._lTI(this.tuix.key.cID,this.tuix.key.cType,c))):q.init&&(c=_._cl(g.importantGetRequests),c.cVersion=e.cVersion,e._gTU(e._lTI(e.cID,e.cType,c)))):(g._rMP(),q.init&&q._i());a=this.tuix.popout_message;b=b&&this.createAnotherObject;d||b||(this.cb&&this.cb.call(),this.close());a&&g._sM(a,!0,!1);if(d){this.changed={};if(this.tuix.tabs)for(l in this.tuix.tabs)s(this.tuix.tabs,l)&&this.tuix.tabs[l]&&this.editModeOn(l)&&(this.tuix.tabs[l]._saved_and_continued=!0);
this.sortTabs();this.draw()}else b&&($(f.h+"abtab").clearQueue(),delete this.tuix,this.open(this.createAnotherObject.path,this.getRequestKey,this.createAnotherObject.tab,this.createAnotherObject.values,h,this.createAnotherObject,!0,this.passMatchedIds))};b.close=function(a){this.callFunctionOnEditors("remove");g._nDS(!1);this.sizing&&clearTimeout(this.sizing);this.stopPoking();e._cAD();a||g._cFB();this.closeBox();this.isOpen=!1;e._eS(this.globalName);delete this.cb;delete this.tuix;delete this.previewValues;
delete this.lastPreviewValues;delete this.previewSlotWidth;delete this.previewSlotWidthInfo;return!1};b.closeButton=function(a){var d=g._o();(d===h||!a&&confirm(d))&&this.isOpen&&this.close();return!1};b.draw=function(){this.isOpen&&this.loaded&&this.tabHidden&&this.draw2()};b.draw2=function(){if(this.tuix.tabs){this.get(f.z+"fbAdminFloatingBox").className=this.baseCSSClass+" "+(this.tuix.css_class||f.z+"fab_default_style")+" "+(k(this.tuix.hide_tab_bar)?f.z+"admin_box_with_tabs_hidden":f.z+"admin_box_with_tabs_shown");
var a=this.tuix;!a.tab||a.tabs[a.tab]&&!g._h(h,this,h,a.tab,h,h,h,h,a.tabs[a.tab])||(a.tab=!1);this.get(f.z+"fabTabs").innerHTML=this.drawTabs();var d=!this.editModeOnBox(),b="",b={isReadOnly:d};this.setTitle(d);this.showCloseButton();this.get(f.z+"fbButtons").innerHTML=this.microTemplate(this.mtPrefix+"_buttons",b);e._aJQE(f.h+"fbButtons ",!0);this.get(f.z+"fbAdminFloatingBox").style.display="block";this.size(!0);g._nDS(!1);d=new e.callback;b=this.drawFields(d);this.animateInTab(b,d,$(f.h+"abtab"));
this.shownTab=a.tab;delete this.lastScrollTop;this.startPoking()}};b.setTitle=function(a){};b.showCloseButton=function(){this.tuix.cancel_button_message?$(f.h+"fbAdminFloatingBox .zenario_fabClose").css("display","none"):$(f.h+"fbAdminFloatingBox .zenario_fabClose").css("display","block")};b.returnAJAXURL=function(a){return"start"==a&&this.passMatchedIds&&n.lastRequests?t+f.s+"admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+r(this.path)+"&path="+r(n.path)+e._uR(n.lastRequests)+e._uR(this.getRequestKey):
t+f.s+"admin/admin_boxes.ajax.php?path="+r(this.path)+e._uR(this.getRequestKey)};b.pluginPreviewDetails=function(a,d,b){var c=_._cl(g.importantGetRequests),k,l=!b;switch(this.path){case f.z+"skin_editor":l=!1;case "plugin_css_and_framework":b="overrideFrameworkAndCSS";k=JSON.stringify(this.getValues1D(!1,!0,!1,!0,!0));break;case "plugin_settings":b="overrideSettings";k=JSON.stringify(this.getValues1D(!0,!1));break;default:return!1}c.cVersion=e.cVersion;a=a||this.tuix&&this.tuix.key&&this.tuix.key.slotName;
d=d||this.tuix&&this.tuix.key&&this.tuix.key.instanceId||e.slots&&e.slots[a]&&e.slots[a].instanceId;if(l){if(!a||!d)return!1;var m=g._gGSD(a),h,l=m&&m.cssClass&&m.cssClass.split(" ")||[];c.method_call="showSingleSlot";c.fakeLayout=1;c.grid_columns=m.columns;c.grid_container=m.container;this.previewSlotWidth=m.pxWidth;this.previewSlotWidthInfo=m.widthInfo;c.grid_pxWidth=this.previewWidth?this.previewWidth:this.previewSlotWidth;c.grid_cssClass="";for(h in l)s(l,h)&&(m=l[h],"alpha"==m||"omega"==m||m.match(/^span[\d_]*$/)||
(c.grid_cssClass+=m+" "))}else c._show_page_preview=1;a&&(c.slotName=a);d&&(c.instanceId=d);return{url:e._lTI(e.cID,e.cType,c),postName:b,postValues:k}};b.addExtraAttsForTextFields=function(a,d){this.hasPreviewWindow&&(d.onkeyup=(d.onkeyup||"")+" "+this.globalName+".updatePreview();")};b.fieldChange=function(a,d){this.updatePreview(750);w(y).fieldChange.call(this,a,d)};b.updatePreview=function(a){var d=this;this.hasPreviewWindow&&!this.previewHidden&&e._aADINS("fabUpdatePreview",function(){var a=
d.pluginPreviewDetails();a&&d.lastPreviewValues!=a.postValues&&(d.lastPreviewValues=d.previewValues=a.postValues,d.submitPreview(a,f.z+"fabPreviewFrame"))},a||1E3)};b.submitPreview=function(a,d){$('<form action="'+p(a.url)+'" method="post" target="'+p(d)+'"><input name="'+p(a.postName)+'" value="'+p(a.postValues)+'"/></form>').appendTo("body").hide().submit().remove()};b.showPreviewInPopoutBox=function(a){var d,b=this,c=this.pluginPreviewDetails(h,h,a);c&&(this.previewValues=c.postValues,a=c.url+
"&"+r(c.postName)+"="+r(c.postValues),a.length>=(e._bII()?2E3:4E3)&&(a="",d=function(){b.submitPreview(c,$("#cboxLoadedContent iframe").attr("name"))}),$[f.x]({width:"95%",height:"90%",iframe:!0,preloading:!1,open:!0,title:this.previewSlotWidthInfo||v.preview,className:f.z+"plugin_preview_popout_box",href:a,onComplete:d}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};b.editModeOn=function(a){if(!this.tuix||!this.tuix.tabs)return!1;a||(a=this.tuix.tab);return this.tuix.tabs[a].edit_mode?
this.tuix.tabs[a].edit_mode.on=k(this.tuix.tabs[a].edit_mode.enabled)&&(k(this.tuix.tabs[a].edit_mode.on)||this.editModeAlwaysOn(a)):!1};b.editModeAlwaysOn=function(a){return this.tuix.tabs[a].edit_mode.always_on===h||k(this.tuix.tabs[a].edit_mode.always_on)||this.savedAndContinued(a)};b.editCancelEnabled=function(a){return this.tuix.tabs[a].edit_mode&&k(this.tuix.tabs[a].edit_mode.enabled)&&!this.editModeAlwaysOn(a)};b.revertEnabled=function(a){return this.tuix.tabs[a].edit_mode&&k(this.tuix.tabs[a].edit_mode.enabled)&&
this.editModeAlwaysOn(a)&&!this.savedAndContinued(a)&&(this.tuix.tabs[a].edit_mode.enable_revert===h&&this.tuix.key&&this.tuix.key.id||k(this.tuix.tabs[a].edit_mode.enable_revert))};b.savedAndContinued=function(a){return!1};b.editModeOnBox=function(){if(this.tuix&&this.tuix.tabs&&this.sortedTabs)for(var a in this.sortedTabs)if(s(this.sortedTabs,a)&&this.editModeOn(this.sortedTabs[a]))return!0;return!1};b.setData=function(a){this.setDataDiff(a)};b.sendStateToServer=function(){return this.sendStateToServerDiff()};
b.save=function(a,b,f){var c=this,g;this.loaded&&(g=this.getURL("save"))&&(this.saving||setTimeout(function(){c.saving=!0;c.differentTab=!0;c.loaded=!1;c.hideTab(!0);c.checkValues();var h={_save:!0,_confirm:a?1:"",_save_and_continue:b,_box:c.sendStateToServer()};k(c.tuix.download)||c.tuix.confirm&&k(c.tuix.confirm.download)?c.save2(e._nAA(c.getURL("save"),e._uR(h),!0),b,f):c.retryAJAX(g,h,!0,function(a){c.save2(a,b,f)},"saving")},100))};b.save2=function(a,b,h){delete this.saving;var c=a&&a._sync&&
a._sync.flags||{},k=n.init&&!u.zenarioOQuickMode&&!u.zenarioOSelectMode;c.close_with_message?(this.close(),k&&n._r(),g._sM(c.close_with_message)):c.reload_organizer&&k?(this.close(),g._rT(),g.uploading=!1,n._sWC("uploading",g.uploading),n._rePa()):c.open_admin_box&&x.init?(this.close(),x.open(c.open_admin_box)):c.go_to_url?(this.close(),g._rT(),e._gTU(e._aBP(c.go_to_url),!0)):c.valid?c.confirm?(this.load(a),this.sortTabs(),this.draw(),this.showConfirm(b,h)):c.download?(this.get(f.z+"iframe_form").action=
this.getURL("download"),this.get(f.z+"iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+p(this.sendStateToServer())+'"/>',this.get(f.z+"iframe_form").submit(),b&&(a=a.substr(15),this.load(a)),this.refreshParentAndClose(!0,b,h)):c.saved?(this.load(a),this.refreshParentAndClose(!1,b,h)):(this.close(),g._sM(a,!0,"error")):(this.load(a),this.sortTabs(),this.switchToATabWithErrors(),this.draw())};b.showConfirm=function(a,b){if(this.tuix&&
this.tuix.confirm&&k(this.tuix.confirm.show)){var e=this.tuix.confirm.message;k(this.tuix.confirm.html)||(e=p(e,!0));var c='<input type="button" class="submit_selected" value="'+this.tuix.confirm.button_message+'" onclick="'+this.globalName+".save(true, "+k(a)+", "+k(b)+');"/><input type="button" class="submit" value="'+this.tuix.confirm.cancel_button_message+'" onclick="zenarioA._cFB();"/>';g._flBo(e,c,this.tuix.confirm.message_type||"none")}};b.stopPoking=function(){this.poking&&clearInterval(this.poking);
this.poking=!1};b.startPoking=function(){this.poking||(this.poking=setInterval(this.poke,12E4))};b.poke=function(){e._a(t+f.s+"admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF,zenarioABToolkit);
