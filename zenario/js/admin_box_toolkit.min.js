zenario.lib(function(e,r,b,w,A,B,d,g,C,n,p,l,h,m,u,D,s,E,t,q,v,x){b=t(x);b.open=function(a,c,y,b,e,k,z,h){if(g._cIBIO("AdminOrganizer"))return!1;d._dS(this.globalName);c||(c={});a=(""+a).split("//",2);a[1]&&!c.id&&(c.id=a[1]);a=a[0];this.isOpen=!0;this.callBack=e;this.passMatchedIds=h;this.createAnotherObject=k;this.getRequestKey=c;this.changed={};this.isSlidUp=this.heightBeforeSlideUp=this.hasPreviewWindow=this.lastPreviewValues=this.previewValues=this.previewSlotWidth=!1;this.previewSlotWidthInfo=
"";this.previewHidden=!0;this.baseCSSClass="zenario_fbAdmin zenario_admin_box zenario_fab_"+a;z||(e=this.microTemplate(this.mtPrefix,{}),this.openBox(e));w.onbeforeunload=g.onbeforeunload;this.start(a,c,y,b);return this.cb=new d.callback};b.openBox=function(a){};b.closeBox=function(){};b.initFields=function(){this.hasPreviewWindow=!!this.pluginPreviewDetails();t(v).initFields.call(this)};b.refreshParentAndClose=function(a,c,b){g._nDS(!1);var f={};c||(this.isOpen=!1);if(this.callBack&&!c){var h;(h=
this.getValueArrayofArrays())&&this.callBack(this.tuix.key,h)}else if(p.init&&(g.isFullOrganizerWindow||g._cIBIO("og"))){a=!1;if(this.tuix.key.id!==e)a=this.tuix.key.id;else for(var k in this.tuix.key)if(q(this.tuix.key,k)){a=this.tuix.key[k];break}p._rTSI(a,b&&s.createdAnother,!c&&s.savedButNotShown)}else d.cID&&this.tuix.key.slotName?(d._rPS(this.tuix.key.slotName,"",g.importantGetRequests),n.init&&n._i()):!d.cID||"zenario_menu"!=this.path&&"zenario_menu_text"!=this.path?a||c||(this.tuix.key.cID?
(this.tuix.key.cID==d.cID&&this.tuix.key.cType==d.cType&&(f=g.importantGetRequests),d._gTU(d._lTI(this.tuix.key.cID,this.tuix.key.cType,f))):n.init&&(f=_._cl(g.importantGetRequests),f.cVersion=d.cVersion,d._gTU(d._lTI(d.cID,d.cType,f)))):(g._rMP(),n.init&&n._i());a=this.tuix.popout_message;b=b&&this.createAnotherObject;c||b||(this.cb&&this.cb.call(),this.close());a&&g._sM(a,!0,!1);if(c){this.changed={};if(this.tuix.tabs)for(k in this.tuix.tabs)q(this.tuix.tabs,k)&&this.tuix.tabs[k]&&this.editModeOn(k)&&
(this.tuix.tabs[k]._saved_and_continued=!0);this.sortTabs();this.draw()}else b&&($("#zenario_abtab").clearQueue(),delete this.tuix,this.open(this.createAnotherObject.path,this.getRequestKey,this.createAnotherObject.tab,this.createAnotherObject.values,e,this.createAnotherObject,!0,this.passMatchedIds))};b.close=function(a){this.callFunctionOnEditors("remove");g._nDS(!1);this.sizing&&clearTimeout(this.sizing);this.stopPoking();d._cAD();a||g._cFB();this.closeBox();this.isOpen=!1;d._eS(this.globalName);
delete this.cb;delete this.tuix;delete this.previewValues;delete this.lastPreviewValues;delete this.previewSlotWidth;delete this.previewSlotWidthInfo;return!1};b.closeButton=function(a){var c=g._o();(c===e||!a&&confirm(c))&&this.isOpen&&this.close();return!1};b.draw=function(){this.isOpen&&this.loaded&&this.tabHidden&&this.draw2()};b.draw2=function(){if(this.tuix.tabs){l("zenario_fbAdminFloatingBox").className=this.baseCSSClass+" "+(this.tuix.css_class||"zenario_fab_default_style")+" "+(h(this.tuix.hide_tab_bar)?
"zenario_admin_box_with_tabs_hidden":"zenario_admin_box_with_tabs_shown");var a=this.tuix;!a.tab||a.tabs[a.tab]&&!g._h(e,e,a.tab,a,e,e,e,e,a.tabs[a.tab])||(a.tab=!1);l("zenario_fabTabs").innerHTML=this.drawTabs();var c=!this.editModeOnBox(),b="",b={isReadOnly:c};this.setTitle(c);this.showCloseButton();l("zenario_fbButtons").innerHTML=this.microTemplate(this.mtPrefix+"_buttons",b);d._aJQE("#zenario_fbButtons ",!0);l("zenario_fbAdminFloatingBox").style.display="block";this.size(!0);g._nDS(!1);c=new d.callback;
b=this.drawFields(c);this.animateInTab(b,c,$("#zenario_abtab"));this.shownTab=a.tab;delete this.lastScrollTop;this.startPoking()}};b.setTitle=function(a){};b.showCloseButton=function(){this.tuix.cancel_button_message?$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display","none"):$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display","block")};b.returnAJAXURL=function(a){return"start"==a&&this.passMatchedIds&&p.lastRequests?r+"zenario/admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+
encodeURIComponent(this.path)+"&path="+encodeURIComponent(p.path)+d._uR(p.lastRequests)+d._uR(this.getRequestKey):r+"zenario/admin/admin_boxes.ajax.php?path="+encodeURIComponent(this.path)+d._uR(this.getRequestKey)};b.pluginPreviewDetails=function(a,c,b){if(this.tuix&&this.tuix.key&&this.tuix.key.nest)return!1;var f=_._cl(g.importantGetRequests),h,k=!b;switch(this.path){case "zenario_skin_editor":k=!1;case "plugin_css_and_framework":b="overrideFrameworkAndCSS";h=JSON.stringify(this.getValues1D(!1,
!0,!1,!0,!0));break;case "plugin_settings":b="overrideSettings";h=JSON.stringify(this.getValues1D(!0,!1));break;default:return!1}f.cVersion=d.cVersion;a=a||this.tuix&&this.tuix.key&&this.tuix.key.slotName;c=c||this.tuix&&this.tuix.key&&this.tuix.key.instanceId||d.slots&&d.slots[a]&&d.slots[a].instanceId;if(k){if(!a||!c)return!1;var e=g._gGSD(a),l,k=e&&e.cssClass&&e.cssClass.split(" ")||[];f.method_call="showSingleSlot";f.fakeLayout=1;f.grid_columns=e.columns;f.grid_container=e.container;this.previewSlotWidth=
e.pxWidth;this.previewSlotWidthInfo=e.widthInfo;f.grid_pxWidth=this.previewWidth?this.previewWidth:this.previewSlotWidth;f.grid_cssClass="";for(l in k)q(k,l)&&(e=k[l],"alpha"==e||"omega"==e||e.match(/^span[\d_]*$/)||(f.grid_cssClass+=e+" "))}else f._show_page_preview=1;a&&(f.slotName=a);c&&(f.instanceId=c);return{url:d._lTI(d.cID,d.cType,f),postName:b,postValues:h}};b.addExtraAttsForTextFields=function(a,c){this.hasPreviewWindow&&(c.onkeyup=u(c.onkeyup,"","")+" "+this.globalName+".updatePreview();")};
b.fieldChange=function(a,c){this.updatePreview(750);t(v).fieldChange.call(this,a,c)};b.updatePreview=function(a){var c=this;this.hasPreviewWindow&&!this.previewHidden&&d._aADINS("fabUpdatePreview",function(){var a=c.pluginPreviewDetails();a&&c.lastPreviewValues!=a.postValues&&(c.lastPreviewValues=c.previewValues=a.postValues,c.submitPreview(a,"zenario_fabPreviewFrame"))},a||1E3)};b.submitPreview=function(a,c){$('<form action="'+m(a.url)+'" method="post" target="'+m(c)+'"><input name="'+m(a.postName)+
'" value="'+m(a.postValues)+'"/></form>').appendTo("body").hide().submit().remove()};b.showPreviewInPopoutBox=function(a){var c,b=this,f=this.pluginPreviewDetails(e,e,a);f&&(this.previewValues=f.postValues,a=f.url+"&"+encodeURIComponent(f.postName)+"="+encodeURIComponent(f.postValues),a.length>=(d._bII()?2E3:4E3)&&(a="",c=function(){b.submitPreview(f,$("#cboxLoadedContent iframe").attr("name"))}),$.colorbox({width:"95%",height:"90%",iframe:!0,preloading:!1,open:!0,title:this.previewSlotWidthInfo||
s.preview,className:"zenario_plugin_preview_popout_box",href:a,onComplete:c}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};b.editModeOn=function(a){if(!this.tuix||!this.tuix.tabs)return!1;a||(a=this.tuix.tab);return this.tuix.tabs[a].edit_mode?this.tuix.tabs[a].edit_mode.on=h(this.tuix.tabs[a].edit_mode.enabled)&&(h(this.tuix.tabs[a].edit_mode.on)||this.editModeAlwaysOn(a)):!1};b.editModeAlwaysOn=function(a){return this.tuix.tabs[a].edit_mode.always_on===e||h(this.tuix.tabs[a].edit_mode.always_on)||
this.savedAndContinued(a)};b.editCancelEnabled=function(a){return this.tuix.tabs[a].edit_mode&&h(this.tuix.tabs[a].edit_mode.enabled)&&!this.editModeAlwaysOn(a)};b.revertEnabled=function(a){return this.tuix.tabs[a].edit_mode&&h(this.tuix.tabs[a].edit_mode.enabled)&&this.editModeAlwaysOn(a)&&!this.savedAndContinued(a)&&(this.tuix.tabs[a].edit_mode.enable_revert===e&&this.tuix.key&&this.tuix.key.id||h(this.tuix.tabs[a].edit_mode.enable_revert))};b.savedAndContinued=function(a){return!1};b.editModeOnBox=
function(){if(this.tuix&&this.tuix.tabs&&this.sortedTabs)for(var a in this.sortedTabs)if(q(this.sortedTabs,a)&&this.editModeOn(this.sortedTabs[a]))return!0;return!1};b.setData=function(a){this.setDataDiff(a)};b.sendStateToServer=function(){return this.sendStateToServerDiff()};b.save=function(a,c,b){var e=this,g;this.loaded&&(g=this.getURL("save"))&&!this.saving&&(this.differentTab=this.saving=!0,this.loaded=!1,this.hideTab(!0),this.checkValues(),a={_save:!0,_confirm:a?1:"",_save_and_continue:c,_box:this.sendStateToServer()},
h(this.tuix.download)||this.tuix.confirm&&h(this.tuix.confirm.download)?this.save2(d._nAA(this.getURL("save"),d._uR(a)),c,b):this.retryAJAX(g,a,function(a){e.save2(a,c,b)},"saving"))};b.save2=function(a,b,d){delete this.saving;"\x3c!--Valid--\x3e"==(""+a).substr(0,12)?(a=a.substr(12),"\x3c!--Confirm--\x3e"==(""+a).substr(0,14)?(a=a.substr(14),this.load(a),this.sortTabs(),this.draw(),this.showConfirm(b,d)):"\x3c!--Download--\x3e"==(""+a).substr(0,15)?(l("zenario_iframe_form").action=this.getURL("download"),
l("zenario_iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+m(this.sendStateToServer())+'"/>',l("zenario_iframe_form").submit(),b&&(a=a.substr(15),this.load(a)),this.refreshParentAndClose(!0,b,d)):"\x3c!--Saved--\x3e"==(""+a).substr(0,12)?(a=a.substr(12),this.load(a),this.refreshParentAndClose(!1,b,d)):(this.close(),g._sM(a,!0,"error"))):(this.load(a),this.sortTabs(),this.switchToATabWithErrors(),this.draw())};b.showConfirm=function(a,
b){if(this.tuix&&this.tuix.confirm&&h(this.tuix.confirm.show)){var d=this.tuix.confirm.message;h(this.tuix.confirm.html)||(d=m(d,!0));var e='<input type="button" class="submit_selected" value="'+this.tuix.confirm.button_message+'" onclick="'+this.globalName+".save(true, "+h(a)+", "+h(b)+');"/><input type="button" class="submit" value="'+this.tuix.confirm.cancel_button_message+'" onclick="zenarioA._cFB();"/>';g._flBo(d,e,u(this.tuix.confirm.message_type,"none"))}};b.stopPoking=function(){this.poking&&
clearInterval(this.poking);this.poking=!1};b.startPoking=function(){this.poking||(this.poking=setInterval(this.poke,12E4))};b.poke=function(){d._a(r+"zenario/admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF,zenarioABToolkit);
