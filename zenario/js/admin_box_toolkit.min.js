zenario.lib(function(r,s,b,z,G,H,e,k,q,C,v,h,p,w,n,I,u,J,A,K,B,x,D,E){b=B(E);b.open=function(a,c,g,f,b,d,l,y){if(k._cIBIO("AdminOrganizer"))return!1;e._dS(this.globalName);c||(c={});a=(""+a).s("//",2);a[1]&&!c.id&&(c.id=a[1]);a=a[0];this.isOpen=!0;this.callBack=b;this.passMatchedIds=y;this.createAnotherObject=d;this.getRequestKey=c;this.changed={};this.isSlidUp=this.heightBeforeSlideUp=this.hasPreviewWindow=this.lastPreviewValues=this.previewValues=this.previewSlotWidth=!1;this.previewSlotWidthInfo=
"";this.previewHidden=!0;this.baseCSSClass="zenario_fbAdmin zenario_admin_box zenario_fab_"+a;l||(b=this.microTemplate(this.mtPrefix,{}),this.openBox(b));z.onbeforeunload=q.onbeforeunload;this.start(a,c,g,f);return this.cb=new e.callback};b.openBox=function(a){};b.closeBox=function(){};b.updateHash=function(){};b.initFields=function(){this.hasPreviewWindow=!!this.pluginPreviewDetails();B(D).initFields.call(this)};b.refreshParentAndClose=function(a,c,g){k._nDS(!1);var f,b={};c||(this.isOpen=!1,this.updateHash());
if(this.callBack&&!c){var d;(d=this.getValueArrayofArrays())&&this.callBack(this.tuix.key,d)}else if(h.init&&(k.isFullOrganizerWindow||k._cIBIO("og"))){a=!1;if(w(this.tuix.key.id))a=this.tuix.key.id;else for(var l in this.tuix.key)if(x(this.tuix.key,l)){a=this.tuix.key[l];break}h._rTSI(a,g&&A.createdAnother,!c&&A.savedButNotShown)}else e.cID&&(f=this.tuix.key.slotName)?(e._rS(f,k.importantGetRequests),v.init&&v.init()):!e.cID||"zenario_menu"!=this.path&&"zenario_menu_text"!=this.path?a||c||(this.tuix.key.cID?
(this.tuix.key.cID==e.cID&&this.tuix.key.cType==e.cType&&(b=k.importantGetRequests),e._gTU(e._lTI(this.tuix.key.cID,this.tuix.key.cType,b))):v.init&&(b=_._cl(k.importantGetRequests),b.cVersion=e.cVersion,e._gTU(e._lTI(e.cID,e.cType,b)))):(k._rMP(),v.init&&v.init());a=this.tuix.popout_message;g=g&&this.createAnotherObject;c||g||(this.cb&&this.cb.call(),this.close());a&&k._sM(a,!0,!1);if(c){this.changed={};if(this.tuix.tabs)for(l in this.tuix.tabs)x(this.tuix.tabs,l)&&this.tuix.tabs[l]&&this.editModeOn(l)&&
(this.tuix.tabs[l]._saved_and_continued=!0);this.sortTabs();this.draw()}else g&&($("#zenario_abtab").clearQueue(),delete this.tuix,this.open(this.createAnotherObject.path,this.getRequestKey,this.createAnotherObject.tab,this.createAnotherObject.values,r,this.createAnotherObject,!0,this.passMatchedIds))};b.close=function(a){this.callFunctionOnEditors("remove");k._nDS(!1);this.sizing&&clearTimeout(this.sizing);this.stopPoking();e._cAD();a||k._cFB();this.isOpen=!1;this.closeBox();e._eS(this.globalName);
delete this.cb;delete this.tuix;delete this.previewValues;delete this.lastPreviewValues;delete this.previewSlotWidth;delete this.previewSlotWidthInfo;return!1};b.closeButton=function(a){var c=q._o();(!w(c)||!a&&confirm(c))&&this.isOpen&&this.close();return!1};b.draw=function(){this.isOpen&&this.loaded&&this.tabHidden&&this.draw2()};b.draw2=function(){if(this.tuix.tabs){this.get("zenario_fbAdminFloatingBox").className=this.baseCSSClass+" "+(this.tuix.css_class||"zenario_fab_default_style")+" "+(n(this.tuix.hide_tab_bar)?
"zenario_admin_box_with_tabs_hidden":"zenario_admin_box_with_tabs_shown");var a=this.tuix;!a.tab||a.tabs[a.tab]&&!q._h(r,this,r,a.tab,r,r,r,r,a.tabs[a.tab])||(a.tab=!1);this.get("zenario_fabTabs").innerHTML=this.drawTabs();var c=!this.editModeOnBox(),g="",g={isReadOnly:c};this.setTitle(c);this.showCloseButton();this.get("zenario_fbButtons").innerHTML=this.microTemplate(this.mtPrefix+"_buttons",g);e._aJQE("#zenario_fbButtons ",!0);this.get("zenario_fbAdminFloatingBox").style.display="block";this.tallAsPossibleField=
r;this.size(!0);k._nDS(!1);c=new e.callback;g=this.drawFields(c);c.after(this.makeFieldAsTallAsPossible);this.animateInTab(g,c,$("#zenario_abtab"));this.shownTab=a.tab;delete this.lastScrollTop;this.startPoking()}};b.setTitle=function(a){};b.showCloseButton=function(){this.tuix.cancel_button_message?$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display","none"):$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display","block")};b.returnAJAXURL=function(a){return"start"==a&&this.passMatchedIds&&
h.lastRequests?s+"zenario/admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+p(this.path)+"&path="+p(h.path)+e._uR(h.lastRequests)+e._uR(this.getRequestKey):s+"zenario/admin/admin_boxes.ajax.php?path="+p(this.path)+e._uR(this.getRequestKey)};b.typeaheadSearchEnabled=function(a,c,g){return(a=a.pick_items)&&(a.path||a.target_path)&&!1!==a.enable_type_ahead_search};b.typeaheadSearchAJAXURL=function(a,c,g){c=a.pick_items;a=c.path&&h._cNPTTPAR(c.path);c=c.target_path&&h._cNPTTPAR(c.target_path);if(a=
a&&c&&a.path==c.path?a:c||a)return s+"zenario/admin/organizer.ajax.php?_typeahead_search=1&path="+p(a.path)+e._uR(a.request)};b.parseTypeaheadSearch=function(a,c,g,f,b){var d,e,y=[];if(b.items)for(d in b.items)x(b.items,d)&&(g=b.items[d],e=k._fOIN(b,d),a.values=a.values||{},a.values[d]={list_image:g.list_image,css_class:g.css_class||b.item&&b.item.css_class,label:e},y.push({value:d,text:e,html:this.drawPickedItem(d,c,a,f,!0)}));return y};b.drawPickedItem=function(a,c,g,b,t){w(g)||(g=this.field(c));
var d=g.values&&g.values[a],l=g.pick_items||{},k=a==1*a,m,h;c={id:c,item:a,label:d,readOnly:b};_._isOb(d)?(c.missing=d.missing,c.css_class=d.css_class,c.list_image=d.list_image,d=c.label=d.label):d?c.label=d:(d=c.label=a,c.missing=!0);g.tag_colors&&(c.tag_color=g.tag_colors[a]||"blue");n(l.hide_info_button)||g.upload&&!k||!(m=l.path)||m!=l.target_path&&l.min_path!=l.target_path||(m="//"==e._rHSS(m,2)?m+a:"/"==e._rHSS(m,1)?m+("/"+a):m+("//"+a),c.organizerPath=m);g.upload&&(c.isUpload=!0,m=(m=(""+d).m(/(.*?)\.(\w+)$/)||
(""+d).m(/(.*?)\.(\w+) \[.*\]$/))&&m[2]?m[2].toLowerCase():"unknown",c.extension=m,k?(h=g.values&&g.values[a])&&h.checksum?(a=s+"zenario/file.php?c="+p(h.checksum),h.usage&&(a+="&usage="+p(h.usage))):a=s+"zenario/file.php?id="+a:a=s+"zenario/file.php?getUploadedFileInCacheDir="+p(a),m.m(/gif|jpg|jpeg|png|svg/)?(c.thumbnail={onclick:this.globalName+".showPickedItemInPopout('"+a+"&popout=1&dummy_filename="+p("image."+m)+"', '"+d+"');",src:a+"&og=1"},(d=(""+d).m(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&
d[1]&&d[2]&&q._rI(d[1],d[2],180,120,c.thumbnail)):c.adminDownload=a+"&adminDownload=1");return t?this.microTemplate(l.dropdown_item_microtemplate||this.mtPrefix+"_dropdown_item",c):this.microTemplate(l.picked_item_microtemplate||this.mtPrefix+"_picked_item",c)};b.pluginPreviewDetails=function(a,c,g,b,t){if(this.tuix&&this.tuix.key&&(this.tuix.key.nest||this.tuix.key.eggId))return!1;var d=_._cl(k.importantGetRequests),l,h=!c;switch(this.path){case "zenario_skin_editor":h=!1;case "plugin_css_and_framework":c=
"overrideFrameworkAndCSS";a&&(l=JSON.stringify(this.getValues1D(!1,!0,!1,!0,!0)));break;case "plugin_settings":c="overrideSettings";a&&(l=JSON.stringify(this.getValues1D(!0,!1)));break;default:return!1}b=b||this.tuix&&this.tuix.key&&this.tuix.key.slotName;t=t||this.tuix&&this.tuix.key&&this.tuix.key.instanceId||e.slots&&e.slots[b]&&e.slots[b].instanceId;b&&zenario_conductor._e(b)&&(d=zenario_conductor._re(b,"refresh",d));d.cVersion=e.cVersion;if(h){if(!b||!t)return!1;var h=k._gGSD(b),m;a=h&&h.cssClass&&
h.cssClass.s(" ")||[];d.method_call="showSingleSlot";d.fakeLayout=1;d.grid_columns=h.columns;d.grid_container=h.container;this.previewSlotWidth=h.pxWidth;this.previewSlotWidthInfo=h.widthInfo;d.grid_pxWidth=this.previewWidth&&!g?this.previewWidth:this.previewSlotWidth;d.grid_cssClass="";for(m in a)x(a,m)&&(g=a[m],"alpha"==g||"omega"==g||g.m(/^span[\d_]*$/)||(d.grid_cssClass+=g+" "))}else d._show_page_preview=1;b&&(d.slotName=b);t&&(d.instanceId=t);return{url:e._lTI(e.cID,e.cType,d),postName:c,postValues:l}};
b.addExtraAttsForTextFields=function(a,c){this.hasPreviewWindow&&(c.onkeyup=(c.onkeyup||"")+" "+this.globalName+".updatePreview();")};b.fieldChange=function(a,c){this.updatePreview(750);B(D).fieldChange.call(this,a,c)};b.updatePreview=function(a){var c=this;c.hasPreviewWindow&&!c.previewHidden&&e._aADINS("fabUpdatePreview",function(){var a=c.pluginPreviewDetails(!0);a&&c.lastPreviewValues!=a.postValues&&(c.lastPreviewValues=c.previewValues=a.postValues,c.submitPreview(a))},a||1E3)};var F=0;b.submitPreview=
function(a,c,b){c=c||$("#zenario_fabPreview");b=b||"zenario_fabPreviewFrame";var f="zenario_previewFrame"+ ++F,e=c.find("."+b).not(".beingRemoved");b=$(q._ht("iframe","id",f,"name",f,"class",b));var d=e[0]&&e[0].contentDocument;if(d=1*(d&&$(d).scrollTop()))a.url+="&_scroll_to="+d;e[0]&&(e.width(e.width()).height(e.height()).attr("id","").attr("name","").addClass("beingRemoved"),setTimeout(function(){e.fadeOut(600,function(){e.remove()})},400));c.append(b);this.showPreviewViaPost(a,f)};b.showPreviewViaPost=
function(a,c){$('<form action="'+u(a.url)+'" method="post" target="'+u(c)+'"><input name="'+u(a.postName)+'" value="'+u(a.postValues)+'"/></form>').appendTo("body").hide().submit().remove()};b.showPreviewInPopoutBox=function(a,c){var b=this,f,h,d=b.pluginPreviewDetails(!0,a,c);d&&(b.previewValues=d.postValues,f=d.url+"&"+p(d.postName)+"="+p(d.postValues),f.length>=(e._bII()?2E3:4E3)&&(f="",h=function(){b.showPreviewViaPost(d,$("#cboxLoadedContent iframe")[0].name)}),$.colorbox({width:"95%",height:"90%",
iframe:!0,preloading:!1,open:!0,title:b.previewSlotWidthInfo||A.preview,className:"zenario_plugin_preview_popout_box",href:f,onComplete:h}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};b.editModeOn=function(a){if(!this.tuix||!this.tuix.tabs)return!1;a||(a=this.tuix.tab);return this.tuix.tabs[a].edit_mode?this.tuix.tabs[a].edit_mode.on=n(this.tuix.tabs[a].edit_mode.enabled)&&(n(this.tuix.tabs[a].edit_mode.on)||this.editModeAlwaysOn(a)):!1};b.editModeAlwaysOn=function(a){return!w(this.tuix.tabs[a].edit_mode.always_on)||
n(this.tuix.tabs[a].edit_mode.always_on)||this.savedAndContinued(a)};b.editCancelEnabled=function(a){return this.tuix.tabs[a].edit_mode&&n(this.tuix.tabs[a].edit_mode.enabled)&&!this.editModeAlwaysOn(a)};b.revertEnabled=function(a){return this.tuix.tabs[a].edit_mode&&n(this.tuix.tabs[a].edit_mode.enabled)&&this.editModeAlwaysOn(a)&&!this.savedAndContinued(a)&&(!w(this.tuix.tabs[a].edit_mode.enable_revert)&&this.tuix.key&&this.tuix.key.id||n(this.tuix.tabs[a].edit_mode.enable_revert))};b.savedAndContinued=
function(a){return!1};b.editModeOnBox=function(){if(this.tuix&&this.tuix.tabs&&this.sortedTabs)for(var a in this.sortedTabs)if(x(this.sortedTabs,a)&&this.editModeOn(this.sortedTabs[a]))return!0;return!1};b.setData=function(a){this.setDataDiff(a)};b.sendStateToServer=function(){return this.sendStateToServerDiff()};b.save=function(a,c,b){var f=this,h;f.loaded&&(h=f.getURL("save"))&&(f.saving||setTimeout(function(){f.saving=!0;f.differentTab=!0;f.loaded=!1;f.hideTab(!0);f.checkValues();var d={_save:!0,
_confirm:a?1:"",_save_and_continue:c,_box:f.sendStateToServer()};n(f.tuix.download)||f.tuix.confirm&&n(f.tuix.confirm.download)?f.save2(e._nAA(f.getURL("save"),e._uR(d),!0),c,b):f.retryAJAX(h,d,!0,function(a){f.save2(a,c,b)},"saving")},100))};b.save2=function(a,c,b){delete this.saving;var f=a&&a._sync&&a._sync.flags||{},n=h.init&&!z.zenarioOQuickMode&&!z.zenarioOSelectMode;f.close_with_message?(this.close(),n&&h._r(),k._sM(f.close_with_message)):f.reload_organizer&&n?(this.close(),k._rT(),q.uploading=
!1,h._sWC("uploading",q.uploading),h._rePa()):f.open_admin_box&&C.init?(this.close(),C.open(f.open_admin_box)):f.go_to_url?(this.close(),k._rT(),e._gTU(e._aBP(f.go_to_url),!0)):f.valid?f.confirm?(this.load(a),this.sortTabs(),this.draw(),this.showConfirm(c,b)):f.download?(this.get("zenario_iframe_form").action=this.getURL("download"),this.get("zenario_iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+u(this.sendStateToServer())+'"/>',
this.get("zenario_iframe_form").submit(),c&&(a=a.substr(15),this.load(a)),this.refreshParentAndClose(!0,c,b)):f.saved?(this.load(a),this.refreshParentAndClose(!1,c,b)):(this.close(),k._sM(a,!0,"error")):(this.load(a),this.sortTabs(),this.switchToATabWithErrors(),this.draw())};b.showConfirm=function(a,b){if(this.tuix&&this.tuix.confirm&&n(this.tuix.confirm.show)){var e=this.tuix.confirm.message;n(this.tuix.confirm.html)||(e=u(e,!0));var f='<input type="button" class="submit_selected" value="'+this.tuix.confirm.button_message+
'" onclick="'+this.globalName+".save(true, "+n(a)+", "+n(b)+');"/><input type="button" class="submit" value="'+this.tuix.confirm.cancel_button_message+'"/>';k._flBo(e,f,this.tuix.confirm.message_type||"none")}};b.dragDropTarget=function(){return this.get("zenario_fbAdminInner")};b.enableDragDropUpload=function(){var a=this.dragDropTarget();q._sHTML5UFDD(this.ajaxURL(),{fileUpload:1},!1,this.uploadCallback,a);$(a).addClass("upload_enabled").removeClass("dragover")};b.disableDragDropUpload=function(){$(this.dragDropTarget()).removeClass("upload_enabled").removeClass("dragover").off("drop")};
b.dragListeners=function(){return q._cDHTML5U()?"ondragover=\"$(this).addClass('dragover');\" ondragleave=\"$(this).removeClass('dragover');\"":""};b.stopPoking=function(){this.poking&&clearInterval(this.poking);this.poking=!1};b.startPoking=function(){this.poking||(this.poking=setInterval(this.poke,12E4))};b.poke=function(){e._a(s+"zenario/admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF,zenarioABToolkit);
