zenario.lib(function(g,v,b,w,G,H,d,h,p,B,s,m,t,I,k,q,J,x,K,y,u,C,D,l,z,L,M,N,r,O,P,Q,R,S,T,U,V,W,E){b=y(D);b.open=function(a,e,n,c,f,b,g,k){if(h._cIBIO("AdminOrganizer"))return!1;d._dS(this.globalName);e||(e={});a=(""+a).split("//",2);a[1]&&!e.id&&(e.id=a[1]);a=a[0];this.isOpen=!0;this.callBack=f;this.passMatchedIds=k;this.createAnotherObject=b;this.getRequestKey=e;this.changed={};this.isSlidUp=this.heightBeforeSlideUp=this.hasPreviewWindow=this.lastPreviewValues=this.previewValues=this.previewSlotWidth=
!1;this.previewSlotWidthInfo="";this.previewHidden=!0;this.baseCSSClass=l+"fbAdmin zenario_admin_box zenario_fab_"+a;g||(f=this.microTemplate(this.mtPrefix,{}),this.openBox(f));w.onbeforeunload=p.onbeforeunload;this.start(a,e,n,c);return this.cb=new d.callback};b.openBox=function(a){};b.closeBox=function(){};b.initFields=function(){this.hasPreviewWindow=!!this.pluginPreviewDetails();y(C).initFields.call(this)};b.refreshParentAndClose=function(a,e,n){h._nDS(!1);var c={};e||(this.isOpen=!1);if(this.callBack&&
!e){var f;(f=this.getValueArrayofArrays())&&this.callBack(this.tuix.key,f)}else if(m.init&&(h.isFullOrganizerWindow||h._cIBIO("og"))){a=!1;if(this.tuix.key.id!==g)a=this.tuix.key.id;else for(var b in this.tuix.key)if(u(this.tuix.key,b)){a=this.tuix.key[b];break}m._rTSI(a,n&&x.createdAnother,!e&&x.savedButNotShown)}else d.cID&&this.tuix.key.slotName?(d._rPS(this.tuix.key.slotName,"",h.importantGetRequests),s.init&&s._i()):!d.cID||this.path!=l+"menu"&&this.path!=l+"menu_text"?a||e||(this.tuix.key.cID?
(this.tuix.key.cID==d.cID&&this.tuix.key.cType==d.cType&&(c=h.importantGetRequests),d._gTU(d._lTI(this.tuix.key.cID,this.tuix.key.cType,c))):s.init&&(c=_._cl(h.importantGetRequests),c.cVersion=d.cVersion,d._gTU(d._lTI(d.cID,d.cType,c)))):(h._rMP(),s.init&&s._i());a=this.tuix.popout_message;n=n&&this.createAnotherObject;e||n||(this.cb&&this.cb.call(),this.close());a&&h._sM(a,!0,!1);if(e){this.changed={};if(this.tuix.tabs)for(b in this.tuix.tabs)u(this.tuix.tabs,b)&&this.tuix.tabs[b]&&this.editModeOn(b)&&
(this.tuix.tabs[b]._saved_and_continued=!0);this.sortTabs();this.draw()}else n&&($(r+"abtab").clearQueue(),delete this.tuix,this.open(this.createAnotherObject.path,this.getRequestKey,this.createAnotherObject.tab,this.createAnotherObject.values,g,this.createAnotherObject,!0,this.passMatchedIds))};b.close=function(a){this.callFunctionOnEditors("remove");h._nDS(!1);this.sizing&&clearTimeout(this.sizing);this.stopPoking();d._cAD();a||h._cFB();this.closeBox();this.isOpen=!1;d._eS(this.globalName);delete this.cb;
delete this.tuix;delete this.previewValues;delete this.lastPreviewValues;delete this.previewSlotWidth;delete this.previewSlotWidthInfo;return!1};b.closeButton=function(a){var e=p._o();(e===g||!a&&confirm(e))&&this.isOpen&&this.close();return!1};b.draw=function(){this.isOpen&&this.loaded&&this.tabHidden&&this.draw2()};b.draw2=function(){if(this.tuix.tabs){this.get(l+"fbAdminFloatingBox").className=this.baseCSSClass+" "+(this.tuix.css_class||l+"fab_default_style")+" "+(k(this.tuix.hide_tab_bar)?l+"admin_box_with_tabs_hidden":
l+"admin_box_with_tabs_shown");var a=this.tuix;!a.tab||a.tabs[a.tab]&&!p._h(g,this,g,a.tab,g,g,g,g,a.tabs[a.tab])||(a.tab=!1);this.get(l+"fabTabs").innerHTML=this.drawTabs();var e=!this.editModeOnBox(),b="",b={isReadOnly:e};this.setTitle(e);this.showCloseButton();this.get(l+"fbButtons").innerHTML=this.microTemplate(this.mtPrefix+"_buttons",b);d._aJQE(r+"fbButtons ",!0);this.get(l+"fbAdminFloatingBox").style.display="block";this.size(!0);h._nDS(!1);e=new d.callback;b=this.drawFields(e);this.animateInTab(b,
e,$(r+"abtab"));this.shownTab=a.tab;delete this.lastScrollTop;this.startPoking()}};b.setTitle=function(a){};b.showCloseButton=function(){this.tuix.cancel_button_message?$(r+"fbAdminFloatingBox .zenario_fabClose").css("display","none"):$(r+"fbAdminFloatingBox .zenario_fabClose").css("display","block")};b.returnAJAXURL=function(a){return"start"==a&&this.passMatchedIds&&m.lastRequests?v+z+"admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+t(this.path)+"&path="+t(m.path)+d._uR(m.lastRequests)+d._uR(this.getRequestKey):
v+z+"admin/admin_boxes.ajax.php?path="+t(this.path)+d._uR(this.getRequestKey)};b.pluginPreviewDetails=function(a,e,b,c){if(this.tuix&&this.tuix.key&&this.tuix.key.nest)return!1;var f=_._cl(h.importantGetRequests),A,g=!b;switch(this.path){case l+"skin_editor":g=!1;case "plugin_css_and_framework":b="overrideFrameworkAndCSS";A=JSON.stringify(this.getValues1D(!1,!0,!1,!0,!0));break;case "plugin_settings":b="overrideSettings";A=JSON.stringify(this.getValues1D(!0,!1));break;default:return!1}f.cVersion=
d.cVersion;a=a||this.tuix&&this.tuix.key&&this.tuix.key.slotName;e=e||this.tuix&&this.tuix.key&&this.tuix.key.instanceId||d.slots&&d.slots[a]&&d.slots[a].instanceId;if(g){if(!a||!e)return!1;var k=h._gGSD(a),m,g=k&&k.cssClass&&k.cssClass.split(" ")||[];f.method_call="showSingleSlot";f.fakeLayout=1;f.grid_columns=k.columns;f.grid_container=k.container;this.previewSlotWidth=k.pxWidth;this.previewSlotWidthInfo=k.widthInfo;f.grid_pxWidth=this.previewWidth&&!c?this.previewWidth:this.previewSlotWidth;f.grid_cssClass=
"";for(m in g)u(g,m)&&(c=g[m],"alpha"==c||"omega"==c||c.match(/^span[\d_]*$/)||(f.grid_cssClass+=c+" "))}else f._show_page_preview=1;a&&(f.slotName=a);e&&(f.instanceId=e);return{url:d._lTI(d.cID,d.cType,f),postName:b,postValues:A}};b.addExtraAttsForTextFields=function(a,e){this.hasPreviewWindow&&(e.onkeyup=(e.onkeyup||"")+" "+this.globalName+".updatePreview();")};b.fieldChange=function(a,e){this.updatePreview(750);y(C).fieldChange.call(this,a,e)};b.updatePreview=function(a){var e=this;this.hasPreviewWindow&&
!this.previewHidden&&d._aADINS("fabUpdatePreview",function(){var a=e.pluginPreviewDetails();a&&e.lastPreviewValues!=a.postValues&&(e.lastPreviewValues=e.previewValues=a.postValues,e.submitPreview(a))},a||1E3)};var F=0;b.submitPreview=function(a,e,b){e=e||$(r+"fabPreview");b=b||l+"fabPreviewFrame";var c=l+"previewFrame"+ ++F,f=e.find("."+b).not(".beingRemoved");b=$(p._ht("iframe","id",c,"name",c,"class",b));var d=f[0]&&f[0].contentDocument;if(d=1*(d&&$(d).scrollTop()))a.url+="&_scroll_to="+d;f[0]&&
(f.width(f.width()).height(f.height()).attr("id","").attr("name","").addClass("beingRemoved"),setTimeout(function(){f.fadeOut(600,function(){f.remove()})},400));e.append(b);this.showPreviewViaPost(a,c)};b.showPreviewViaPost=function(a,b){$('<form action="'+q(a.url)+'" method="post" target="'+q(b)+'"><input name="'+q(a.postName)+'" value="'+q(a.postValues)+'"/></form>').appendTo("body").hide().submit().remove()};b.showPreviewInPopoutBox=function(a,b){var k=this,c,f,h=this.pluginPreviewDetails(g,g,
a,b);h&&(this.previewValues=h.postValues,c=h.url+"&"+t(h.postName)+"="+t(h.postValues),c.length>=(d._bII()?2E3:4E3)&&(c="",f=function(){k.showPreviewViaPost(h,$("#cboxLoadedContent iframe")[0].name)}),$[E]({width:"95%",height:"90%",iframe:!0,preloading:!1,open:!0,title:this.previewSlotWidthInfo||x.preview,className:l+"plugin_preview_popout_box",href:c,onComplete:f}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};b.editModeOn=function(a){if(!this.tuix||!this.tuix.tabs)return!1;
a||(a=this.tuix.tab);return this.tuix.tabs[a].edit_mode?this.tuix.tabs[a].edit_mode.on=k(this.tuix.tabs[a].edit_mode.enabled)&&(k(this.tuix.tabs[a].edit_mode.on)||this.editModeAlwaysOn(a)):!1};b.editModeAlwaysOn=function(a){return this.tuix.tabs[a].edit_mode.always_on===g||k(this.tuix.tabs[a].edit_mode.always_on)||this.savedAndContinued(a)};b.editCancelEnabled=function(a){return this.tuix.tabs[a].edit_mode&&k(this.tuix.tabs[a].edit_mode.enabled)&&!this.editModeAlwaysOn(a)};b.revertEnabled=function(a){return this.tuix.tabs[a].edit_mode&&
k(this.tuix.tabs[a].edit_mode.enabled)&&this.editModeAlwaysOn(a)&&!this.savedAndContinued(a)&&(this.tuix.tabs[a].edit_mode.enable_revert===g&&this.tuix.key&&this.tuix.key.id||k(this.tuix.tabs[a].edit_mode.enable_revert))};b.savedAndContinued=function(a){return!1};b.editModeOnBox=function(){if(this.tuix&&this.tuix.tabs&&this.sortedTabs)for(var a in this.sortedTabs)if(u(this.sortedTabs,a)&&this.editModeOn(this.sortedTabs[a]))return!0;return!1};b.setData=function(a){this.setDataDiff(a)};b.sendStateToServer=
function(){return this.sendStateToServerDiff()};b.save=function(a,b,h){var c=this,f;this.loaded&&(f=this.getURL("save"))&&(this.saving||setTimeout(function(){c.saving=!0;c.differentTab=!0;c.loaded=!1;c.hideTab(!0);c.checkValues();var g={_save:!0,_confirm:a?1:"",_save_and_continue:b,_box:c.sendStateToServer()};k(c.tuix.download)||c.tuix.confirm&&k(c.tuix.confirm.download)?c.save2(d._nAA(c.getURL("save"),d._uR(g),!0),b,h):c.retryAJAX(f,g,!0,function(a){c.save2(a,b,h)},"saving")},100))};b.save2=function(a,
b,g){delete this.saving;var c=a&&a._sync&&a._sync.flags||{},f=m.init&&!w.zenarioOQuickMode&&!w.zenarioOSelectMode;c.close_with_message?(this.close(),f&&m._r(),h._sM(c.close_with_message)):c.reload_organizer&&f?(this.close(),h._rT(),p.uploading=!1,m._sWC("uploading",p.uploading),m._rePa()):c.open_admin_box&&B.init?(this.close(),B.open(c.open_admin_box)):c.go_to_url?(this.close(),h._rT(),d._gTU(d._aBP(c.go_to_url),!0)):c.valid?c.confirm?(this.load(a),this.sortTabs(),this.draw(),this.showConfirm(b,g)):
c.download?(this.get(l+"iframe_form").action=this.getURL("download"),this.get(l+"iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+q(this.sendStateToServer())+'"/>',this.get(l+"iframe_form").submit(),b&&(a=a.substr(15),this.load(a)),this.refreshParentAndClose(!0,b,g)):c.saved?(this.load(a),this.refreshParentAndClose(!1,b,g)):(this.close(),h._sM(a,!0,"error")):(this.load(a),this.sortTabs(),this.switchToATabWithErrors(),this.draw())};
b.showConfirm=function(a,b){if(this.tuix&&this.tuix.confirm&&k(this.tuix.confirm.show)){var d=this.tuix.confirm.message;k(this.tuix.confirm.html)||(d=q(d,!0));var c='<input type="button" class="submit_selected" value="'+this.tuix.confirm.button_message+'" onclick="'+this.globalName+".save(true, "+k(a)+", "+k(b)+');"/><input type="button" class="submit" value="'+this.tuix.confirm.cancel_button_message+'"/>';h._flBo(d,c,this.tuix.confirm.message_type||"none")}};b.stopPoking=function(){this.poking&&
clearInterval(this.poking);this.poking=!1};b.startPoking=function(){this.poking||(this.poking=setInterval(this.poke,12E4))};b.poke=function(){d._a(v+z+"admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF,zenarioABToolkit);
