zenario.lib(function(h,u,b,v,B,C,e,g,y,r,l,k,s,D,f,q,E,w,F,x,t,z,A){b=x(A);b.open=function(a,d,p,c,b,n,h,f){if(g._cIBIO("AdminOrganizer"))return!1;e._dS(this.globalName);d||(d={});a=(""+a).split("//",2);a[1]&&!d.id&&(d.id=a[1]);a=a[0];this.isOpen=!0;this.callBack=b;this.passMatchedIds=f;this.createAnotherObject=n;this.getRequestKey=d;this.changed={};this.isSlidUp=this.heightBeforeSlideUp=this.hasPreviewWindow=this.lastPreviewValues=this.previewValues=this.previewSlotWidth=!1;this.previewSlotWidthInfo=
"";this.previewHidden=!0;this.baseCSSClass=k.z+"fbAdmin zenario_admin_box zenario_fab_"+a;h||(b=this.microTemplate(this.mtPrefix,{}),this.openBox(b));v.onbeforeunload=g.onbeforeunload;this.start(a,d,p,c);return this.cb=new e.callback};b.openBox=function(a){};b.closeBox=function(){};b.initFields=function(){this.hasPreviewWindow=!!this.pluginPreviewDetails();x(z).initFields.call(this)};b.refreshParentAndClose=function(a,d,p){g._nDS(!1);var c={};d||(this.isOpen=!1);if(this.callBack&&!d){var b;(b=this.getValueArrayofArrays())&&
this.callBack(this.tuix.key,b)}else if(l.init&&(g.isFullOrganizerWindow||g._cIBIO("og"))){a=!1;if(this.tuix.key.id!==h)a=this.tuix.key.id;else for(var n in this.tuix.key)if(t(this.tuix.key,n)){a=this.tuix.key[n];break}l._rTSI(a,p&&w.createdAnother,!d&&w.savedButNotShown)}else e.cID&&this.tuix.key.slotName?(e._rPS(this.tuix.key.slotName,"",g.importantGetRequests),r.init&&r._i()):!e.cID||this.path!=k.z+"menu"&&this.path!=k.z+"menu_text"?a||d||(this.tuix.key.cID?(this.tuix.key.cID==e.cID&&this.tuix.key.cType==
e.cType&&(c=g.importantGetRequests),e._gTU(e._lTI(this.tuix.key.cID,this.tuix.key.cType,c))):r.init&&(c=_._cl(g.importantGetRequests),c.cVersion=e.cVersion,e._gTU(e._lTI(e.cID,e.cType,c)))):(g._rMP(),r.init&&r._i());a=this.tuix.popout_message;p=p&&this.createAnotherObject;d||p||(this.cb&&this.cb.call(),this.close());a&&g._sM(a,!0,!1);if(d){this.changed={};if(this.tuix.tabs)for(n in this.tuix.tabs)t(this.tuix.tabs,n)&&this.tuix.tabs[n]&&this.editModeOn(n)&&(this.tuix.tabs[n]._saved_and_continued=!0);
this.sortTabs();this.draw()}else p&&($(k.h+"abtab").clearQueue(),delete this.tuix,this.open(this.createAnotherObject.path,this.getRequestKey,this.createAnotherObject.tab,this.createAnotherObject.values,h,this.createAnotherObject,!0,this.passMatchedIds))};b.close=function(a){this.callFunctionOnEditors("remove");g._nDS(!1);this.sizing&&clearTimeout(this.sizing);this.stopPoking();e._cAD();a||g._cFB();this.closeBox();this.isOpen=!1;e._eS(this.globalName);delete this.cb;delete this.tuix;delete this.previewValues;
delete this.lastPreviewValues;delete this.previewSlotWidth;delete this.previewSlotWidthInfo;return!1};b.closeButton=function(a){var d=g._o();(d===h||!a&&confirm(d))&&this.isOpen&&this.close();return!1};b.draw=function(){this.isOpen&&this.loaded&&this.tabHidden&&this.draw2()};b.draw2=function(){if(this.tuix.tabs){this.get(k.z+"fbAdminFloatingBox").className=this.baseCSSClass+" "+(this.tuix.css_class||k.z+"fab_default_style")+" "+(f(this.tuix.hide_tab_bar)?k.z+"admin_box_with_tabs_hidden":k.z+"admin_box_with_tabs_shown");
var a=this.tuix;!a.tab||a.tabs[a.tab]&&!g._h(h,this,h,a.tab,h,h,h,h,a.tabs[a.tab])||(a.tab=!1);this.get(k.z+"fabTabs").innerHTML=this.drawTabs();var d=!this.editModeOnBox(),b="",b={isReadOnly:d};this.setTitle(d);this.showCloseButton();this.get(k.z+"fbButtons").innerHTML=this.microTemplate(this.mtPrefix+"_buttons",b);e._aJQE(k.h+"fbButtons ",!0);this.get(k.z+"fbAdminFloatingBox").style.display="block";this.size(!0);g._nDS(!1);d=new e.callback;b=this.drawFields(d);this.animateInTab(b,d,$(k.h+"abtab"));
this.shownTab=a.tab;delete this.lastScrollTop;this.startPoking()}};b.setTitle=function(a){};b.showCloseButton=function(){this.tuix.cancel_button_message?$(k.h+"fbAdminFloatingBox .zenario_fabClose").css("display","none"):$(k.h+"fbAdminFloatingBox .zenario_fabClose").css("display","block")};b.returnAJAXURL=function(a){return"start"==a&&this.passMatchedIds&&l.lastRequests?u+k.s+"admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+s(this.path)+"&path="+s(l.path)+e._uR(l.lastRequests)+e._uR(this.getRequestKey):
u+k.s+"admin/admin_boxes.ajax.php?path="+s(this.path)+e._uR(this.getRequestKey)};b.pluginPreviewDetails=function(a,d,b,c){var m=_._cl(g.importantGetRequests),n,h=!b;switch(this.path){case k.z+"skin_editor":h=!1;case "plugin_css_and_framework":b="overrideFrameworkAndCSS";n=JSON.stringify(this.getValues1D(!1,!0,!1,!0,!0));break;case "plugin_settings":b="overrideSettings";n=JSON.stringify(this.getValues1D(!0,!1));break;default:return!1}m.cVersion=e.cVersion;a=a||this.tuix&&this.tuix.key&&this.tuix.key.slotName;
d=d||this.tuix&&this.tuix.key&&this.tuix.key.instanceId||e.slots&&e.slots[a]&&e.slots[a].instanceId;if(h){if(!a||!d)return!1;var f=g._gGSD(a),l,h=f&&f.cssClass&&f.cssClass.split(" ")||[];m.method_call="showSingleSlot";m.fakeLayout=1;m.grid_columns=f.columns;m.grid_container=f.container;this.previewSlotWidth=f.pxWidth;this.previewSlotWidthInfo=f.widthInfo;m.grid_pxWidth=this.previewWidth&&!c?this.previewWidth:this.previewSlotWidth;m.grid_cssClass="";for(l in h)t(h,l)&&(c=h[l],"alpha"==c||"omega"==
c||c.match(/^span[\d_]*$/)||(m.grid_cssClass+=c+" "))}else m._show_page_preview=1;a&&(m.slotName=a);d&&(m.instanceId=d);return{url:e._lTI(e.cID,e.cType,m),postName:b,postValues:n}};b.addExtraAttsForTextFields=function(a,d){this.hasPreviewWindow&&(d.onkeyup=(d.onkeyup||"")+" "+this.globalName+".updatePreview();")};b.fieldChange=function(a,d){this.updatePreview(750);x(z).fieldChange.call(this,a,d)};b.updatePreview=function(a){var d=this;this.hasPreviewWindow&&!this.previewHidden&&e._aADINS("fabUpdatePreview",
function(){var a=d.pluginPreviewDetails();a&&d.lastPreviewValues!=a.postValues&&(d.lastPreviewValues=d.previewValues=a.postValues,d.submitPreview(a,k.z+"fabPreviewFrame"))},a||1E3)};b.submitPreview=function(a,d){$('<form action="'+q(a.url)+'" method="post" target="'+q(d)+'"><input name="'+q(a.postName)+'" value="'+q(a.postValues)+'"/></form>').appendTo("body").hide().submit().remove()};b.showPreviewInPopoutBox=function(a,d){var b,c,g=this,f=this.pluginPreviewDetails(h,h,a,d);f&&(this.previewValues=
f.postValues,b=f.url+"&"+s(f.postName)+"="+s(f.postValues),b.length>=(e._bII()?2E3:4E3)&&(b="",c=function(){g.submitPreview(f,$("#cboxLoadedContent iframe").attr("name"))}),$[k.x]({width:"95%",height:"90%",iframe:!0,preloading:!1,open:!0,title:this.previewSlotWidthInfo||w.preview,className:k.z+"plugin_preview_popout_box",href:b,onComplete:c}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};b.editModeOn=function(a){if(!this.tuix||!this.tuix.tabs)return!1;a||(a=this.tuix.tab);return this.tuix.tabs[a].edit_mode?
this.tuix.tabs[a].edit_mode.on=f(this.tuix.tabs[a].edit_mode.enabled)&&(f(this.tuix.tabs[a].edit_mode.on)||this.editModeAlwaysOn(a)):!1};b.editModeAlwaysOn=function(a){return this.tuix.tabs[a].edit_mode.always_on===h||f(this.tuix.tabs[a].edit_mode.always_on)||this.savedAndContinued(a)};b.editCancelEnabled=function(a){return this.tuix.tabs[a].edit_mode&&f(this.tuix.tabs[a].edit_mode.enabled)&&!this.editModeAlwaysOn(a)};b.revertEnabled=function(a){return this.tuix.tabs[a].edit_mode&&f(this.tuix.tabs[a].edit_mode.enabled)&&
this.editModeAlwaysOn(a)&&!this.savedAndContinued(a)&&(this.tuix.tabs[a].edit_mode.enable_revert===h&&this.tuix.key&&this.tuix.key.id||f(this.tuix.tabs[a].edit_mode.enable_revert))};b.savedAndContinued=function(a){return!1};b.editModeOnBox=function(){if(this.tuix&&this.tuix.tabs&&this.sortedTabs)for(var a in this.sortedTabs)if(t(this.sortedTabs,a)&&this.editModeOn(this.sortedTabs[a]))return!0;return!1};b.setData=function(a){this.setDataDiff(a)};b.sendStateToServer=function(){return this.sendStateToServerDiff()};
b.save=function(a,b,g){var c=this,k;this.loaded&&(k=this.getURL("save"))&&(this.saving||setTimeout(function(){c.saving=!0;c.differentTab=!0;c.loaded=!1;c.hideTab(!0);c.checkValues();var h={_save:!0,_confirm:a?1:"",_save_and_continue:b,_box:c.sendStateToServer()};f(c.tuix.download)||c.tuix.confirm&&f(c.tuix.confirm.download)?c.save2(e._nAA(c.getURL("save"),e._uR(h),!0),b,g):c.retryAJAX(k,h,!0,function(a){c.save2(a,b,g)},"saving")},100))};b.save2=function(a,b,f){delete this.saving;var c=a&&a._sync&&
a._sync.flags||{},h=l.init&&!v.zenarioOQuickMode&&!v.zenarioOSelectMode;c.close_with_message?(this.close(),h&&l._r(),g._sM(c.close_with_message)):c.reload_organizer&&h?(this.close(),g._rT(),g.uploading=!1,l._sWC("uploading",g.uploading),l._rePa()):c.open_admin_box&&y.init?(this.close(),y.open(c.open_admin_box)):c.go_to_url?(this.close(),g._rT(),e._gTU(e._aBP(c.go_to_url),!0)):c.valid?c.confirm?(this.load(a),this.sortTabs(),this.draw(),this.showConfirm(b,f)):c.download?(this.get(k.z+"iframe_form").action=
this.getURL("download"),this.get(k.z+"iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+q(this.sendStateToServer())+'"/>',this.get(k.z+"iframe_form").submit(),b&&(a=a.substr(15),this.load(a)),this.refreshParentAndClose(!0,b,f)):c.saved?(this.load(a),this.refreshParentAndClose(!1,b,f)):(this.close(),g._sM(a,!0,"error")):(this.load(a),this.sortTabs(),this.switchToATabWithErrors(),this.draw())};b.showConfirm=function(a,b){if(this.tuix&&
this.tuix.confirm&&f(this.tuix.confirm.show)){var e=this.tuix.confirm.message;f(this.tuix.confirm.html)||(e=q(e,!0));var c='<input type="button" class="submit_selected" value="'+this.tuix.confirm.button_message+'" onclick="'+this.globalName+".save(true, "+f(a)+", "+f(b)+');"/><input type="button" class="submit" value="'+this.tuix.confirm.cancel_button_message+'" onclick="zenarioA._cFB();"/>';g._flBo(e,c,this.tuix.confirm.message_type||"none")}};b.stopPoking=function(){this.poking&&clearInterval(this.poking);
this.poking=!1};b.startPoking=function(){this.poking||(this.poking=setInterval(this.poke,12E4))};b.poke=function(){e._a(u+k.s+"admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF,zenarioABToolkit);
