zenario.lib(function(p,e,u,v,w,x,r,k,y,z,A,B,C,D,E,F,G,s,t,l,q){e=t(q.admin_box_builder=s(q.form_builder_base_class));e.init=function(){this.saveChangesWarningMessage="You are currently editing this dataset. If you leave now you will lose any unsaved changes.";this.changingForm=!1;this.formatOnChange="values_source is_protected required validation show_in_organizer create_index admin_box_visibility".split(" ");this.formEditorSelector="#organizer_admin_form_builder";this.formFieldsSelector="#organizer_form_sections .form_field";
this.formFieldInlineButtonsSelector="#organizer_form_sections .form_field_inline_buttons";this.saveButtonText="Save changes";this.cancelButtonText="Reset"};e.getOrderedItems=function(a){var b,d,c,f,g,h,e,n,m,k=[];for(b in a)if(l(a,b)&&(d=a[b],!d.remove)){c=_.clone(d);if(c.fields){h=[];for(f in c.fields)if(l(c.fields,f)&&(g=c.fields[f],!d.remove)){g=_.clone(g);if(g.lov){m=[];for(e in g.lov)l(g.lov,e)&&(n=g.lov[e],n.remove||m.push(n));m.sort(this.sortByOrd);g.lov=m}h.push(g)}h.sort(this.sortByOrd);
c.fields=h}else if(c.lov){m=[];for(e in c.lov)l(c.lov,e)&&(n=c.lov[e],n.remove||m.push(n));m.sort(this.sortByOrd);c.lov=m}k.push(c)}k.sort(this.sortByOrd);return k};e.showPanel=function(a,b,d){a.html("").hide();this.changesSaved&&(this.changesSaved=!1,k.toast({message_type:"success",message:"Your changes have been saved!"}));var c=this,f=_.clone(this.tuix.items);a={items:{},field:{},tab:{},details_section:"field_type_list",dataset_label:this.tuix.dataset_label};this.currentFieldTab=this.currentFieldTab?
this.currentFieldTab:"details";this.currentTab=this.currentTab?this.currentTab:!1;this.currentTabOrd=this.currentTabOrd?this.currentTabOrd:0;this.currentTab&&(a.items=this.getOrderedItems(f),this.tuix.items[this.currentTab]||(this.currentTabOrd!==p&&a.items[this.currentTabOrd]?(this.currentTab=a.items[this.currentTabOrd].name,this.current&&"tab"==this.current.type&&(this.current.id=a.items[this.currentTabOrd].name)):this.currentTab=this.current=!1),this.current&&("field"==this.current.type&&!this.tuix.items[this.currentTab].fields[this.current.id]&&
this.currentFieldOrd!==p&&this.currentTabOrd!==p&&a.items[this.currentTabOrd]&&a.items[this.currentTabOrd].fields[this.currentFieldOrd]&&(this.current.id=a.items[this.currentTabOrd].fields[this.currentFieldOrd].id),"field"==this.current.type?(a.details_section="field_details",a.field=this.getCurrentFieldDetailsMergeFields(),f[this.currentTab].fields[this.current.id].selected=!0):"tab"==this.current.type&&(a.details_section="tab_details",a.tab=this.getCurrentTabDetailsMergeFields(),f[this.currentTab].selected=
!0)));a.items=this.getOrderedItems(f);a.use_groups_field=this.tuix.use_groups_field;f=k.microTemplate("zenario_organizer_admin_box_builder",a);b.html(f).show();this.current?"field"==this.current.type?this.initCurrentFieldDetails():"tab"==this.current.type&&this.initCurrentTabDetails():this.current={id:!1,type:!1};b=!1;this.maxNewCustomFieldValue=this.maxNewCustomField=this.maxNewCustomTab=1;this.current_db_columns=this.tuix.existing_db_columns;this.deleting=!1;for(var g in a.items)if(l(a.items,g)){var f=
a.items[g],h=$("#organizer_form_tab_"+f.name);$section=$("#organizer_section_"+f.name);this.initTab(h);this.initSection($section);!1!=this.currentTab?f.name!=this.currentTab?$section.hide().sortable("disable"):h.addClass("on"):1!=f.ord?$section.hide().sortable("disable"):(h.addClass("on"),b=f.name)}b&&(this.currentTab=b);$("#organizer_field_type_list div.field_type, #organizer_centralised_field_type_list div.field_type").draggable({connectToSortable:"#organizer_form_sections div.form_section",helper:"clone"});
$("#organizer_form_tabs").sortable({axis:"x",containment:"parent",items:"div.sort",start:function(a,b){c.startIndex=b.item.index()},stop:function(a,b){c.startIndex!=b.item.index()&&("tab"==c.current.type&&(c.currentTabOrd=$("#organizer_form_tab_"+c.current.id).index()),c.changeMadeToPanel())}});$("#organizer_add_new_tab").on("click",function(){var a=function(a){_.isEmpty(a)&&c.addNewTab()};(cb=c.validate())?cb.after(a):a([])});$("#organizer_form_sections div.form_field").on("click",function(){c.fieldClick($(this))});
this.initDeleteButtons();d.html("").show()};e.initDeleteButtons=function(){var a=this;$("#organizer_form_sections .delete_icon").off().on("click",function(b){a.deleting="field";var d=$(this).data("id"),c="",f="",g=!0;a.tuix.items[a.currentTab].fields[d].is_protected?(c="<p>This field is protected, and might be important to your site!</p>",c+="<p>If you're sure you want to delete this field then first unprotect it.</p>",k.showMessage(c,g,"warning",!0),a.listenForDelete(d),b.stopPropagation()):a.sendAJAXRequest({mode:"get_field_record_count",
field_id:d}).after(function(h){h=JSON.parse(h);g="Delete";h.record_count&&1<=h.record_count?(f=1==h.record_count?"":"s",c="<p>This field contains data on "+h.record_count+" record"+f+".</p>",c+="<p>When you save changes to this dataset, that data will be deleted.</p>"):c="<p>This field doesn't contain any data for any user/contact records.</p>";c+="<p>Delete this dataset field?</p>";k.showMessage(c,g,"warning",!0);a.listenForDelete(d);b.stopPropagation()})})};e.listenForDelete=function(a){var b=this;
$("#zenario_fbMessageButtons input.submit_selected").on("click",function(){setTimeout(function(){"tab"==b.deleting?b.deleteTab():(b.deleting="field")&&b.deleteField(a);b.deleting=!1})})};e.deleteTab=function(){var a,b;this.tuix.items[this.current.id]={remove:!0};a=$("#organizer_form_tab_"+this.current.id);b=a.prev();0==b.length&&(b=a.next());a.remove();this.changeMadeToPanel();1==b.length&&this.tabClick(b)};e.deleteField=function(a){var b=this,d,c;a===p&&(a=this.current.id);if(!this.tuix.items[this.currentTab].fields[a]||
0==this.tuix.items[this.currentTab].fields[a].is_system_field)if(this.tuix.items[this.currentTab].fields[a]={remove:!0},d=$("#organizer_form_field_"+a))c=this.selectNextField(d),this.changeMadeToPanel(),d.animate({height:0,opacity:0},500,function(){d.remove();!1===c&&b.showNoFieldsMessage()})};e.selectNextField=function(a){for($next=a.prev();1==$next.length;)if(this.tuix.items[this.currentTab].fields[$next.data("id")]&&this.tuix.items[this.currentTab].fields[$next.data("id")].remove)$next=$next.prev();
else break;if(0==$next.length)for($next=a.next();1==$next.length;)if(this.tuix.items[this.currentTab].fields[$next.data("id")]&&this.tuix.items[this.currentTab].fields[$next.data("id")].remove)$next=$next.next();else break;return 1==$next.length?(this.fieldClick($next),$next):!1};e.showNoFieldsMessage=function(){$("#organizer_section_"+this.currentTab).addClass("empty").html('<span class="no_fields_message">There are no fields on this tab</span>');this.showDetailsSection("organizer_field_type_list")};
e.addNewTab=function(){var a="__custom_tab_t"+this.maxNewCustomTab++,b={name:a,label:"Untitled tab"},d=k.microTemplate("zenario_organizer_admin_box_builder_tab",b);$("#organizer_add_new_tab").before(d);this.tuix.items[a]={label:"Untitled tab",is_new_tab:!0,is_system_field:0,fields:{}};d=k.microTemplate("zenario_organizer_admin_box_builder_section",b);$("#organizer_form_sections").append(d);b=$("#organizer_section_"+a);this.initSection(b);a=$("#organizer_form_tab_"+a);this.initTab(a);this.tabClick(a);
this.changeMadeToPanel()};e.initTab=function(a){var b=this;a.on("click",function(){b.tabClick($(this))});a.droppable({accept:"div.form_field:not(.system_field)",greedy:!0,hoverClass:"ui-state-hover",tolerance:"pointer",drop:function(a,c){var f=$(this).data("name"),g=$(c.draggable).data("id"),h=function(a){_.isEmpty(a)?f!=b.currentTab&&setTimeout(function(){$(c.draggable).detach().appendTo("#organizer_section_"+f);"field"==b.current.type&&b.current.id==g&&b.unselectField();b.tuix.items[f].fields[g]=
b.tuix.items[b.currentTab].fields[g];delete b.tuix.items[b.currentTab].fields[g];"field"==b.current.type&&(b.current={type:"tab",id:b.currentTab},b.tabClick($("#organizer_form_tab_"+b.currentTab)));0==_.size(b.tuix.items[b.currentTab].fields)&&b.showNoFieldsMessage();b.removeNoItemsMessage(f);b.changeMadeToPanel()}):(a=$("#organizer_form_field_"+g),b.fieldClick(a))};b.save();(cb=b.validate())?cb.after(h):h([])}})};e.initSection=function(a){var b=this;a.sortable({items:"div.form_field",placeholder:"preview",
receive:function(a,c){$(this).find("div.field_type").each(function(){b.addNewField($(this))})},start:function(a,c){b.startIndex=c.item.index()},stop:function(a,c){b.startIndex!=c.item.index()&&("field"==b.current.type&&(b.currentFieldOrd=$("#organizer_form_field_"+b.current.id).index()),b.changeMadeToPanel())}})};e.removeNoItemsMessage=function(a){$("#organizer_section_"+a).removeClass("empty").find("span.no_fields_message").remove()};e.addNewField=function(a){var b="t"+this.maxNewCustomField++,d=
a.data("type"),c={id:b,type:d,label:"Untitled"},f="";this.removeNoItemsMessage(this.currentTab);if(-1<$.inArray(d,["checkboxes","radios","select"])){c.lov={};for(var g=1;3>=g;g++){var h="t"+this.maxNewCustomFieldValue++;c.lov[h]={is_new_value:!0,id:h,ord:g,label:"Option "+g}}}if("centralised_radios"==d||"centralised_select"==d){for(method in this.tuix.centralised_lists.values)if(l(this.tuix.centralised_lists.values,method)){f=method;break}c.lov=_.toArray(this.tuix.centralised_lists.initial_lov)}mergeFields=
_.clone(c);c.lov&&(mergeFields.lov=this.getOrderedItems(c.lov));d=k.microTemplate("zenario_organizer_admin_box_builder_field",mergeFields);a.replaceWith(d);$.extend(c,{is_protected:0,include_in_export:0,is_new_field:!0,just_added:!0,db_column:"",is_system_field:0,validation:"none",required:0,show_in_organizer:0,create_index:0,organizer_visibility:"",values_source:f,values_source_filter:"",remove:!1});this.tuix.items[this.currentTab].fields[b]=c;a=$("#organizer_form_field_"+b);a.effect({effect:"highlight",
duration:1E3});this.initField(a);this.fieldClick(a)};e.tabClick=function(a){var b=this,d=function(c){_.isEmpty(c)&&($("#organizer_section_"+b.currentTab).sortable("disable"),b.unselectField(),b.currentTab=a.data("name"),b.currentTabOrd=a.index(),b.current={id:b.currentTab,type:"tab"},$("#organizer_section_"+b.currentTab).sortable("enable"),$("#organizer_form_tabs div.tab").removeClass("on"),a.addClass("on"),$("#organizer_form_sections div.form_section").hide(),b.setCurrentTabDetails(),b.tuix.items[b.currentTab]&&
1==b.tuix.items[b.currentTab].is_system_field?$("#organizer_remove_form_tab").hide():$("#organizer_remove_form_tab").show(),b.showDetailsSection("organizer_tab_details"),$("#organizer_section_"+b.currentTab).show())};this.save();(cb=this.validate())?cb.after(d):d([])};e.setCurrentTabDetails=function(){var a=this.getCurrentTabDetailsMergeFields(),a=k.microTemplate("zenario_organizer_admin_box_builder_tab_details",a);$("#organizer_tab_details_outer").html(a);this.initCurrentTabDetails()};e.getCurrentTabDetailsMergeFields=
function(){var a=this.tuix.items[this.currentTab]||{},b=_.clone(a),d={};for(tabName in this.tuix.items)if(l(this.tuix.items,tabName)){tabDetails=this.tuix.items[tabName];var c={};for(fieldID in tabDetails.fields)l(tabDetails.fields,fieldID)&&(fieldDetails=tabDetails.fields[fieldID],"group"===fieldDetails.type||"checkbox"===fieldDetails.type)&&(c[fieldID]={ord:fieldDetails.ord,label:fieldDetails.label});d[tabName]={label:tabDetails.label,ord:tabDetails.ord,childOptions:c}}b.parent_field_id_options=
this.createSelectList(d,a.parent_field_id," -- No conditional display --",!0);return b};e.initCurrentTabDetails=function(){var a=this;$("#organizer_tab_details :input").off().on("change",function(){a.changeMadeToPanel()});$('#organizer_tab_details input[type="text"], #organizer_tab_details textarea').on("keyup",function(){a.changeMadeToPanel()});$("#tab__label").on("keyup",function(){$("#organizer_form_tab_"+a.currentTab+" span, #zenario_tab_details_header_content h5").text($(this).val())});$("#organizer_remove_form_tab").on("click",
function(){0==a.tuix.items[a.current.id].is_system_field&&(a.deleting="tab",k.showMessage("Are you sure you want to delete this Tab?<br><br>All fields on this tab will also be deleted.","Delete","warning",!0),a.listenForDelete())});this.initAddNewFieldsButton()};e.getCurrentTabDetails=function(){var a={};$.each($("#organizer_tab_details_form").serializeArray(),function(b,d){a[d.name]=d.value});return a};e.fieldClick=function(a){var b=this,d=function(c){_.isEmpty(c)&&(c=a.data("id"),b.current={type:"field",
id:c},b.currentFieldOrd=a.index(),$(b.formFieldsSelector).removeClass("selected"),a.addClass("selected"),b.currentFieldTab="details",b.setCurrentFieldDetails(),$(b.formFieldInlineButtonsSelector).hide(),$("#organizer_form_field_inline_buttons_"+b.current.id).show(),b.showDetailsSection("organizer_field_details"))};this.save();(cb=this.validate())?cb.after(d):d([])};e.setCurrentFieldDetails=function(){var a=this.getCurrentFieldDetailsMergeFields(),a=k.microTemplate("zenario_organizer_admin_box_builder_field_details",
a);$("#organizer_field_details_outer").html(a);this.initCurrentFieldDetails()};e.getCurrentFieldDetailsMergeFields=function(){var a=_.clone(this.tuix.items[this.currentTab].fields[this.current.id]||{});a.currentFieldTab=this.currentFieldTab;a.dataset_label=this.tuix.dataset_label;a.is_text_field=-1<$.inArray(a.type,["date","editor","text","textarea","url"]);a.is_checkbox_field=-1<$.inArray(a.type,["group","checkbox"]);a.is_list_field=-1<$.inArray(a.type,["checkboxes","radios","centralised_radios",
"select","centralised_select"]);a.cannot_export=-1<$.inArray(a.type,["editor","textarea","file_picker"]);switch(a.type){case "group":a.formattedType="Group";break;case "checkbox":a.formattedType="Checkbox";break;case "checkboxes":a.formattedType="Checkboxes";break;case "date":a.formattedType="Date";break;case "editor":a.formattedType="Editor";break;case "radios":a.formattedType="Radios";break;case "centralised_radios":a.formattedType="Centralised radios";break;case "select":a.formattedType="Select";
break;case "centralised_select":a.formattedType="Centralised select";break;case "text":a.formattedType="Text";break;case "textarea":a.formattedType="Textarea";break;case "url":a.formattedType="URL";break;case "other_system_field":a.formattedType="Other system field";break;case "dataset_select":a.formattedType="Dataset select";break;case "dataset_picker":a.formattedType="Dataset picker";break;case "file_picker":a.formattedType="File picker";break;default:a.formattedType="Unknown"}a.is_system_field&&
(a.formattedType+=", system field");var b={},d=1,c,f;for(c in this.tuix.centralised_lists.values)l(this.tuix.centralised_lists.values,c)&&(f=this.tuix.centralised_lists.values[c],b[c]={ord:d++,label:f.label});a.values_source_options=this.createSelectList(b,a.values_source);this.tuix.centralised_lists.values[a.values_source]&&this.tuix.centralised_lists.values[a.values_source].info.can_filter&&(a.show_source_filter=!0,a.source_filter_label=this.tuix.centralised_lists.values[a.values_source].info.filter_label);
a.dataset_foreign_key_id_options=this.createSelectList(this.tuix.datasets,a.dataset_foreign_key_id);b={};for(tabName in this.tuix.items)if(l(this.tuix.items,tabName)){tab=this.tuix.items[tabName];d={};for(fieldID in tab.fields)l(tab.fields,fieldID)&&(fieldDetails=tab.fields[fieldID],"group"===fieldDetails.type||"checkbox"===fieldDetails.type)&&(d[fieldID]={ord:fieldDetails.ord,label:fieldDetails.label});b[tabName]={label:tab.label,ord:tab.ord,childOptions:d}}a.parent_id_options=this.createSelectList(b,
a.parent_id," -- Select --",!0);a.width_options=this.createSelectList({1:{ord:1,label:"1 character (em)"},5:{ord:2,label:"5 characters (em)"},10:{ord:3,label:"10 characters (em)"},25:{ord:4,label:"25 characters (em)"},40:{ord:5,label:"40 characters (em)"},56:{ord:6,label:"56 characters (em)"}},a.width," -- Default width -- ");a.height_options=this.createSelectList({3:{ord:1,label:"3 rows"},5:{ord:2,label:"5 rows"},10:{ord:3,label:"10 rows"},20:{ord:4,label:"20 rows"}},a.height," -- Default rows -- ");
a.admin_box_visibility_options=this.createSelectList({show:{ord:1,label:"Show"},show_on_condition:{ord:2,label:"Show on condition"},hide:{ord:3,label:"Hide"}},a.admin_box_visibility);a.store_file_options=this.createRadioList({in_docstore:{ord:1,label:"Docstore"},in_database:{ord:2,label:"Database"}},a.store_file,"store_file");b=a.is_system_field?!0:!1;a.validation_options=this.createRadioList({none:{ord:1,label:"None"},email:{ord:2,label:"Email"},emails:{ord:3,label:"Multiple emails"},no_spaces:{ord:4,
label:"No spaces allowed"},numeric:{ord:5,label:"Numeric"},screen_name:{ord:6,label:"Screen name"}},a.validation,"validation",b);a.create_index_options=this.createRadioList({0:{ord:1,label:"Don't index"},1:{ord:2,label:"Index"}},a.create_index,"create_index",b);a.show_searchable_field=a.is_text_field?a.show_in_organizer:a.show_in_organizer&&a.create_index;a.organizer_visibility_options=this.createSelectList({1:{ord:1,label:"Show by default"},2:{ord:1,label:"Always show"}},a.organizer_visibility,"Hide by default");
a.showDetailsTab=!0;a.showValidationTab="other_system_field"!=a.type;a.showOrganizerTab="other_system_field"!=a.type;a.showValuesTab="other_system_field"!=a.type&&-1!=$.inArray(a.type,["select","radios","checkboxes","centralised_radios","centralised_select"]);return a};e.initCurrentFieldDetails=function(){for(var a=this,b=this.tuix.items[this.currentTab].fields[this.current.id]||{},d="",c=0;c<this.formatOnChange.length;c++)0!=c&&(d+=", "),d+="#field_container__"+this.formatOnChange[c]+" :input";$(d).on("change",
function(){a.formatFieldDetails()});$("#organizer_field_details :input").on("change",function(){a.changeMadeToPanel()});$('#organizer_field_details input[type="text"], #organizer_field_details textarea').on("keyup",function(){a.changeMadeToPanel()});$("#field__label").on("keyup",function(){$("#organizer_form_field_"+a.current.id+" .label, #zenario_field_details_header_content h5").text($(this).val());if(b.just_added){var c=$(this).val().toLowerCase().replace(/[\s-]+/g,"_").replace(/[^a-z_0-9]/g,"");
$("#field__db_column").val(c)}});$("#field__note_below").on("keyup",function(){var b=$(this).val(),c=$("#organizer_form_field_note_below_"+a.current.id);$("#organizer_form_field_note_below_"+a.current.id+" div.zenario_note_content").html(b);c.toggle(""!==b)});$("#field__side_note").on("keyup",function(){var b=$(this).val(),c=$("#organizer_form_field_side_note_"+a.current.id);$("#organizer_form_field_side_note_"+a.current.id+" div.zenario_note_content").html(b);c.toggle(""!==b)});d={min:0,max:5,slide:function(b,
c){var d=$("#organizer_form_field_"+a.current.id),f=d.prop("class").split(/\s+/),e;for(e=0;e<f.length;e++)if(0<=f[e].lastIndexOf("zenario_indent_level_",0)){d.removeClass(f[e]);break}0<c.value?d.addClass("zenario_indent_level zenario_indent_level_"+c.value):d.removeClass("zenario_indent_level")},change:function(b,c){a.changeMadeToPanel();$("#field__indent").val(c.value)}};b.indent&&(d.value=b.indent);$("#field__indent_slider").slider(d);$("#field_container__values_source :input").on("change",function(){$("#field_container__values_source_filter :input").val("");
var b=$(this).val();a.updateCentralisedRadioValues(a.current.id,b,"")});var f=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}();$("#field_container__values_source_filter :input").on("keyup",function(){var b=$("#field_container__values_source :input").val(),c=$(this).val();f(function(){a.updateCentralisedRadioValues(a.current.id,b,c)},1E3)});d=this.getOrderedItems(b.lov);d=k.microTemplate("zenario_organizer_admin_box_builder_field_value",d);$("#field_values_list").html(d).sortable({axis:"y",
start:function(b,c){a.startIndex=c.item.index()},stop:function(c,d){a.startIndex!=d.item.index()&&(a.save(),a.setCurrentFieldValues(b),a.changeMadeToPanel())}});this.initFieldValues(b);this.initAddNewFieldValuesButton(b);this.initAddNewFieldsButton()};e.updateCentralisedRadioValues=function(a,b,d){this.sendAJAXRequest({mode:"get_centralised_lov",method:b,filter:d}).after(function(b){b=JSON.parse(b);b=k.microTemplate("zenario_organizer_admin_box_builder_radio_values_preview",b);$("#organizer_form_field_values_"+
a).html(b)})};e.getCurrentFieldDetails=function(){var a={},b=this.tuix.items[this.currentTab].fields[this.current.id];$.each($("#organizer_field_details_form").serializeArray(),function(b,c){a[c.name]=c.value});$("#organizer_field_details_form input[type=checkbox]").map(function(b,c){a[c.name]=c.checked?1:0});-1==["select","radios","checkboxes"].indexOf(b.type)||b.field_id||(a.lov=this.getCurrentFieldValues(b));a.create_index&&(a.create_index=parseInt(a.create_index));return a};e.save=function(){var a,
b,d={};if(this.current.id&&this.current.type)if("tab"==this.current.type)for(a in d=this.getCurrentTabDetails(),this.tuix.items[this.current.id]||(this.tuix.items[this.current.id]={}),d)l(d,a)&&(b=d[a],this.tuix.items[this.current.id][a]=b);else if("field"==this.current.type)for(a in d=this.getCurrentFieldDetails(),this.tuix.items[this.currentTab].fields[this.current.id]||(this.tuix.items[this.currentTab].fields[this.current.id]={}),d)l(d,a)&&(b=d[a],this.tuix.items[this.currentTab].fields[this.current.id][a]=
b)};e.validate=function(){var a=this,b=new r.callback,d={mode:"validate",id:this.current.id,type:this.current.type,tab:this.currentTab,field_tab:this.currentFieldTab,items:JSON.stringify(this.tuix.items)};if(this.current.id&&this.current.type)if("tab"==this.current.type){if(!this.tuix.items[this.currentTab].remove)return this.sendAJAXRequest(d).after(function(c){c=JSON.parse(c);$("#organizer_tab_field_error").remove();if(0<c.length){var d=$('<div id="organizer_tab_field_error"></div>');for(index in c)l(c,
index)&&(message=c[index],d.append('<p class="error">'+message+"</p>"));$("#organizer_tab_details").prepend(d);a.shakeBox("#organizer_admin_form_builder .form_fields_palette")}else a.tuix.items[a.currentTab].just_added&&delete a.tuix.items[a.currentTab].just_added;b.call(c)}),b}else if("field"==this.current.type&&!this.tuix.items[this.currentTab].fields[this.current.id].remove)return this.sendAJAXRequest(d).after(function(c){c=JSON.parse(c);$("#organizer_form_field_error").remove();if(0<c.length){var d=
$('<div id="organizer_form_field_error"></div>');for(index in c)l(c,index)&&(message=c[index],d.append('<p class="error">'+message+"</p>"));$("#organizer_field_details").prepend(d);a.shakeBox("#organizer_admin_form_builder .form_fields_palette")}else a.tuix.items[a.currentTab].fields[a.current.id].just_added&&delete a.tuix.items[a.currentTab].fields[a.current.id].just_added;b.call(c)}),b;return!1};e.saveItemsOrder=function(){var a=this;$("#organizer_form_tabs div.tab.sort").each(function(b,d){var c=
$(d).data("name");a.tuix.items[c].ord=b+1;$("#organizer_section_"+c+" .form_field").each(function(b,d){var e=$(d).data("id");a.tuix.items[c].fields[e].ord=b+1;a.tuix.items[c].fields[e].tab_name=c})})}},zenarioO.panelTypes);
