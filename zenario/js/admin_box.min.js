zenario.lib(function(h,A,L,F,M,N,g,p,a,J,H,k,n,r,x,I,C,O,P,K){a.init=!0;a.welcome=!1;a.baseCSSClass="";a.onKeyUpNum=0;a.sizing=!1;a.documentScrollTop=!1;a.cachedAJAXSnippets={};a.getKey=function(b){return a.tuix.key};a.getKeyId=function(b){return a.tuix&&a.tuix.key?a.tuix.key.id:!1};a.getLastKeyId=function(b){return a.getKeyId(b)};a.openSiteSettings=function(b,c){a.open("site_settings",{id:b},c,h,function(){H.reloadPage()})};a.enableOrDisableSite=function(){a.open("zenario_enable_site",h,h,h,function(){H.reloadPage()})};
a.open=function(b,c,d,f,e,l){if(p.checkIfBoxIsOpen("AdminOrganizer"))return!1;a.templatePrefix=l||"zenario_admin_box";!1===a.documentScrollTop&&(a.documentScrollTop=$(g.browserIsSafari()?"body":"html").scrollTop());c||(c={});b=(""+b).split("//",2);b[1]&&!c.id&&(c.id=b[1]);b=b[0];a.isOpen=!0;a.callBack=e;a.getRequestKey=c;a.changed={};a.SKColPicker=!1;e=p.microTemplate(a.templatePrefix,{});a.baseCSSClass="zenario_fbAdmin zenario_admin_box zab_"+b;p.openBox(e,a.baseCSSClass,"AdminFloatingBox"+K,!1,
800,50,2,!0,!0,".zenario_jqmHead",!1);k("zenario_fbAdminFloatingBox").style.display="none";F.onbeforeunload=p.onbeforeunload;a.start(b,c,d,f)};a.start=function(b,c,d,f){a.tabHidden=!0;a.differentTab=!1;a.path=x(b,"");a.tuix={};a.focus=a.tuix;a.key=x(c,{});a.tab=d;a.shownTab=!1;a.url=a.getURL();$.post(a.url,{_fill:!0,_values:f?JSON.stringify(f):""},function(b){a.load(b)?(a.tab&&(a.tuix.tab=a.tab),delete a.key,delete a.tab,a.sortTabs(),a.initFields(),a.draw()):a.close(!0)},"text")};a.load=function(b){a.loaded=
!0;if(!(b=p.readData(b)))return!1;a.callFunctionOnEditors("isDirty")&&a.markAsChanged();a.callFunctionOnEditors("remove");a.welcome?(a.tuix=b,a.focus=a.tuix):a.syncAdminBoxFromServerToClient(b,a.tuix);return!a.tuix||!a.tuix.tabs&&a.tuix._location===h?(p.showMessage(C.couldNotOpenBox,!0,"error"),!1):!0};a.initFields=function(){var b,c,d;if(a.tuix.tabs)for(b in a.tuix.tabs)if(g.has(a.tuix.tabs,b)&&!a.isInfoTag(b)&&a.tuix.tabs[b]&&a.tuix.tabs[b].fields)for(c in a.tuix.tabs[b].fields)g.has(a.tuix.tabs[b].fields,
c)&&!a.isInfoTag(c)&&(d=a.tuix.tabs[b].fields[c])&&(d.pick_items&&d.plugin_setting&&d.plugin_setting.use_value_for_plugin_name?a.pickedItemsArray(c,a.value(c,b,!1)):d.load_values_from_organizer_path&&!d.values&&a.loadValuesFromOrganizerPath(d))};a.loadValuesFromOrganizerPath=function(b){var c,d;if(b.load_values_from_organizer_path&&!b.values&&(b.values={},(d=p.getSKItem(b.load_values_from_organizer_path))&&d.items))for(c in d.items)g.has(d.items,c)&&(a.isInfoTag(c)||(b.values[g.decodeItemIdForStorekeeper(c)]=
p.formatSKItemName(d,c)))};a.changeMode=function(){a.editCancelEnabled(a.tuix.tab)&&(a.editModeOn()?a.editCancelOrRevert("cancel",a.tuix.tab):a.editCancelOrRevert("edit",a.tuix.tab))};a.revertTab=function(){a.changes(a.tuix.tab)&&a.revertEnabled(a.tuix.tab)&&a.editCancelOrRevert("revert",a.tuix.tab)};a.editCancelOrRevert=function(b,c){if(a.tuix.tabs[c].edit_mode){var d,f,e;"edit"==b?(f=n(a.tuix.tabs[c].edit_mode.format_on_edit),e=n(a.tuix.tabs[c].edit_mode.validate_on_edit)):"cancel"==b?(f=n(a.tuix.tabs[c].edit_mode.format_on_cancel_edit),
e=n(a.tuix.tabs[c].edit_mode.validate_on_cancel_edit)):"revert"==b&&(f=n(a.tuix.tabs[c].edit_mode.format_on_revert),e=a.errorOnTab(c)||n(a.tuix.tabs[c].edit_mode.validate_on_revert));if(a.tuix.tabs[c].fields&&!e)for(var l in a.tuix.tabs[c].fields)if(g.has(a.tuix.tabs[c].fields,l)&&!a.isInfoTag(l))if(n(a.tuix.tabs[c].fields[l].validate_onchange)&&(d=a.readField(l))!==h&&d!=a.tuix.tabs[c].fields[l].value){e=!0;break}else!f&&n(a.tuix.tabs[c].fields[l].format_onchange)&&(d=a.readField(l))!==h&&d!=a.tuix.tabs[c].fields[l].value&&
(f=!0);a.tuix.tabs[c].edit_mode.on="cancel"!=b;a.changed[c]=!1;e?a.validate(h,h,!0):f?a.format(!0):(a.wipeTab(),a.redrawTab(!0));a.tuix.tab==c&&$("#zenario_abtab").removeClass("zenario_abtab_changed")}};a.clickTab=function(b){a.loaded&&a.validate(b!=a.tuix.tab,b)};a.clickButton=function(b,c){"submit"==a.tuix.tabs[a.tuix.tab].fields[c].type?(a.tuix.tabs[a.tuix.tab].fields[c].pressed=!0,a.validate(!0)):"toggle"==a.tuix.tabs[a.tuix.tab].fields[c].type&&((a.tuix.tabs[a.tuix.tab].fields[c].pressed=!n(a.tuix.tabs[a.tuix.tab].fields[c].pressed))?
$("#"+c).removeClass("not_pressed").addClass("pressed"):$("#"+c).removeClass("pressed").addClass("not_pressed"),a.validateFormatOrRedrawForField(a.tuix.tabs[a.tuix.tab].fields[c]))};a.toggleLevelsPressed={};a.togglePressed=function(b,c){var d;d=b?1<b?a.toggleLevelsPressed[b-1]:!0:a.toggleLevelsPressed.last;d===h&&(d=!0);c&&"toggle"==c.type&&(a.toggleLevelsPressed.last=d&&n(c.pressed),b&&(a.toggleLevelsPressed[b]=a.toggleLevelsPressed.last));return d};a.toggleLevel=function(b){return a.toggleLevelsPressed.last};
a.format=function(b){!a.SKColPicker&&a.loaded&&(a.loaded=!1,a.hideTab(),a.checkValues(b),$.post(a.getURL(),{_format:!0,_box:a.syncAdminBoxFromClientToServer()},function(b){a.load(b);a.sortTabs();a.draw()},"text"),p.nowDoingSomething("loading"))};a.validate=function(b,c,d,f){!a.SKColPicker&&a.loaded&&(a.differentTab=b,a.loaded=!1,a.hideTab(b),a.checkValues(d),$.post(a.getURL(),{_validate:!0,_box:a.syncAdminBoxFromClientToServer()},function(b){a.load(b)&&!a.errorOnTab(a.tuix.tab)&&c!==h&&(a.tuix.tab=
c);a.sortTabs();a.switchToATabWithErrors();a.draw();f&&f()},"text"),p.nowDoingSomething("loading"))};a.switchToATabWithErrors=function(){if(a.tuix&&a.tuix.tabs&&!a.errorOnTab(a.tuix.tab))for(var b in a.sortedTabs)if(g.has(a.sortedTabs,b)){var c=a.sortedTabs[b];if(a.tuix.tabs[c]&&!p.hidden(a.tuix.tabs[c])&&a.errorOnTab(c))return a.tuix.tab=c,!0}return!1};a.save=function(b,c){if(!a.SKColPicker&&a.loaded&&!a.saving){a.saving=!0;a.differentTab=!0;a.loaded=!1;a.hideTab(!0);a.checkValues();var d={_save:!0,
_confirm:b?1:"",_save_and_continue:c,_box:a.syncAdminBoxFromClientToServer()};n(a.tuix.download)||a.tuix.confirm&&n(a.tuix.confirm.download)?a.save2(g.nonAsyncAJAX(a.getURL(),g.urlRequest(d)),c):($.post(a.getURL(),d,function(b){a.save2(b,c)},"text"),p.nowDoingSomething("saving"))}};a.save2=function(b,c){delete a.saving;"\x3c!--Valid--\x3e"==(""+b).substr(0,12)?(b=b.substr(12),"\x3c!--Confirm--\x3e"==(""+b).substr(0,14)?(b=b.substr(14),a.load(b),a.sortTabs(),a.draw(),a.showConfirm(c)):"\x3c!--Download--\x3e"==
(""+b).substr(0,15)?(k("zenario_iframe_form").action=a.getURL(),k("zenario_iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+r(a.syncAdminBoxFromClientToServer())+'"/>',k("zenario_iframe_form").submit(),c&&(b=b.substr(15),a.load(b)),a.refreshParentAndClose(!0,c)):"\x3c!--Saved--\x3e"==(""+b).substr(0,12)?(b=b.substr(12),a.load(b),a.refreshParentAndClose(!1,c)):(a.close(),p.showMessage(b,!0,"error"))):(a.load(b),a.sortTabs(),a.switchToATabWithErrors(),
a.draw())};a.showConfirm=function(b){if(a.tuix&&a.tuix.confirm&&n(a.tuix.confirm.show)){var c=a.tuix.confirm.message;n(a.tuix.confirm.html)||(c=r(c,!0));b='<input type="button" class="submit_selected" value="'+a.tuix.confirm.button_message+'" onclick="zenarioAB.save(true, '+n(b)+');"/><input type="button" class="submit" value="'+a.tuix.confirm.cancel_button_message+'" onclick="zenarioA.closeFloatingBox();"/>';p.floatingBox(c,b,x(a.tuix.confirm.message_type,"none"))}};a.hideTab=function(b){b?($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled",
"disabled"),$("#zenario_abtab").clearQueue().show().animate({opacity:0.8},200,function(){a.tabHidden=!0;a.draw()})):($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled","disabled").animate({opacity:0.9},100),a.tabHidden=!0,a.draw())};a.draw=function(){if(a.welcome&&a.tuix){a.tuix._clear_local_storage&&(delete a.tuix._clear_local_storage,g.sClear(!0));if(a.tuix._location!==h){L.location.href=g.addBasePath(a.tuix._location);return}a.tuix._task!==h&&
(a.task=a.tuix._task,delete a.tuix._task)}(a.isOpen||a.SKColPicker||a.welcome)&&a.loaded&&a.tabHidden&&a.draw2()};a.draw2=function(b){a.SKColPicker=b;if(!a.SKColPicker&&!a.welcome){k("zenario_fbAdminFloatingBox").className=a.baseCSSClass+" "+(a.tuix.css_class||"")+" "+(n(a.tuix.hide_tab_bar)?"zenario_admin_box_with_tabs_hidden":"zenario_admin_box_with_tabs_shown");!a.tuix.tab||a.tuix.tabs[a.tuix.tab]&&!p.hidden(a.tuix.tabs[a.tuix.tab])||(a.tuix.tab=!1);b=[];for(var c in a.sortedTabs)if(g.has(a.sortedTabs,
c)){var d=a.sortedTabs[c];a.tuix.tabs[d]&&!p.hidden(a.tuix.tabs[d])&&(a.tuix.tab||(a.tuix.tab=d),b.push({tabId:d,current:a.tuix.tab==d,label:a.tuix.tabs[d].label}))}k("zenario_jqmTabs").innerHTML=p.microTemplate(a.templatePrefix+"_tab",b);a.setTitle(a.tuix.title);a.showCloseButton();f="";a.tuix.save_and_continue_button_message&&(f+='<input id="zenarioAFB_save_and_continue"  type="button" value="'+r(a.tuix.save_and_continue_button_message)+'"',f=a.editModeOnBox()?f+' class="submit_selected" onclick="zenarioAB.save(undefined, true);"/>':
f+' class="submit_disabled"/>');f+='<input id="zenarioAFB_save"  type="button" value="'+x(r(a.tuix.save_button_message),C.save)+'"';f=a.editModeOnBox()?f+' class="submit_selected" onclick="zenarioAB.save();"/>':f+' class="submit_disabled"/>';a.tuix.cancel_button_message&&(f+='<input type="button" value="'+r(a.tuix.cancel_button_message)+'" onclick="zenarioAB.close();">');k("zenario_fbButtons").innerHTML=f;a.size();k("zenario_fbAdminFloatingBox").style.display="block"}p.nowDoingSomething(!1);a.welcome&&
$("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").clearQueue();var f=a.drawFields();if(a.SKColPicker)return f;if(a.welcome&&!1===a.shownTab)a.insertHTML(f),$("#welcome").show({effect:"drop",direction:"up",duration:300,complete:a.addJQueryElementsToTabAndFocusFirstField}),g.addJQueryElements("#zenario_abtab ",!0);else if(a.shownTab==a.tuix.tab){if(a.tuix.shake===h?a.differentTab&&a.errorOnTab(a.tuix.tab):n(a.tuix.shake))$(a.welcome?"#welcome":"#zenario_abtab").effect({effect:"bounce",
duration:125,direction:"right",times:2,distance:5,mode:"effect",complete:function(){a.insertHTML(f);$("#zenario_abtab").clearQueue().show().animate({opacity:1},75,function(){g.browserIsIE()&&this.style.removeAttribute("filter");a.addJQueryElementsToTabAndFocusFirstField()});a.hideShowFields()}});else{a.insertHTML(f);var e=a.lastScrollTop;$("#zenario_abtab").clearQueue().show().animate({opacity:1},150,function(){g.browserIsIE()&&this.style.removeAttribute("filter");e!==h?a.addJQueryElementsToTab():
a.addJQueryElementsToTabAndFocusFirstField()});$("#zenario_fbAdminInner").scrollTop(e);a.hideShowFields()}delete a.tuix.shake}else a.insertHTML(f),$("#zenario_abtab").clearQueue().show().animate({opacity:1},150,function(){g.browserIsIE()&&this.style.removeAttribute("filter");a.addJQueryElementsToTabAndFocusFirstField()});a.shownTab=a.tuix.tab;delete a.lastScrollTop};a.drawFields=function(){p.clearHTML5UploadFromDragDrop();a.sliders={};a.codeEditors={};a.colourPickers={};var b=a.tuix.tab,c="",d="";
!a.savedAndContinued(b)&&a.editCancelEnabled(b)&&(d='<div class="zenario_editCancelButton"><input class="submit" type="button" onclick="zenarioAB.changeMode(); return false;" value="'+(a.editModeOn()?C.cancel:C.edit)+'"></div>');var f=x(a.tuix.tabs[b].template,a.templatePrefix+"_current_tab"),e=!1,d={fields:{},rows:[],tabId:b,path:a.path,revert:d,errors:[],notices:{}};if(a.editModeOn()){if(a.tuix.tabs[b].errors)for(var l in a.tuix.tabs[b].errors)g.has(a.tuix.tabs[b].errors,l)&&(a.isInfoTag(l)||d.errors.push({message:a.tuix.tabs[b].errors[l]}));
if(a.tuix.tabs[b].fields)for(var h in a.tuix.tabs[b].fields)g.has(a.tuix.tabs[b].fields,h)&&!a.isInfoTag(h)&&a.tuix.tabs[b].fields[h].error&&d.errors.push({message:a.tuix.tabs[b].fields[h].error})}if(a.tuix.tabs[b].notices)for(var m in a.tuix.tabs[b].notices)g.has(a.tuix.tabs[b].notices,m)&&!a.isInfoTag(m)&&n(a.tuix.tabs[b].notices[m].show)&&{error:1,warning:1,question:1,success:1}[a.tuix.tabs[b].notices[m].type]&&(d.notices[m]=a.tuix.tabs[b].notices[m]);for(h in a.sortedFields[b])g.has(a.sortedFields[b],
h)&&(l=a.sortedFields[b][h],m=a.tuix.tabs[b].fields[l],m._id=l,m._html=a.drawField(b,l,!0),!1!==m._html&&(!m._startNewRow&&d.rows.length||d.rows.push({fields:[]}),e||a.tuix.tabs[b].show_errors_after_field!=l||(d.rows[d.rows.length-1].errors=d.errors,d.rows[d.rows.length-1].notices=d.notices,e=!0),d.rows[d.rows.length-1].fields.push(m),d.fields[l]=m));e||d.rows.splice(0,0,{errors:d.errors,notices:d.notices});c+=p.microTemplate(f,d);for(h in a.sortedFields[b])g.has(a.sortedFields[b],h)&&(l=a.sortedFields[b][h],
delete a.tuix.tabs[b].fields[l]._startNewRow,delete a.tuix.tabs[b].fields[l]._hideOnOpen,delete a.tuix.tabs[b].fields[l]._showOnOpen,delete a.tuix.tabs[b].fields[l]._html,delete a.tuix.tabs[b].fields[l]._id);return c};a.insertHTML=function(b){var c,d=k("zenario_abtab");d.innerHTML=b;a.tabHidden=!1;a.changes(a.tuix.tab)?$(d).addClass("zenario_abtab_changed"):$(d).removeClass("zenario_abtab_changed");if(a.sliders)for(c in a.sliders)g.has(a.sliders,c)&&$(k(c)).each(function(b,d){var f;if(f=k("zenario_slider_for__"+
c))a.sliders[c].min!==h&&(a.sliders[c].min*=1),a.sliders[c].max!==h&&(a.sliders[c].max*=1),a.sliders[c].step!==h&&(a.sliders[c].step*=1),a.sliders[c].disabled=!a.editModeOn(),a.sliders[c].value=$(d).val(),a.sliders[c].slide=function(a,b){$(d).val(b.value)},a.sliders[c].change=function(b,c){this&&this.id&&a.fieldChange(this.id.replace("zenario_slider_for__",""))},$(f).slider(a.sliders[c])});if(a.codeEditors)for(c in a.codeEditors)if(g.has(a.codeEditors,c)&&(d=a.codeEditors[c],b=ace.edit(c),b.session.setUseSoftTabs(!1),
b.setShowPrintMargin(!1),d.readonly&&(b.setReadOnly(!0),b.setBehavioursEnabled(!1)),b.session.setOption("useWorker",!1),d=a.codeEditors[c].language))try{d=d.match(/\.twig\.html$/i)?"ace/mode/twig":d.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(d).mode:"ace/mode/"+d,b.session.setMode(d)}catch(f){console.log("Ace editor could not load that language",d)}if(a.colourPickers)for(c in a.colourPickers)g.has(a.colourPickers,c)&&(d=a.colourPickers[c],$(k(c)).spectrum(d))};a.hideShowFields=function(a){var c=
$(".zenario_hide_on_open"),d=$(".zenario_hide_row_on_open"),f=$(".zenario_show_on_open"),e=function(a,b){b.style.display="none"};f.length&&!c.length?f.show("blind",200,a):!f.length&&c.length?c.hide("blind",200,function(){d.each(e)}):f.length&&c.length&&(c.each(e),d.each(e),f.show())};a.addJQueryElementsToTab=function(){g.addJQueryElements("#zenario_abtab ",!0)};a.addJQueryElementsToTabAndFocusFirstField=function(){g.addJQueryElements("#zenario_abtab ",!0);a.focusFirstField()};a.focusFirstField=function(){if(a.tuix&&
!n(a.tuix.tabs[a.tuix.tab].disable_autofocus)){var b=-1,c=[],d=h,f;for(f in a.sortedFields[a.tuix.tab])if(g.has(a.sortedFields[a.tuix.tab],f)){var e=a.sortedFields[a.tuix.tab][f],l=a.tuix.tabs[a.tuix.tab].fields[e];if(k(e)&&$(k(e)).is(":visible")&&(c[++b]={id:e,type:l.type,empty:""==k(e).value,focusable:l.type&&{password:1,checkbox:1,select:1,text:1,textarea:1}[l.type]&&!n(k(e).disabled)&&!n(k(e).readonly)},1<b))break}if(c[0]&&!c[0].empty&&c[1]&&c[1].focusable&&c[1].empty&&"password"==c[1].type)d=
1;else if(c[0]&&c[0].focusable)d=0;else if(c[1]&&c[1].focusable)d=1;else return;setTimeout(function(){k(c[d].id).focus()},50)}};a.focusField=function(){a.fieldToFocus&&k(a.fieldToFocus)&&$(k(a.fieldToFocus)).is(":visible")&&k(a.fieldToFocus).focus();delete a.fieldToFocus};a.setTitle=function(a,c){a?($("#zenario_fbAdminFloatingBox .zenario_jqmTitle").css("display","block"),$("#zenario_fbAdminFloatingBox .zenario_jqmTitle").addClass(" zenario_no_drag"),c||(a=r(a)),k("zenario_jqmTitle").innerHTML=a,
p.setTooltipIfTooLarge("#zenario_jqmTitle",a,p.tooltipLengthThresholds.adminBoxTitle)):$("#zenario_fbAdminFloatingBox .zenario_jqmTitle").css("display","none")};a.showCloseButton=function(){a.tuix.cancel_button_message?$("#zenario_fbAdminFloatingBox .zenario_jqmClose").css("display","none"):$("#zenario_fbAdminFloatingBox .zenario_jqmClose").css("display","block")};a.errorOnBox=function(){if(a.tuix&&a.tuix.tabs)for(tab in a.tuix.tabs)if(g.has(a.tuix.tabs,tab)&&a.errorOnTab(tab))return!0;return!1};
a.errorOnTab=function(b){if(a.tuix.tabs[b]&&a.editModeOn(b)){if(a.tuix.tabs[b].errors)for(var c in a.tuix.tabs[b].errors)if(g.has(a.tuix.tabs[b].errors,c)&&!a.isInfoTag(c))return!0;if(a.tuix.tabs[b].fields)for(var d in a.tuix.tabs[b].fields)if(g.has(a.tuix.tabs[b].fields,d)&&!a.isInfoTag(d)&&a.tuix.tabs[b].fields[d].error)return!0}};a.checkValues=function(b){b?a.wipeTab():a.readTab();for(var c in a.tuix.tabs)if(g.has(a.tuix.tabs,c)&&!a.isInfoTag(c)&&(b=a.editModeOn(c),a.tuix.tabs[c].fields))for(var d in a.tuix.tabs[c].fields)if(g.has(a.tuix.tabs[c].fields,
d)&&!a.isInfoTag(d)){var f=a.tuix.tabs[c].fields[d];f.snippet||"submit"==f.type||"toggle"==f.type||(f.current_value===h&&(f.current_value=a.value(d,c,!0)),b&&(f.value===h&&(f.value=a.value(d,c,!1)),f.multiple_edit&&f.multiple_edit._changed===h&&f.multiple_edit.changed!==h&&(f.multiple_edit._changed=f.multiple_edit.changed)))}};a.allowedAtt={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,
onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,onmouseover:!0,onmouseup:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,list:!0,max:!0,min:!0,multiple:!0,pattern:!0,placeholder:!0,required:!0,step:!0};a.drawField=function(b,c,d,f,e,l,s,m,u,B){d="";var E=!1,q={"class":""},z={},v=!0;e===h&&(e=a.tuix.tabs[b].fields[c]);s===h&&(s=!a.editModeOn()||n(e.read_only));e.type&&"datetime"==e.type&&(s=!0);if(u===h&&"object"==typeof e.values){u=
[];for(var t in e.values)g.has(e.values,t)&&("object"==typeof e.values[t]?p.hidden(e.values[t])||(e.values[t].ord!==h?u.push([t,e.values[t].ord]):e.values[t].label!==h?u.push([t,e.values[t].label]):u.push([t,t])):u.push([t,e.values[t]]));u.sort(p.sortArray);for(var y in u)g.has(u,y)&&(u[y]=u[y][0])}if(f===h){e.load_values_from_organizer_path&&!e.values&&a.loadValuesFromOrganizerPath(e);e._startNewRow=!n(e.same_row);if(e._startNewRow&&!1!==a.shownTab&&a.shownTab==a.tuix.tab&&"editor"!=e.type&&"code_editor"!=
e.type&&a.tuix.tabs[b].fields[c]._h&&!p.hidden(e))e._showOnOpen=!0,delete a.tuix.tabs[b].fields[c]._h;else if(e._startNewRow&&!1!==a.shownTab&&a.shownTab==a.tuix.tab&&"editor"!=e.type&&"code_editor"!=e.type&&!a.tuix.tabs[b].fields[c]._h&&p.hidden(e))e._hideOnOpen=!0,a.tuix.tabs[b].fields[c]._h=!0;else{if(p.hidden(e))return a.tuix.tabs[b].fields[c]._h=!0,!1;delete a.tuix.tabs[b].fields[c]._h}t="";var G=!1;e.multiple_edit&&(G=s||e.multiple_edit._changed===h?e.multiple_edit.changed:n(e.multiple_edit._changed),
n(e.multiple_edit.disable_when_unchanged)&&!G&&(m=!0),n(e.multiple_edit.hide_ui)||!e.multiple_edit.select_list?(t+='<input type="checkbox" class="multiple_edit" id="multiple_edit__'+r(c)+'"'+(G?' checked="checked"':""),t=n(e.multiple_edit.hide_ui)?t+' style="display: none;"':s?t+' disabled="disabled"':t+(" onchange=\"zenarioAB.meChange(this.checked, '"+r(c)+"');\""),t+="/> "):(t+='<select class="multiple_edit" id="multiple_edit__'+r(c)+'"',t=s?t+' disabled="disabled"':t+(" onchange=\"zenarioAB.meChange(this.value == 1, '"+
r(c)+"');\""),t+='><option value=""'+(G?"":' selected="selected"')+">"+x(e.multiple_edit.select_list.not_changed_label,C.notChanged)+'</option><option value="1"'+(G?' selected="selected"':"")+">"+x(e.multiple_edit.select_list.changed_label,C.changed)+"</option></select> "));d+=t;t=h;e.pre_field_html!==h&&(d+=e.pre_field_html)}e.snippet||l!==h||(l=a.value(c,b,h,!0));l===h&&(l="");if(s||m)q.disabled="disabled";if(e.snippet)e.snippet.html?d+='<span id="snippet__'+r(c)+'">'+e.snippet.html+"</span>":e.snippet.url?
d=n(e.snippet.cache)?a.cachedAJAXSnippets[e.snippet.url]?d+a.cachedAJAXSnippets[e.snippet.url]:d+(a.cachedAJAXSnippets[e.snippet.url]=g.nonAsyncAJAX(g.addBasePath(e.snippet.url))):d+g.nonAsyncAJAX(g.addBasePath(e.snippet.url)):e.snippet.separator&&(d+='<hr class="input_separator"',e.snippet.separator.style&&(d+=' style="'+r(e.snippet.separator.style)+'"'),d+="/>");else if(("checkboxes"==e.type||"radios"==e.type)&&f===h)e.values&&(B=a.pickedItemsArray(e,l),y=$.extend(!0,{},e),y.name=x(e.name,c),y.type=
"checkboxes"==e.type?"checkbox":"radio",s&&(y.disabled=!0),d+=a.hierarchicalBoxes(b,c,l,e,y,B,m,u));else if(e.upload||e.pick_items)l={id:c,wrappedId:"name_for_"+c,readOnly:s,tempReadOnly:m},s?l.pickedItems=a.drawPickedItems(c,!0):(l.pickedItems=a.drawPickedItems(c,!1,m),e.pick_items&&e.pick_items.path&&e.pick_items.min_path&&e.pick_items.target_path&&!n(e.pick_items.hide_select_button)&&(l.select={onclick:"zenarioAB.pickItems('"+r(c)+"');",phrase:e.pick_items.select_phrase||C.selectDotDotDot}),e.upload&&
(l.upload={onclick:"zenarioAB.upload('"+r(c)+"');",phrase:e.upload.upload_phrase||C.uploadDotDotDot},n(e.upload.drag_and_drop)&&a.upload(c,!0),F.Dropbox&&Dropbox.isBrowserSupported()&&(l.dropbox={onclick:"zenarioAB.chooseFromDropbox('"+r(c)+"');",phrase:e.upload.dropbox_phrase||C.dropboxDotDotDot}))),d+=p.microTemplate(a.templatePrefix+"_picked_items",l);else if(e.type){q.onchange="zenarioAB.fieldChange('"+r(c)+"');";e.disabled&&(q["class"]+="disabled ");e.return_key_presses_button&&!s&&(q.onkeyup=
x(q.onkeyup,"","")+"if (event.keyCode == 13) {$('#"+r(e.return_key_presses_button)+"').click();}");n(e.multiple_edit)&&!s&&(q.onkeyup=x(q.onkeyup,"","")+"if (event && event.keyCode == 9) return true; zenarioAB.meMarkChanged('"+r(c)+"', this.value, '"+r(e.value)+"');");q["class"]+="input_"+e.type;if("select"==e.type)e.slider&&(E=!0,d+=a.drawSlider(c,e,s,!0)),d+="<select";else if("textarea"==e.type)d+="<textarea";else if("code_editor"==e.type)d+="<div",q["class"]=" zenario_embedded_ace_editor",a.codeEditors[c]=
{readonly:s,language:e.language};else if("color_picker"==e.type||"colour_picker"==e.type)d+="<input",q["class"]=" zenario_color_picker",m=e.color_picker_options||e.colour_picker_options||{},m.disabled=s,m.preferredFormat=m.preferredFormat||"hex",a.colourPickers[c]=m;else if("editor"==e.type)d+="<textarea",q.style="visibility: hidden;",q["class"]=s?" tinymce_readonly":e.insert_image_button?e.insert_link_button?" tinymce_with_images_and_links":" tinymce_with_images":e.insert_link_button?" tinymce_with_links":
" tinymce";else if("submit"==e.type||"toggle"==e.type){d+="<input";q.type="button";if(!s||n(e.can_be_pressed_in_view_mode))z.onclick="zenarioAB.clickButton(this, '"+c+"');",delete q.disabled;"submit"==e.type&&(a.tuix.tabs[b].fields[c].pressed=!1);"toggle"==e.type&&(q["class"]+=a.tuix.tabs[b].fields[c].pressed?" pressed":" not_pressed")}else"date"==e.type||"datetime"==e.type?(d+="<input",q.type="text",q["class"]+=" zenario_datepicker",n(e.change_month_and_year)&&(q["class"]+=" zenario_datepicker_change_month_and_year"),
q.readonly="readonly",s||(q.onkeyup=x(q.onkeyup,"","")+"zenario.dateFieldKeyUp(this, event, '"+r(c)+"');")):"url"==e.type?(d+="<input",q.type="url",q.onfocus=x(q.onfocus,"","")+"if(!this.value) this.value = 'http://';",q.onblur=x(q.onblur,"","")+"if(this.value == 'http://') this.value = '';"):(e.slider&&(E=!0,d+=a.drawSlider(c,e,s,!0)),d+="<input",q.type=e.type,v=!0);if("checkbox"==e.type||"radio"==e.type)n(l)&&(q.checked="checked"),l=h;E&&(q.onchange=x(q.onchange,"","")+"$('#zenario_slider_for__"+
c+"').slider('value', $(this).val());",q.onkeyup=x(q.onkeyup,"","")+"$('#zenario_slider_for__"+c+"').slider('value', $(this).val());");f===h?e.id=c:(e.id=c+"___"+f,q["class"]+=" control_for__"+c);"radio"==e.type&&e.name||(e.name=c);m=e;B&&(m=$.extend({},e,B));for(var w in m)if(g.has(m,w)&&a.allowedAtt[w])if("disabled"==w||"readonly"==w){if(n(q[w])||n(m[w]))d+=" "+w+'="'+w+'"'}else d+=" "+w+'="',q[w]&&(d+=q[w]+" ",delete q[w]),d+=r(m[w]),z[w]&&(d+=" "+z[w],delete z[w]),d+='"';for(w in q)g.has(q,w)&&
(d+=" "+w+'="'+r(q[w]),z[w]&&(d+=" "+z[w],delete z[w]),d+='"');for(w in z)g.has(z,w)&&(d+=" "+w+'="'+r(z[w])+'"');"select"==e.type?d+=">":"textarea"==e.type||"editor"==e.type?d+=">"+r(l,!1,"asis")+"</textarea>":"code_editor"==e.type?d+=">"+r(l,!1,"asis")+"</div>":"date"==e.type||"datetime"==e.type?(d+=' value="'+r(g.formatDate(l,"datetime"==e.type))+'"/>',d+='<input type="hidden" id="_value_for__'+r(c)+'" value="'+r(l)+'"/>',s||a.SKColPicker||(d+='<input type="button" class="zenario_remove_date" value="x" onclick="zenarioAB.blankField(\''+
r(c)+"'); zenarioAB.fieldChange('"+r(c)+"');\"/>")):d=l!==h?d+(' value="'+r(l,!1,"asis")+'"/>'):d+"/>";if("select"==e.type){e.empty_value&&(d+='<option value="">'+r(e.empty_value)+"</option>");if(e.values)for(y in u)g.has(u,y)&&(t=u[y],d+='<option value="'+r(t)+'"'+(t==l?' selected="selected"':"")+">"+r(e.values[t],!1,!0)+"</option>");d+="</select>"}else if(v&&e.values&&!s){var A=[];for(y in u)g.has(u,y)&&(t=u[y],A.push({label:e.values[t],value:t}));setTimeout(function(){if(k(c)){var a=$(k(c)),b=
{source:A,minLength:0,appendTo:a.parent()};e.return_key_presses_button&&(b.select=function(){setTimeout(function(){$("#"+e.return_key_presses_button).click()},0)});a.autocomplete(b);a.focus(function(){a.autocomplete("widget").is(":visible")||a.autocomplete("search","")})}},0)}}f===h&&("url"!=e.type||s||(d+='&nbsp; <input type="button" class="submit" value="Test" onclick="if (get(\''+r(c)+"').value) window.open(zenario.addBasePath(get('"+r(c)+"').value));\"/>"),e.post_field_label!==h&&(d+='<label for="'+
r(c)+'" id="label_for__'+r(c)+'"> '+r(e.post_field_label)+"</label>"),e.post_field_html!==h&&(d+=e.post_field_html),E&&(d+=a.drawSlider(c,e,s,!1)));return d};a.chooseFromDropbox=function(b){var c;if(!a.tuix.tabs[a.tuix.tab]||!(c=a.tuix.tabs[a.tuix.tab].fields[b])||!c.upload)return!1;c={cancel:function(){p.hideAJAXLoader()},linkType:"direct",multiselect:!!n(c.upload.multi),extensions:c.upload.extensions?_.toArray(c.upload.extensions):h,success:function(c){p.showAJAXLoader();var f,e,l=new g.callback;
for(f in c)g.has(c,f)&&(e=c[f],l.add(g.ajax("zenario/ajax.php?method_call=handleAdminBoxAJAX&fetchFromDropbox=1",e,!0)));l.after(function(){var c,d,e,f,l;if(!a.tuix.tabs[a.tuix.tab]||!(e=a.tuix.tabs[a.tuix.tab].fields[b])||!e.upload)return!1;f=e.current_value===h?e.value:e.current_value;l=n(e.upload.multi);for(c in arguments)g.has(arguments,c)&&(d=arguments[c])&&d.id&&(f=l&&f?f+(","+d.id):d.id);p.hideAJAXLoader();a.redrawPickedItems(b,e,f)})}};p.showAJAXLoader();Dropbox.choose(c)};a.upload=function(b,
c){var d;if(!a.tuix.tabs[a.tuix.tab]||!(d=a.tuix.tabs[a.tuix.tab].fields[b])||!d.upload)return!1;d={class_name:d.class_name,upload:d.upload};a.uploadCallback=function(c){if(c){var d,l,s,m,k;if(!a.tuix.tabs[a.tuix.tab]||!(s=a.tuix.tabs[a.tuix.tab].fields[b])||!s.upload)return!1;m=s.current_value===h?s.value:s.current_value;k=n(s.upload.multi);for(d in c)g.has(c,d)&&(l=c[d])&&l.id&&(m=k&&m?m+(","+l.id):l.id);a.redrawPickedItems(b,s,m)}};c?p.setHTML5UploadFromDragDrop(A+"zenario/ajax.php?method_call=handleAdminBoxAJAX",
{fileUpload:1},!1,a.uploadCallback,k("zenario_fbAdminInner")):p.action(a,d,h,h,h,{fileUpload:1})};a.uploadComplete=function(b){a.uploadCallback!==h&&a.uploadCallback(b);delete a.uploadCallback};a.drawSlider=function(b,c,d,f){html="";if(n(c.slider.before_field)?f:!f)d&&(html+='<div class="ui-disabled">'),html+='<div id="zenario_slider_for__'+r(b)+'" class="'+r(c.slider["class"])+'" style="'+r(c.slider.style)+'"></div>',a.sliders[b]=c.slider,d&&(html+="</div>");return html};a.pickedItemsArray=function(a,
c){if(!1===c||null===c||c===h||!(0!==c&&"0"!==c||a.values&&(a.values[0]||a.values["0"])))return{};var d=(c+"").split(","),f={},e,l,s,m;a._display_value=!1;for(s in d)g.has(d,s)&&(m=d[s])&&(a.upload&&(l=g.decodeItemIdForStorekeeper(m))&&(l=l.split("/"))&&l[1]?(f[m]=l[1],n(l[2])&&n(l[3])&&(f[m]+=" ["+l[2]+" \u00d7 "+l[3]+"px]")):a.values&&a.values[m]&&"string"==typeof a.values[m]?f[m]=a.values[m]:a.values&&a.values[m]&&a.values[m].label?f[m]=a.values[m].label:a.pick_items&&(a.pick_items.target_path&&
(e=p.getSKItem(a.pick_items.target_path,m))||a.pick_items.path&&a.pick_items.path!=a.pick_items.target_path&&-1==a.pick_items.path.indexOf("//")&&(e=p.getSKItem(a.pick_items.path,m)))?(a.values||(a.values={}),a.values[m]=f[m]=p.formatSKItemName(e,m)):a.upload&&m==1*m&&(l=p.lookupFileDetails(m))?(a.values||(a.values={}),f[m]=l.filename,n(l.width)&&n(l.height)&&(f[m]+=" ["+l.width+" \u00d7 "+l.height+"px]"),a.values[m]=f[m]):f[m]=m,!1===a._display_value&&(a._display_value=f[m]));return f};a.pickedItemsValue=
function(a){var c,d="";if(a)for(c in a)g.has(a,c)&&(d+=(""===d?"":",")+c);return d};a.hierarchicalBoxes=function(b,c,d,f,e,l,s,m,k,B,E,q){var z=1;if(!q)q=0,z=1*f.cols||1;else if(10<q)return"";if(k===h){k={};for(var v in f.values)g.has(f.values,v)&&"object"==typeof f.values[v]&&f.values[v].parent&&(k[f.values[v].parent]=!0)}E||(E={});B&&(E[B]=!0);var t=0,y="",x,w;q&&(y+='<div class="zenario_hierarchical_box_children" id="'+r("children_for___"+c+"___"+B)+'">');for(var C in m)if(g.has(m,C)){x={};v=m[C];
v==1*v&&(v*=1);var A=h;w="object"==typeof f.values[v]?f.values[v]:{label:f.values[v]};A=w.parent;"0"===A&&(A=!1);if(!B&&!A||B==A){if(x.newRow=++t>z)t=1;A=d?!0===d||1===d||"1"===d?!0===v||1===v||"1"===v:l?l[v]!==h?!0:!1:v==d:!v;if("checkboxes"==f.type&&n(f.checking_child_checks_parents)){var D="";B&&(D+="if (this.checked) { for (var cb in "+JSON.stringify(E)+") { get('"+r(c)+"___' + cb).checked = true; } } ");k[v]&&(D+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");
D?e.onchange=f.onchange?D+" "+f.onchange:D:f.onchange?e.onchange=f.onchange:delete e.onchange}else"checkboxes"==f.type&&n(f.checking_parent_checks_children)&&(D="",k[v]&&(D+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),D?e.onchange=f.onchange?D+" "+f.onchange:D:f.onchange?e.onchange=f.onchange:delete e.onchange);x.lovId=c+"___"+v;x.lovField=w;x.lovHTML=a.drawField(b,c,!0,v,e,A,!1,s,m,w);x.childrenHTML="";k[v]&&(x.childrenHTML=a.hierarchicalBoxes(b,
c,d,f,e,l,s,m,k,v,$.extend(!0,{},E),q+1),t=0);y+=p.microTemplate("zenario_admin_box_radio_or_checkbox",x)}}q&&(y+="</div>");return y};a.drawPickedItems=function(b,c,d,f){f===h&&(f=a.tuix.tab);var e=a.tuix.tabs[f].fields[b],l=!1,k,m=a.value(b,f,c),u=a.pickedItemsArray(e,m);f=e.upload&&n(e.upload.reorder_items);for(k in u)if(g.has(u,k)){l=!0;break}if(l){var l=[],B=[];if(f)for(k in m=m.split(","),m)g.has(m,k)&&B.push([m[k],u[m[k]]]);else{for(k in u)g.has(u,k)&&B.push([k,u[k]]);B.sort(p.sortArray)}for(k=
0;k<B.length;++k){var u=B[k][0],r=B[k][1],q=u==1*u,z,v,m={id:b,item:u,label:r,first:0==k,last:k==B.length-1,readOnly:c,tempReadOnly:d};!e.pick_items||e.upload&&!q||!(v=e.pick_items.path)||v!=e.pick_items.target_path&&e.pick_items.min_path!=e.pick_items.target_path||(v="//"==g.rightHandedSubStr(v,2)?v+u:"/"==g.rightHandedSubStr(v,1)?v+("/"+u):v+("//"+u),m.organizerPath=v);e.upload&&(m.isUpload=!0,z=(z=(""+r).match(/(.*?)\.(\w+)$/)||(""+r).match(/(.*?)\.(\w+) \[.*\]$/))&&z[2]?z[2].toLowerCase():"unknown",
m.extension=z,q=q?A+"zenario/file.php?id="+u:A+"zenario/file.php?getUploadedFileInCacheDir="+encodeURIComponent(u),z.match(/gif|jpg|jpeg|png/)?(m.thumbnail={onclick:"zenarioAB.showPickedItemInPopout('"+q+"&popout=1&dummy_filename="+encodeURIComponent("image."+z)+"');",src:q+"&og=1"},(r=(""+r).match(/.*\[\s*(\d+)p?x?\s*[\u00d7x]\s*(\d+)p?x?\s*\]$/))&&r[1]&&r[2]&&p.resizeImage(r[1],r[2],180,120,m.thumbnail)):m.adminDownload=q+"&adminDownload=1",f&&(m.first||(m.nudgeUp={onclick:"zenarioAB.nudge('"+I(b)+
"', "+(k-1)+", "+k+");"}),m.last||(m.nudgeDown={onclick:"zenarioAB.nudge('"+I(b)+"', "+k+", "+(k+1)+");"})));c||e.pick_items&&n(e.pick_items.hide_remove_button)||(m.removeButton={onclick:"zenarioAB.removePickedItem('"+I(b)+"', '"+I(u)+"');"});l.push(m)}}else l={readOnly:c,tempReadOnly:d,noItemSelected:!0,nothing_selected_phrase:x(e.pick_items&&e.pick_items.nothing_selected_phrase,C.nothing_selected)};return p.microTemplate(a.templatePrefix+"_picked_item",l)};a.showPickedItemInPopout=function(b){p.action(a,
{popout:{href:b,css_class:"zenario_show_colobox_above_fab"}})};a.pickItems=function(b){if(!a.tuix.tabs[a.tuix.tab]||!a.tuix.tabs[a.tuix.tab].fields[b])return!1;var c=a.tuix.tabs[a.tuix.tab].fields[b],d,f;if(!(c.pick_items&&c.pick_items.path&&c.pick_items.min_path&&c.pick_items.target_path))return!1;f=c.pick_items.path;n(c.pick_items.multiple_select)||f!=c.pick_items.target_path&&c.pick_items.min_path!=c.pick_items.target_path||!(d=a.readField(b))||-1!=d.indexOf(",")||(f="//"==g.rightHandedSubStr(f,
2)?f+d:"/"==g.rightHandedSubStr(f,1)?f+("/"+d):f+("//"+d));a.SKTarget=b;p.organizerSelect("zenarioAB","setPickedItems",c.pick_items.multiple_select,f,c.pick_items.target_path,c.pick_items.min_path,c.pick_items.max_path,c.pick_items.disallow_refiners_looping_on_min_path,h,c.pick_items.one_to_one_choose_phrase,c.pick_items.one_to_many_choose_phrase,h,!0,h,h,h,h,h,h,h,h,c.pick_items)};a.setPickedItems=function(b,c,d,f){b=a.SKTarget;var e;values={};for(e in c._items)g.has(c._items,e)&&(d=g.decodeItemIdForStorekeeper(e),
values[d]=p.formatSKItemName(f,e));a.addToPickedItems(values,b)};a.addToPickedItems=function(b,c,d){d||(d=a.tuix.tab);d=a.tuix.tabs[d].fields[c];var f=d.current_value===h?d.value:d.current_value,e,l,k;if(_.isString(b))for(e in k=b.split(","),b={},k)g.has(k,e)&&(l=k[e],b[l]=l);f=n(d.pick_items.multiple_select)&&f?a.pickedItemsArray(d,f):{};for(l in b)if(g.has(b,l)&&(e=b[l],d.values||(d.values={}),d.values[l]||(d.values[l]=e),f[l]=!0,!n(d.pick_items.multiple_select)))break;a.redrawPickedItems(c,d,f)};
a.removePickedItem=function(b,c){var d=a.tuix.tabs[a.tuix.tab].fields[b],f=d.current_value===h?d.value:d.current_value,f=f.split(","),e;for(e in f)if(g.has(f,e)&&f[e]==c){f.splice(e,1);break}f=f.join(",");a.redrawPickedItems(b,d,f)};a.nudge=function(b,c,d){c*=1;d*=1;var f=a.tuix.tabs[a.tuix.tab].fields[b],e=f.current_value===h?f.value:f.current_value,e=e.split(",");if(e[c]!==h&&e[d]!==h){var l=e[c];e[c]=e[d];e[d]=l}e=e.join(",");a.redrawPickedItems(b,f,e)};a.redrawPickedItems=function(b,c,d){"object"==
typeof d&&(d=a.pickedItemsValue(d));c.current_value=d;k("name_for_"+b).innerHTML=a.drawPickedItems(b);a.fieldChange(b)};a.changed={};a.changes=function(b){if(a.tuix&&a.tuix.tab){if(b==h){for(b in a.tuix.tabs)if(g.has(a.tuix.tabs,b)&&a.changed[b])return!0;return!1}return a.changed[b]}return!1};a.markAsChanged=function(b,c){a.tuix&&(b===h&&(b=a.tuix.tab),b&&(a.changed[b]||(a.changed[b]=!0),a.tuix.tab==b&&$("#zenario_abtab").addClass("zenario_abtab_changed")))};a.fieldChange=function(b){if(a.tuix&&a.tuix.tab&&
a.tuix.tabs[a.tuix.tab]&&a.tuix.tabs[a.tuix.tab].fields[b]){var c=a.tuix.tab,d=a.tuix.tabs[c].fields[b];a.markAsChanged(c);n(d.multiple_edit)&&a.meMarkChanged(b);a.validateFormatOrRedrawForField(d)}};a.validateFormatOrRedrawForField=function(b){"object"!=typeof b&&(b=a.tuix.tabs[a.tuix.tab].fields[b]);var c=n(b.validate_onchange),d=n(b.format_onchange);b=n(b.redraw_onchange);if(c=c||a.errorOnTab(a.tuix.tab)&&(d||b))return a.validate(),!0;if(d)return a.format(),!0;b&&(a.readTab(),a.redrawTab());return b};
a.meMarkChanged=function(b,c,d){if(c===h||c!=d)a.tuix.tabs[a.tuix.tab].fields[b].multiple_edit._changed=!0,a.meSetCheckbox(b,!0)};a.meSetCheckbox=function(a,c){"checkbox"==k("multiple_edit__"+a).type?k("multiple_edit__"+a).checked=c:k("multiple_edit__"+a).value=c?1:""};a.meChange=function(b,c,d){if(b)a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit._changed=!0;else{if(!d&&n(a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit.warn_when_abandoning_changes)&&a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit.original_value!==
h&&a.readField(c)!=a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit.original_value){d='<input type="button" class="submit_selected" value="'+C.abandonChanges+'" onclick="zenarioAB.meChange(false, \''+r(c)+'\', true);"/><input type="button" class="submit" value="'+C.cancel+'"/>';p.floatingBox(C.abandonChangesConfirm,d,"warning");a.meSetCheckbox(c,!0);return}a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit._changed=!1;delete a.tuix.tabs[a.tuix.tab].fields[c].current_value;d=a.tuix.tabs[a.tuix.tab].fields[c];
var f=d.value;d.multiple_edit.original_value!==h&&(f=a.tuix.tabs[a.tuix.tab].fields[c].current_value=d.multiple_edit.original_value);k(c)&&!d.pick_items?"checkbox"==k(c).type?k(c).checked=f?!0:!1:$(k(c)).val(x(f,"","")):a.insertHTML(a.drawFields())}n(a.tuix.tabs[a.tuix.tab].fields[c].multiple_edit.disable_when_unchanged)&&(k(c)&&(k(c).disabled=!b),$(".control_for__"+c).each(function(a,c){c.disabled=!b;"button"==c.type&&(b?$(c).removeClass("submit_disabled"):$(c).addClass("submit_disabled"))}));a.meSetCheckbox(c,
b);a.validateFormatOrRedrawForField(c)};a.value=function(b,c,d,f){c||(c=a.tuix.tab);b=a.tuix.tabs[c].fields[b];d===h&&(d=!a.editModeOn(c));return b?f||"submit"!=b.type&&"toggle"!=b.type?d||b.current_value===h?b.value!==h?b.value:b.multiple_edit&&b.multiple_edit.original_value!==h?b.multiple_edit.original_value:h:b.current_value:b.pressed:h};a.readField=function(b){var c=h,d=a.tuix.tab,f=a.tuix.tabs[d].fields[b],e;if(!f||f.snippet||"submit"==f.type||"toggle"==f.type)return h;var l=!a.editModeOn()||
n(f.read_only),s=a.tuix.tabs[d].fields[b]._h;f.multiple_edit&&l&&delete a.tuix.tabs[d].fields[b].multiple_edit._changed;if("checkboxes"==f.type||"radios"==f.type){if(!l&&!s&&f.values){var m,s="",u=!0;for(m in f.values)g.has(f.values,m)&&k(b+"___"+m)&&k(b+"___"+m).checked&&(s+=(u?"":",")+m,u=!1);f.current_value=s}s=!0}else if(f.pick_items||f.upload)s=!0;if(s)return l||f.current_value===h?f.value:f.current_value;if(k("_value_for__"+b))a.tuix.tabs[d].fields[b].current_value=c=k("_value_for__"+b).value;
else if("editor"!=f.type&&"code_editor"!=f.type||l)if(!l&&(e=k(b))){if("checkbox"==f.type||"radio"==f.type)c=e.checked?!0:!1;else if("color_picker"==f.type||"colour_picker"==f.type)try{c=$(e).spectrum("get").toHexString()}catch(r){c=$(e).val()}else c=$(e).val();a.tuix.tabs[d].fields[b].current_value=c}else delete a.tuix.tabs[d].fields[b].current_value,c=f.value;else if(c=h,"editor"==f.type?F.tinyMCE&&tinyMCE.get(b)&&(c=p.tinyMCEGetContent(tinyMCE.get(b))):"code_editor"==f.type&&(e=ace.edit(b))&&(c=
e.getValue()),c!==h&&!1!==c)c=a.tuix.tabs[d].fields[b].current_value=c;else return f.current_value===h?f.value:f.current_value;return c};a.blankField=function(b){var c=a.tuix.tab;k(b)&&$(k(b)).val("");k("_value_for__"+b)&&(k("_value_for__"+b).value="");a.tuix.tabs[c].fields[b].current_value=""};a.readTab=function(){var b=a.tuix.tab,c,d={};a.lastScrollTop=$("#zenario_fbAdminInner").scrollTop();for(var f in a.tuix.tabs[b].fields)g.has(a.tuix.tabs[b].fields,f)&&(a.isInfoTag(f)||(c=a.readField(f))!==
h&&(d[f]=c));return d};a.wipeTab=function(){var b=a.tuix.tab,c;for(c in a.tuix.tabs[b].fields)g.has(a.tuix.tabs[b].fields,c)&&!a.isInfoTag(c)&&(delete a.tuix.tabs[b].fields[c].current_value,a.tuix.tabs[b].fields[c].multiple_edit&&delete a.tuix.tabs[b].fields[c].multiple_edit._changed)};a.redrawTab=function(){a.tuix.shake=!1;a.draw2()};a.size=function(){a.sizing&&clearTimeout(a.sizing);k("zenario_fbMain")&&(a.tuix&&n(a.tuix.hide_tab_bar)?(k("zenario_fbMain").style.top="0px",k("zenario_fbButtons").style.paddingBottom=
"7px",k("zenario_jqmTabs").style.display="none"):(k("zenario_fbMain").style.top="24px",k("zenario_fbButtons").style.paddingBottom="31px",k("zenario_jqmTabs").style.display=g.browserIsIE()?"":"inherit"));if(k("zenario_fbAdminInner")){var b=Math.floor(0.96*$(F).height()-(g.browserIsIE()?210:g.browserIsSafari()?202:205));a.tuix.max_height&&b>a.tuix.max_height&&(b=a.tuix.max_height);a.tuix&&n(a.tuix.hide_tab_bar)&&(b=1*b+24);0<(b*=1)&&(k("zenario_fbAdminInner").style.height=b+"px")}a.isOpen&&!1!==a.documentScrollTop&&
$(g.browserIsSafari()?"body":"html").scrollTop(0);a.sizing=setTimeout(a.size,250)};a.getURL=function(){++a.onKeyUpNum;return a.welcome?A+"zenario/admin/welcome_ajax.php?_json=1&_ab=1&task="+encodeURIComponent(a.task)+"&get="+encodeURIComponent(JSON.stringify(a.getRequest))+g.urlRequest(x(a.key,a.tuix.key)):A+"zenario/admin/ajax.php?_json=1&_ab=1&path="+encodeURIComponent(a.path)+g.urlRequest(a.getRequestKey)};a.editModeOn=function(b){if(!a.tuix||!a.tuix.tabs)return!1;b||(b=a.tuix.tab);return a.tuix.tabs[b].edit_mode?
a.tuix.tabs[b].edit_mode.on=n(a.tuix.tabs[b].edit_mode.enabled)&&(n(a.tuix.tabs[b].edit_mode.on)||a.editModeAlwaysOn(b)):!1};a.editModeAlwaysOn=function(b){return a.tuix.tabs[b].edit_mode.always_on===h||n(a.tuix.tabs[b].edit_mode.always_on)||a.savedAndContinued(b)};a.editCancelEnabled=function(b){return a.tuix.tabs[b].edit_mode&&n(a.tuix.tabs[b].edit_mode.enabled)&&!a.editModeAlwaysOn(b)};a.revertEnabled=function(b){return a.tuix.tabs[b].edit_mode&&n(a.tuix.tabs[b].edit_mode.enabled)&&a.editModeAlwaysOn(b)&&
!a.savedAndContinued(b)&&(a.tuix.tabs[b].edit_mode.enable_revert===h&&a.tuix.key&&a.tuix.key.id||n(a.tuix.tabs[b].edit_mode.enable_revert))};a.savedAndContinued=function(b){return a.tuix.tabs[b]._saved_and_continued};a.editModeOnBox=function(){if(a.tuix&&a.tuix.tabs&&a.sortedTabs)for(var b in a.sortedTabs)if(g.has(a.sortedTabs,b)&&a.editModeOn(a.sortedTabs[b]))return!0;return!1};a.isInfoTag=function(a){return"class_name"==a||"count"==a||"ord"==a};a.sortTabs=function(){a.sortedTabs=[];if(a.tuix.tabs)for(var b in a.tuix.tabs)g.has(a.tuix.tabs,
b)&&!a.isInfoTag(b)&&a.tuix.tabs[b]&&a.sortedTabs.push([b,a.tuix.tabs[b].ord]);a.sortedTabs.sort(p.sortArray);a.sortedFields={};for(b in a.sortedTabs)if(g.has(a.sortedTabs,b)){var c=a.sortedTabs[b]=a.sortedTabs[b][0];a.sortFields(c)}};a.sortFields=function(b){a.sortedFields[b]=[];if(a.tuix.tabs[b].fields)for(var c in a.tuix.tabs[b].fields)g.has(a.tuix.tabs[b].fields,c)&&!a.isInfoTag(c)&&a.tuix.tabs[b].fields[c]&&a.sortedFields[b].push([c,a.tuix.tabs[b].fields[c].ord]);a.sortedFields[b].sort(p.sortArray);
for(c in a.sortedFields[b])g.has(a.sortedFields[b],c)&&(a.sortedFields[b][c]=a.sortedFields[b][c][0])};a.syncAdminBoxFromClientToServer=function(){if(a.welcome)return JSON.stringify(a.tuix);var b={};a.syncAdminBoxFromClientToServerR(b,a.tuix);return JSON.stringify(b)};a.syncAdminBoxFromClientToServerR=function(b,c,d,f,e,l,k,m){if("object"==typeof c){var g,n;for(n in c)if((g="array")&&d===h&&"_sync"==n||(g="value")&&f===h&&"_sync"==d&&"session"==n||(g="value")&&f===h&&"_sync"==d&&"cache_dir"==n||(g=
"array")&&d===h&&"key"==n||(g="value")&&f===h&&"key"==d||(g="value")&&d===h&&"shake"==n||(g="value")&&d===h&&"download"==n||(g="array")&&d===h&&"tabs"==n||(g="array")&&f===h&&"tabs"==d||(g="array")&&e===h&&"tabs"==f&&"edit_mode"==n||(g="value")&&l===h&&"tabs"==e&&"edit_mode"==d&&"on"==n||(g="array")&&e===h&&"tabs"==f&&"fields"==n||(g="array")&&l===h&&"tabs"==e&&"fields"==d||(g="value")&&k===h&&"tabs"==l&&"fields"==f&&"_h"==n||(g="value")&&k===h&&"tabs"==l&&"fields"==f&&"_h_js"==n||(g="value")&&k===
h&&"tabs"==l&&"fields"==f&&"current_value"==n||(g="value")&&k===h&&"tabs"==l&&"fields"==f&&"_display_value"==n||(g="value")&&k===h&&"tabs"==l&&"fields"==f&&"pressed"==n||(g="array")&&k===h&&"tabs"==l&&"fields"==f&&"multiple_edit"==n||(g="value")&&m===h&&"tabs"==k&&"fields"==e&&"multiple_edit"==d&&"_changed"==n)"value"==g?"function"!=typeof c[n]&&"object"!=typeof c[n]&&(b[n]=c[n]):"array"==g&&"object"==typeof c[n]&&(b[n]={},a.syncAdminBoxFromClientToServerR(b[n],c[n],n,d,f,e,l,k))}};a.syncAdminBoxFromServerToClient=
function(b,c){for(var d in b)b[d]["[[__unset__]]"]?delete c[d]:c[d]===h||null===c[d]?c[d]=b[d]:b[d]["[[__replace__]]"]?(delete b[d]["[[__replace__]]"],c[d]=b[d]):"object"!=typeof c[d]?c[d]=b[d]:"object"==typeof c[d]&&"object"!=typeof b[d]?c[d]=b[d]:a.syncAdminBoxFromServerToClient(b[d],c[d])};a.getValueArrayofArrays=function(b){return g.nonAsyncAJAX(a.getURL(),g.urlRequest({_read_values:!0,_box:a.syncAdminBoxFromClientToServer()}),!b)};a.refreshParentAndClose=function(b,c){p.nowDoingSomething(!1);
c||(a.isOpen=!1);if(a.callBack&&!c){var d;(d=a.getValueArrayofArrays())&&a.callBack(a.tuix.key,d)}else if(H.init&&(p.storekeeperWindow||p.checkIfBoxIsOpen("og"))){d=!1;if(a.tuix.key.id!==h)d=a.tuix.key.id;else for(var f in a.tuix.key)if(g.has(a.tuix.key,f)){d=a.tuix.key[f];break}H.refreshToShowItem(d)}else a.tuix.key.slotName?(g.refreshPluginSlot(a.tuix.key.slotName,""),J.init&&J.init()):b||c||(a.tuix.key.cID?g.goToURL(g.linkToItem(a.tuix.key.cID,a.tuix.key.cType)):J.init&&g.goToURL(g.linkToItem(g.cID,
g.cType,"cVersion="+g.cVersion)));d=a.tuix.popout_message;c||a.close();d&&p.showMessage(d,!0,!1);if(c){a.changed={};if(a.tuix.tabs)for(f in a.tuix.tabs)g.has(a.tuix.tabs,f)&&!a.isInfoTag(f)&&a.tuix.tabs[f]&&a.editModeOn(f)&&(a.tuix.tabs[f]._saved_and_continued=!0);a.sortTabs();a.draw()}};a.close=function(b){a.callFunctionOnEditors("remove");p.nowDoingSomething(!1);a.sizing&&clearTimeout(a.sizing);b||p.closeFloatingBox();p.closeBox("AdminFloatingBox"+K);a.isOpen=!1;!1!==a.documentScrollTop&&($(g.browserIsSafari()?
"body":"html").scrollTop(a.documentScrollTop),a.documentScrollTop=!1);delete a.tuix;return!1};a.closeButton=function(b){var c=p.onbeforeunload();(c===h||!b&&confirm(c))&&a.isOpen&&a.close();return!1};a.callFunctionOnEditors=function(b){if(a.tuix&&a.tuix.tab&&a.tuix.tabs[a.tuix.tab]&&a.tuix.tabs[a.tuix.tab].fields&&F.tinyMCE)for(var c in a.tuix.tabs[a.tuix.tab].fields)if(g.has(a.tuix.tabs[a.tuix.tab].fields,c)&&"editor"==a.tuix.tabs[a.tuix.tab].fields[c].type&&tinyMCE.get(c))if("remove"==b)tinyMCE.get(c).remove();
else if("isDirty"==b&&tinyMCE.get(c).isDirty())return!0;return!1};a.validateAlias=function(){g.actAfterDelayIfNotSuperseded("validateAlias",a.validateAliasGo)};a.validateAliasGo=function(){var b={_validate_alias:1,alias:k("alias").value};a.tuix.key.cID&&(b.cID=a.tuix.key.cID);a.tuix.key.cType&&(b.cType=a.tuix.key.cType);a.tuix.key.equivId&&(b.equivId=a.tuix.key.equivId);k("language_id")&&(b.langId=k("language_id").value);k("update_translations")&&(b.lang_code_in_url="show","update_this"==k("update_translations").value&&
k("lang_code_in_url")&&(b.lang_code_in_url=k("lang_code_in_url").value));$.post(A+"zenario/admin/quick_ajax.php",b,function(a){if(!(a=p.readData(a)))return!1;var b="";if(a)for(var f in a)g.has(a,f)&&(b+=(b?"<br />":"")+a[f]);k("alias_warning_display").innerHTML=b},"text")};a.generateAlias=function(a){return a.toLowerCase().replace(/[\u00e1\u00c1\u00e0\u00c0\u00e2\u00c2\u00e5\u00c5\u00e4\u00c4\u00e3\u00c3\u00c6\u00e6\u00e7\u00c7\u00f0\u00d0\u00e9\u00c9\u00e8\u00c8\u00ea\u00ca\u00eb\u00cb\u00ed\u00cd\u00ec\u00cc\u00ee\u00ce\u00ef\u00cf\u00f1\u00d1\u00f3\u00d3\u00f2\u00d2\u00f4\u00d4\u00f6\u00d6\u00f5\u00d5\u00f8\u00d8\u0161\u0160\u00fa\u00da\u00f9\u00d9\u00fb\u00db\u00fc\u00dc\u00fd\u00dd\u017e\u017d]/g,
function(a){return{"\u00e1":"a","\u00c1":"a","\u00e0":"a","\u00c0":"a","\u00e2":"a","\u00c2":"a","\u00e5":"a","\u00c5":"a","\u00e4":"a","\u00c4":"a","\u00e3":"a","\u00c3":"a","\u00c6":"ae","\u00e6":"ae","\u00e7":"c","\u00c7":"c","\u00f0":"d","\u00d0":"d","\u00e9":"e","\u00c9":"e","\u00e8":"e","\u00c8":"e","\u00ea":"e","\u00ca":"e","\u00eb":"e","\u00cb":"e","\u00ed":"i","\u00cd":"i","\u00ec":"i","\u00cc":"i","\u00ee":"i","\u00ce":"i","\u00ef":"i","\u00cf":"i","\u00f1":"n","\u00d1":"n","\u00f3":"o",
"\u00d3":"o","\u00f2":"o","\u00d2":"o","\u00f4":"o","\u00d4":"o","\u00f6":"o","\u00d6":"o","\u00f5":"o","\u00d5":"o","\u00f8":"o","\u00d8":"o","\u0161":"s","\u0160":"s","\u00fa":"u","\u00da":"u","\u00f9":"u","\u00d9":"u","\u00fb":"u","\u00db":"u","\u00fc":"u","\u00dc":"u","\u00fd":"y","\u00dd":"y","\u017e":"z","\u017d":"z"}[a]}).replace(/&/g,"and").replace(/[^a-z0-9\s_-]/g,"").replace(/\s+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-+/g,"-").substr(0,50)};a.contentTitleChange=function(){k("menu_title")&&
!a.tuix.___menu_title_changed&&(k("menu_title").value=k("title").value.replace(/\s+/g," "),k("menu_title").onkeyup());k("alias")&&!a.tuix.___alias_changed&&(k("alias").value=a.generateAlias(k("title").value),a.validateAlias())};a.viewFrameworkSource=function(){var b=A+"zenario/admin/organizer.php#zenario__modules/show_frameworks//"+a.tuix.key.moduleId+"//"+g.encodeItemIdForStorekeeper(a.readField("framework"));F.open(b);return!1};a.adminPermChange=function(b,c,d,f,e){var g=!0;f===h&&(e=0,f=$("input[name="+
c+"]").each(function(a,b){b.checked&&++e}).size());0==e?(g=!1,c="zenario_permgroup_empty"):c=e<f?"zenario_permgroup_half_full":"zenario_permgroup_full";k(b).checked=a.tuix.tabs[a.tuix.tab].fields[b].current_value=g;$(k("row__"+b)).removeClass("zenario_permgroup_empty").removeClass("zenario_permgroup_half_full").removeClass("zenario_permgroup_full").addClass(c);k(d).value=a.tuix.tabs[a.tuix.tab].fields[d].value=a.tuix.tabs[a.tuix.tab].fields[d].current_value=e+"/"+f};a.adminParentPermChange=function(b,
c,d){var f=0,e=0,h="",n=k(b).checked,m=$("input[name="+c+"]"),p;for(p in a.tuix.tabs[a.tuix.tab].fields[c].values)g.has(a.tuix.tabs[a.tuix.tab].fields[c].values,p)&&!a.isInfoTag(p)&&(++f,n&&(h+=(h?",":"")+p,++e));m.size()&&m.each(function(a,b){b.checked=n});a.tuix.tabs[a.tuix.tab].fields[c].current_value=h;a.adminPermChange(b,c,d,f,e)};a.previewDateFormat=function(b,c){g.actAfterDelayIfNotSuperseded(b,function(){a.previewDateFormatGo(b,c)})};a.previewDateFormatGo=function(a,c){(a=k(a))&&(c=k(c))&&
(c.value=g.pluginClassAJAX("zenario_common_features",{previewDateFormat:a.value}))};a.quickValidateWelcomePage=function(b){g.actAfterDelayIfNotSuperseded("quickValidateWelcomePage",a.quickValidateWelcomePageGo,b)};a.quickValidateWelcomePageGo=function(){var b={},c;for(c in a.tuix.tabs[a.tuix.tab].fields)g.has(a.tuix.tabs[a.tuix.tab].fields,c)&&(a.isInfoTag(c)||(b[c]=x(a.tuix.tabs[a.tuix.tab].fields[c].row_class,"","")));$.post(A+"zenario/admin/welcome_ajax.php?quickValidate=1",{tab:a.tuix.tab,path:a.welcome?
"":a.path,values:JSON.stringify(a.readTab()),row_classes:JSON.stringify(b)},function(b){if(!(b=p.readData(b)))return!1;if(b&&b.row_classes)for(var c in b.row_classes)g.has(b.row_classes,c)&&a.tuix.tabs[a.tuix.tab].fields[c]&&k("row__"+c)&&(a.tuix.tabs[a.tuix.tab].fields[c].row_class=b.row_classes[c],k("row__"+c).className="zenario_ab_row zenario_ab_row__"+c+" "+b.row_classes[c]);if(b&&b.snippets)for(c in b.snippets)g.has(b.snippets,c)&&a.tuix.tabs[a.tuix.tab].fields[c]&&a.tuix.tabs[a.tuix.tab].fields[c].snippet&&
a.tuix.tabs[a.tuix.tab].fields[c].snippet.html&&k("snippet__"+c)&&(a.tuix.tabs[a.tuix.tab].fields[c].snippet.html=b.snippets[c],k("snippet__"+c).innerHTML=b.snippets[c])},"text");return!0}},"");
