zenario.lib(function(g,u,D,p,E,F,f,h,a,r,s,n,z,v,B,G,w,H,x,t,y){a.init("zenarioAB");FAB_NAME="AdminFloatingBox";FAB_LEFT=50;FAB_TOP=2;FAB_PADDING_HEIGHT=188;FAB_TAB_BAR_HEIGHT=53;FAB_WIDTH=960;PLUGIN_SETTINGS_WIDTH=800;PLUGIN_SETTINGS_MIN_WIDTH_FOR_PREVIEW=1100;PLUGIN_SETTINGS_BORDER_WIDTH=4;a.open=function(b,c,d,e,g,m,q,C){if(h.checkIfBoxIsOpen("AdminOrganizer"))return!1;!1===a.documentScrollTop&&(a.documentScrollTop=$(f.browserIsSafari()?"body":"html").scrollTop());c||(c={});b=(""+b).split("//",
2);b[1]&&!c.id&&(c.id=b[1]);b=b[0];a.isOpen=!0;a.callBack=g;a.passMatchedIds=C;a.createAnotherObject=m;a.getRequestKey=c;a.changed={};a.isSlidUp=!1;a.previewHidden=!0;a.hasPreviewWindow=!1;a.lastPreviewValues=!1;a.previewSlotWidth=!1;a.previewSlotWidthInfo="";a.heightBeforeSlideUp=!1;a.baseCSSClass="zenario_fbAdmin zenario_admin_box zenario_fab_"+b;q||(g=h.microTemplate(a.mtPrefix,{}),h.openBox(g,a.baseCSSClass,FAB_NAME,!1,FAB_WIDTH,FAB_LEFT,FAB_TOP,!0,!0,".zenario_fabHead",!1),n("zenario_fbAdminFloatingBox").style.display=
"none");p.onbeforeunload=h.onbeforeunload;a.start(b,c,d,e);return a.cb=new f.callback};a.initFields=function(){a.hasPreviewWindow=!!a.pluginPreviewURL();x(y).initFields.call(a)};a.refreshParentAndClose=function(b,c,d){h.nowDoingSomething(!1);var e={};c||(a.isOpen=!1);if(a.callBack&&!c){var A;(A=a.getValueArrayofArrays())&&a.callBack(a.tuix.key,A)}else if(s.init&&(h.isFullOrganizerWindow||h.checkIfBoxIsOpen("og"))){b=!1;if(a.tuix.key.id!==g)b=a.tuix.key.id;else for(var m in a.tuix.key)if(t(a.tuix.key,
m)){b=a.tuix.key[m];break}s.refreshToShowItem(b,d&&w.createdAnother,!c&&w.savedButNotShown)}else f.cID&&a.tuix.key.slotName?(f.refreshPluginSlot(a.tuix.key.slotName,"",h.importantGetRequests),r.init&&r.init()):!f.cID||"zenario_menu"!=a.path&&"zenario_menu_text"!=a.path?b||c||(a.tuix.key.cID?(a.tuix.key.cID==f.cID&&a.tuix.key.cType==f.cType&&(e=h.importantGetRequests),f.goToURL(f.linkToItem(a.tuix.key.cID,a.tuix.key.cType,e))):r.init&&(e=_.clone(h.importantGetRequests),e.cVersion=f.cVersion,f.goToURL(f.linkToItem(f.cID,
f.cType,e)))):(h.reloadMenuPlugins(),r.init&&r.init());b=a.tuix.popout_message;d=d&&a.createAnotherObject;c||d||(a.cb&&a.cb.call(),a.close());b&&h.showMessage(b,!0,!1);if(c){a.changed={};if(a.tuix.tabs)for(m in a.tuix.tabs)t(a.tuix.tabs,m)&&a.tuix.tabs[m]&&a.editModeOn(m)&&(a.tuix.tabs[m]._saved_and_continued=!0);a.sortTabs();a.draw()}else d&&($("#zenario_abtab").clearQueue(),delete a.tuix,a.open(a.createAnotherObject.path,a.getRequestKey,a.createAnotherObject.tab,a.createAnotherObject.values,g,a.createAnotherObject,
!0,a.passMatchedIds))};a.close=function(b){a.callFunctionOnEditors("remove");h.nowDoingSomething(!1);a.sizing&&clearTimeout(a.sizing);a.stopPoking();f.clearAllDelays();b||h.closeFloatingBox();h.closeBox(FAB_NAME);a.isOpen=!1;!1!==a.documentScrollTop&&($(f.browserIsSafari()?"body":"html").scrollTop(a.documentScrollTop),a.documentScrollTop=!1);delete a.cb;delete a.tuix;delete a.lastPreviewValues;delete a.previewSlotWidth;delete a.previewSlotWidthInfo;return!1};a.closeButton=function(b){var c=h.onbeforeunload();
(c===g||!b&&confirm(c))&&a.isOpen&&a.close();return!1};a.setData=function(b){a.syncAdminBoxFromServerToClient(b,a.tuix)};a.syncAdminBoxFromServerToClient=function(b,c){for(var d in b)b[d]["[[__unset__]]"]?delete c[d]:c[d]===g||null===c[d]?c[d]=b[d]:b[d]["[[__replace__]]"]?(delete b[d]["[[__replace__]]"],c[d]=b[d]):"object"!=typeof c[d]?c[d]=b[d]:"object"==typeof c[d]&&"object"!=typeof b[d]?c[d]=b[d]:a.syncAdminBoxFromServerToClient(b[d],c[d])};a.sendStateToServer=function(){var b={};a.syncAdminBoxFromClientToServerR(b,
a.tuix);return JSON.stringify(b)};a.syncAdminBoxFromClientToServerR=function(b,c,d,e,f,m,h,n){if("object"==typeof c){var l,k;for(k in c)if((l="array")&&d===g&&"_sync"==k||(l="value")&&e===g&&"_sync"==d&&"session"==k||(l="value")&&e===g&&"_sync"==d&&"cache_dir"==k||(l="value")&&e===g&&"_sync"==d&&"password"==k||(l="value")&&e===g&&"_sync"==d&&"iv"==k||(l="array")&&d===g&&"key"==k||(l="value")&&e===g&&"key"==d||(l="value")&&d===g&&"shake"==k||(l="value")&&d===g&&"download"==k||(l="array")&&d===g&&"tabs"==
k||(l="array")&&e===g&&"tabs"==d||(l="array")&&f===g&&"tabs"==e&&"edit_mode"==k||(l="value")&&m===g&&"tabs"==f&&"edit_mode"==d&&"on"==k||(l="array")&&f===g&&"tabs"==e&&"fields"==k||(l="array")&&m===g&&"tabs"==f&&"fields"==d||(l="value")&&h===g&&"tabs"==m&&"fields"==e&&"current_value"==k||(l="value")&&h===g&&"tabs"==m&&"fields"==e&&"_display_value"==k||(l="value")&&h===g&&"tabs"==m&&"fields"==e&&"_was_hidden_before"==k||(l="value")&&h===g&&"tabs"==m&&"fields"==e&&"pressed"==k||(l="array")&&h===g&&
"tabs"==m&&"fields"==e&&"multiple_edit"==k||(l="value")&&n===g&&"tabs"==h&&"fields"==f&&"multiple_edit"==d&&"_changed"==k)"value"==l?"function"!=typeof c[k]&&"object"!=typeof c[k]&&(b[k]=c[k]):"array"==l&&"object"==typeof c[k]&&(b[k]={},a.syncAdminBoxFromClientToServerR(b[k],c[k],k,d,e,f,m,h))}};a.draw=function(){a.isOpen&&a.loaded&&a.tabHidden&&a.draw2()};a.draw2=function(){if(a.tuix.tabs){n("zenario_fbAdminFloatingBox").className=a.baseCSSClass+" "+(a.tuix.css_class||"zenario_fab_default_style")+
" "+(z(a.tuix.hide_tab_bar)?"zenario_admin_box_with_tabs_hidden":"zenario_admin_box_with_tabs_shown");!a.tuix.tab||a.tuix.tabs[a.tuix.tab]&&!h.hidden(a.tuix.tabs[a.tuix.tab])||(a.tuix.tab=!1);n("zenario_fabTabs").innerHTML=a.drawTabs();var b=!a.editModeOnBox(),c="",c={isReadOnly:b};a.setTitle(b);a.showCloseButton();n("zenario_fbButtons").innerHTML=h.microTemplate("zenario_admin_box_buttons",c);f.addJQueryElements("#zenario_fbButtons ",!0);n("zenario_fbAdminFloatingBox").style.display="block";a.size(!0);
h.nowDoingSomething(!1);b=new f.callback;c=a.drawFields(b);a.animateInTab(c,b,$("#zenario_abtab"));a.shownTab=a.tuix.tab;delete a.lastScrollTop;a.startPoking()}};a.setTitle=function(b){var c,d,e,f,g,q,p=$("#zenario_fabId");if(a.tuix.key&&a.tuix.key.id&&(c=a.tuix.title_for_existing_records))for(e in d=a.getValues1D(!1,!0,!0),d){if(t(d,e)&&(f=d[e],-1!=c.indexOf("[["+e+"]]")))for(;c!=(g=c.replace("[["+e+"]]",f));)c=g}else c=a.tuix.title;c?($("#zenario_fabTitleWrap").css("display","block"),$("#zenario_fabTitleWrap").addClass(" zenario_no_drag"),
n("zenario_fabTitle").innerHTML=v(c)):$("#zenario_fabTitleWrap").css("display","none");b?$("#zenario_fabBox_readonlyMarker").css("display","block"):$("#zenario_fabBox_readonlyMarker").css("display","none");a.tuix.key&&(q=a.tuix.identifier)&&(q.value=q.value||a.tuix.key.id)?p.show().html(h.microTemplate("zenario_admin_box_identifier",q)):p.hide()};a.showCloseButton=function(){this.tuix.cancel_button_message?$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display","none"):$("#zenario_fbAdminFloatingBox .zenario_fabClose").css("display",
"block")};a.lastSize=!1;a.previewHidden=!0;a.size=function(b){a.sizing&&clearTimeout(a.sizing);var c=Math.floor($(p).width()),d=Math.floor($(p).height()),e;c&&d&&!a.isSlidUp&&((e=a.lastSize!=c+"x"+d)||b)&&(a.lastSize=c+"x"+d,e=a.tuix&&z(a.tuix.hide_tab_bar),n("zenario_fbMain")&&(e?(n("zenario_fbMain").style.top="0px",n("zenario_fbButtons").style.paddingBottom="7px",n("zenario_fabTabs").style.display="none"):(n("zenario_fbMain").style.top="24px",n("zenario_fbButtons").style.paddingBottom="31px",n("zenario_fabTabs").style.display=
f.browserIsIE()?"":"inherit")),b=FAB_PADDING_HEIGHT,e&&(b-=FAB_TAB_BAR_HEIGHT),b+=$("#zenario_fabTitleWrap").height(),d=Math.floor(0.96*d),maxBoxWidth=Math.floor(0.96*c),c=d-b,(e=1*(a.tuix&&a.tuix.max_height))&&c>e&&(c=e,d=e+b),c&&0<c&&$("#zenario_fbAdminInner").height(c),d&&0<d&&($("#zenario_fabBox").height(d),$("#zenario_fabPreview").height(d)),a.tuix&&a.tuix.css_class&&a.tuix.css_class.match(/zenario_fab_plugin\b/)?($("#zenario_fabBox").width(PLUGIN_SETTINGS_WIDTH),(previewHidden=!a.hasPreviewWindow||
maxBoxWidth<PLUGIN_SETTINGS_MIN_WIDTH_FOR_PREVIEW)?(c=PLUGIN_SETTINGS_WIDTH,a.previewWidth=!1,a.lastPreviewValues=!1):(c=a.previewSlotWidth?Math.min(maxBoxWidth,PLUGIN_SETTINGS_WIDTH+PLUGIN_SETTINGS_BORDER_WIDTH+a.previewSlotWidth):maxBoxWidth,a.previewWidth=c-PLUGIN_SETTINGS_WIDTH-PLUGIN_SETTINGS_BORDER_WIDTH,$("#zenario_fabPreview").width(a.previewWidth),a.previewSlotWidthInfo?$("#zenario_fabPreviewInfo").show().text(a.previewSlotWidthInfo):$("#zenario_fabPreviewInfo").hide())):($("#zenario_fabBox").width(FAB_WIDTH),
c=FAB_WIDTH,a.previewWidth=!1,a.lastPreviewValues=!1,previewHidden=!0),a.hasPreviewWindow?previewHidden?$("#zenario_fb"+FAB_NAME).removeClass("zenario_fab_with_no_preview").addClass("zenario_fab_with_preview").addClass("zenario_fab_with_preview_hidden").removeClass("zenario_fab_with_preview_shown"):$("#zenario_fb"+FAB_NAME).removeClass("zenario_fab_with_no_preview").addClass("zenario_fab_with_preview").removeClass("zenario_fab_with_preview_hidden").addClass("zenario_fab_with_preview_shown"):$("#zenario_fb"+
FAB_NAME).addClass("zenario_fab_with_no_preview").removeClass("zenario_fab_with_preview").removeClass("zenario_fab_with_preview_hidden").removeClass("zenario_fab_with_preview_shown"),a.previewHidden!=previewHidden&&((a.previewHidden=previewHidden)||a.updatePreview()),h.adjustBox(FAB_NAME,!1,c,FAB_LEFT,FAB_TOP));a.isOpen&&!1!==a.documentScrollTop&&$(f.browserIsSafari()?"body":"html").scrollTop(a.documentScrollTop);a.sizing=setTimeout(a.size,250)};a.returnAJAXURL=function(b){return"start"==b&&a.passMatchedIds&&
s.lastRequests?u+"zenario/admin/organizer.ajax.php?_get_matched_ids=1&_fab_path="+encodeURIComponent(a.path)+"&path="+encodeURIComponent(s.path)+f.urlRequest(s.lastRequests)+f.urlRequest(a.getRequestKey):u+"zenario/admin/admin_boxes.ajax.php?path="+encodeURIComponent(a.path)+f.urlRequest(a.getRequestKey)};a.pluginPreviewURL=function(b,c){if("plugin_settings"!=a.path||!f.slots||!(b=b||a.tuix&&a.tuix.key&&a.tuix.key.slotName)||!(c=c||a.tuix&&a.tuix.key&&a.tuix.key.instanceId||f.slots[b].instanceId))return!1;
var d=h.getGridSlotDetails(b),e=_.clone(h.importantGetRequests),g,m=d&&d.cssClass&&d.cssClass.split(" ")||[];e.cVersion=f.cVersion;e.slotName=b;e.instanceId=c;e.method_call="showSingleSlot";e.fakeLayout=1;e.grid_columns=d.columns;e.grid_container=d.container;a.previewSlotWidth=d.pxWidth;a.previewSlotWidthInfo=d.widthInfo;e.grid_pxWidth=a.previewWidth?a.previewWidth:a.previewSlotWidth;e.grid_cssClass="";for(g in m)t(m,g)&&(d=m[g],"alpha"==d||"omega"==d||d.match(/^span[\d_]*$/)||(e.grid_cssClass+=d+
" "));return f.linkToItem(f.cID,f.cType,e)};a.addExtraAttsForTextFields=function(b,c){a.hasPreviewWindow&&(c.onkeyup=B(c.onkeyup,"","")+" zenarioAB.updatePreview();")};a.fieldChange=function(b,c){a.updatePreview(750);x(y).fieldChange.call(a,b,c)};a.updatePreview=function(b){a.hasPreviewWindow&&!a.previewHidden&&f.actAfterDelayIfNotSuperseded("fabUpdatePreview",a.updatePreview2,b||1E3)};a.updatePreview2=function(){var b=JSON.stringify(a.getValues1D(!0));a.lastPreviewValues!=b&&(a.lastPreviewValues=
b,$('<form action="'+v(a.pluginPreviewURL())+'" method="post" target="zenario_fabPreviewFrame"><input name="overrideSettings" value="'+v(b)+'"/></form>').appendTo("body").hide().submit().remove())};a.showPreviewInPopoutBox=function(){var b=a.pluginPreviewURL(),c=JSON.stringify(a.getValues1D(!0));b&&($.colorbox({width:Math.floor(0.7*$(p).width()),height:Math.floor(0.9*$(p).height()),iframe:!0,preloading:!1,open:!0,title:a.previewSlotWidthInfo||w.preview,href:b+"&overrideSettings="+encodeURIComponent(c),
className:"zenario_plugin_preview_popout_box"}),$("#colorbox,#cboxOverlay,#cboxWrapper").css("z-index","333000"))};a.slideToggle=function(){a.isSlidUp?a.slideDown():a.slideUp()};a.slideUp=function(){if(!a.isSlidUp){var b=$("#zenario_fabBox_Header").height(),c=$("#zenario_fabBox");a.heightBeforeSlideUp=c.height();$("#zenario_fabBox_Body").stop(!0).slideUp();c.stop(!0).animate({height:b});$("#zenario_fabSlideToggle").addClass("zenario_fabSlideToggleUp").removeClass("zenario_fabSlideToggleDown");a.isSlidUp=
!0}};a.slideDown=function(){a.isSlidUp&&($("#zenario_fabBox_Body").stop(!0).slideDown(),$("#zenario_fabBox").stop(!0).animate({height:a.heightBeforeSlideUp},function(){a.size(!0)}),$("#zenario_fabSlideToggle").addClass("zenario_fabSlideToggleDown").removeClass("zenario_fabSlideToggleUp"),a.isSlidUp=!1)};a.clickTab=function(b){a.slideDown();x(y).clickTab.call(a,b)};a.stopPoking=function(){a.poking&&clearInterval(a.poking);a.poking=!1};a.startPoking=function(){a.poking||(a.poking=setInterval(a.poke,
12E4))};a.poke=function(){f.ajax(u+"zenario/admin/quick_ajax.php?keep_session_alive=1")}},zenarioAF);
