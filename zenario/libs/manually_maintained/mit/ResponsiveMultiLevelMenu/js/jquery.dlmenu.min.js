(function(b,e,n){var h=e.Modernizr,m=b("body");b.DLMenu=function(a,c){this.$el=b(c);this._init(a)};b.DLMenu.defaults={animationClasses:{classin:"dl-animate-in-1",classout:"dl-animate-out-1"},onLevelClick:function(a,c){return!1},onLinkClick:function(a,c){return!1},backLabel:"Back",useActiveItemAsBackLabel:!1,useActiveItemAsLink:!1};b.DLMenu.prototype={_init:function(a){this.options=b.extend(!0,{},b.DLMenu.defaults,a);this._config();this.animEndEventName={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",
msAnimation:"MSAnimationEnd",animation:"animationend"}[h.prefixed("animation")]+".dlmenu";this.transEndEventName={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[h.prefixed("transition")]+".dlmenu";this.supportAnimations=h.cssanimations;this.supportTransitions=h.csstransitions;this._initEvents()},_config:function(){this.open=!1;this.$trigger=this.$el.children(".dl-trigger");this.$menu=this.$el.children("ul.dl-menu");
this.$menuitems=this.$menu.find("li:not(.dl-back)");this.$el.find("ul.dl-submenu").prepend('<li class="dl-back"><a href="#">'+this.options.backLabel+"</a></li>");this.$back=this.$menu.find("li.dl-back");this.options.useActiveItemAsBackLabel&&this.$back.each(function(){var a=b(this),c=a.parents("li:first").find("a:first").text();a.find("a").html(c)});this.options.useActiveItemAsLink&&this.$el.find("ul.dl-submenu").prepend(function(){var a=b(this).parents("li:not(.dl-back):first").find("a:first");return'<li class="dl-parent"><a href="'+
a.attr("href")+'">'+a.text()+"</a></li>"})},_initEvents:function(){var a=this;this.$trigger.on("click.dlmenu",function(){a.open?a._closeMenu():(a._openMenu(),m.off("click").children().on("click.dlmenu",function(){a._closeMenu()}));return!1});this.$menuitems.on("click.dlmenu",function(c){c.stopPropagation();var d=b(this),k=d.children("ul.dl-submenu");if(0<k.length&&!b(c.currentTarget).hasClass("dl-subviewopen")){var f=k.clone().css("opacity",0).insertAfter(a.$menu),g=function(){a.$menu.off(a.animEndEventName).removeClass(a.options.animationClasses.classout).addClass("dl-subview");
d.addClass("dl-subviewopen").parents(".dl-subviewopen:first").removeClass("dl-subviewopen").addClass("dl-subview");f.remove()};setTimeout(function(){f.addClass(a.options.animationClasses.classin);a.$menu.addClass(a.options.animationClasses.classout);if(a.supportAnimations)a.$menu.on(a.animEndEventName,g);else g.call();a.options.onLevelClick(d,d.children("a:first").text())});return!1}a.options.onLinkClick(d,c)});this.$back.on("click.dlmenu",function(c){var d=b(this);c=d.parents("ul.dl-submenu:first");
var k=c.parent(),f=c.clone().insertAfter(a.$menu),g=function(){a.$menu.off(a.animEndEventName).removeClass(a.options.animationClasses.classin);f.remove()};setTimeout(function(){f.addClass(a.options.animationClasses.classout);a.$menu.addClass(a.options.animationClasses.classin);if(a.supportAnimations)a.$menu.on(a.animEndEventName,g);else g.call();k.removeClass("dl-subviewopen");var l=d.parents(".dl-subview:first");l.is("li")&&l.addClass("dl-subviewopen");l.removeClass("dl-subview")});return!1})},closeMenu:function(){this.open&&
this._closeMenu()},_closeMenu:function(){var a=this,c=function(){a.$menu.off(a.transEndEventName);a._resetMenu()};this.$menu.removeClass("dl-menuopen");this.$menu.addClass("dl-menu-toggle");this.$trigger.removeClass("dl-active");if(this.supportTransitions)this.$menu.on(this.transEndEventName,c);else c.call();this.open=!1},openMenu:function(){this.open||this._openMenu()},_openMenu:function(){var a=this;m.off("click").on("click.dlmenu",function(){a._closeMenu()});this.$menu.addClass("dl-menuopen dl-menu-toggle").on(this.transEndEventName,
function(){b(this).removeClass("dl-menu-toggle")});this.$trigger.addClass("dl-active");this.open=!0},_resetMenu:function(){this.$menu.removeClass("dl-subview");this.$menuitems.removeClass("dl-subview dl-subviewopen")}};b.fn.dlmenu=function(a){if("string"===typeof a){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=b.data(this,"dlmenu");d?b.isFunction(d[a])&&"_"!==a.charAt(0)?d[a].apply(d,c):e.console&&e.console.error("no such method '"+a+"' for dlmenu instance"):e.console&&
e.console.error("cannot call methods on dlmenu prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){var d=b.data(this,"dlmenu");d?d._init():b.data(this,"dlmenu",new b.DLMenu(a,this))});return this}})(jQuery,window);
