(function(b){"function"===typeof define&&define.amd?define(["jquery","./jquery.fileupload"],b):"object"===typeof exports?b(require("jquery")):b(window.jQuery)})(function(b){var k=b.blueimp.fileupload.prototype.options.add;b.widget("blueimp.fileupload",b.blueimp.fileupload,{options:{processQueue:[],add:function(c,d){var a=b(this);d.process(function(){return a.fileupload("process",d)});k.call(this,c,d)}},processActions:{},_processFile:function(c,d){var a=this,f=b.Deferred().resolveWith(a,[c]).promise();
this._trigger("process",null,c);b.each(c.processQueue,function(g,e){g=function(h){return d.errorThrown?b.Deferred().rejectWith(a,[d]).promise():a.processActions[e.action].call(a,h,e)};f=f.pipe(g,e.always&&g)});f.done(function(){a._trigger("processdone",null,c);a._trigger("processalways",null,c)}).fail(function(){a._trigger("processfail",null,c);a._trigger("processalways",null,c)});return f},_transformProcessQueue:function(c){var d=[];b.each(c.processQueue,function(){var a={},f=this.action,g=!0===
this.prefix?f:this.prefix;b.each(this,function(e,h){"string"===b.type(h)&&"@"===h.charAt(0)?a[e]=c[h.slice(1)||(g?g+e.charAt(0).toUpperCase()+e.slice(1):e)]:a[e]=h});d.push(a)});c.processQueue=d},processing:function(){return this._processing},process:function(c){var d=this,a=b.extend({},this.options,c);a.processQueue&&a.processQueue.length&&(this._transformProcessQueue(a),0===this._processing&&this._trigger("processstart"),b.each(c.files,function(f){var g=f?b.extend({},a):a,e=function(){return c.errorThrown?
b.Deferred().rejectWith(d,[c]).promise():d._processFile(g,c)};g.index=f;d._processing+=1;d._processingQueue=d._processingQueue.pipe(e,e).always(function(){--d._processing;0===d._processing&&d._trigger("processstop")})}));return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=b.Deferred().resolveWith(this).promise()}})});
