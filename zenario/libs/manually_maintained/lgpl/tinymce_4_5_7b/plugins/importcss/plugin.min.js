tinymce.PluginManager.add("importcss",function(d){function r(b){var a=tinymce.Env.cacheSuffix;"string"==typeof b&&(b=b.replace("?"+a,"").replace("&"+a,""));return b}function s(b){var a=d.settings,e=!1!==a.skin?a.skin||"lightgray":!1;return e?(a=(a=a.skin_url)?d.documentBaseURI.toAbsolute(a):tinymce.baseURL+"/skins/"+e,b===a+"/content"+(d.inline?".inline":"")+".min.css"):!1}function k(b){return"string"==typeof b?function(a){return-1!==a.indexOf(b)}:b instanceof RegExp?function(a){return b.test(a)}:
b}function t(b,a){function e(b,d){var h=b.href,n;if((h=r(h))&&a(h,d)&&!s(h)){f(b.imports,function(a){e(a,!0)});try{n=b.cssRules||b.rules}catch(g){}f(n,function(a){a.styleSheet?e(a.styleSheet,!0):a.selectorText&&f(a.selectorText.split(","),function(a){c.push(tinymce.trim(a))})})}}var c=[],g={};f(d.contentCSS,function(a){g[a]=!0});a||(a=function(a,b){return b||g[a]});f(b.styleSheets,function(a){e(a)});return c}function p(b){var a,e=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(b);if(e){var c=e[1],
g=e[2].substr(1).split(".").join(" "),f=tinymce.makeMap("a,img");e[1]?(a={title:b},d.schema.getTextBlockElements()[c]?a.block=c:d.schema.getBlockElements()[c]||f[c.toLowerCase()]?a.selector=c:a.inline=c):e[2]&&(a={inline:"span",title:b.substr(1),classes:g});!1!==d.settings.importcss_merge_classes?a.classes=g:a.attributes={"class":g};return a}}function u(b,a){return tinymce.util.Tools.grep(b,function(b){return!b.filter||b.filter(a)})}function v(b){return tinymce.util.Tools.map(b,function(a){return tinymce.util.Tools.extend({},
a,{original:a,selectors:{},filter:k(a.filter),item:{text:a.title,menu:[]}})})}var q=this,f=tinymce.each;d.on("renderFormatsMenu",function(b){var a=d.settings,e={},c=k(a.importcss_selector_filter),g=b.control,l=v(a.importcss_groups),m=function(a,b){if(!(null===b||!1!==d.settings.importcss_exclusive?a in e:a in b.selectors)){null===b||!1!==d.settings.importcss_exclusive?e[a]=!0:b.selectors[a]=!0;var c;c=d.settings;if(c=(b&&b.selector_converter?b.selector_converter:c.importcss_selector_converter?c.importcss_selector_converter:
p).call(q,a,b)){var f=c.name||tinymce.DOM.uniqueId();d.formatter.register(f,c);return tinymce.extend({},g.settings.itemDefaults,{text:c.title,format:f})}}return null};d.settings.importcss_append||g.items().remove();f(t(b.doc||d.getDoc(),k(a.importcss_file_filter)),function(a){if(-1===a.indexOf(".mce-")&&(!c||c(a))){var b=u(l,a);0<b.length?tinymce.util.Tools.each(b,function(b){var c=m(a,b);c&&b.item.menu.push(c)}):(b=m(a,null))&&g.add(b)}});f(l,function(a){0<a.item.menu.length&&g.add(a.item)});b.control.renderNew()});
q.convertSelectorToFormat=p});
