tinymce.PluginManager.add("pagebreak",function(a){var f=a.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),g=RegExp(f.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi"),e='<img src="'+tinymce.Env.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />';a.addCommand("mcePageBreak",function(){a.settings.pagebreak_split_block?a.insertContent("<p>"+e+"</p>"):a.insertContent(e)});a.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"});
a.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"});a.on("ResolveName",function(b){"IMG"==b.target.nodeName&&a.dom.hasClass(b.target,"mce-pagebreak")&&(b.name="pagebreak")});a.on("click",function(b){b=b.target;"IMG"===b.nodeName&&a.dom.hasClass(b,"mce-pagebreak")&&a.selection.select(b)});a.on("BeforeSetContent",function(a){a.content=a.content.replace(g,e)});a.on("PreInit",function(){a.serializer.addNodeFilter("img",function(b){for(var e=b.length,c,d;e--;)c=
b[e],(d=c.attr("class"))&&-1!==d.indexOf("mce-pagebreak")&&(d=c.parent,a.schema.getBlockElements()[d.name]&&a.settings.pagebreak_split_block?(d.type=3,d.value=f,d.raw=!0,c.remove()):(c.type=3,c.value=f,c.raw=!0))})})});
