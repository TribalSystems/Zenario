tinymce.PluginManager.add("visualchars",function(b){function g(){var a=this;b.on("VisualChars",function(b){a.active(b.state)})}var n=this,e;b.addCommand("mceVisualChars",function(a){function g(b){return'<span data-mce-bogus="1" class="mce-'+f[b]+'">'+b+"</span>"}function p(){var b,a="";for(b in f)a&&(a+=","),a+="span.mce-"+f[b];return a}var c,d;c=b.getBody();var k=b.selection,l,m,f,h;f={"\u00a0":"nbsp","\u00ad":"shy"};e=!e;n.state=e;b.fire("VisualChars",{state:e});h=function(){var b,a="";for(b in f)a+=
b;return RegExp("["+a+"]","g")}();a&&(m=k.getBookmark());if(e)for(d=[],tinymce.walk(c,function(a){3==a.nodeType&&a.nodeValue&&h.test(a.nodeValue)&&d.push(a)},"childNodes"),a=0;a<d.length;a++){c=d[a].nodeValue;c=c.replace(h,g);for(l=b.dom.create("div",null,c);c=l.lastChild;)b.dom.insertAfter(c,d[a]);b.dom.remove(d[a])}else for(d=b.dom.select(p(),c),a=d.length-1;0<=a;a--)b.dom.remove(d[a],1);k.moveToBookmark(m)});b.addButton("visualchars",{title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g});
b.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g,selectable:!0,context:"view",prependToContext:!0})});
