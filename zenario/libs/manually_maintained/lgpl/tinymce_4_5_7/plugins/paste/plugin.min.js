(function(B,H){function L(g,n){for(var c,k=[],e=0;e<g.length;++e){if(!(c=C[g[e]]))a:{c=B;for(var b=g[e].split(/[.\/]/),a=0;a<b.length;++a){if(!c[b[a]]){c=void 0;break a}c=c[b[a]]}}if(!c)throw"module definition dependecy not found: "+g[e];k.push(c)}n.apply(null,k)}function z(g,n,c){if("string"!==typeof g)throw"invalid module definition, module id must be defined and be a string";if(n===H)throw"invalid module definition, dependencies must be specified";if(c===H)throw"invalid module definition, definition function must be specified";
L(n,function(){C[g]=c.apply(null,arguments)})}var C={};z("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(g,n,c){function k(b,a){g.each(a,function(a){b=a.constructor==RegExp?b.replace(a,""):b.replace(a[0],a[1])});return b}var e=function(b){var a=b.indexOf("\x3c!--StartFragment--\x3e");if(-1!==a){var a=b.substr(a+20),c=a.indexOf("\x3c!--EndFragment--\x3e");if(-1!==c&&/^<\/(p|h[1-6]|li)>/i.test(a.substr(c+18,5)))return a.substr(0,c)}return b};
return{filter:k,innerText:function(b){function a(b){var c=b.name,e=b;if("br"===c)l+="\n";else if(p[c]&&(l+=" "),d[c])l+=" ";else{3==b.type&&(l+=b.value);if(!b.shortEnded&&(b=b.firstChild)){do a(b);while(b=b.next)}r[c]&&e.next&&(l+="\n","p"==c&&(l+="\n"))}}var e=new c,m=new n({},e),l="",p=e.getShortEndedElements(),d=g.makeMap("script noscript style textarea video audio iframe object"," "),r=e.getBlockElements();b=k(b,[/<!\[[^\]]+\]>/g]);a(m.parse(b));return l},trimHtml:function(b){return b=k(e(b),
[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(a,b,c){return b||c?"\u00a0":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},createIdGenerator:function(b){var a=0;return function(){return b+a++}}}});z("tinymce/pasteplugin/SmartPaste",["tinymce/util/Tools"],function(g){var n=function(a){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(a)},c=function(a){return n(a)&&
/.(gif|jpe?g|png)$/.test(a)},k=function(a,b,d){a.undoManager.extra(function(){d(a,b)},function(){a.insertContent('<img src="'+b+'">')});return!0},e=function(a,b,d){a.undoManager.extra(function(){d(a,b)},function(){a.execCommand("mceInsertLink",!1,b)});return!0},b=function(a,b,d){return!1===a.selection.isCollapsed()&&n(b)?e(a,b,d):!1},a=function(a,b,d){return c(b)?k(a,b,d):!1},s=function(a,b){a.insertContent(b,{merge:!1!==a.settings.paste_merge_formats,paste:!0});return!0},m=function(c,p){g.each([b,
a,s],function(a){return!0!==a(c,p,s)})};return{isImageUrl:c,isAbsoluteUrl:n,insertContent:function(a,b){!1===a.settings.smart_paste?s(a,b):m(a,b)}}});z("tinymce/pasteplugin/Clipboard","tinymce/Env tinymce/dom/RangeUtils tinymce/util/VK tinymce/pasteplugin/Utils tinymce/pasteplugin/SmartPaste tinymce/util/Delay".split(" "),function(g,n,c,k,e,b){return function(a){function s(b){var q,h=a.dom;q=a.fire("BeforePastePreProcess",{content:b});q=a.fire("PastePreProcess",q);b=q.content;q.isDefaultPrevented()||
(a.hasEventListeners("PastePostProcess")&&!q.isDefaultPrevented()&&(b=h.add(a.getBody(),"div",{style:"display:none"},b),q=a.fire("PastePostProcess",{node:b}),h.remove(b),b=q.node.innerHTML),q.isDefaultPrevented()||e.insertContent(a,b))}function m(b){b=a.dom.encode(b).replace(/\r\n/g,"\n");var q=a.dom.getParent(a.selection.getStart(),a.dom.isBlock),h=a.settings.forced_root_block,f;h&&(f=a.dom.createHTML(h,a.settings.forced_root_block_attrs),f=f.substr(0,f.length-3)+">");q&&/^(PRE|DIV)$/.test(q.nodeName)||
!h?b=k.filter(b,[[/\n/g,"<br>"]]):(b=k.filter(b,[[/\n\n/g,"</p>"+f],[/^(.*<\/p>)(<p>)$/,f+"$1"],[/\n/g,"<br />"]]),-1!=b.indexOf("<p>")&&(b=f+b));s(b)}function l(){function b(a){var h,f;f=a.startContainer;h=a.getClientRects();if(h.length)return h[0];if(a.collapsed&&1==f.nodeType){for(a=f.childNodes[w.startOffset];a&&3==a.nodeType&&!a.data.length;)a=a.nextSibling;if(a&&("BR"==a.tagName&&(f=q.doc.createTextNode("\ufeff"),a.parentNode.insertBefore(f,a),a=q.createRng(),a.setStartBefore(f),a.setEndAfter(f),
h=a.getClientRects(),q.remove(f)),h.length))return h[0]}}var q=a.dom,h=a.getBody(),f=a.dom.getViewPort(a.getWin()).y,d=20,c;w=a.selection.getRng();a.inline&&(c=a.selection.getScrollContainer())&&0<c.scrollTop&&(f=c.scrollTop);if(w.getClientRects)if(d=b(w))d=f+(d.top-q.getPos(h).y);else if(d=f,f=w.startContainer)3==f.nodeType&&f.parentNode!=h&&(f=f.parentNode),1==f.nodeType&&(d=q.getPos(f,c||h).y);u=q.add(a.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+
d+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},F);(g.ie||g.gecko)&&q.setStyle(u,"left","rtl"==q.getStyle(h,"direction",!0)?65535:-65535);q.bind(u,"beforedeactivate focusin focusout",function(a){a.stopPropagation()});u.focus();a.selection.select(u,!0)}function p(){if(u){for(var b;b=a.dom.get("mcepastebin");)a.dom.remove(b),a.dom.unbind(b);w&&a.selection.setRng(w)}u=w=null}function d(){var b="",d,h,f;d=a.dom.select("div[id=mcepastebin]");for(h=0;h<d.length;h++)f=d[h],f.firstChild&&
"mcepastebin"==f.firstChild.id&&(f=f.firstChild),f=f.innerHTML,b!=F&&(b+=f);return b}function r(a){var b={};if(a){if(a.getData){var h=a.getData("Text");h&&0<h.length&&-1==h.indexOf(z)&&(b["text/plain"]=h)}if(a.types)for(h=0;h<a.types.length;h++){var f=a.types[h];b[f]=a.getData(f)}}return b}function I(a){return v(a,"text/html")||v(a,"text/plain")}function t(a){var b;b=a.indexOf(",");return-1!==b?a.substr(b+1):null}function D(b,d,h){b&&(a.selection.setRng(b),b=null);b=d.result;var f=t(b);d=new Image;
d.src=b;(a.settings.images_dataimg_filter?a.settings.images_dataimg_filter(d):1)?(b=a.editorUpload.blobCache,(d=b.findFirst(function(a){return a.base64()===f}))?h=d:(h=b.create(M(),h,f),b.add(h)),s('<img src="'+h.blobUri()+'">')):s('<img src="'+b+'">')}function A(b,d){function h(a){var h,f,c=!1;if(a)for(h=0;h<a.length;h++)f=a[h],/^image\/(jpeg|png|gif|bmp)$/.test(f.type)&&(c=f.getAsFile?f.getAsFile():f,f=new FileReader,f.onload=D.bind(null,d,f,c),f.readAsDataURL(c),b.preventDefault(),c=!0);return c}
var f=b.clipboardData||b.dataTransfer;if(a.settings.paste_data_images&&f)return h(f.items)||h(f.files)}function x(a){a=a.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&a&&a.items&&0===a.items.length}function v(a,b){return b in a&&0<a[b].length}function y(){function y(b,f,c){var e;v(b,"text/html")?e=b["text/html"]:(e=d(),e==F&&(c=!0));e=k.trimHtml(e);u&&u.firstChild&&"mcepastebin"===u.firstChild.id&&(c=!0);p();e.length||(c=!0);c&&(e=v(b,"text/plain")&&-1==e.indexOf("</p>")?b["text/plain"]:
k.innerText(e));e==F?f||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):c?m(e):s(e)}function e(a){return(a=a["text/plain"])?0===a.indexOf("file://"):!1}a.on("keydown",function(b){function f(a){(c.metaKeyPressed(a)&&86==a.keyCode||a.shiftKey&&45==a.keyCode)&&!a.isDefaultPrevented()&&p()}(c.metaKeyPressed(b)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)&&!b.isDefaultPrevented()&&(E=b.shiftKey&&86==b.keyCode,E&&g.webkit&&-1!=navigator.userAgent.indexOf("Version/")||
(b.stopImmediatePropagation(),J=(new Date).getTime(),g.ie&&E?(b.preventDefault(),a.fire("paste",{ieFake:!0})):(p(),l(),a.once("keyup",f),a.once("paste",function(){a.off("keyup",f)}))))});a.on("paste",function(h){var f=(new Date).getTime(),c=r(h.clipboardData||a.getDoc().dataTransfer),f=(new Date).getTime()-f,e=1E3>(new Date).getTime()-J-f,q="text"==G.pasteFormat||E;E=!1;h.isDefaultPrevented()||x(h)?p():!I(c)&&A(h,w||a.selection.getRng())?p():(e||h.preventDefault(),!g.ie||e&&!h.ieFake||(l(),a.dom.bind(u,
"paste",function(a){a.stopPropagation()}),a.getDoc().execCommand("Paste",!1,null),c["text/html"]=d()),v(c,"text/html")?(h.preventDefault(),y(c,e,q)):b.setEditorTimeout(a,function(){y(c,e,q)},0))});a.on("dragstart dragend",function(a){K="dragstart"==a.type});a.on("drop",function(h){var f,d;d=n.getCaretRangeFromPoint(h.clientX,h.clientY,a.getDoc());if(!h.isDefaultPrevented()&&!K&&(f=r(h.dataTransfer),(I(f)&&!e(f)||!A(h,d))&&d&&!1!==a.settings.paste_filter_drop)){var c=f["mce-internal"]||f["text/html"]||
f["text/plain"];c&&(h.preventDefault(),b.setEditorTimeout(a,function(){a.undoManager.transact(function(){f["mce-internal"]&&a.execCommand("Delete");a.selection.setRng(d);c=k.trimHtml(c);f["text/html"]?s(c):m(c)})}))}});a.on("dragover dragend",function(b){a.settings.paste_data_images&&b.preventDefault()})}var G=this,u,w,J=0,K=!1,F="%MCEPASTEBIN%",E,z="data:text/mce-internal,",M=k.createIdGenerator("mceclip");G.pasteHtml=s;G.pasteText=m;G.pasteImageData=A;a.on("preInit",function(){y();a.parser.addNodeFilter("img",
function(b,d,h){function f(a){a.attr("data-mce-object")||c===g.transparentSrc||a.remove()}if(!a.settings.paste_data_images&&h.data&&!0===h.data.paste)for(d=b.length;d--;){var c=b[d].attributes.map.src;c&&(0===c.indexOf("webkit-fake-url")?f(b[d]):a.settings.allow_html_data_urls||0!==c.indexOf("data:")||f(b[d]))}})})}});z("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),function(g,
n,c,k,e,b){function a(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function s(a){var b;a=a.replace(/^[\u00a0 ]+/,"");g.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],
function(d){if(d.test(a))return b=!0,!1});return b}function m(l){var p=l.settings;l.on("BeforePastePreProcess",function(d){function r(a){function b(a){var d="";if(3===a.type)return a.value;if(a=a.firstChild){do d+=b(a);while(a=a.next)}return d}function d(a,b){if(3===a.type&&b.test(a.value))return a.value=a.value.replace(b,""),!1;if(a=a.firstChild){do if(!d(a,b))return!1;while(a=a.next)}return!0}function c(a){if(a._listIgnore)a.remove();else if(a=a.firstChild){do c(a);while(a=a.next)}}function p(a,
b,r){var y=a._listLevel||k;y!=k&&(y<k?g&&(g=g.parent.parent):(l=g,g=null));g&&g.name==b?g.append(a):(l=l||g,g=new e(b,1),1<r&&g.attr("start",""+r),a.wrap(g));a.name="li";y>k&&l&&l.lastChild.append(g);k=y;c(a);d(a,/^\u00a0+/);d(a,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);d(a,/^\u00a0+/)}for(var g,l,k=1,n=[],r=a.firstChild;"undefined"!==typeof r&&null!==r;)if(n.push(r),r=r.walk(),null!==r)for(;"undefined"!==typeof r&&r.parent!==a;)r=r.walk();for(r=0;r<n.length;r++)if(a=n[r],"p"==a.name&&a.firstChild){var m=
b(a);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(m))p(a,"ul");else if(s(m)){var m=/([0-9]+)\./.exec(m),q=1;m&&(q=parseInt(m[1],10));p(a,"ol",q)}else a._listLevel?p(a,"ul",1):g=null}else l=g,g=null}function m(a,b){var d={},c,p=l.dom.parseStyle(b);g.each(p,function(e,g){switch(g){case "mso-list":if(c=/\w+ \w+([0-9]+)/i.exec(b))a._listLevel=parseInt(c[1],10);/Ignore/i.test(e)&&a.firstChild&&(a._listIgnore=!0,a.firstChild._listIgnore=!0);break;case "horiz-align":g="text-align";break;case "vert-align":g=
"vertical-align";break;case "font-color":case "mso-foreground":g="color";break;case "mso-background":case "mso-highlight":g="background";break;case "font-weight":case "font-style":"normal"!=e&&(d[g]=e);return;case "mso-element":if(/^(comment|comment-list)$/i.test(e)){a.remove();return}}0===g.indexOf("mso-comment")?a.remove():0!==g.indexOf("mso-")&&("all"==D||A&&A[g])&&(d[g]=e)});/(bold)/i.test(d["font-weight"])&&(delete d["font-weight"],a.wrap(new e("b",1)));/(italic)/i.test(d["font-style"])&&(delete d["font-style"],
a.wrap(new e("i",1)));return(d=l.dom.serializeStyle(d,a.name))?d:null}var t=d.content,D,A,t=t.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),t=t.replace(/<br class="?Apple-interchange-newline"?>/gi,"");(D=p.paste_retain_style_properties)&&(A=g.makeMap(D.split(/[, ]/)));if(!1!==p.paste_enable_default_filters&&a(d.content)){d.wordContent=!0;var t=b.filter(t,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,
"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return 0<b.length?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join("\u00a0"):""}]]),x=p.paste_word_valid_elements;x||(x="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");x=new c({valid_elements:x,valid_children:"-li[p]"});
g.each(x.elements,function(a){a.attributes["class"]||(a.attributes["class"]={},a.attributesOrder.push("class"));a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});var v=new n({},x);v.addAttributeFilter("style",function(a){for(var b=a.length,d;b--;)d=a[b],d.attr("style",m(d,d.attr("style"))),"span"==d.name&&d.parent&&!d.attributes.length&&d.unwrap()});v.addAttributeFilter("class",function(a){for(var b=a.length,d,c;b--;)d=a[b],c=d.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(c)&&
d.remove(),d.attr("class",null)});v.addNodeFilter("del",function(a){for(var b=a.length;b--;)a[b].remove()});v.addNodeFilter("a",function(a){for(var b=a.length,d,c,e;b--;)d=a[b],c=d.attr("href"),e=d.attr("name"),c&&-1!=c.indexOf("#_msocom_")?d.remove():(c&&0===c.indexOf("file://")&&(c=c.split("#")[1])&&(c="#"+c),c||e?e&&!/^_?(?:toc|edn|ftn)/i.test(e)?d.unwrap():d.attr({href:c,name:e}):d.unwrap())});t=v.parse(t);!1!==p.paste_convert_word_fake_lists&&r(t);d.content=(new k({validate:p.validate},x)).serialize(t)}})}
m.isWordContent=a;return m});z("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(g,n,c,k){return function(e){function b(a){e.on("BeforePastePreProcess",function(b){b.content=a(b.content)})}function a(a){e.on("PastePostProcess",function(b){a(b.node)})}function s(a){if(!c.isWordContent(a))return a;var b=[];n.each(e.schema.getBlockElements(),function(a,c){b.push(c)});var g=RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+
b.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");a=k.filter(a,[[g,"$1"]]);return a=k.filter(a,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function m(a){if(c.isWordContent(a))return a;var b=e.settings.paste_webkit_styles;if(!1===e.settings.paste_remove_styles_if_webkit||"all"==b)return a;b&&(b=b.split(/[, ]/));if(b){var g=e.dom,l=e.selection.getNode();a=a.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,c,e,k){a=g.parseStyle(e,"span");e={};if("none"===b)return c+
k;for(var m=0;m<b.length;m++){var n=a[b[m]],p=g.getStyle(l,b[m],!0);/color/.test(b[m])&&(n=g.toHex(n),p=g.toHex(p));p!=n&&(e[b[m]]=n)}return(e=g.serializeStyle(e,"span"))?c+' style="'+e+'"'+k:c+k})}else a=a.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return a=a.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,b,c,d){return b+' style="'+c+'"'+d})}function l(a){e.$("a",a).find("font,u").each(function(a,b){e.dom.remove(b,!0)})}g.webkit&&b(m);g.ie&&(b(s),a(l))}});z("tinymce/pasteplugin/Plugin",
["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(g,n,c,k){var e;g.add("paste",function(b){function a(){if("text"==l.pasteFormat)l.pasteFormat="html",b.fire("PastePlainTextToggle",{state:!1});else if(l.pasteFormat="text",b.fire("PastePlainTextToggle",{state:!0}),!e&&!1!==b.settings.paste_plaintext_inform){var a=b.translate("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");
b.notificationManager.open({text:a,type:"info"});e=!0}b.focus()}function s(){var a=this;a.active("text"===l.pasteFormat);b.on("PastePlainTextToggle",function(b){a.active(b.state)})}var m=this,l,p=b.settings;if(/(^|[ ,])powerpaste([, ]|$)/.test(p.plugins)&&g.get("powerpaste"))"undefined"!==typeof console&&console.log&&console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option.");else{m.clipboard=l=new n(b);m.quirks=new k(b);m.wordFilter=new c(b);b.settings.paste_as_text&&
(m.clipboard.pasteFormat="text");if(p.paste_preprocess)b.on("PastePreProcess",function(a){p.paste_preprocess.call(m,m,a)});if(p.paste_postprocess)b.on("PastePostProcess",function(a){p.paste_postprocess.call(m,m,a)});b.addCommand("mceInsertClipboardContent",function(a,b){b.content&&m.clipboard.pasteHtml(b.content);b.text&&m.clipboard.pasteText(b.text)});if(b.settings.paste_block_drop)b.on("dragend dragover draggesture dragdrop drop drag",function(a){a.preventDefault();a.stopPropagation()});if(!b.settings.paste_data_images)b.on("drop",
function(a){var b=a.dataTransfer;b&&b.files&&0<b.files.length&&a.preventDefault()});b.addCommand("mceTogglePlainTextPaste",a);b.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:a,onPostRender:s});b.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:l.pasteFormat,onclick:a,onPostRender:s})}})});(function(g){var n,c,k,e;for(n=0;n<g.length;n++){c=B;k=g[n];e=k.split(/[.\/]/);for(var b=0;b<e.length-1;++b)c[e[b]]===H&&(c[e[b]]={}),c=c[e[b]];c[e[e.length-1]]=C[k]}if(B.AMDLC_TESTS){c=
B.privateModules||{};for(k in C)c[k]=C[k];for(n=0;n<g.length;n++)delete c[g[n]];B.privateModules=c}})(["tinymce/pasteplugin/Utils"])})(window);
