'use strict';(function(){var A={},u=function(b,e,m){if("string"!==typeof b)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+b;if(void 0===m)throw"no definition function for "+b;A[b]={deps:e,defn:m,instance:void 0}},B=function(b){var e=A[b];if(void 0===e)throw"module ["+b+"] was undefined";if(void 0===e.instance){for(var m=A[b],l=m.deps,v=m.defn,t=l.length,g=Array(t),d=0;d<t;++d)g[d]=B(l[d]);l=v.apply(null,g);if(void 0===l)throw"module ["+b+"] returned undefined";m.instance=
l}return e.instance};u("ephox.katamari.api.Cell",[],function(){var b=function(e){var m=e;return{get:function(){return m},set:function(l){m=l},clone:function(){return b(m)}}};return b});(function(b,e){u(b,[],function(){return e})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);u("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.PluginManager")});u("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.util.Tools")});
u("tinymce.core.html.DomParser",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.html.DomParser")});u("tinymce.core.html.Node",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.html.Node")});u("tinymce.core.html.Serializer",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.html.Serializer")});u("tinymce.plugins.fullpage.api.Settings",[],function(){return{shouldHideInSourceView:function(b){return b.getParam("fullpage_hide_in_source_view")},getDefaultXmlPi:function(b){return b.getParam("fullpage_default_xml_pi")},
getDefaultEncoding:function(b){return b.getParam("fullpage_default_encoding")},getDefaultFontFamily:function(b){return b.getParam("fullpage_default_font_family")},getDefaultFontSize:function(b){return b.getParam("fullpage_default_font_size")},getDefaultTextColor:function(b){return b.getParam("fullpage_default_text_color")},getDefaultTitle:function(b){return b.getParam("fullpage_default_title")},getDefaultDocType:function(b){return b.getParam("fullpage_default_doctype","<!DOCTYPE html>")}}});u("tinymce.plugins.fullpage.core.Parser",
["tinymce.core.html.DomParser","tinymce.core.html.Node","tinymce.core.html.Serializer","tinymce.core.util.Tools","tinymce.plugins.fullpage.api.Settings"],function(b,e,m,l,v){var t=function(g){return(new b({validate:!1,root_name:"#document"})).parse(g)};return{parseHeader:t,htmlToData:function(g,d){d=t(d);var c={};c.fontface=v.getDefaultFontFamily(g);c.fontsize=v.getDefaultFontSize(g);g=d.firstChild;7===g.type&&(c.xml_pi=!0,g=/encoding="([^"]+)"/.exec(g.value))&&(c.docencoding=g[1]);if(g=d.getAll("#doctype")[0])c.doctype=
"<!DOCTYPE"+g.value+">";(g=d.getAll("title")[0])&&g.firstChild&&(c.title=g.firstChild.value);l.each(d.getAll("meta"),function(f){var h=f.attr("name"),k=f.attr("http-equiv");h?c[h.toLowerCase()]=f.attr("content"):"Content-Type"===k&&(f=/charset\s*=\s*(.*)\s*/gi.exec(f.attr("content")))&&(c.docencoding=f[1])});if(g=d.getAll("html")[0])c.langcode=g.attr("lang")||g.attr("xml:lang")||"";c.stylesheets=[];l.each(d.getAll("link"),function(f){"stylesheet"===f.attr("rel")&&c.stylesheets.push(f.attr("href"))});
if(g=d.getAll("body")[0])c.langdir=g.attr("dir")||"",c.style=g.attr("style")||"",c.visited_color=g.attr("vlink")||"",c.link_color=g.attr("link")||"",c.active_color=g.attr("alink")||"";return c},dataToHtml:function(g,d,c){function f(n,y,w){n.attr(y,w?w:void 0)}function h(n){q.firstChild?q.insert(n,q.firstChild):q.append(n)}var k=g.dom;var p=t(c);var q=p.getAll("head")[0];if(!q){var a=p.getAll("html")[0];q=new e("head",1);a.firstChild?a.insert(q,a.firstChild,!0):a.append(q)}a=p.firstChild;d.xml_pi?
(c='version="1.0"',d.docencoding&&(c+=' encoding="'+d.docencoding+'"'),7!==a.type&&(a=new e("xml",7),p.insert(a,p.firstChild,!0)),a.value=c):a&&7===a.type&&a.remove();a=p.getAll("#doctype")[0];d.doctype?(a||(a=new e("#doctype",10),d.xml_pi?p.insert(a,p.firstChild):h(a)),a.value=d.doctype.substring(9,d.doctype.length-1)):a&&a.remove();a=null;l.each(p.getAll("meta"),function(n){"Content-Type"===n.attr("http-equiv")&&(a=n)});d.docencoding?(a||(a=new e("meta",1),a.attr("http-equiv","Content-Type"),a.shortEnded=
!0,h(a)),a.attr("content","text/html; charset="+d.docencoding)):a&&a.remove();a=p.getAll("title")[0];d.title?(a?a.empty():(a=new e("title",1),h(a)),a.append(new e("#text",3)).value=d.title):a&&a.remove();l.each(["keywords","description","author","copyright","robots"],function(n){var y=p.getAll("meta"),w,r=d[n];for(w=0;w<y.length;w++){var z=y[w];if(z.attr("name")===n){r?z.attr("content",r):z.remove();return}}r&&(a=new e("meta",1),a.attr("name",n),a.attr("content",r),a.shortEnded=!0,h(a))});var x={};
l.each(p.getAll("link"),function(n){"stylesheet"===n.attr("rel")&&(x[n.attr("href")]=n)});l.each(d.stylesheets,function(n){x[n]||(a=new e("link",1),a.attr({rel:"stylesheet",text:"text/css",href:n}),a.shortEnded=!0,h(a));delete x[n]});l.each(x,function(n){n.remove()});if(a=p.getAll("body")[0])f(a,"dir",d.langdir),f(a,"style",d.style),f(a,"vlink",d.visited_color),f(a,"link",d.link_color),f(a,"alink",d.active_color),k.setAttribs(g.getBody(),{style:d.style,dir:d.dir,vLink:d.visited_color,link:d.link_color,
aLink:d.active_color});if(a=p.getAll("html")[0])f(a,"lang",d.langcode),f(a,"xml:lang",d.langcode);q.firstChild||q.remove();g=(new m({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"})).serialize(p);return g.substring(0,g.indexOf("</body>"))}}});u("tinymce.plugins.fullpage.ui.Dialog",["tinymce.core.util.Tools","tinymce.plugins.fullpage.core.Parser"],function(b,e){return{open:function(m,
l){var v=e.htmlToData(m,l.get());m.windowManager.open({title:"Document properties",data:v,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(t){t=e.dataToHtml(m,b.extend(v,t.data),l.get());l.set(t)}})}}});u("tinymce.plugins.fullpage.api.Commands",["tinymce.plugins.fullpage.ui.Dialog"],function(b){return{register:function(e,
m){e.addCommand("mceFullPageProperties",function(){b.open(e,m)})}}});u("tinymce.plugins.fullpage.core.Protect",["tinymce.core.util.Tools"],function(b){return{protectHtml:function(e,m){b.each(e,function(l){m=m.replace(l,function(v){return"\x3c!--mce:protected "+escape(v)+"--\x3e"})});return m},unprotectHtml:function(e){return e.replace(/\x3c!--mce:protected ([\s\S]*?)--\x3e/g,function(m,l){return unescape(l)})}}});u("tinymce.plugins.fullpage.core.FilterContent",["tinymce.core.util.Tools","tinymce.plugins.fullpage.api.Settings",
"tinymce.plugins.fullpage.core.Parser","tinymce.plugins.fullpage.core.Protect"],function(b,e,m,l){var v=b.each,t=function(c){return c.replace(/<\/?[A-Z]+/g,function(f){return f.toLowerCase()})},g=function(c,f,h,k){var p="",q=c.dom;if(!k.selection){var a=l.protectHtml(c.settings.protect,k.content);if("raw"!==k.format||!f.get())if(!k.source_view||!e.shouldHideInSourceView(c)){0!==a.length||k.source_view||(a=b.trim(f.get())+"\n"+b.trim(a)+"\n"+b.trim(h.get()));a=a.replace(/<(\/?)BODY/gi,"<$1body");var x=
a.indexOf("<body");if(-1!==x){x=a.indexOf(">",x);f.set(t(a.substring(0,x+1)));var n=a.indexOf("</body",x);-1===n&&(n=a.length);k.content=b.trim(a.substring(x+1,n));h.set(t(a.substring(n)))}else f.set(d(c)),h.set("\n</body>\n</html>");f=m.parseHeader(f.get());v(f.getAll("style"),function(r){r.firstChild&&(p+=r.firstChild.value)});(h=f.getAll("body")[0])&&q.setAttribs(c.getBody(),{style:h.attr("style")||"",dir:h.attr("dir")||"",vLink:h.attr("vlink")||"",link:h.attr("link")||"",aLink:h.attr("alink")||
""});q.remove("fullpage_styles");var y=c.getDoc().getElementsByTagName("head")[0];p&&(q.add(y,"style",{id:"fullpage_styles"},p),h=q.get("fullpage_styles"),h.styleSheet&&(h.styleSheet.cssText=p));var w={};b.each(y.getElementsByTagName("link"),function(r){"stylesheet"===r.rel&&r.getAttribute("data-mce-fullpage")&&(w[r.href]=r)});b.each(f.getAll("link"),function(r){var z=r.attr("href");if(!z)return!0;w[z]||"stylesheet"!==r.attr("rel")||q.add(y,"link",{rel:"stylesheet",text:"text/css",href:z,"data-mce-fullpage":"1"});
delete w[z]});b.each(w,function(r){r.parentNode.removeChild(r)})}}},d=function(c){var f="",h="";if(e.getDefaultXmlPi(c)){var k=e.getDefaultEncoding(c);f+='<?xml version="1.0" encoding="'+(k?k:"ISO-8859-1")+'" ?>\n'}f+=e.getDefaultDocType(c);f+="\n<html>\n<head>\n";if(k=e.getDefaultTitle(c))f+="<title>"+k+"</title>\n";if(k=e.getDefaultEncoding(c))f+='<meta http-equiv="Content-Type" content="text/html; charset='+k+'" />\n';if(k=e.getDefaultFontFamily(c))h+="font-family: "+k+";";if(k=e.getDefaultFontSize(c))h+=
"font-size: "+k+";";if(k=e.getDefaultTextColor(c))h+="color: "+k+";";return f+("</head>\n<body"+(h?' style="'+h+'"':"")+">\n")};return{setup:function(c,f,h){c.on("BeforeSetContent",function(k){g(c,f,h,k)});c.on("GetContent",function(k){var p=f.get(),q=h.get();k.selection||k.source_view&&e.shouldHideInSourceView(c)||(k.content=l.unprotectHtml(b.trim(p)+"\n"+b.trim(k.content)+"\n"+b.trim(q)))})}}});u("tinymce.plugins.fullpage.ui.Buttons",[],function(){return{register:function(b){b.addButton("fullpage",
{title:"Document properties",cmd:"mceFullPageProperties"});b.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})}}});u("tinymce.plugins.fullpage.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.fullpage.api.Commands","tinymce.plugins.fullpage.core.FilterContent","tinymce.plugins.fullpage.ui.Buttons"],function(b,e,m,l,v){e.add("fullpage",function(t){var g=b(""),d=b("");m.register(t,g);v.register(t);l.setup(t,g,d)});return function(){}});
B("tinymce.plugins.fullpage.Plugin")()})();
