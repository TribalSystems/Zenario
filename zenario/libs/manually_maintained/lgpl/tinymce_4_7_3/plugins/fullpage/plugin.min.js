(function(){var t={},v=function(a){var e=t[a];if(void 0===e)throw"module ["+a+"] was undefined";if(void 0===e.instance){for(var h=t[a],l=h.deps,k=h.defn,p=l.length,q=Array(p),f=0;f<p;++f)q[f]=v(l[f]);l=k.apply(null,q);if(void 0===l)throw"module ["+a+"] returned undefined";h.instance=l}return e.instance},k=function(a,e,h){if("string"!==typeof a)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+a;if(void 0===h)throw"no definition function for "+a;t[a]={deps:e,defn:h,instance:void 0}};
k("ephox.katamari.api.Cell",[],function(){var a=function(e){var h=e;return{get:function(){return h},set:function(a){h=a},clone:function(){return a(h)}}};return a});(function(a,e){k(a,[],function(){return e})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);k("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(a){return a("tinymce.PluginManager")});k("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(a){return a("tinymce.util.Tools")});
k("tinymce.core.html.DomParser",["global!tinymce.util.Tools.resolve"],function(a){return a("tinymce.html.DomParser")});k("tinymce.core.html.Node",["global!tinymce.util.Tools.resolve"],function(a){return a("tinymce.html.Node")});k("tinymce.core.html.Serializer",["global!tinymce.util.Tools.resolve"],function(a){return a("tinymce.html.Serializer")});k("tinymce.plugins.fullpage.api.Settings",[],function(){return{shouldHideInSourceView:function(a){return a.getParam("fullpage_hide_in_source_view")},getDefaultXmlPi:function(a){return a.getParam("fullpage_default_xml_pi")},
getDefaultEncoding:function(a){return a.getParam("fullpage_default_encoding")},getDefaultFontFamily:function(a){return a.getParam("fullpage_default_font_family")},getDefaultFontSize:function(a){return a.getParam("fullpage_default_font_size")},getDefaultTextColor:function(a){return a.getParam("fullpage_default_text_color")},getDefaultTitle:function(a){return a.getParam("fullpage_default_title")},getDefaultDocType:function(a){return a.getParam("fullpage_default_doctype","<!DOCTYPE html>")}}});k("tinymce.plugins.fullpage.core.Parser",
["tinymce.core.html.DomParser","tinymce.core.html.Node","tinymce.core.html.Serializer","tinymce.core.util.Tools","tinymce.plugins.fullpage.api.Settings"],function(a,e,h,l,k){var p=function(e){return(new a({validate:!1,root_name:"#document"})).parse(e)};return{parseHeader:p,htmlToData:function(a,e){var m=p(e),d={},c;d.fontface=k.getDefaultFontFamily(a);d.fontsize=k.getDefaultFontSize(a);c=m.firstChild;7===c.type&&(d.xml_pi=!0,c=/encoding="([^"]+)"/.exec(c.value))&&(d.docencoding=c[1]);if(c=m.getAll("#doctype")[0])d.doctype=
"<!DOCTYPE"+c.value+">";(c=m.getAll("title")[0])&&c.firstChild&&(d.title=c.firstChild.value);l.each(m.getAll("meta"),function(a){var c=a.attr("name"),b=a.attr("http-equiv");c?d[c.toLowerCase()]=a.attr("content"):"Content-Type"===b&&(a=/charset\s*=\s*(.*)\s*/gi.exec(a.attr("content")))&&(d.docencoding=a[1])});if(c=m.getAll("html")[0])d.langcode=c.attr("lang")||""||c.attr("xml:lang")||"";d.stylesheets=[];l.each(m.getAll("link"),function(a){"stylesheet"===a.attr("rel")&&d.stylesheets.push(a.attr("href"))});
if(c=m.getAll("body")[0])d.langdir=c.attr("dir")||"",d.style=c.attr("style")||"",d.visited_color=c.attr("vlink")||"",d.link_color=c.attr("link")||"",d.active_color=c.attr("alink")||"";return d},dataToHtml:function(a,f,m){function d(a,b,c){a.attr(b,c?c:void 0)}function c(a){n.firstChild?n.insert(a,n.firstChild):n.append(a)}var g,n,b,k=a.dom;g=p(m);n=g.getAll("head")[0];n||(b=g.getAll("html")[0],n=new e("head",1),b.firstChild?b.insert(n,b.firstChild,!0):b.append(n));b=g.firstChild;f.xml_pi?(m='version="1.0"',
f.docencoding&&(m+=' encoding="'+f.docencoding+'"'),7!==b.type&&(b=new e("xml",7),g.insert(b,g.firstChild,!0)),b.value=m):b&&7===b.type&&b.remove();b=g.getAll("#doctype")[0];f.doctype?(b||(b=new e("#doctype",10),f.xml_pi?g.insert(b,g.firstChild):c(b)),b.value=f.doctype.substring(9,f.doctype.length-1)):b&&b.remove();b=null;l.each(g.getAll("meta"),function(a){"Content-Type"===a.attr("http-equiv")&&(b=a)});f.docencoding?(b||(b=new e("meta",1),b.attr("http-equiv","Content-Type"),b.shortEnded=!0,c(b)),
b.attr("content","text/html; charset="+f.docencoding)):b&&b.remove();b=g.getAll("title")[0];f.title?(b?b.empty():(b=new e("title",1),c(b)),b.append(new e("#text",3)).value=f.title):b&&b.remove();l.each(["keywords","description","author","copyright","robots"],function(a){var d=g.getAll("meta"),m,h,l=f[a];for(m=0;m<d.length;m++)if(h=d[m],h.attr("name")===a){l?h.attr("content",l):h.remove();return}l&&(b=new e("meta",1),b.attr("name",a),b.attr("content",l),b.shortEnded=!0,c(b))});var s={};l.each(g.getAll("link"),
function(a){"stylesheet"===a.attr("rel")&&(s[a.attr("href")]=a)});l.each(f.stylesheets,function(a){s[a]||(b=new e("link",1),b.attr({rel:"stylesheet",text:"text/css",href:a}),b.shortEnded=!0,c(b));delete s[a]});l.each(s,function(a){a.remove()});if(b=g.getAll("body")[0])d(b,"dir",f.langdir),d(b,"style",f.style),d(b,"vlink",f.visited_color),d(b,"link",f.link_color),d(b,"alink",f.active_color),k.setAttribs(a.getBody(),{style:f.style,dir:f.dir,vLink:f.visited_color,link:f.link_color,aLink:f.active_color});
if(b=g.getAll("html")[0])d(b,"lang",f.langcode),d(b,"xml:lang",f.langcode);n.firstChild||n.remove();a=(new h({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"})).serialize(g);return a.substring(0,a.indexOf("</body>"))}}});k("tinymce.plugins.fullpage.ui.Dialog",["tinymce.core.util.Tools","tinymce.plugins.fullpage.core.Parser"],function(a,e){return{open:function(h,l){var k=e.htmlToData(h,
l.get());h.windowManager.open({title:"Document properties",data:k,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(p){p=e.dataToHtml(h,a.extend(k,p.data),l.get());l.set(p)}})}}});k("tinymce.plugins.fullpage.api.Commands",["tinymce.plugins.fullpage.ui.Dialog"],function(a){return{register:function(e,
h){e.addCommand("mceFullPageProperties",function(){a.open(e,h)})}}});k("tinymce.plugins.fullpage.core.Protect",["tinymce.core.util.Tools"],function(a){return{protectHtml:function(e,h){a.each(e,function(a){h=h.replace(a,function(a){return"\x3c!--mce:protected "+escape(a)+"--\x3e"})});return h},unprotectHtml:function(a){return a.replace(/\x3c!--mce:protected ([\s\S]*?)--\x3e/g,function(a,e){return unescape(e)})}}});k("tinymce.plugins.fullpage.core.FilterContent",["tinymce.core.util.Tools","tinymce.plugins.fullpage.api.Settings",
"tinymce.plugins.fullpage.core.Parser","tinymce.plugins.fullpage.core.Protect"],function(a,e,h,l){var k=a.each,p=function(a){return a.replace(/<\/?[A-Z]+/g,function(a){return a.toLowerCase()})},q=function(m,d,c,g){var n,b,r,s="",q=m.dom;if(!(g.selection||(r=l.protectHtml(m.settings.protect,g.content),"raw"===g.format&&d.get())||g.source_view&&e.shouldHideInSourceView(m))){0!==r.length||g.source_view||(r=a.trim(d.get())+"\n"+a.trim(r)+"\n"+a.trim(c.get()));r=r.replace(/<(\/?)BODY/gi,"<$1body");n=r.indexOf("<body");
-1!==n?(n=r.indexOf(">",n),d.set(p(r.substring(0,n+1))),b=r.indexOf("</body",n),-1===b&&(b=r.length),g.content=a.trim(r.substring(n+1,b)),c.set(p(r.substring(b)))):(d.set(f(m)),c.set("\n</body>\n</html>"));d=h.parseHeader(d.get());k(d.getAll("style"),function(a){a.firstChild&&(s+=a.firstChild.value)});(c=d.getAll("body")[0])&&q.setAttribs(m.getBody(),{style:c.attr("style")||"",dir:c.attr("dir")||"",vLink:c.attr("vlink")||"",link:c.attr("link")||"",aLink:c.attr("alink")||""});q.remove("fullpage_styles");
var t=m.getDoc().getElementsByTagName("head")[0];s&&(q.add(t,"style",{id:"fullpage_styles"},s),c=q.get("fullpage_styles"),c.styleSheet&&(c.styleSheet.cssText=s));var u={};a.each(t.getElementsByTagName("link"),function(a){"stylesheet"===a.rel&&a.getAttribute("data-mce-fullpage")&&(u[a.href]=a)});a.each(d.getAll("link"),function(a){var b=a.attr("href");if(!b)return!0;u[b]||"stylesheet"!==a.attr("rel")||q.add(t,"link",{rel:"stylesheet",text:"text/css",href:b,"data-mce-fullpage":"1"});delete u[b]});a.each(u,
function(a){a.parentNode.removeChild(a)})}},f=function(a){var d="",c,g="";e.getDefaultXmlPi(a)&&(c=e.getDefaultEncoding(a),d+='<?xml version="1.0" encoding="'+(c?c:"ISO-8859-1")+'" ?>\n');d+=e.getDefaultDocType(a);d+="\n<html>\n<head>\n";if(c=e.getDefaultTitle(a))d+="<title>"+c+"</title>\n";if(c=e.getDefaultEncoding(a))d+='<meta http-equiv="Content-Type" content="text/html; charset='+c+'" />\n';if(c=e.getDefaultFontFamily(a))g+="font-family: "+c+";";if(c=e.getDefaultFontSize(a))g+="font-size: "+c+
";";if(c=e.getDefaultTextColor(a))g+="color: "+c+";";return d+("</head>\n<body"+(g?' style="'+g+'"':"")+">\n")};return{setup:function(f,d,c){f.on("BeforeSetContent",function(a){q(f,d,c,a)});f.on("GetContent",function(g){var h=d.get(),b=c.get();g.selection||g.source_view&&e.shouldHideInSourceView(f)||(g.content=l.unprotectHtml(a.trim(h)+"\n"+a.trim(g.content)+"\n"+a.trim(b)))})}}});k("tinymce.plugins.fullpage.ui.Buttons",[],function(){return{register:function(a){a.addButton("fullpage",{title:"Document properties",
cmd:"mceFullPageProperties"});a.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})}}});k("tinymce.plugins.fullpage.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.fullpage.api.Commands","tinymce.plugins.fullpage.core.FilterContent","tinymce.plugins.fullpage.ui.Buttons"],function(a,e,h,k,t){e.add("fullpage",function(e){var q=a(""),f=a("");h.register(e,q);t.register(e);k.setup(e,q,f)});return function(){}});v("tinymce.plugins.fullpage.Plugin")()})();
