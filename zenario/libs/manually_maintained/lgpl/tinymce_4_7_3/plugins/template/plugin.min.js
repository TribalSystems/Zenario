(function(){var n={},r=function(c){var b=n[c];if(void 0===b)throw"module ["+c+"] was undefined";if(void 0===b.instance){for(var a=n[c],d=a.deps,h=a.defn,q=d.length,f=Array(q),k=0;k<q;++k)f[k]=r(d[k]);d=h.apply(null,f);if(void 0===d)throw"module ["+c+"] returned undefined";a.instance=d}return b.instance},e=function(c,b,a){if("string"!==typeof c)throw"module id must be a string";if(void 0===b)throw"no dependencies for "+c;if(void 0===a)throw"no definition function for "+c;n[c]={deps:b,defn:a,instance:void 0}},
p=function(c,b){e(c,[],function(){return b})};p("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);e("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.PluginManager")});p("global!Array",Array);p("global!Error",Error);e("ephox.katamari.api.Fun",["global!Array","global!Error"],function(c,b){var a=function(a){return function(){return a}},d=a(!1),h=a(!0);return{noop:function(){},compose:function(a,b){return function(){return a(b.apply(null,arguments))}},
constant:a,identity:function(a){return a},tripleEquals:function(a,b){return a===b},curry:function(a){for(var b=new c(arguments.length-1),d=1;d<arguments.length;d++)b[d-1]=arguments[d];return function(){for(var d=new c(arguments.length),k=0;k<d.length;k++)d[k]=arguments[k];d=b.concat(d);return a.apply(null,d)}},not:function(a){return function(){return!a.apply(null,arguments)}},die:function(a){return function(){throw new b(a);}},apply:function(a){return a()},call:function(a){a()},never:d,always:h}});
e("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Tools")});e("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.XHR")});e("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.dom.DOMUtils")});e("tinymce.plugins.template.api.Settings",["tinymce.core.dom.DOMUtils"],function(c){return{getCreationDateClasses:function(b){return b.getParam("template_cdate_classes",
"cdate")},getModificationDateClasses:function(b){return b.getParam("template_mdate_classes","mdate")},getSelectedContentClasses:function(b){return b.getParam("template_selected_content_classes","selcontent")},getPreviewReplaceValues:function(b){return b.getParam("template_preview_replace_values")},getTemplateReplaceValues:function(b){return b.getParam("template_replace_values")},getTemplates:function(b){return b.templates},getCdateFormat:function(b){return b.getParam("template_cdate_format",b.getLang("template.cdate_format"))},
getMdateFormat:function(b){return b.getParam("template_mdate_format",b.getLang("template.mdate_format"))},getDialogWidth:function(b){return b.getParam("template_popup_width",600)},getDialogHeight:function(b){return Math.min(c.DOM.getViewPort().h,b.getParam("template_popup_height",500))}}});e("tinymce.plugins.template.core.DateTimeHelper",[],function(){var c=function(b,a){b=""+b;if(b.length<a)for(var d=0;d<a-b.length;d++)b="0"+b;return b};return{getDateTime:function(b,a,d){d=d||new Date;a=a.replace("%D",
"%m/%d/%Y");a=a.replace("%r","%I:%M:%S %p");a=a.replace("%Y",""+d.getFullYear());a=a.replace("%y",""+d.getYear());a=a.replace("%m",c(d.getMonth()+1,2));a=a.replace("%d",c(d.getDate(),2));a=a.replace("%H",""+c(d.getHours(),2));a=a.replace("%M",""+c(d.getMinutes(),2));a=a.replace("%S",""+c(d.getSeconds(),2));a=a.replace("%I",""+((d.getHours()+11)%12+1));a=a.replace("%p",""+(12>d.getHours()?"AM":"PM"));a=a.replace("%B",""+b.translate("January February March April May June July August September October November December".split(" ")[d.getMonth()]));
a=a.replace("%b",""+b.translate("Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[d.getMonth()]));a=a.replace("%A",""+b.translate("Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ")[d.getDay()]));a=a.replace("%a",""+b.translate("Sun Mon Tue Wed Thu Fri Sat Sun".split(" ")[d.getDay()]));return a=a.replace("%%","%")}}});e("tinymce.plugins.template.core.Templates",["tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper"],
function(c,b,a,d){var h=function(a,b,d){c.each(d,function(a,d){"function"===typeof a&&(a=a(d));b=b.replace(RegExp("\\{\\$"+d+"\\}","g"),a)});return b},e=function(b,d){var g=b.dom,f=a.getTemplateReplaceValues(b);c.each(g.select("*",d),function(a){c.each(f,function(b,d){if(g.hasClass(a,d)&&"function"===typeof f[d])f[d](a)})})},f=function(a,b){return RegExp("\\b"+b+"\\b","g").test(a.className)};return{createTemplateList:function(d,c){return function(){var f=a.getTemplates(d);"function"===typeof f?f(c):
"string"===typeof f?b.send({url:f,success:function(a){c(JSON.parse(a))}}):c(f)}},replaceTemplateValues:h,replaceVals:e,insertTemplate:function(b,m,g){var l;m=b.dom;var s=b.selection.getContent();g=h(b,g,a.getTemplateReplaceValues(b));g=m.create("div",null,g);(l=m.select(".mceTmpl",g))&&0<l.length&&(g=m.create("div",null),g.appendChild(l[0].cloneNode(!0)));c.each(m.select("*",g),function(c){f(c,a.getCreationDateClasses(b).replace(/\s+/g,"|"))&&(c.innerHTML=d.getDateTime(b,a.getCdateFormat(b)));f(c,
a.getModificationDateClasses(b).replace(/\s+/g,"|"))&&(c.innerHTML=d.getDateTime(b,a.getMdateFormat(b)));f(c,a.getSelectedContentClasses(b).replace(/\s+/g,"|"))&&(c.innerHTML=s)});e(b,g);b.execCommand("mceInsertContent",!1,g.innerHTML);b.addVisual()}}});e("tinymce.plugins.template.api.Commands",["ephox.katamari.api.Fun","tinymce.plugins.template.core.Templates"],function(c,b){return{register:function(a){a.addCommand("mceInsertTemplate",c.curry(b.insertTemplate,a))}}});e("tinymce.plugins.template.core.FilterContent",
["tinymce.core.util.Tools","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper","tinymce.plugins.template.core.Templates"],function(c,b,a,d){return{setup:function(h){h.on("PreProcess",function(e){var f=h.dom,k=b.getMdateFormat(h);c.each(f.select("div",e.node),function(b){f.hasClass(b,"mceTmpl")&&(c.each(f.select("*",b),function(b){f.hasClass(b,h.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(b.innerHTML=a.getDateTime(h,k))}),d.replaceVals(h,b))})})}}});
e("tinymce.plugins.template.ui.Dialog",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.Templates"],function(c,b,a,d,h){var e=function(a,c,e){if(-1===e.indexOf("<html>")){var g="";b.each(a.contentCSS,function(b){g+='<link type="text/css" rel="stylesheet" href="'+a.documentBaseURI.toAbsolute(b)+'">'});var l=a.settings.body_class||"";-1!==l.indexOf("=")&&(l=a.getParam("body_class","","hash"),l=l[a.id]||
"");e="<!DOCTYPE html><html><head>"+g+'</head><body class="'+l+'">'+e+"</body></html>"}e=h.replaceTemplateValues(a,e,d.getPreviewReplaceValues(a));c=c.find("iframe")[0].getEl().contentWindow.document;c.open();c.write(e);c.close()};return{open:function(c,k){var m,g=[],l;if(k&&0!==k.length)b.each(k,function(a){g.push({selected:!g.length,text:a.title,value:{url:a.url,content:a.content,description:a.description}})}),m=c.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",
padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:g,onselect:function(b){var d=b.control.value();d.url?a.send({url:d.url,success:function(a){l=a;e(c,m,l)}}):(l=d.content,e(c,m,l));m.find("#description")[0].text(b.control.value().description)}}}]},{type:"label",name:"description",label:"Description",text:"\u00a0"},{type:"iframe",flex:1,border:1}],onsubmit:function(){h.insertTemplate(c,
!1,l)},minWidth:d.getDialogWidth(c),minHeight:d.getDialogHeight(c)}),m.find("listbox")[0].fire("select");else{var n=c.translate("No templates defined.");c.notificationManager.open({text:n,type:"info"})}}}});e("tinymce.plugins.template.ui.Buttons",["tinymce.plugins.template.core.Templates","tinymce.plugins.template.ui.Dialog"],function(c,b){var a=function(a){return function(c){b.open(a,c)}};return{register:function(b){b.addButton("template",{title:"Insert template",onclick:c.createTemplateList(b.settings,
a(b))});b.addMenuItem("template",{text:"Template",onclick:c.createTemplateList(b.settings,a(b)),icon:"template",context:"insert"})}}});e("tinymce.plugins.template.Plugin",["tinymce.core.PluginManager","tinymce.plugins.template.api.Commands","tinymce.plugins.template.core.FilterContent","tinymce.plugins.template.ui.Buttons"],function(c,b,a,d){c.add("template",function(c){d.register(c);b.register(c);a.setup(c)});return function(){}});r("tinymce.plugins.template.Plugin")()})();
