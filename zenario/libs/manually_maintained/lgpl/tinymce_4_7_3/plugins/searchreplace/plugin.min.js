'use strict';(function(){var I={},B=function(h,e,b){if("string"!==typeof h)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+h;if(void 0===b)throw"no definition function for "+h;I[h]={deps:e,defn:b,instance:void 0}},K=function(h){var e=I[h];if(void 0===e)throw"module ["+h+"] was undefined";if(void 0===e.instance){for(var b=I[h],k=b.deps,r=b.defn,q=k.length,t=Array(q),x=0;x<q;++x)t[x]=K(k[x]);k=r.apply(null,t);if(void 0===k)throw"module ["+h+"] returned undefined";b.instance=
k}return e.instance};B("ephox.katamari.api.Cell",[],function(){var h=function(e){var b=e;return{get:function(){return b},set:function(k){b=k},clone:function(){return h(b)}}};return h});(function(h,e){B(h,[],function(){return e})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);B("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(h){return h("tinymce.PluginManager")});B("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(h){return h("tinymce.util.Tools")});
B("tinymce.plugins.searchreplace.core.FindReplaceText",[],function(){function h(e){return e&&1===e.nodeType&&"false"===e.contentEditable}return{findAndReplaceDOMText:function(e,b,k,r,q){function t(c,p){p=p||0;if(!c[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var u=c.index;if(0<p){p=c[p];if(!p)throw"Invalid capture group";u+=c[0].indexOf(p);c[0]=p}return[u,u+c[0].length,[c[0]]]}function x(c){if(3===c.nodeType)return c.data;if(n[c.nodeName]&&!d[c.nodeName])return"";var p="";if(h(c))return"\n";
if(d[c.nodeName]||m[c.nodeName])p+="\n";if(c=c.firstChild){do p+=x(c);while(c=c.nextSibling)}return p}function v(c,p,u){var g=[],l=0,f=c,y=p.shift(),w=0;a:for(;;){(d[f.nodeName]||m[f.nodeName]||h(f))&&l++;if(3===f.nodeType){if(!z&&f.length+l>=y[1]){var z=f;var G=y[1]-l}else E&&g.push(f);if(!E&&f.length+l>y[0]){var E=f;var H=y[0]-l}l+=f.length}if(E&&z){if(f=u({startNode:E,startNodeIndex:H,endNode:z,endNodeIndex:G,innerNodes:g,match:y[2],matchIndex:w}),l-=z.length-G,z=E=null,g=[],y=p.shift(),w++,!y)break}else if((!n[f.nodeName]||
d[f.nodeName])&&f.firstChild){if(!h(f)){f=f.firstChild;continue}}else if(f.nextSibling){f=f.nextSibling;continue}for(;;)if(f.nextSibling){f=f.nextSibling;break}else if(f.parentNode!==c)f=f.parentNode;else break a}}function F(c){if("function"!==typeof c){var p=c.nodeType?c:a.createElement(c);var u=function(g,l){var f=p.cloneNode(!1);f.setAttribute("data-mce-index",l);g&&f.appendChild(a.createTextNode(g));return f}}else u=c;return function(g){var l=g.startNode,f=g.endNode,y=g.matchIndex;if(l===f){var w=
l.parentNode;if(0<g.startNodeIndex){var z=a.createTextNode(l.data.substring(0,g.startNodeIndex));w.insertBefore(z,l)}z=u(g.match[0],y);w.insertBefore(z,l);if(g.endNodeIndex<l.length){var G=a.createTextNode(l.data.substring(g.endNodeIndex));w.insertBefore(G,l)}l.parentNode.removeChild(l);return z}z=a.createTextNode(l.data.substring(0,g.startNodeIndex));G=a.createTextNode(f.data.substring(g.endNodeIndex));var E=u(l.data.substring(g.startNodeIndex),y);w=[];for(var H=0,M=g.innerNodes.length;H<M;++H){var J=
g.innerNodes[H],L=u(J.data,y);J.parentNode.replaceChild(L,J);w.push(L)}g=u(f.data.substring(0,g.endNodeIndex),y);w=l.parentNode;w.insertBefore(z,l);w.insertBefore(E,l);w.removeChild(l);w=f.parentNode;w.insertBefore(g,f);w.insertBefore(G,f);w.removeChild(f);return g}}var A=[],C,D=0;var a=b.ownerDocument;var d=q.getBlockElements();var n=q.getWhiteSpaceElements();var m=q.getShortEndedElements();if(C=x(b)){if(e.global)for(;q=e.exec(C);)A.push(t(q,r));else q=C.match(e),A.push(t(q,r));A.length&&(D=A.length,
v(b,A,F(k)));return D}}}});B("tinymce.plugins.searchreplace.core.Actions",["tinymce.core.util.Tools","tinymce.plugins.searchreplace.core.FindReplaceText"],function(h,e){var b=function(a){a=a.getAttribute("data-mce-index");return"number"===typeof a?""+a:a},k=function(a){var d=a.parentNode;a.firstChild&&d.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)},r=function(a,d){var n=[];a=h.toArray(a.getBody().getElementsByTagName("span"));if(a.length)for(var m=0;m<a.length;m++){var c=b(a[m]);null!==
c&&c.length&&c===d.toString()&&n.push(a[m])}return n},q=function(a,d,n){var m=d.get(),c=a.dom;!1!==n?m++:m--;c.removeClass(r(a,d.get()),"mce-match-marker-selected");d=r(a,m);return d.length?(c.addClass(r(a,m),"mce-match-marker-selected"),a.selection.scrollIntoView(d[0]),m):-1},t=function(a,d){var n=d.parentNode;a.remove(d);a.isEmpty(n)&&a.remove(n)},x=function(a,d){a=q(a,d,!0);-1!==a&&d.set(a)},v=function(a,d){a=q(a,d,!1);-1!==a&&d.set(a)},F=function(a){a=b(a);return null!==a&&0<a.length},A=function(a,
d,n){var m;var c=h.toArray(a.getBody().getElementsByTagName("span"));for(m=0;m<c.length;m++){var p=b(c[m]);if(null!==p&&p.length){if(p===d.get().toString()){if(!u)var u=c[m].firstChild;var g=c[m].firstChild}k(c[m])}}if(u&&g)return d=a.dom.createRng(),d.setStart(u,0),d.setEnd(g,g.data.length),!1!==n&&a.selection.setRng(d),d},C=function(a,d){return 0<r(a,d.get()+1).length},D=function(a,d){return 0<r(a,d.get()-1).length};return{done:A,find:function(a,d,n,m,c){n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,
"\\$&");n=n.replace(/\s/g,"\\s");n=new RegExp(c?"\\b"+n+"\\b":n,m?"g":"gi");c=a.dom.create("span",{"data-mce-bogus":1});c.className="mce-match-marker";m=a.getBody();A(a,d,!1);if(n=e.findAndReplaceDOMText(n,m,c,!1,a.schema))d.set(-1),d.set(q(a,d,!0));return n},next:x,prev:v,replace:function(a,d,n,m,c){var p,u=d.get();m=!1!==m;var g=a.getBody();var l=h.grep(h.toArray(g.getElementsByTagName("span")),F);for(g=0;g<l.length;g++){var f=b(l[g]);f=p=parseInt(f,10);if(c||f===d.get()){n.length?(l[g].firstChild.nodeValue=
n,k(l[g])):t(a.dom,l[g]);for(;l[++g];)if(f=parseInt(b(l[g]),10),f===p)t(a.dom,l[g]);else{g--;break}m&&u--}else p>d.get()&&l[g].setAttribute("data-mce-index",p-1)}d.set(u);m?(n=C(a,d),x(a,d)):(n=D(a,d),v(a,d));return!c&&n},hasNext:C,hasPrev:D}});B("tinymce.plugins.searchreplace.api.Api",["tinymce.plugins.searchreplace.core.Actions"],function(h){return{get:function(e,b){return{done:function(k){return h.done(e,b,k)},find:function(k,r,q){return h.find(e,b,k,r,q)},next:function(){return h.next(e,b)},prev:function(){return h.prev(e,
b)},replace:function(k,r,q){return h.replace(e,b,k,r,q)}}}}});B("tinymce.plugins.searchreplace.ui.Dialog",["tinymce.core.util.Tools","tinymce.plugins.searchreplace.core.Actions"],function(h,e){return{open:function(b,k){function r(){v.statusbar.find("#next").disabled(!1===e.hasNext(b,k));v.statusbar.find("#prev").disabled(!1===e.hasPrev(b,k))}function q(){b.windowManager.alert("Could not find the specified string.",function(){v.find("#find")[0].focus()})}var t={};b.undoManager.add();var x=h.trim(b.selection.getContent({format:"text"}));
var v=b.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){b.focus();e.done(b,k);b.undoManager.add()},onSubmit:function(F){F.preventDefault();var A=v.find("#case").checked();var C=v.find("#words").checked();var D=v.find("#find").value();D.length?t.text===D&&t.caseState===A&&t.wholeWord===C?e.hasNext(b,k)?(e.next(b,k),r()):q():((F=e.find(b,k,D,A,C))||q(),v.statusbar.items().slice(1).disabled(0===F),r(),t={text:D,caseState:A,wholeWord:C}):(e.done(b,k,!1),v.statusbar.items().slice(1).disabled(!0))},
buttons:[{text:"Find",subtype:"primary",onclick:function(){v.submit()}},{text:"Replace",disabled:!0,onclick:function(){e.replace(b,k,v.find("#replace").value())||(v.statusbar.items().slice(1).disabled(!0),k.set(-1),t={})}},{text:"Replace all",disabled:!0,onclick:function(){e.replace(b,k,v.find("#replace").value(),!0,!0);v.statusbar.items().slice(1).disabled(!0);t={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){e.prev(b,k);r()}},{text:"Next",name:"next",disabled:!0,
onclick:function(){e.next(b,k);r()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:x},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})}}});B("tinymce.plugins.searchreplace.api.Commands",["tinymce.plugins.searchreplace.ui.Dialog"],function(h){return{register:function(e,b){e.addCommand("SearchReplace",
function(){h.open(e,b)})}}});B("tinymce.plugins.searchreplace.ui.Buttons",["tinymce.plugins.searchreplace.ui.Dialog"],function(h){var e=function(b,k){return function(){h.open(b,k)}};return{register:function(b,k){b.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:e(b,k),separator:"before",context:"edit"});b.addButton("searchreplace",{tooltip:"Find and replace",onclick:e(b,k)});b.shortcuts.add("Meta+F","",e(b,k))}}});B("tinymce.plugins.searchreplace.Plugin",["ephox.katamari.api.Cell",
"tinymce.core.PluginManager","tinymce.plugins.searchreplace.api.Api","tinymce.plugins.searchreplace.api.Commands","tinymce.plugins.searchreplace.ui.Buttons"],function(h,e,b,k,r){e.add("searchreplace",function(q){var t=h(-1);k.register(q,t);r.register(q,t);return b.get(q,t)});return function(){}});K("tinymce.plugins.searchreplace.Plugin")()})();
