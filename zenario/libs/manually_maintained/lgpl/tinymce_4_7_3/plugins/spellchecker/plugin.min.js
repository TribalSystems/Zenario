'use strict';(function(){var L={},C=function(c,n,q){if("string"!==typeof c)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+c;if(void 0===q)throw"no definition function for "+c;L[c]={deps:n,defn:q,instance:void 0}},O=function(c){var n=L[c];if(void 0===n)throw"module ["+c+"] was undefined";if(void 0===n.instance){for(var q=L[c],x=q.deps,D=q.defn,y=x.length,r=Array(y),v=0;v<y;++v)r[v]=O(x[v]);x=D.apply(null,r);if(void 0===x)throw"module ["+c+"] returned undefined";q.instance=
x}return n.instance},M=function(c,n){C(c,[],function(){return n})};C("ephox.katamari.api.Cell",[],function(){var c=function(n){var q=n;return{get:function(){return q},set:function(x){q=x},clone:function(){return c(q)}}};return c});M("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);C("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.PluginManager")});M("global!window",window);C("tinymce.plugins.spellchecker.alien.DetectProPlugin",["global!window",
"tinymce.core.PluginManager"],function(c,n){return{hasProPlugin:function(q){return/(^|[ ,])tinymcespellchecker([, ]|$)/.test(q.settings.plugins)&&n.get("tinymcespellchecker")?("undefined"!==typeof c.console&&c.console.log&&c.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),!0):!1}}});C("tinymce.plugins.spellchecker.api.Settings",[],function(){return{getLanguages:function(c){return c.getParam("spellchecker_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")},
getLanguage:function(c){var n=c.getParam("language","en");return c.getParam("spellchecker_language",n)},getRpcUrl:function(c){return c.getParam("spellchecker_rpc_url")},getSpellcheckerCallback:function(c){return c.getParam("spellchecker_callback")},getSpellcheckerWordcharPattern:function(c){return c.getParam("spellchecker_wordchar_pattern",/[^\s!"#$%&()*+,-./:;<=>?@[\]^_{|}`\u00a7\u00a9\u00ab\u00ae\u00b1\u00b6\u00b7\u00b8\u00bb\u00bc\u00bd\u00be\u00bf\u00d7\u00f7\u00a4\u201d\u201c\u201e\u00a0\u2002\u2003\u2009]+/g)}}});
C("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Tools")});C("tinymce.core.util.URI",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.URI")});C("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.XHR")});C("tinymce.plugins.spellchecker.api.Events",[],function(){return{fireSpellcheckStart:function(c){return c.fire("SpellcheckStart")},fireSpellcheckEnd:function(c){return c.fire("SpellcheckEnd")}}});
C("tinymce.plugins.spellchecker.core.DomTextMatcher",[],function(){function c(n){return n&&1===n.nodeType&&"false"===n.contentEditable}return function(n,q){function x(b,d){if(!b[0])throw"findAndReplaceDOMText cannot handle zero-length matches";return{start:b.index,end:b.index+b[0].length,text:b[0],data:d}}function D(b){if(3===b.nodeType)return b.data;if(g[b.nodeName]&&!f[b.nodeName])return"";if(c(b))return"\n";var d="";if(f[b.nodeName]||t[b.nodeName])d+="\n";if(b=b.firstChild){do d+=D(b);while(b=
b.nextSibling)}return d}function y(b,d,e){var p=[],h=0,m=b,G=0;d=d.slice(0);d.sort(function(I,J){return I.start-J.start});var A=d.shift();a:for(;;){(f[m.nodeName]||t[m.nodeName]||c(m))&&h++;if(3===m.nodeType){if(!F&&m.length+h>=A.end){var F=m;var K=A.end-h}else H&&p.push(m);if(!H&&m.length+h>A.start){var H=m;var N=A.start-h}h+=m.length}if(H&&F){if(m=e({startNode:H,startNodeIndex:N,endNode:F,endNodeIndex:K,innerNodes:p,match:A.text,matchIndex:G}),h-=F.length-K,F=H=null,p=[],A=d.shift(),G++,!A)break}else if((!g[m.nodeName]||
f[m.nodeName])&&m.firstChild){if(!c(m)){m=m.firstChild;continue}}else if(m.nextSibling){m=m.nextSibling;continue}for(;;)if(m.nextSibling){m=m.nextSibling;break}else if(m.parentNode!==b)m=m.parentNode;else break a}}function r(b){function d(e,p){var h=l[p];h.stencil||(h.stencil=b(h));h=h.stencil.cloneNode(!1);h.setAttribute("data-mce-index",p);e&&h.appendChild(a.doc.createTextNode(e));return h}return function(e){var p=e.startNode,h=e.endNode,m=e.matchIndex;var G=a.doc;if(p===h){var A=p.parentNode;if(0<
e.startNodeIndex){var F=G.createTextNode(p.data.substring(0,e.startNodeIndex));A.insertBefore(F,p)}F=d(e.match,m);A.insertBefore(F,p);e.endNodeIndex<p.length&&(G=G.createTextNode(p.data.substring(e.endNodeIndex)),A.insertBefore(G,p));p.parentNode.removeChild(p);return F}F=G.createTextNode(p.data.substring(0,e.startNodeIndex));G=G.createTextNode(h.data.substring(e.endNodeIndex));var K=d(p.data.substring(e.startNodeIndex),m);A=[];for(var H=0,N=e.innerNodes.length;H<N;++H){var I=e.innerNodes[H],J=d(I.data,
m);I.parentNode.replaceChild(J,I);A.push(J)}e=d(h.data.substring(0,e.endNodeIndex),m);A=p.parentNode;A.insertBefore(F,p);A.insertBefore(K,p);A.removeChild(p);A=h.parentNode;A.insertBefore(e,h);A.insertBefore(G,h);A.removeChild(h);return e}}function v(b){var d=n.getElementsByTagName("*"),e=[];b="number"===typeof b?""+b:null;for(var p=0;p<d.length;p++){var h=d[p],m=h.getAttribute("data-mce-index");null!==m&&m.length&&-1!==h.className.indexOf("mce-spellchecker-word")&&(m===b||null===b)&&e.push(h)}return e}
function k(b){for(var d=l.length;d--;)if(l[d]===b)return d;return-1}function z(b){for(var d=0,e=l.length;d<e&&!1!==b(l[d],d);d++);return this}function w(b){var d=v(b?k(b):null);for(b=d.length;b--;){var e=d[b];e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}return this}function E(b){b=v(k(b));var d=q.dom.createRng();d.setStartBefore(b[0]);d.setEndAfter(b[b.length-1]);return d}var B,l=[],a=q.dom;var f=q.schema.getBlockElements();var g=q.schema.getWhiteSpaceElements();var t=q.schema.getShortEndedElements();
var u=D(n);return{text:u,matches:l,each:z,filter:function(b){var d=[];z(function(e,p){b(e,p)&&d.push(e)});l=d;return this},reset:function(){l.splice(0,l.length);w();return this},matchFromElement:function(b){return l[b.getAttribute("data-mce-index")]},elementFromMatch:function(b){return v(k(b))[0]},find:function(b,d){if(u&&b.global)for(;B=b.exec(u);)l.push(x(B,d));return this},add:function(b,d,e){l.push({start:b,end:b+d,text:u.substr(b,d),data:e});return this},wrap:function(b){l.length&&y(n,l,r(b));
return this},unwrap:w,replace:function(b,d){b=E(b);b.deleteContents();0<d.length&&b.insertNode(q.dom.doc.createTextNode(d));return b},rangeFromMatch:E,indexOf:k}}});C("tinymce.plugins.spellchecker.core.Actions","tinymce.core.util.Tools tinymce.core.util.URI tinymce.core.util.XHR tinymce.plugins.spellchecker.api.Events tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.core.DomTextMatcher".split(" "),function(c,n,q,x,D,y){var r=function(a,f){f.get()||(a=new y(a.getBody(),a),f.set(a));
return f.get()},v=function(a){for(var f in a)return!1;return!0},k=function(a,f,g){return function(t,u,b,d){var e={method:t,lang:g.get()},p="";e["addToDictionary"===t?"word":"text"]=u;c.each(e,function(h,m){p&&(p+="&");p+=m+"="+encodeURIComponent(h)});q.send({url:(new n(f)).toAbsolute(D.getRpcUrl(a)),type:"post",content_type:"application/x-www-form-urlencoded",data:p,success:function(h){(h=JSON.parse(h))?h.error?d(h.error):b(h):(h=a.translate("Server response wasn't proper JSON."),d(h))},error:function(){var h=
a.translate("The spelling service was not found: (")+D.getRpcUrl(a)+a.translate(")");d(h)}})}},z=function(a,f,g,t,u,b,d){var e=D.getSpellcheckerCallback(a);(e?e:k(a,f,g)).call(a.plugins.spellchecker,t,u,b,d)},w=function(a,f,g){a.dom.select("span.mce-spellchecker-word").length||E(a,f,g)},E=function(a,f,g){r(a,g).reset();g.set(null);if(f.get())return f.set(!1),x.fireSpellcheckEnd(a),!0},B=function(a){a=a.getAttribute("data-mce-index");return"number"===typeof a?""+a:a},l=function(a,f,g,t,u){if(u.words){var b=
!!u.dictionary;var d=u.words}else d=u;a.setProgressState(!1);v(d)?(g=a.translate("No misspellings found."),a.notificationManager.open({text:g,type:"info"}),f.set(!1)):(t.set({suggestions:d,hasDictionarySupport:b}),r(a,g).find(D.getSpellcheckerWordcharPattern(a)).filter(function(e){return!!d[e.text]}).wrap(function(e){return a.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":e.text})}),f.set(!0),x.fireSpellcheckStart(a))};return{spellcheck:function(a,f,g,t,u,b){E(a,
g,t)||(a.setProgressState(!0),z(a,f,b,"spellcheck",r(a,t).text,function(d){l(a,g,t,u,d)},function(d){a.notificationManager.open({text:d,type:"error"});a.setProgressState(!1);E(a,g,t)}),a.focus())},checkIfFinished:w,addToDictionary:function(a,f,g,t,u,b){a.setProgressState(!0);z(a,f,"addToDictionary",u,function(){a.setProgressState(!1);a.dom.remove(b,!0);w(a,g,t)},function(d){a.notificationManager.open({text:d,type:"error"});a.setProgressState(!1)})},ignoreWord:function(a,f,g,t,u,b){a.selection.collapse();
b?c.each(a.dom.select("span.mce-spellchecker-word"),function(d){d.getAttribute("data-mce-word")===t&&a.dom.remove(d,!0)}):a.dom.remove(u,!0);w(a,f,g)},findSpansByIndex:function(a,f){var g=[];a=c.toArray(a.getBody().getElementsByTagName("span"));if(a.length)for(var t=0;t<a.length;t++){var u=B(a[t]);null!==u&&u.length&&u===f.toString()&&g.push(a[t])}return g},getElmIndex:B,markErrors:l}});C("tinymce.plugins.spellchecker.api.Api",["tinymce.plugins.spellchecker.api.Settings","tinymce.plugins.spellchecker.core.Actions"],
function(c,n){return{get:function(q,x,D,y,r){return{getTextMatcher:function(){return y.get()},getWordCharPattern:function(){return c.getSpellcheckerWordcharPattern(q)},markErrors:function(v){n.markErrors(q,x,y,D,v)},getLanguage:function(){return c.getLanguage(q)}}}}});C("tinymce.plugins.spellchecker.api.Commands",["tinymce.plugins.spellchecker.core.Actions"],function(c){return{register:function(n,q,x,D,y,r){n.addCommand("mceSpellCheck",function(){c.spellcheck(n,q,x,D,y,r)})}}});C("tinymce.plugins.spellchecker.ui.Buttons",
["tinymce.core.util.Tools","tinymce.plugins.spellchecker.api.Settings","tinymce.plugins.spellchecker.core.Actions"],function(c,n,q){var x=function(r,v){var k=[];c.each(v,function(z){k.push({selectable:!0,text:z.name,data:z.value})});return k},D=function(r){return function(v){var k=n.getLanguage(r);v.control.items().each(function(z){z.active(z.settings.data===k)})}},y=function(r){return c.map(n.getLanguages(r).split(","),function(v){v=v.split("=");return{name:v[0],value:v[1]}})};return{register:function(r,
v,k,z,w,E){var B=x("Language",y(r)),l=function(){q.spellcheck(r,v,k,z,E,w)},a={tooltip:"Spellcheck",onclick:l,onPostRender:function(f){var g=f.control;r.on("SpellcheckStart SpellcheckEnd",function(){g.active(k.get())})}};1<B.length&&(a.type="splitbutton",a.menu=B,a.onshow=D(r),a.onselect=function(f){w.set(f.control.settings.data)});r.addButton("spellchecker",a);r.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:l,selectable:!0,onPostRender:function(){var f=this;f.active(k.get());
r.on("SpellcheckStart SpellcheckEnd",function(){f.active(k.get())})}})}}});M("global!document",document);C("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.dom.DOMUtils")});C("tinymce.core.ui.Factory",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.ui.Factory")});C("tinymce.plugins.spellchecker.ui.SuggestionsMenu","global!document tinymce.core.dom.DOMUtils tinymce.core.ui.Factory tinymce.core.util.Tools tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.core.Actions".split(" "),
function(c,n,q,x,D,y){var r,v=function(k,z,w,E,B,l,a){var f=[],g=w.get().suggestions[l];x.each(g,function(u){f.push({text:u,onclick:function(){k.insertContent(k.dom.encode(u));k.dom.remove(a);y.checkIfFinished(k,E,B)}})});f.push({text:"-"});w.get().hasDictionarySupport&&f.push({text:"Add to Dictionary",onclick:function(){y.addToDictionary(k,z,E,B,l,a)}});f.push.apply(f,[{text:"Ignore",onclick:function(){y.ignoreWord(k,E,B,l,a)}},{text:"Ignore all",onclick:function(){y.ignoreWord(k,E,B,l,a,!0)}}]);
r=q.create("menu",{items:f,context:"contextmenu",onautohide:function(u){-1!==u.target.className.indexOf("spellchecker")&&u.preventDefault()},onhide:function(){r.remove();r=null}});r.renderTo(c.body);w=n.DOM.getPos(k.getContentAreaContainer());g=k.dom.getPos(a[0]);var t=k.dom.getRoot();"BODY"===t.nodeName?(g.x-=t.ownerDocument.documentElement.scrollLeft||t.scrollLeft,g.y-=t.ownerDocument.documentElement.scrollTop||t.scrollTop):(g.x-=t.scrollLeft,g.y-=t.scrollTop);w.x+=g.x;w.y+=g.y;r.moveTo(w.x,w.y+
a[0].offsetHeight)};return{setup:function(k,z,w,E,B){k.on("click",function(l){var a=l.target;if("mce-spellchecker-word"===a.className&&(l.preventDefault(),l=y.findSpansByIndex(k,y.getElmIndex(a)),0<l.length)){var f=k.dom.createRng();f.setStartBefore(l[0]);f.setEndAfter(l[l.length-1]);k.selection.setRng(f);v(k,z,w,E,B,a.getAttribute("data-mce-word"),l)}})}}});C("tinymce.plugins.spellchecker.Plugin","ephox.katamari.api.Cell tinymce.core.PluginManager tinymce.plugins.spellchecker.alien.DetectProPlugin tinymce.plugins.spellchecker.api.Api tinymce.plugins.spellchecker.api.Commands tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.ui.Buttons tinymce.plugins.spellchecker.ui.SuggestionsMenu".split(" "),
function(c,n,q,x,D,y,r,v){n.add("spellchecker",function(k,z){if(!1===q.hasProPlugin(k)){var w=c(!1),E=c(y.getLanguage(k)),B=c(null),l=c({});r.register(k,z,w,B,E,l);v.setup(k,z,l,w,B);D.register(k,z,w,B,l,E);return x.get(k,w,l,B,z)}});return function(){}});O("tinymce.plugins.spellchecker.Plugin")()})();
