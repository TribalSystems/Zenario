(function(){var K={},C=function(c,m,p){if("string"!==typeof c)throw"module id must be a string";if(void 0===m)throw"no dependencies for "+c;if(void 0===p)throw"no definition function for "+c;K[c]={deps:m,defn:p,instance:void 0}},N=function(c){var m=K[c];if(void 0===m)throw"module ["+c+"] was undefined";if(void 0===m.instance){for(var p=K[c],x=p.deps,D=p.defn,y=x.length,n=Array(y),u=0;u<y;++u)n[u]=N(x[u]);x=D.apply(null,n);if(void 0===x)throw"module ["+c+"] returned undefined";p.instance=x}return m.instance},
L=function(c,m){C(c,[],function(){return m})};C("ephox.katamari.api.Cell",[],function(){var c=function(m){var p=m;return{get:function(){return p},set:function(x){p=x},clone:function(){return c(p)}}};return c});L("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);C("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.PluginManager")});L("global!window",window);C("tinymce.plugins.spellchecker.alien.DetectProPlugin",["global!window","tinymce.core.PluginManager"],
function(c,m){return{hasProPlugin:function(p){return/(^|[ ,])tinymcespellchecker([, ]|$)/.test(p.settings.plugins)&&m.get("tinymcespellchecker")?("undefined"!==typeof c.console&&c.console.log&&c.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),!0):!1}}});C("tinymce.plugins.spellchecker.api.Settings",[],function(){return{getLanguages:function(c){return c.getParam("spellchecker_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")},
getLanguage:function(c){var m=c.getParam("language","en");return c.getParam("spellchecker_language",m)},getRpcUrl:function(c){return c.getParam("spellchecker_rpc_url")},getSpellcheckerCallback:function(c){return c.getParam("spellchecker_callback")},getSpellcheckerWordcharPattern:function(c){return c.getParam("spellchecker_wordchar_pattern",RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\u00a7\u00a9\u00ab\u00ae\u00b1\u00b6\u00b7\u00b8\u00bb\u00bc\u00bd\u00be\u00bf\u00d7\u00f7\u00a4\u201d\u201c\u201e\u00a0\u2002\u2003\u2009]+',
"g"))}}});C("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Tools")});C("tinymce.core.util.URI",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.URI")});C("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.XHR")});C("tinymce.plugins.spellchecker.api.Events",[],function(){return{fireSpellcheckStart:function(c){return c.fire("SpellcheckStart")},fireSpellcheckEnd:function(c){return c.fire("SpellcheckEnd")}}});
C("tinymce.plugins.spellchecker.core.DomTextMatcher",[],function(){function c(m){return m&&1===m.nodeType&&"false"===m.contentEditable}return function(m,p){function x(b){if(3===b.nodeType)return b.data;if(g[b.nodeName]&&!a[b.nodeName])return"";if(c(b))return"\n";var e="";if(a[b.nodeName]||h[b.nodeName])e+="\n";if(b=b.firstChild){do e+=x(b);while(b=b.nextSibling)}return e}function D(b,e,d){var k=[],q=0,f=b,E=0;e=e.slice(0);e.sort(function(H,I){return H.start-I.start});var B=e.shift();a:for(;;){(a[f.nodeName]||
h[f.nodeName]||c(f))&&q++;if(3===f.nodeType){if(!F&&f.length+q>=B.end){var F=f;var J=B.end-q}else G&&k.push(f);if(!G&&f.length+q>B.start){var G=f;var M=B.start-q}q+=f.length}if(G&&F){if(f=d({startNode:G,startNodeIndex:M,endNode:F,endNodeIndex:J,innerNodes:k,match:B.text,matchIndex:E}),q-=F.length-J,F=G=null,k=[],B=e.shift(),E++,!B)break}else if((!g[f.nodeName]||a[f.nodeName])&&f.firstChild){if(!c(f)){f=f.firstChild;continue}}else if(f.nextSibling){f=f.nextSibling;continue}for(;;)if(f.nextSibling){f=
f.nextSibling;break}else if(f.parentNode!==b)f=f.parentNode;else break a}}function y(b){function e(d,k){var q=t[k];q.stencil||(q.stencil=b(q));q=q.stencil.cloneNode(!1);q.setAttribute("data-mce-index",k);d&&q.appendChild(v.doc.createTextNode(d));return q}return function(d){var k=d.startNode,q=d.endNode,f=d.matchIndex;var E=v.doc;if(k===q){var B=k.parentNode;if(0<d.startNodeIndex){var F=E.createTextNode(k.data.substring(0,d.startNodeIndex));B.insertBefore(F,k)}F=e(d.match,f);B.insertBefore(F,k);d.endNodeIndex<
k.length&&(E=E.createTextNode(k.data.substring(d.endNodeIndex)),B.insertBefore(E,k));k.parentNode.removeChild(k);return F}F=E.createTextNode(k.data.substring(0,d.startNodeIndex));E=E.createTextNode(q.data.substring(d.endNodeIndex));var J=e(k.data.substring(d.startNodeIndex),f);B=[];for(var G=0,M=d.innerNodes.length;G<M;++G){var H=d.innerNodes[G],I=e(H.data,f);H.parentNode.replaceChild(I,H);B.push(I)}d=e(q.data.substring(0,d.endNodeIndex),f);B=k.parentNode;B.insertBefore(F,k);B.insertBefore(J,k);B.removeChild(k);
B=q.parentNode;B.insertBefore(d,q);B.insertBefore(E,q);B.removeChild(q);return d}}function n(b){var e=m.getElementsByTagName("*"),d=[];b="number"===typeof b?""+b:null;for(var k=0;k<e.length;k++){var q=e[k],f=q.getAttribute("data-mce-index");null!==f&&f.length&&-1!==q.className.indexOf("mce-spellchecker-word")&&(f===b||null===b)&&d.push(q)}return d}function u(b){for(var e=t.length;e--;)if(t[e]===b)return e;return-1}function l(b){for(var e=0,d=t.length;e<d&&!1!==b(t[e],e);e++);return this}function z(b){var e=
n(b?u(b):null);for(b=e.length;b--;){var d=e[b];d.parentNode.insertBefore(d.firstChild,d);d.parentNode.removeChild(d)}return this}function w(b){b=n(u(b));var e=p.dom.createRng();e.setStartBefore(b[0]);e.setEndAfter(b[b.length-1]);return e}var A,t=[],v=p.dom;var a=p.schema.getBlockElements();var g=p.schema.getWhiteSpaceElements();var h=p.schema.getShortEndedElements();var r=x(m);return{text:r,matches:t,each:l,filter:function(b){var e=[];l(function(d,k){b(d,k)&&e.push(d)});t=e;return this},reset:function(){t.splice(0,
t.length);z();return this},matchFromElement:function(b){return t[b.getAttribute("data-mce-index")]},elementFromMatch:function(b){return n(u(b))[0]},find:function(b,e){if(r&&b.global)for(;A=b.exec(r);){var d=t,k=d.push;if(!A[0])throw"findAndReplaceDOMText cannot handle zero-length matches";k.call(d,{start:A.index,end:A.index+A[0].length,text:A[0],data:e})}return this},add:function(b,e,d){t.push({start:b,end:b+e,text:r.substr(b,e),data:d});return this},wrap:function(b){t.length&&D(m,t,y(b));return this},
unwrap:z,replace:function(b,e){b=w(b);b.deleteContents();0<e.length&&b.insertNode(p.dom.doc.createTextNode(e));return b},rangeFromMatch:w,indexOf:u}}});C("tinymce.plugins.spellchecker.core.Actions","tinymce.core.util.Tools tinymce.core.util.URI tinymce.core.util.XHR tinymce.plugins.spellchecker.api.Events tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.core.DomTextMatcher".split(" "),function(c,m,p,x,D,y){var n=function(a,g){g.get()||(a=new y(a.getBody(),a),g.set(a));return g.get()},
u=function(a){for(var g in a)return!1;return!0},l=function(a,g,h){return function(r,b,e,d){var k={method:r,lang:h.get()},q="";k["addToDictionary"===r?"word":"text"]=b;c.each(k,function(f,E){q&&(q+="&");q+=E+"="+encodeURIComponent(f)});p.send({url:(new m(g)).toAbsolute(D.getRpcUrl(a)),type:"post",content_type:"application/x-www-form-urlencoded",data:q,success:function(f){(f=JSON.parse(f))?f.error?d(f.error):e(f):(f=a.translate("Server response wasn't proper JSON."),d(f))},error:function(){var f=a.translate("The spelling service was not found: (")+
D.getRpcUrl(a)+a.translate(")");d(f)}})}},z=function(a,g,h,r,b,e,d){var k=D.getSpellcheckerCallback(a);(k?k:l(a,g,h)).call(a.plugins.spellchecker,r,b,e,d)},w=function(a,g,h){a.dom.select("span.mce-spellchecker-word").length||A(a,g,h)},A=function(a,g,h){n(a,h).reset();h.set(null);if(g.get())return g.set(!1),x.fireSpellcheckEnd(a),!0},t=function(a){a=a.getAttribute("data-mce-index");return"number"===typeof a?""+a:a},v=function(a,g,h,r,b){if(b.words){var e=!!b.dictionary;var d=b.words}else d=b;a.setProgressState(!1);
u(d)?(h=a.translate("No misspellings found."),a.notificationManager.open({text:h,type:"info"}),g.set(!1)):(r.set({suggestions:d,hasDictionarySupport:e}),n(a,h).find(D.getSpellcheckerWordcharPattern(a)).filter(function(k){return!!d[k.text]}).wrap(function(k){return a.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":k.text})}),g.set(!0),x.fireSpellcheckStart(a))};return{spellcheck:function(a,g,h,r,b,e){A(a,h,r)||(a.setProgressState(!0),z(a,g,e,"spellcheck",n(a,r).text,
function(d){v(a,h,r,b,d)},function(d){a.notificationManager.open({text:d,type:"error"});a.setProgressState(!1);A(a,h,r)}),a.focus())},checkIfFinished:w,addToDictionary:function(a,g,h,r,b,e){a.setProgressState(!0);z(a,g,"addToDictionary",b,function(){a.setProgressState(!1);a.dom.remove(e,!0);w(a,h,r)},function(d){a.notificationManager.open({text:d,type:"error"});a.setProgressState(!1)})},ignoreWord:function(a,g,h,r,b,e){a.selection.collapse();e?c.each(a.dom.select("span.mce-spellchecker-word"),function(d){d.getAttribute("data-mce-word")===
r&&a.dom.remove(d,!0)}):a.dom.remove(b,!0);w(a,g,h)},findSpansByIndex:function(a,g){var h=[];a=c.toArray(a.getBody().getElementsByTagName("span"));if(a.length)for(var r=0;r<a.length;r++){var b=t(a[r]);null!==b&&b.length&&b===g.toString()&&h.push(a[r])}return h},getElmIndex:t,markErrors:v}});C("tinymce.plugins.spellchecker.api.Api",["tinymce.plugins.spellchecker.api.Settings","tinymce.plugins.spellchecker.core.Actions"],function(c,m){return{get:function(p,x,D,y,n){return{getTextMatcher:function(){return y.get()},
getWordCharPattern:function(){return c.getSpellcheckerWordcharPattern(p)},markErrors:function(u){m.markErrors(p,x,y,D,u)},getLanguage:function(){return c.getLanguage(p)}}}}});C("tinymce.plugins.spellchecker.api.Commands",["tinymce.plugins.spellchecker.core.Actions"],function(c){return{register:function(m,p,x,D,y,n){m.addCommand("mceSpellCheck",function(){c.spellcheck(m,p,x,D,y,n)})}}});C("tinymce.plugins.spellchecker.ui.Buttons",["tinymce.core.util.Tools","tinymce.plugins.spellchecker.api.Settings",
"tinymce.plugins.spellchecker.core.Actions"],function(c,m,p){var x=function(n,u){var l=[];c.each(u,function(z){l.push({selectable:!0,text:z.name,data:z.value})});return l},D=function(n){return function(u){var l=m.getLanguage(n);u.control.items().each(function(z){z.active(z.settings.data===l)})}},y=function(n){return c.map(m.getLanguages(n).split(","),function(u){u=u.split("=");return{name:u[0],value:u[1]}})};return{register:function(n,u,l,z,w,A){var t=x("Language",y(n)),v=function(){p.spellcheck(n,
u,l,z,A,w)},a={tooltip:"Spellcheck",onclick:v,onPostRender:function(g){var h=g.control;n.on("SpellcheckStart SpellcheckEnd",function(){h.active(l.get())})}};1<t.length&&(a.type="splitbutton",a.menu=t,a.onshow=D(n),a.onselect=function(g){w.set(g.control.settings.data)});n.addButton("spellchecker",a);n.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:v,selectable:!0,onPostRender:function(){var g=this;g.active(l.get());n.on("SpellcheckStart SpellcheckEnd",function(){g.active(l.get())})}})}}});
L("global!document",document);C("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.dom.DOMUtils")});C("tinymce.core.ui.Factory",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.ui.Factory")});C("tinymce.plugins.spellchecker.ui.SuggestionsMenu","global!document tinymce.core.dom.DOMUtils tinymce.core.ui.Factory tinymce.core.util.Tools tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.core.Actions".split(" "),function(c,
m,p,x,D,y){var n,u=function(l,z,w,A,t,v,a){var g=[],h=w.get().suggestions[v];x.each(h,function(b){g.push({text:b,onclick:function(){l.insertContent(l.dom.encode(b));l.dom.remove(a);y.checkIfFinished(l,A,t)}})});g.push({text:"-"});w.get().hasDictionarySupport&&g.push({text:"Add to Dictionary",onclick:function(){y.addToDictionary(l,z,A,t,v,a)}});g.push.apply(g,[{text:"Ignore",onclick:function(){y.ignoreWord(l,A,t,v,a)}},{text:"Ignore all",onclick:function(){y.ignoreWord(l,A,t,v,a,!0)}}]);n=p.create("menu",
{items:g,context:"contextmenu",onautohide:function(b){-1!==b.target.className.indexOf("spellchecker")&&b.preventDefault()},onhide:function(){n.remove();n=null}});n.renderTo(c.body);w=m.DOM.getPos(l.getContentAreaContainer());h=l.dom.getPos(a[0]);var r=l.dom.getRoot();"BODY"===r.nodeName?(h.x-=r.ownerDocument.documentElement.scrollLeft||r.scrollLeft,h.y-=r.ownerDocument.documentElement.scrollTop||r.scrollTop):(h.x-=r.scrollLeft,h.y-=r.scrollTop);w.x+=h.x;w.y+=h.y;n.moveTo(w.x,w.y+a[0].offsetHeight)};
return{setup:function(l,z,w,A,t){l.on("click",function(v){var a=v.target;if("mce-spellchecker-word"===a.className&&(v.preventDefault(),v=y.findSpansByIndex(l,y.getElmIndex(a)),0<v.length)){var g=l.dom.createRng();g.setStartBefore(v[0]);g.setEndAfter(v[v.length-1]);l.selection.setRng(g);u(l,z,w,A,t,a.getAttribute("data-mce-word"),v)}})}}});C("tinymce.plugins.spellchecker.Plugin","ephox.katamari.api.Cell tinymce.core.PluginManager tinymce.plugins.spellchecker.alien.DetectProPlugin tinymce.plugins.spellchecker.api.Api tinymce.plugins.spellchecker.api.Commands tinymce.plugins.spellchecker.api.Settings tinymce.plugins.spellchecker.ui.Buttons tinymce.plugins.spellchecker.ui.SuggestionsMenu".split(" "),
function(c,m,p,x,D,y,n,u){m.add("spellchecker",function(l,z){if(!1===p.hasProPlugin(l)){var w=c(!1),A=c(y.getLanguage(l)),t=c(null),v=c({});n.register(l,z,w,t,A,v);u.setup(l,z,v,w,t);D.register(l,z,w,t,v,A);return x.get(l,w,v,t,z)}});return function(){}});N("tinymce.plugins.spellchecker.Plugin")()})();
