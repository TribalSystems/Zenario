(function(d){d.extend({roundaboutShapes:{def:"lazySusan",lazySusan:function(a,b,f){return{x:Math.sin(a+b),y:Math.sin(a+3*Math.PI/2+b)/8*f,z:(Math.cos(a+b)+1)/2,scale:Math.sin(a+Math.PI/2+b)/2+.5}}}});var u={bearing:0,tilt:0,minZ:100,maxZ:280,minOpacity:.4,maxOpacity:1,minScale:.4,maxScale:1,duration:600,btnNext:null,btnNextCallback:function(){},btnPrev:null,btnPrevCallback:function(){},btnToggleAutoplay:null,btnStartAutoplay:null,btnStopAutoplay:null,easing:"swing",clickToFocus:!0,clickToFocusCallback:function(){},
focusBearing:0,shape:"lazySusan",debug:!1,childSelector:"li",startingChild:null,reflect:!1,floatComparisonThreshold:.001,autoplay:!1,autoplayDuration:1E3,autoplayPauseOnHover:!1,autoplayCallback:function(){},autoplayInitialDelay:0,enableDrag:!1,dropDuration:600,dropEasing:"swing",dropAnimateTo:"nearest",dropCallback:function(){},dragAxis:"x",dragFactor:4,triggerFocusEvents:!0,triggerBlurEvents:!0,responsive:!1};var v={autoplayInterval:null,autoplayIsRunning:!1,autoplayStartTimeout:null,animating:!1,
childInFocus:-1,touchMoveStartPosition:null,stopAnimation:!1,lastAnimationStep:!1};var g={init:function(a,b,f){(new Date).getTime();a="object"===typeof a?a:{};b=d.isFunction(b)?b:function(){};b=d.isFunction(a)?a:b;var c=d.extend({},u,a,v);return this.each(function(){var e=d(this),h=e.children(c.childSelector).length,k=360/h;h=c.startingChild&&c.startingChild>h-1?h-1:c.startingChild;var m=null===c.startingChild?c.bearing:360-h*k,p="static"!==e.css("position")?e.css("position"):"relative";e.css({padding:0,
position:p}).addClass("roundabout-holder").data("roundabout",d.extend({},c,{startingChild:h,bearing:m,oppositeOfFocusBearing:g.normalize.apply(null,[c.focusBearing-180]),dragBearing:m,period:k}));f?e.unbind(".roundabout").children(c.childSelector).unbind(".roundabout"):c.responsive&&d(window).bind("resize",function(){g.stopAutoplay.apply(e);g.relayoutChildren.apply(e)});c.clickToFocus&&e.children(c.childSelector).each(function(n){d(this).bind("click.roundabout",function(){var l=g.getPlacement.apply(e,
[n]);if(!g.isInFocus.apply(e,[l]))return g.stopAnimation.apply(d(this)),e.data("roundabout").animating||g.animateBearingToFocus.apply(e,[l,e.data("roundabout").clickToFocusCallback]),!1})});c.btnNext&&d(c.btnNext).bind("click.roundabout",function(){e.data("roundabout").animating||g.animateToNextChild.apply(e,[e.data("roundabout").btnNextCallback]);return!1});c.btnPrev&&d(c.btnPrev).bind("click.roundabout",function(){g.animateToPreviousChild.apply(e,[e.data("roundabout").btnPrevCallback]);return!1});
c.btnToggleAutoplay&&d(c.btnToggleAutoplay).bind("click.roundabout",function(){g.toggleAutoplay.apply(e);return!1});c.btnStartAutoplay&&d(c.btnStartAutoplay).bind("click.roundabout",function(){g.startAutoplay.apply(e);return!1});c.btnStopAutoplay&&d(c.btnStopAutoplay).bind("click.roundabout",function(){g.stopAutoplay.apply(e);return!1});c.autoplayPauseOnHover&&e.bind("mouseenter.roundabout.autoplay",function(){g.stopAutoplay.apply(e,[!0])}).bind("mouseleave.roundabout.autoplay",function(){g.startAutoplay.apply(e)});
c.enableDrag&&(d.isFunction(e.drag)?d.isFunction(e.drop)?e.drag(function(n,l){n=e.data("roundabout");var q="x"===n.dragAxis.toLowerCase()?"deltaX":"deltaY";g.stopAnimation.apply(e);g.setBearing.apply(e,[n.dragBearing+l[q]/n.dragFactor])}).drop(function(n){n=e.data("roundabout");var l=g.getAnimateToMethod(n.dropAnimateTo);g.allowAnimation.apply(e);g[l].apply(e,[n.dropDuration,n.dropEasing,n.dropCallback]);n.dragBearing=n.period*g.getNearestChild.apply(e)}):c.debug&&alert("You do not have the drop plugin loaded."):
c.debug&&alert("You do not have the drag plugin loaded."),e.each(function(){var n=d(this).get(0),l=d(this).data("roundabout"),q="x"===l.dragAxis.toLowerCase()?"pageX":"pageY",t=g.getAnimateToMethod(l.dropAnimateTo);n.addEventListener&&(n.addEventListener("touchstart",function(r){l.touchMoveStartPosition=r.touches[0][q]},!1),n.addEventListener("touchmove",function(r){var w=(r.touches[0][q]-l.touchMoveStartPosition)/l.dragFactor;r.preventDefault();g.stopAnimation.apply(d(this));g.setBearing.apply(d(this),
[l.dragBearing+w])},!1),n.addEventListener("touchend",function(r){r.preventDefault();g.allowAnimation.apply(d(this));t=g.getAnimateToMethod(l.dropAnimateTo);g[t].apply(d(this),[l.dropDuration,l.dropEasing,l.dropCallback]);l.dragBearing=l.period*g.getNearestChild.apply(d(this))},!1))}));g.initChildren.apply(e,[b,f])})},initChildren:function(a,b){var f=d(this),c=f.data("roundabout");a=a||function(){};f.children(c.childSelector).each(function(e){var h=g.getPlacement.apply(f,[e]);if(b&&d(this).data("roundabout")){var k=
d(this).data("roundabout").startWidth;var m=d(this).data("roundabout").startHeight;var p=d(this).data("roundabout").startFontSize}d(this).addClass("roundabout-moveable-item").css("position","absolute");d(this).data("roundabout",{startWidth:k||d(this).width(),startHeight:m||d(this).height(),startFontSize:p||parseInt(d(this).css("font-size"),10),degrees:h,backDegrees:g.normalize.apply(null,[h-180]),childNumber:e,currentScale:1,parent:f})});g.updateChildren.apply(f);c.autoplay&&(c.autoplayStartTimeout=
setTimeout(function(){g.startAutoplay.apply(f)},c.autoplayInitialDelay));f.trigger("ready");a.apply(f);return f},updateChildren:function(){return this.each(function(){var a=d(this),b=a.data("roundabout"),f=-1,c={bearing:b.bearing,tilt:b.tilt,stage:{width:Math.floor(.9*d(this).width()),height:Math.floor(.9*d(this).height())},animating:b.animating,inFocus:b.childInFocus,focusBearingRadian:g.degToRad.apply(null,[b.focusBearing]),shape:d.roundaboutShapes[b.shape]||d.roundaboutShapes[d.roundaboutShapes.def]};
c.midStage={width:c.stage.width/2,height:c.stage.height/2};c.nudge={width:c.midStage.width+.05*c.stage.width,height:c.midStage.height+.05*c.stage.height};c.zValues={min:b.minZ,max:b.maxZ,diff:b.maxZ-b.minZ};c.opacity={min:b.minOpacity,max:b.maxOpacity,diff:b.maxOpacity-b.minOpacity};c.scale={min:b.minScale,max:b.maxScale,diff:b.maxScale-b.minScale};a.children(b.childSelector).each(function(e){!g.updateChild.apply(a,[d(this),c,e,function(){d(this).trigger("ready")}])||c.animating&&!b.lastAnimationStep?
d(this).removeClass("roundabout-in-focus"):(f=e,d(this).addClass("roundabout-in-focus"))});f!==c.inFocus&&(b.triggerBlurEvents&&a.children(b.childSelector).eq(c.inFocus).trigger("blur"),b.childInFocus=f,b.triggerFocusEvents&&-1!==f&&a.children(b.childSelector).eq(f).trigger("focus"));a.trigger("childrenUpdated")})},updateChild:function(a,b,f,c){a=d(a);var e=a.data("roundabout"),h=[];var k=g.degToRad.apply(null,[360-e.degrees+b.bearing]);c=c||function(){};k=g.normalizeRad.apply(null,[k]);k=b.shape(k,
b.focusBearingRadian,b.tilt);k.scale=1<k.scale?1:k.scale;k.adjustedScale=(b.scale.min+b.scale.diff*k.scale).toFixed(4);k.width=(k.adjustedScale*e.startWidth).toFixed(4);k.height=(k.adjustedScale*e.startHeight).toFixed(4);a.css({left:(k.x*b.midStage.width+b.nudge.width-k.width/2).toFixed(0)+"px",top:(k.y*b.midStage.height+b.nudge.height-k.height/2).toFixed(0)+"px",width:k.width+"px",height:k.height+"px",opacity:(b.opacity.min+b.opacity.diff*k.scale).toFixed(2),zIndex:Math.round(b.zValues.min+b.zValues.diff*
k.z),fontSize:(k.adjustedScale*e.startFontSize).toFixed(1)+"px"});e.currentScale=k.adjustedScale;this.data("roundabout").debug&&(h.push('<div style="font-weight: normal; font-size: 10px; padding: 2px; width: '+a.css("width")+'; background-color: #ffc;">'),h.push('<strong style="font-size: 12px; white-space: nowrap;">Child '+f+"</strong><br />"),h.push("<strong>left:</strong> "+a.css("left")+"<br />"),h.push("<strong>top:</strong> "+a.css("top")+"<br />"),h.push("<strong>width:</strong> "+a.css("width")+
"<br />"),h.push("<strong>opacity:</strong> "+a.css("opacity")+"<br />"),h.push("<strong>height:</strong> "+a.css("height")+"<br />"),h.push("<strong>z-index:</strong> "+a.css("z-index")+"<br />"),h.push("<strong>font-size:</strong> "+a.css("font-size")+"<br />"),h.push("<strong>scale:</strong> "+a.data("roundabout").currentScale),h.push("</div>"),a.html(h.join("")));a.trigger("reposition");c.apply(this);return g.isInFocus.apply(this,[e.degrees])},setBearing:function(a,b){b=b||function(){};a=g.normalize.apply(null,
[a]);this.each(function(){var f=d(this),c=f.data("roundabout"),e=c.bearing;c.bearing=a;f.trigger("bearingSet");g.updateChildren.apply(f);var h=Math.abs(e-a);!c.animating||180<h||(h=Math.abs(e-a),f.children(c.childSelector).each(function(k){g.isChildBackDegreesBetween.apply(d(this),[a,e])&&(k=e>a?"Clockwise":"Counterclockwise",d(this).trigger("move"+k+"ThroughBack"))}))});b.apply(this);return this},adjustBearing:function(a,b){b=b||function(){};if(0===a)return this;this.each(function(){g.setBearing.apply(d(this),
[d(this).data("roundabout").bearing+a])});b.apply(this);return this},setTilt:function(a,b){b=b||function(){};this.each(function(){d(this).data("roundabout").tilt=a;g.updateChildren.apply(d(this))});b.apply(this);return this},adjustTilt:function(a,b){b=b||function(){};this.each(function(){g.setTilt.apply(d(this),[d(this).data("roundabout").tilt+a])});b.apply(this);return this},animateToBearing:function(a,b,f,c,e){var h=(new Date).getTime();e=e||function(){};d.isFunction(c)?(e=c,c=null):d.isFunction(f)?
(e=f,f=null):d.isFunction(b)&&(e=b,b=null);this.each(function(){var k=d(this),m=k.data("roundabout"),p=b?b:m.duration,n=f?f:m.easing||"swing";c||(c={timerStart:h,start:m.bearing,totalTime:p});var l=h-c.timerStart;if(m.stopAnimation)g.allowAnimation.apply(k),m.animating=!1;else if(l<p){m.animating||k.trigger("animationStart");m.animating=!0;if("string"===typeof d.easing.def){var q=d.easing[n]||d.easing[d.easing.def];l=q(null,l,c.start,a-c.start,c.totalTime)}else l=d.easing[n](l/c.totalTime,l,c.start,
a-c.start,c.totalTime);0<=g.compareVersions.apply(null,[d().jquery,"1.7.2"])&&(l=c.start+(a-c.start)*l);l=g.normalize.apply(null,[l]);m.dragBearing=l;g.setBearing.apply(k,[l,function(){setTimeout(function(){g.animateToBearing.apply(k,[a,p,n,c,e])},0)}])}else m.lastAnimationStep=!0,a=g.normalize.apply(null,[a]),g.setBearing.apply(k,[a,function(){k.trigger("animationEnd")}]),m.animating=!1,m.lastAnimationStep=!1,m.dragBearing=a,e.apply(k)});return this},animateToNearbyChild:function(a,b){var f=a[0],
c=a[1],e=a[2]||function(){};d.isFunction(c)?(e=c,c=null):d.isFunction(f)&&(e=f,f=null);return this.each(function(){var h,k=d(this),m=k.data("roundabout"),p=m.reflect?m.bearing:m.bearing%360,n=k.children(m.childSelector).length;if(!m.animating)if(m.reflect&&"previous"===b||!m.reflect&&"next"===b)for(p=Math.abs(p)<m.floatComparisonThreshold?360:p,h=0;h<n;h+=1){var l=m.period*h;var q=m.period*(h+1);q=h===n-1?360:q;if(p<=Math.ceil(q)&&p>=Math.floor(l)){2===n&&360===p?g.animateToDelta.apply(k,[-180,f,
c,e]):g.animateBearingToFocus.apply(k,[l,f,c,e]);break}}else for(p=Math.abs(p)<m.floatComparisonThreshold||360-Math.abs(p)<m.floatComparisonThreshold?0:p,h=n-1;0<=h;--h)if(l=m.period*h,q=m.period*(h+1),q=h===n-1?360:q,p>=Math.floor(l)&&p<Math.ceil(q)){2===n&&360===p?g.animateToDelta.apply(k,[180,f,c,e]):g.animateBearingToFocus.apply(k,[q,f,c,e]);break}})},animateToNearestChild:function(a,b,f){f=f||function(){};d.isFunction(b)?(f=b,b=null):d.isFunction(a)&&(f=a,a=null);return this.each(function(){var c=
g.getNearestChild.apply(d(this));g.animateToChild.apply(d(this),[c,a,b,f])})},animateToChild:function(a,b,f,c){c=c||function(){};d.isFunction(f)?(c=f,f=null):d.isFunction(b)&&(c=b,b=null);return this.each(function(){var e=d(this);var h=e.data("roundabout");h.childInFocus===a||h.animating||(h=e.children(h.childSelector).eq(a),g.animateBearingToFocus.apply(e,[h.data("roundabout").degrees,b,f,c]))})},animateToNextChild:function(a,b,f){return g.animateToNearbyChild.apply(this,[arguments,"next"])},animateToPreviousChild:function(a,
b,f){return g.animateToNearbyChild.apply(this,[arguments,"previous"])},animateToDelta:function(a,b,f,c){c=c||function(){};d.isFunction(f)?(c=f,f=null):d.isFunction(b)&&(c=b,b=null);return this.each(function(){var e=d(this).data("roundabout").bearing+a;g.animateToBearing.apply(d(this),[e,b,f,c])})},animateBearingToFocus:function(a,b,f,c){c=c||function(){};d.isFunction(f)?(c=f,f=null):d.isFunction(b)&&(c=b,b=null);return this.each(function(){var e=d(this).data("roundabout").bearing-a;e=Math.abs(360-
e)<Math.abs(e)?360-e:-e;e=180<e?-(360-e):e;0!==e&&g.animateToDelta.apply(d(this),[e,b,f,c])})},stopAnimation:function(){return this.each(function(){d(this).data("roundabout").stopAnimation=!0})},allowAnimation:function(){return this.each(function(){d(this).data("roundabout").stopAnimation=!1})},startAutoplay:function(a){return this.each(function(){var b=d(this),f=b.data("roundabout");a=a||f.autoplayCallback||function(){};clearInterval(f.autoplayInterval);f.autoplayInterval=setInterval(function(){g.animateToNextChild.apply(b,
[a])},f.autoplayDuration);f.autoplayIsRunning=!0;b.trigger("autoplayStart")})},stopAutoplay:function(a){return this.each(function(){clearInterval(d(this).data("roundabout").autoplayInterval);d(this).data("roundabout").autoplayInterval=null;d(this).data("roundabout").autoplayIsRunning=!1;a||d(this).unbind(".autoplay");d(this).trigger("autoplayStop")})},toggleAutoplay:function(a){return this.each(function(){var b=d(this).data("roundabout");a=a||b.autoplayCallback||function(){};g.isAutoplaying.apply(d(this))?
g.stopAutoplay.apply(d(this),[a]):g.startAutoplay.apply(d(this),[a])})},isAutoplaying:function(){return this.data("roundabout").autoplayIsRunning},changeAutoplayDuration:function(a){return this.each(function(){var b=d(this);b.data("roundabout").autoplayDuration=a;g.isAutoplaying.apply(b)&&(g.stopAutoplay.apply(b),setTimeout(function(){g.startAutoplay.apply(b)},10))})},normalize:function(a){a%=360;return 0>a?360+a:a},normalizeRad:function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a},
isChildBackDegreesBetween:function(a,b){var f=d(this).data("roundabout").backDegrees;return a>b?f>=b&&f<a:f<b&&f>=a},getAnimateToMethod:function(a){a=a.toLowerCase();return"next"===a?"animateToNextChild":"previous"===a?"animateToPreviousChild":"animateToNearestChild"},relayoutChildren:function(){return this.each(function(){var a=d(this),b=d.extend({},a.data("roundabout"));b.startingChild=a.data("roundabout").childInFocus;g.init.apply(a,[b,null,!0])})},getNearestChild:function(){var a=d(this),b=a.data("roundabout");
a=a.children(b.childSelector).length;return b.reflect?Math.round(b.bearing/b.period)%a:(a-Math.round(b.bearing/b.period)%a)%a},degToRad:function(a){return g.normalize.apply(null,[a])*Math.PI/180},getPlacement:function(a){var b=this.data("roundabout");return b.reflect?b.period*a:360-b.period*a},isInFocus:function(a){var b=this.data("roundabout"),f=g.normalize.apply(null,[b.bearing]);a=g.normalize.apply(null,[a]);a=Math.abs(f-a);return a<=b.floatComparisonThreshold||a>=360-b.floatComparisonThreshold},
getChildInFocus:function(){var a=d(this).data("roundabout");return-1<a.childInFocus?a.childInFocus:!1},compareVersions:function(a,b){a=a.split(/\./i);var f=b.split(/\./i),c=a.length>f.length?a.length:f.length;for(b=0;b<=c;b++){if(a[b]&&!f[b]&&0!==parseInt(a[b],10))return 1;if(f[b]&&!a[b]&&0!==parseInt(f[b],10))return-1;if(a[b]!==f[b]&&a[b]&&f[b])return parseInt(a[b],10)>parseInt(f[b],10)?1:-1}return 0}};d.fn.roundabout=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,
1));if("object"===typeof a||d.isFunction(a)||!a)return g.init.apply(this,arguments);d.error("Method "+a+" does not exist for jQuery.roundabout.")}})(jQuery);
