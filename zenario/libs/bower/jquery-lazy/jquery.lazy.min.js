(function(g,n){function E(r,a,c,f,d){function h(){I=1<g.devicePixelRatio;k(c);0<=a.delay&&setTimeout(function(){q(!0)},a.delay);if(0>a.delay||a.combined)f.e=N(a.throttle,function(b){"resize"===b.type&&(A=B=-1);q(b.all)}),f.a=function(b){k(b);c.push.apply(c,b)},f.g=function(){return c=e(c).filter(function(){return!e(this).data(a.loadedName)})},f.f=function(b){for(var a=0;a<b.length;a++){var e=c.filter(function(){return this===b[a]});e.length&&q(!1,e)}},q(),e(a.appendScroll).on("scroll."+d+" resize."+
d,f.e)}function k(b){var c=a.defaultImage,J=a.placeholder,O=a.imageBase,f=a.srcsetAttribute,d=a.loaderAttribute,k=a._f||{};b=e(b).filter(function(){var b=e(this),c=this.tagName.toLowerCase();return!b.data(a.handledName)&&(b.attr(a.attribute)||b.attr(f)||b.attr(d)||k[c]!==n)}).data("plugin_"+a.name,r);for(var p=0,m=b.length;p<m;p++){var l=e(b[p]),h=b[p].tagName.toLowerCase(),g=l.attr(a.imageBaseAttribute)||O;h===v&&g&&l.attr(f)&&l.attr(f,H(l.attr(f),g));k[h]===n||l.attr(d)||l.attr(d,k[h]);h===v&&c&&
!l.attr(u)?l.attr(u,c):h===v||!J||l.css(w)&&"none"!==l.css(w)||l.css(w,"url('"+J+"')")}}function q(b,f){if(c.length){for(var d=f||c,k=!1,h=a.imageBase||"",g=a.srcsetAttribute,n=a.handledName,p=0;p<d.length;p++)if(b||f||E(d[p])){var m=e(d[p]),l=d[p].tagName.toLowerCase(),q=m.attr(a.attribute),s=m.attr(a.imageBaseAttribute)||h,K=m.attr(a.loaderAttribute);m.data(n)||a.visibleOnly&&!m.is(":visible")||!((q||m.attr(g))&&(l===v&&(s+q!==m.attr(u)||m.attr(g)!==m.attr(C))||l!==v&&s+q!==m.css(w))||K)||(k=!0,
m.data(n,!0),z(m,l,s,K))}k&&(c=e(c).filter(function(){return!e(this).data(n)}))}else a.autoDestroy&&r.destroy()}function z(b,c,f,d){++F;var k=function(){s("onError",b);G();k=e.noop};s("beforeLoad",b);var h=a.attribute,r=a.srcsetAttribute,p=a.sizesAttribute,m=a.retinaAttribute,l=a.removeAttribute,g=a.loadedName,n=b.attr(m);if(d){var q=function(){l&&b.removeAttr(a.loaderAttribute);b.data(g,!0);s(L,b);setTimeout(G,1);q=e.noop};b.off(x).one(x,k).one(y,q);s(d,b,function(a){a?(b.off(y),q()):(b.off(x),k())})||
b.trigger(x)}else{var t=e(new Image);t.one(x,k).one(y,function(){b.hide();c===v?b.attr(D,t.attr(D)).attr(C,t.attr(C)).attr(u,t.attr(u)):b.css(w,"url('"+t.attr(u)+"')");b[a.effect](a.effectTime);l&&(b.removeAttr(h+" "+r+" "+m+" "+a.imageBaseAttribute),p!==D&&b.removeAttr(p));b.data(g,!0);s(L,b);t.remove();G()});d=(I&&n?n:b.attr(h))||"";t.attr(D,b.attr(p)).attr(C,b.attr(r)).attr(u,d?f+d:null);t.complete&&t.trigger(y)}}function E(b){var c=b.getBoundingClientRect();b=a.scrollDirection;var d=a.threshold,
f=(0<=B?B:B=e(g).height())+d>c.top&&-d<c.bottom,c=(0<=A?A:A=e(g).width())+d>c.left&&-d<c.right;return"vertical"===b?f:"horizontal"===b?c:f&&c}function H(b,a){if(a){var c=b.split(",");b="";for(var d=0,e=c.length;d<e;d++)b+=a+c[d].trim()+(d!==e-1?",":"")}return b}function N(b,c){var d,e=0;return function(f,k){function h(){e=+new Date;c.call(r,f)}var g=+new Date-e;d&&clearTimeout(d);g>b||!a.enableThrottle||k?h():d=setTimeout(h,b-g)}}function G(){--F;c.length||F||s("onFinishedAll")}function s(b,c,d){return(b=
a[b])?(b.apply(r,[].slice.call(arguments,1)),!0):!1}var F=0,A=-1,B=-1,I=!1,L="afterLoad",y="load",x="error",v="img",u="src",C="srcset",D="sizes",w="background-image";if("event"===a.bind||M)h();else e(g).on(y+"."+d,h)}function z(r,a){var c=this,f=e.extend({},c.config,a),d={},h=f.name+"-"+ ++H;c.config=function(a,d){if(d===n)return f[a];f[a]=d;return c};c.addItems=function(a){d.a&&d.a("string"===e.type(a)?e(a):a);return c};c.getItems=function(){return d.g?d.g():{}};c.update=function(a){d.e&&d.e({},
!a);return c};c.force=function(a){d.f&&d.f("string"===e.type(a)?e(a):a);return c};c.loadAll=function(){d.e&&d.e({all:!0},!0);return c};c.destroy=function(){e(f.appendScroll).off("."+h,d.e);e(g).off("."+h);d={};return n};E(c,f,r,d,h);return f.chainable?r:c}var e=g.jQuery||g.Zepto,H=0,M=!1;e.fn.Lazy=e.fn.lazy=function(e){return new z(this,e)};e.Lazy=e.lazy=function(g,a,c){e.isFunction(a)&&(c=a,a=[]);if(e.isFunction(c)){g=e.isArray(g)?g:[g];a=e.isArray(a)?a:[a];for(var f=z.prototype.config,d=f._f||(f._f=
{}),h=0,k=g.length;h<k;h++)if(f[g[h]]===n||e.isFunction(f[g[h]]))f[g[h]]=c;c=0;for(f=a.length;c<f;c++)d[a[c]]=g[0]}};z.prototype.config={name:"lazy",chainable:!0,autoDestroy:!0,bind:"load",threshold:500,visibleOnly:!1,appendScroll:g,scrollDirection:"both",imageBase:null,defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",placeholder:null,delay:-1,combined:!1,attribute:"data-src",srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",retinaAttribute:"data-retina",
loaderAttribute:"data-loader",imageBaseAttribute:"data-imagebase",removeAttribute:!0,handledName:"handled",loadedName:"loaded",effect:"show",effectTime:0,enableThrottle:!0,throttle:250,beforeLoad:n,afterLoad:n,onError:n,onFinishedAll:n};e(g).on("load",function(){M=!0})})(window);
