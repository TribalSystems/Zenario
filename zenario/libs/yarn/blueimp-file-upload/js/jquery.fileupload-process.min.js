(function(c){"function"===typeof define&&define.amd?define(["jquery","./jquery.fileupload"],c):"object"===typeof exports?c(require("jquery"),require("./jquery.fileupload")):c(window.jQuery)})(function(c){var k=c.blueimp.fileupload.prototype.options.add;c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{processQueue:[],add:function(d,b){var a=c(this);b.process(function(){return a.fileupload("process",b)});k.call(this,d,b)}},processActions:{},_processFile:function(d,b){var a=this,f=c.Deferred().resolveWith(a,
[d]).promise();this._trigger("process",null,d);c.each(d.processQueue,function(g,e){g=function(h){return b.errorThrown?c.Deferred().rejectWith(a,[b]).promise():a.processActions[e.action].call(a,h,e)};f=f[a._promisePipe](g,e.always&&g)});f.done(function(){a._trigger("processdone",null,d);a._trigger("processalways",null,d)}).fail(function(){a._trigger("processfail",null,d);a._trigger("processalways",null,d)});return f},_transformProcessQueue:function(d){var b=[];c.each(d.processQueue,function(){var a=
{},f=this.action,g=!0===this.prefix?f:this.prefix;c.each(this,function(e,h){"string"===c.type(h)&&"@"===h.charAt(0)?a[e]=d[h.slice(1)||(g?g+e.charAt(0).toUpperCase()+e.slice(1):e)]:a[e]=h});b.push(a)});d.processQueue=b},processing:function(){return this._processing},process:function(d){var b=this,a=c.extend({},this.options,d);a.processQueue&&a.processQueue.length&&(this._transformProcessQueue(a),0===this._processing&&this._trigger("processstart"),c.each(d.files,function(f){var g=f?c.extend({},a):
a,e=function(){return d.errorThrown?c.Deferred().rejectWith(b,[d]).promise():b._processFile(g,d)};g.index=f;b._processing+=1;b._processingQueue=b._processingQueue[b._promisePipe](e,e).always(function(){--b._processing;0===b._processing&&b._trigger("processstop")})}));return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=c.Deferred().resolveWith(this).promise()}})});
