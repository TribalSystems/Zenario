zenario.lib(function(l,c,z,x,A,u,h,n,B,C,D,r,v,y,E,w,F,G,t,m,s,H){c=createZenarioLibrary("FEA",zenarioF);c=t(c);c.idVarName=function(b){return"id"};c.validateFormatOrRedrawForField=function(b){b=this.field(b);return v(b.save_onchange)?(this.save(),!0):t(zenarioF).validateFormatOrRedrawForField.apply(this,arguments)};c.fill=function(){return this.ffov("fill")};c.format=function(){return this.ffov("format")};c.validate=function(){return this.ffov("validate")};c.save=function(){return this.ffov("save")};
c.setData=function(b){this.setDataDiff(b)};c.sendStateToServer=function(){return this.sendStateToServerDiff()};c.ffov=function(b){var a=this,e=new h.callback,d=this.url=h._pVTL(this.moduleClassName,this.containerId,this.path,this.customisationName,this.request,b,!0),f=!1;"fill"!=b&&(this.prevPath=this.path,this.checkValues(),f={_format:!0,_tuix:this.sendStateToServer()});this.loading||(this.showLoader(),this.ajax(d,f,!0).after(function(d){a.hideLoader();"fill"==b?a.tuix=d:a.setData(d);a.tuix.go?(a.tuix.transition_out&&
a.transitionOut(a.tuix.transition_out),a.tuix.transition_in_on_next_screen&&(a.transitionInOnNextScreen=a.tuix.transition_in_on_next_screen),a.go(a.containerId,a.tuix.go)):(a.sortOutTUIX(a.containerId,a.tuix),a.draw(),e.call())}));return e};c.draw=function(){this.draw2()};c.redrawTab=function(){this.draw2();this.hideLoader(!0)};c.draw2=function(){this.sortTabs();this.tuix.form_title=this.getTitle();var b,a=new h.callback;$("#"+this.containerId).html(this.drawFields(a,this.mtPrefix+"_form",this.tuix));
h._aJQE(this.containerId+" ");this.path==this.prevPath&&this.lastFieldInFocus&&(b=r(this.lastFieldInFocus))&&b.focus();a.call()};c.ajaxURL=function(){return h._pAL(l,this.containerId,{path:this.path})};c.microTemplate=function(b,a,e){var d;if(_._isAr(a))for(d in a)a[d].that=this,a[d].tuix||(a[d].tuix=this.tuix);else a.that=this,a.tuix||(a.tuix=this.tuix);b=h._mT(b,a,e);if(_._isAr(a))for(d in a)delete a[d].that,delete a[d].tuix;else delete a.that,delete a.tuix;return b};c.showLoader=function(b,a){var e=
"loader_for_"+this.containerId,d=r(this.containerId),f=r(e),d=$(d);b?(this.loading=!1,d.removeClass("fea_loading").addClass("fea_loaded").addClass("fea_initial_load_done")):(this.loading=!0,d.removeClass("fea_loaded").addClass("fea_loading"));a?d.removeClass("fea_just_loaded").addClass("fea_just_redrawn"):d.removeClass("fea_just_redrawn").addClass("fea_just_loaded");if(f)e=$(f);else{if(b)return;e=$(this.microTemplate(this.mtPrefix+"_loading",{loaderId:e}));d.prepend(e)}b?e.hide():e.width(d.width()).height(d.height()).show()};
c.hideLoader=function(b){this.showLoader(!0,b)};c.reload=function(b){this.containerId&&this.runLogic(this.containerId,this.request,b||function(){})};c.checkModeAndPathOnRequest=function(b){b.mode?b.path=this.getPathFromMode(b.mode):b.path?b.mode=this.getModeFromPath(b.path):(b.mode=this.defaultMode,b.path=this.getPathFromMode(this.defaultMode))};c.runLogic=function(b,a,e){this.checkModeAndPathOnRequest(a);this.mode=a.mode;this.path=a.path;this.request=a;this.containerId=b;this.logic(b,a,e)};c.logic=
function(b,a,e){a.path.match(/list/)?this.showList(e):this.showForm(e)};c.showForm=function(b){this.changed={};this.fill().after(b)};c.showList=function(b){if(!this.loading){var a=this,e=this.url=h._pVTL(this.moduleClassName,this.containerId,this.request.path,this.customisationName,this.request);this.showLoader();this.ajax(e,!1,!0).after(function(d){a.tuix=d;a.drawList();a.hideLoader(!1);b()})}};c.sizeTableListCells=function(){$(".zfea_with_responsive_table .zfea_table_list_wrap tr").each(function(b,
a){var e=0,d=$(a).children();d.each(function(a,b){$(b).css("height","")});d.each(function(a,b){e=Math.max(e,$(b).height())});d.each(function(a,b){$(b).height(e)})})};c.sizeTableListCellsIfNeededAfterDelay=function(){if(h.mobile){var b=this;setTimeout(function(){b.sizeTableListCells()},0)}};c.drawList=function(){this.hadSparkline=!1;this.sortOutTUIX(this.containerId,this.tuix);$("#"+this.containerId).html(this.microTemplate(this.mtPrefix+"_list",{}));var b=this,a=1*this.tuix.__page__,e=1*this.tuix.__page_size__,
d=1*this.tuix.__item_count__,f;a&&e&&d&&d>e&&(f="#pagination_"+this.containerId,$(f).show().jPaginator({nbPages:Math.ceil(d/e),selectedPage:a,overBtnLeft:f+"_o_left",overBtnRight:f+"_o_right",maxBtnLeft:f+"_m_left",maxBtnRight:f+"_m_right",onPageClicked:function(a,d){b.go(b.containerId,{page:d})}}));h._aJQE(this.containerId+" ");this.hadSparkline&&this.initSparklineChart();!this.addedResizeListener&&x.addEventListener&&x.addEventListener("resize",this.sizeTableListCells);this.addedResizeListener=
!0;h.mobile&&this.sizeTableListCellsIfNeededAfterDelay()};c.getPathFromMode=function(b){return"zenario_"+b};c.getModeFromPath=function(b){return b.replace(/^zenario_/,"")};c.recordRequestsInURL=function(b,a){h._rRIU(b,this.checkRequests(a,!0))};c.checkRequests=function(b,a,e,d,f){var g,c;b=h._cl(b,d);this.checkModeAndPathOnRequest(b);c=this.idVarName(b.mode||this.mode)||"id";if(this.tuix&&this.tuix.key)for(g in this.tuix.key)m(this.tuix.key,g)&&(d=this.tuix.key[g],"id"==g&&"id"!=c&&this.tuix.key[c]===
l&&(g=c),b[g]===l&&(b[g]=d));b[c]===l&&(e?b[c]=e:f&&(b[c]=""));if(!f)for(g in b)m(b,g)&&(d=b[g],""!==d&&!1!==d||delete b[g]);a&&(delete b.path,b.mode==this.defaultMode&&delete b.mode);return b};c.init=function(b,a,e,d,f,g,c,k,h){t(zenarioF).init.call(this,b,a);this.last={};this.pages=c||{};this.prevPath=this.path=this.mode="";this.customisationName=h||"";this.containerId=d;this.defaultMode=g;this.hasEditPerms=k;this.moduleClassName=e;this.go(d,f,l,!0);this.hardcodedPhrase={ok:"OK",retry:"Retry",cancel:"Cancel",
unknownMode:"Unknown mode requested",error404:"Could not access a file on the server. Please check that you have uploaded all of the CMS files to the server, and that you have no misconfigured rewrite rules in your Apache config or .htaccess file that might cause a 404 error.",error500:"Something on the server is incorrectly set up or misconfigured.",errorTimedOut:"There was no reply or a blank reply from the server.\n\nThis could be a temporary network problem, or could be a bug in the application."}};
c.editModeOn=function(b){return this.hasEditPerms};c.editModeAlwaysOn=function(b){return this.hasEditPerms};c.debug=function(){this.path&&this.tuix&&this.url&&n._d(this.globalName)};c.doSearch=function(b){h._st(b);b=this.request;var a={search:r("search_"+this.containerId).value};this.go(this.containerId,this.checkRequests(b,!1,l,a));return!1};c.go=function(b,a,e,d){b=s(b);a.mode===l&&a.path===l&&(a.path=this.path);a=this.checkRequests(a,!1,e);this.last[b]={request:a};this.prevPath=this.path;var f,
g=this;e=a.command;delete a.command;e&&zenario_conductor.commandEnabled(b,e)?(delete a.mode,delete a.path,zenario_conductor.go(b,e,a)):d||!a.mode||a.mode==this.defaultMode||!(f=this.pages[a.mode])||f.cID==h.cID&&f.cType==h.cType?this.runLogic(b,a,function(){d||g.recordRequestsInURL(b,a);g.transitionInOnNextScreen?g.transitionIn(g.transitionInOnNextScreen):g.newlyNavigated&&g.tuix.transition_in&&g.transitionIn(g.tuix.transition_in);delete g.transitionInOnNextScreen}):(delete a.mode,h._gTU(h._lTI(f.cID,
f.cType,a)))};c.hidden=function(b,a,e,d,f,g,c,k,h){b=b||f||g||c||a||k||h;if(f&&f.go&&f.go.command)if(zenario_conductor.enabled(this.containerId)){if(!zenario_conductor.commandEnabled(this.containerId,f.go.command))return!0}else if(!f.go.mode)return!0;return!this.hasEditPerms&&v(b.needs_edit_perms)?!0:n._h(b,a,e,d,f,g,c,k,h)};c.sortOutTUIX=function(b,a){b=s(b);this.newlyNavigated=this.path!=this.prevPath;a.collection_buttons=a.collection_buttons||{};a.item_buttons=a.item_buttons||{};a.columns=a.columns||
{};a.items=a.items||{};var e,d,f,c,h,k,p=!1;d=a.sort_by||"name";sortDesc=v(a.sort_desc);a.sortedCollectionButtonIds=n._gSIOTE(a,a.collection_buttons);a.sortedCollectionButtons=[];a.sortedItemButtonIds=n._gSIOTE(a,a.item_buttons);a.sortedItemButtons=[];a.sortedColumnIds=n._gSIOTE(a,a.columns);a.sortedColumns=[];a.sortedItemIds=a.__item_sort_order__?a.__item_sort_order__:n._gSIOTE(a,"items",d,sortDesc);a.sortedItems=[];for(e in a.sortedColumnIds)m(a.sortedColumnIds,e)&&(d=a.sortedColumnIds[e],c=a.columns[d],
c.id=d,this.hidden(l,l,d,a,l,c)||a.sortedColumns.push(c));for(e in a.sortedItemIds)if(m(a.sortedItemIds,e)){d=a.sortedItemIds[e];h=a.items[d];h.id=d;a.sortedItems.push(h);h.sortedItemButtons=[];for(f in a.sortedItemButtonIds)m(a.sortedItemButtonIds,f)&&(c=a.sortedItemButtonIds[f],k=_._cl(a.item_buttons[c]),k.id=c,this.setupButtonLinks(b,k,d),p&&a.sortedItemButtons.push(k),this.hidden(l,h,c,a,k)||h.sortedItemButtons.push(k));p=!1}for(e in a.sortedCollectionButtonIds)m(a.sortedCollectionButtonIds,e)&&
(d=a.sortedCollectionButtonIds[e],k=a.collection_buttons[d],k.id=d,this.hidden(l,l,d,a,k)||(this.setupButtonLinks(b,k),this.hidden(l,h,d,a,k)||a.sortedCollectionButtons.push(k)));n._sK(a.sortedColumns);n._sK(a.sortedCollectionButtons,"zfea_button_with_children");n._sK(a.sortedItemButtons,"zfea_button_with_children");this.last[b].tuix=a};c.setupButtonLinks=function(b,a,e){b=s(b);var d,c,g;if(a.go||a.ajax||a.confirm)a.onclick&&a.onclick.match(/\bzzdonezzthiszz\b/)||(g=this.globalName+".button(this, '"+
w(b)+"', '"+w(a.id)+"'",g=e?g+(", '"+w(e)+"'"):g+", undefined",a.go&&(c=this.checkRequests(a.go,!0,e)),a.onclick&&(g+=", function () {"+a.onclick+"}"),a.onclick=g+"); return false; /* zzdonezzthiszz */");a.href===l&&c&&(e=c.command,delete c.command,e&&zenario_conductor.commandEnabled(b,e)?(delete c.mode,delete c.path,a.href=zenario_conductor.link(b,e,c)):c.mode&&c.mode!=this.defaultMode&&(d=this.pages[c.mode])&&(d.cID!=h.cID||d.cType!=h.cType)?(delete c.mode,a.href=h._lTI(d.cID,d.cType,c)):a.href=
h._lTI(h.cID,h.cType,c))};c.clickButton=function(b,a){var e=this,d=this.field(a),c=t(zenarioF).clickButton;d.confirm&&!this.hidden(d.confirm,l,a,this.tuix,d,l,d)?awf.confirm(d.confirm,function(){c.call(e,b,a)}):c.call(this,b,a)};c.button=function(b,a,e,d,c,g){if(!this.loading){delete this.transitionInOnNextScreen;a=s(a);var n=this,k,p=!1,m=this.last[a],q;d!==l?(p=m.tuix.items[d],k=m.tuix.item_buttons[e]):k=m.tuix.collection_buttons[e];if(g||!(q=k.confirm||k.go&&k.go.confirm||k.ajax&&k.ajax.confirm)||
this.hidden(q,p,e,m.tuix,k)){if(c&&(g=c.call(b),g!==l&&!g))return;k.ajax?(k=this.checkRequests(k.ajax.request,!1,d,l,!0),this.runAJAXRequest(a,k,m.request)):(k.transition_out&&this.transitionOut(k.transition_out),k.transition_in_on_next_screen&&(this.transitionInOnNextScreen=k.transition_in_on_next_screen),this.go(a,k.go,d))}else p&&(q=_._ex({},q),q.message=h._aMF(q.message,p)),this.confirm(q,function(){n.button(b,a,e,d,c,!0)})}};c.sparkline=function(){Highcharts.SparkLine=function(a,b,c){var d="string"===
typeof a||a.nodeName,e=arguments[d?1:0],e=Highcharts.merge({chart:{renderTo:e.chart&&e.chart.renderTo||this,backgroundColor:null,borderWidth:0,type:"area",margin:[2,0,2,0],width:120,height:40,style:{overflow:"visible"},skipClone:!0},title:{text:""},credits:{enabled:!1},xAxis:{labels:{enabled:!1},title:{text:null},startOnTick:!1,endOnTick:!1,tickPositions:[]},yAxis:{endOnTick:!1,startOnTick:!1,labels:{enabled:!1},title:{text:null},tickPositions:[0]},legend:{enabled:!1},tooltip:{backgroundColor:null,
borderWidth:0,shadow:!1,useHTML:!0,hideDelay:0,shared:!0,padding:0,positioner:function(a,b,c){return{x:c.plotX-a/2,y:c.plotY-b}}},plotOptions:{series:{animation:!1,lineWidth:1,shadow:!1,states:{hover:{enabled:!1}},marker:{radius:1,states:{hover:{radius:2}}},fillOpacity:0.25},column:{negativeColor:"#910000",borderColor:"silver"}}},e);return d?new Highcharts.Chart(a,e,c):new Highcharts.Chart(e,b)};$("td[data-sparkline]");var b,a,c,d;for(c in this.tuix.sortedColumns)if(m(this.tuix.sortedColumns,c)&&
(d=this.tuix.sortedColumns[c],d.sparkline))for(b in this.tuix.sortedItems)if(m(this.tuix.sortedItems,b)){a=this.tuix.sortedItems[b];var f=$(r("zfea_"+this.containerId+"_row_"+b+"_col_"+c));a=a[d.id];var g={};a.values?(a.values=$.map(a.values,parseFloat),f.highcharts("SparkLine",{colors:[a.colour?a.colour:"#82CAFF"],series:[{data:a.values,pointStart:1}],tooltip:{headerFormat:'<span style="font-size: 10px">'+a.label+":</span><br/>",pointFormat:"<b>{point.y}</b> "+a.units},chart:g})):$("#"+("zfea_"+
this.containerId+"_row_"+b+"_col_"+c)).html(a.no_data_message)}};c.initSparklineChart=function(){var b=this;h._lL("zenario/libraries/not_to_redistribute/highcharts/highcharts.min.js",function(){b.sparkline();b.sizeTableListCellsIfNeededAfterDelay()})};c.transitionIn=function(b){var a=$("#"+this.containerId).find(".zfea"),c=b.options||{};_._iS(c.duration)&&(c.duration*=1);_._isAr(c.easing)&&(c.easing=$.bez(c.easing));b.initial&&a.css(b.initial);b.animate&&a.animate(b.animate,c)};c.transitionOut=function(b){if(b&&
b.animate){var a=$("#"+this.containerId),c=a.clone().attr("id","").css("position","absolute").addClass("zenario_slot_dummy_for_transition").width(a.width()).height(a.height()).insertBefore(a),d=a.find(".zfea"),f=c.find(".zfea").removeClass("zfea_newly_navigated").addClass("zfea_dummy_for_transition"),g=b.options||{},h=a.height(),k=a.css("min-height");g.complete=function(){c.remove();a.css("min-height",k)};a.css("min-height",h+"px");_._iS(g.duration)&&(g.duration*=1);_._isAr(g.easing)&&(g.easing=$.bez(g.easing));
f.animate(b.animate,g);d.hide()}};c.confirm=function(b,a){if(!this.loading){if(!_._isFu(a)&&a._zenario_confirmed)return delete a._zenario_confirmed,!0;$.colorbox({transition:"none",closeButton:!1,html:this.microTemplate(this.mtPrefix+"_confirm",b),className:"zfea_colorbox_content"+(b.css_class?" "+b.css_class:"")});_._isFu(a)?$("#zfea_do_it").click(function(){$.colorbox.remove();a()}):$("#zfea_do_it").click(function(){$.colorbox.remove();a._zenario_confirmed=!0;$(a).click()})}};c.runAJAXRequest=function(b,
a,c){if(!this.loading){b=s(b);$.colorbox.remove();var d=this,f=h._pAL(this.moduleClassName,b);this.showLoader();this.ajax(f,a).after(function(a){d.hideLoader();a?d.AJAXErrorHandler(a):d.go(b,c)})}};c.phrase=function(b,a){return h._p(h.slots[this.containerId]&&h.slots[this.containerId].moduleClassNameForPhrases,b,a)};c.ajax=function(b,a,c){var d=u&&u.zenarioAB&&u.zenarioAB.previewValues;if(d){if(!1===a||a===l)a={};_._isOb(a)?a.overrideSettings=d:a+="&overrideSettings="+encodeURIComponent(d)}return h._a(b,
a,c,!1,!0,l,l,this.AJAXErrorHandler,function(){$.colorbox.remove()})};c.pickerLink=function(b,a){var c;return(c=this.pages[b])?this.showSingleSlotLink(c.containerId,a,!1,c.cID,c.cType):!1};c.AJAXErrorHandler=function(b,a,c){var d=this,f="",g={};if(_._iS(b))f=y(b);else{c&&(f+="<h1><b>"+y(b.status+" "+c)+"</b></h1>");if(404==b.status)f+="<p>"+this.hardcodedPhrase.error404+"</p>";else if(500==b.status)f+="<p>"+this.hardcodedPhrase.error500+"</p>";else if(0==b.status||"timeout"==a)f+="<p>"+this.hardcodedPhrase.errorTimedOut+
"</p>";b.responseText&&(f+="<div>"+b.responseText+"</div>")}showErrorMessage=function(){g.body=f;g.retry=!!b.zenario_retry;$.colorbox({transition:"none",closeButton:!1,html:d.microTemplate(d.mtPrefix+"_error",g)});b.zenario_retry&&$("#zfea_retry").click(function(){setTimeout(b.zenario_retry,1)})};0==b.status||"timeout"==a?setTimeout(showErrorMessage,750):showErrorMessage()}},zenario.getContainerIdFromEl,window.zenarioGrid||{});
