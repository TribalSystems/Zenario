zenario.lib(function(h,f,C,u,D,x,k,m,E,F,G,n,A,B,s,z,y,H,I,w,q,t,J){f=createZenarioLibrary("FEA",zenarioF);f=w(f);f.idVarName=function(b){return"id"};f.validateFormatOrRedrawForField=function(b){b=this.field(b);return s(b.save_onchange)?(this.save(),!0):w(zenarioF).validateFormatOrRedrawForField.apply(this,arguments)};f.fill=function(){return this.ffov("fill")};f.format=function(){return this.ffov("format")};f.validate=function(){return this.ffov("validate")};f.save=function(){return this.ffov("save")};
f.setData=function(b){this.setDataDiff(b)};f.sendStateToServer=function(){return this.sendStateToServerDiff()};f.ffov=function(b){var a=this,d=new k.callback,c=this.url=k._pVTL(this[n.m],this.containerId,this.path,this.customisationName,this.request,b,!0),e=!1;"fill"!=b&&(this.prevPath=this.path,this.checkValues(),e={_format:!0,_tuix:this.sendStateToServer()});this.loading||(this.showLoader(),this.ajax(c,e,!0).after(function(c){a.hideLoader();"fill"==b?a.tuix=c:a.setData(c);a.tuix.go?a.go(a.containerId,
a.tuix.go):(a.sortOutTUIX(a.containerId,a.tuix),a.draw(),d.call())}));return d};f.draw=function(){this.draw2();if(this.tuix.confirm_on_close){var b=this;zenario_conductor.confirmOnClose(b.containerId,function(){return!b.hidden(h,b.tuix.confirm_on_close)},function(a){b.confirm(b.tuix.confirm_on_close,a)},b.tuix.confirm_on_close.message)}};f.redrawTab=function(){this.draw2();this.hideLoader(!0)};f.draw2=function(){this.sortTabs();this.tuix.form_title=this.getTitle();var b,a=new k.callback;this.putHTMLOnPage(this.drawFields(a,
this.mtPrefix+"_form"));this.path==this.prevPath&&this.lastFieldInFocus&&(b=this.get(this.lastFieldInFocus))&&b.focus();a.call()};f.ajaxURL=function(){return k._pAL(h,this.containerId,{path:this.path})};f.putHTMLOnPage=function(b){this.clearOnScrollForItemButtons();var a=this.containerId,d="#"+a;$(d).html(b);k._aJQE(d+" ");k.adminId&&m._sHADS(a)};f.microTemplate=function(b,a,d){var c;if(_._isAr(a))for(c in a)a[c].that=this,a[c].tuix||(a[c].tuix=this.tuix);else a.that=this,a.tuix||(a.tuix=this.tuix);
b=k._mT(b,a,d);if(_._isAr(a))for(c in a)delete a[c].that,delete a[c].tuix;else delete a.that,delete a.tuix;return b};f.showLoader=function(b,a){var d="loader_for_"+this.containerId,c=this.get(this.containerId),e=this.get(d),c=$(c);b?(this.loading=!1,c.removeClass("fea_loading").addClass("fea_loaded").addClass("fea_initial_load_done")):(this.loading=!0,c.removeClass("fea_loaded").addClass("fea_loading"));a?c.removeClass("fea_just_loaded").addClass("fea_just_redrawn"):c.removeClass("fea_just_redrawn").addClass("fea_just_loaded");
if(e)d=$(e);else{if(b)return;d=$(this.microTemplate(this.mtPrefix+"_loading",{loaderId:d}));c.prepend(d)}b?d.hide():d.width(c.width()).height(c.height()).show()};f.hideLoader=function(b){this.showLoader(!0,b)};f.reload=function(b){this.containerId&&this.runLogic(this.containerId,this.request,b||function(){})};f.navigationEnabled=function(b,a){return zenario_conductor.enabled(this.containerId)?zenario_conductor.commandEnabled(this.containerId,b):this.tuix.allowed_modes&&this.tuix.allowed_modes[a||
b]};f.checkModeAndPathOnRequest=function(b){b.mode?b.path=this.getPathFromMode(b.mode):b.path?b.mode=this.getModeFromPath(b.path):(b.mode=this.defaultMode,b.path=this.getPathFromMode(this.defaultMode))};f.runLogic=function(b,a,d){this.checkModeAndPathOnRequest(a);this.mode=a.mode;this.path=a.path;this.request=a;this.containerId=b;this.logic(b,a,d)};f.typeOfLogic=function(b){return b.path.match(/list/)?"list":"form"};f.logic=function(b,a,d){switch(this.typeOfLogic(a)){case "list":this.showList(d);
break;case "form":this.showForm(d);break;case "normal_plugin":k._rPS(b,n.u,a);break;case "normal_plugin_using_post":k._rPS(b,n.u,!1,!1,!1,!1,!1,a)}};f.showForm=function(b){this.changed={};this.fill().after(b)};f.showList=function(b){if(!this.loading){var a=this,d=this.url=k._pVTL(this[n.m],this.containerId,this.request.path,this.customisationName,this.request);this.showLoader();this.ajax(d,!1,!0).after(function(c){a.tuix=c;a.drawList();a.hideLoader(!1);b()})}};f.sizeTableListCells=function(){$(".zfea_with_responsive_table .zfea_table_list_wrap tr").each(function(b,
a){var d=0,c=$(a).children();c.each(function(a,b){$(b).css("height","")});c.each(function(a,b){d=Math.max(d,$(b).height())});c.each(function(a,b){$(b).height(d)})})};f.sizeTableListCellsIfNeededAfterDelay=function(){if(k.mobile){var b=this;setTimeout(function(){b.sizeTableListCells()},0)}};f.drawList=function(){this.hadSparkline=!1;this.sortOutTUIX(this.containerId,this.tuix);this.putHTMLOnPage(this.microTemplate(this.mtPrefix+"_list",{}));var b=this,a=1*this.tuix.__page__,d=1*this.tuix.__page_size__,
c=1*this.tuix.__item_count__,e;a&&d&&c&&c>d&&(e="#pagination_"+this.containerId,$(e).show().jPaginator({nbPages:Math.ceil(c/d),selectedPage:a,overBtnLeft:e+"_o_left",overBtnRight:e+"_o_right",maxBtnLeft:e+"_m_left",maxBtnRight:e+"_m_right",onPageClicked:function(a,c){b.go(b.containerId,{page:c})}}));this.hadSparkline&&this.initSparklineChart();!this.addedResizeListener&&u.addEventListener&&u.addEventListener("resize",this.sizeTableListCells);this.addedResizeListener=!0;k.mobile&&this.sizeTableListCellsIfNeededAfterDelay()};
f.getPathFromMode=function(b){return n.z+""+b};f.getModeFromPath=function(b){return b.replace(/^zenario_/,"")};f.recordRequestsInURL=function(b,a){k._rRIU(b,this.checkRequests(a,!0))};f.checkRequests=function(b,a,d,c,e){var g,f;b=k._cl(b,c);this.checkModeAndPathOnRequest(b);f=this.idVarName(this.mode)||"id";if(this.tuix&&this.tuix.key)for(g in this.tuix.key)q(this.tuix.key,g)&&(c=this.tuix.key[g],"id"==g&&"id"!=f&&this.tuix.key[f]===h&&(g=f),b[g]===h&&(b[g]=c));d?b[f]=d:e&&b[f]===h&&(b[f]="");for(g in b)q(b,
g)&&(c=b[g],_._isOb(c)&&(c=b[g]=c.replace_with_field_from_item&&d&&this.tuix.items&&this.tuix.items[d]?this.tuix.items[d][c.replace_with_field_from_item]:""),e||(_._isEm(c)||"0"===c)&&delete b[g]);a&&(delete b.path,b.mode==this.defaultMode&&delete b.mode);return b};f.init=function(b,a,d,c,e,g,f,l){w(zenarioF).init.call(this,b,a,c);this.last={};this.pages=f||{};this.prevPath=this.path=this.mode="";this.customisationName=l||"";this.defaultMode=g;this[n.m]=d;this.go(c,e,h,!0);this.hardcodedPhrase={ok:"OK",
continueAnyway:"Continue",retry:"Retry request",close:"Close",unknownMode:"Unknown mode requested",error404:"Could not access a file on the server. Please check that you have uploaded all of the CMS files to the server, and that you have no misconfigured rewrite rules in your Apache config or .htaccess file that might cause a 404 error.",error500:"Something on the server is incorrectly set up or misconfigured.",errorTimedOut:"There was no reply or a blank reply from the server.\n\nThis could be a temporary network problem, or could be a bug in the application."}};
f.editModeOn=function(b){return!0};f.editModeAlwaysOn=function(b){return!0};f.debug=function(){this.path&&this.tuix&&this.url&&m._d(this.globalName)};f.doSearch=function(b,a){k._st(b);var d=this.request,c={page:"",search:a!==h?a:this.get("search_"+this.containerId).value};this.go(this.containerId,this.checkRequests(d,!1,h,c,!0));return!1};f.go=function(b,a,d,c){b=t(b);a=a||{};a.mode===h&&a.path===h&&(a.path=this.path);a=this.checkRequests(a,!1,d,h,!0);this.last[b]={request:a};this.prevPath=this.path;
var e,g=this;d=a.command;delete a.command;d&&zenario_conductor.commandEnabled(b,d)?(delete a.mode,delete a.path,zenario_conductor.go(b,d,a)):c||!a.mode||a.mode==this.defaultMode||!(e=this.pages[a.mode])||e.cID==k.cID&&e.cType==k.cType?this.runLogic(b,a,function(){c||g.recordRequestsInURL(b,a)}):(delete a.mode,k._gTU(k._lTI(e.cID,e.cType,a)))};f.itemButtonIsntHidden=function(b,a,d){var c,e,g=!1,f=1,l=0;d=d?a.length:0;for(c in a)if(!(e=this.tuix.items[a[c]]))return!1;if(this.hidden(h,e,b.id,b))return!1;
s(b.multiple_select)&&(b.hide_when_children_are_not_visible||(this.multiSelectButtonsExist=!0),f=b.multiple_select_max_items,s(b.multiple_select_only)&&(l=2),b.multiple_select_min_items&&(l=Math.max(l,b.multiple_select_min_items)));if(d<l||f&&d>f)return!1;if(b.visible_if_for_all_selected_items!==h)for(c in a)if(e=this.tuix.items[a[c]],!m._e(b.visible_if_for_all_selected_items,this,h,e,b.id,b))return!1;if(b.visible_if_for_any_selected_items!==h){for(c in a)if(e=this.tuix.items[a[c]],m._e(b.visible_if_for_any_selected_items,
this,h,e,b.id,b)){g=!0;break}return g}return!0};f.buttonIsntDisabled=function(b,a){a:do if(!(s(b.disabled)||b.disabled_if!==h&&m._e(b.disabled_if,this,h,c,b.id,b))){var d,c;if(a!==h&&b.disabled_if_for_any_selected_items!==h)for(d in a)if(c=this.tuix.items[a[d]],m._e(b.disabled_if_for_any_selected_items,this,h,c,b.id,b))break a;if(a!==h&&b.disabled_if_for_all_selected_items!==h)for(d in a){if(c=this.tuix.items[a[d]],!m._e(b.disabled_if_for_all_selected_items,this,h,c,b.id,b))return!0}else return!0}while(0);
b._isDisabled=!0;b.tooltip=b.disabled_tooltip||b.tooltip;return!1};f.hidden=function(b,a,d,c,e,g,f,l){b=b||c||e||g||a||f||l;if(c&&c.go&&c.go.command)if(zenario_conductor.enabled(this.containerId)){if(!zenario_conductor.commandEnabled(this.containerId,c.go.command))return!0}else if(!c.go.mode)return!0;return m._h(b,this,a,d,c,e,g,f,l)};f.sortOutTUIX=function(b,a){b=t(b);this.newlyNavigated=this.path!=this.prevPath;this.multiSelectButtonsExist=!1;a.collection_buttons=a.collection_buttons||{};a.item_buttons=
a.item_buttons||{};a.columns=a.columns||{};a.items=a.items||{};var d,c,e,g;g=a.sort_by||"name";sortDesc=s(a.sort_desc);a.sortedCollectionButtonIds=m._gSIOTE(a,a.collection_buttons);a.sortedCollectionButtons=[];a.sortedItemButtonIds=m._gSIOTE(a,a.item_buttons);a.sortedItemButtons=[];a.sortedColumnIds=m._gSIOTE(a,a.columns);a.sortedColumns=[];for(d in a.sortedCollectionButtonIds)q(a.sortedCollectionButtonIds,d)&&(c=a.sortedCollectionButtonIds[d],e=_._cl(a.collection_buttons[c]),e.id=c,this.hidden(h,
h,c,e)||(this.buttonIsntDisabled(e)&&this.setupButtonLinks(b,e),a.sortedCollectionButtons.push(e)));for(d in a.sortedItemButtonIds)q(a.sortedItemButtonIds,d)&&(c=a.sortedItemButtonIds[d],e=a.item_buttons[c],e.id=c,a.sortedItemButtons.push(e));for(d in a.sortedColumnIds)q(a.sortedColumnIds,d)&&(c=a.sortedColumnIds[d],e=a.columns[c],e.id=c,this.hidden(h,h,c,h,e)||a.sortedColumns.push(e));m._sK(a.sortedColumns);m._sK(a.sortedCollectionButtons,"zfea_button_with_children");m._sK(a.sortedItemButtons,"zfea_button_with_children");
a.sortedItemIds=a.__item_sort_order__?a.__item_sort_order__:m._gSIOTE(a,"items",g,sortDesc);a.sortedItems=[];for(d in a.sortedItemIds)q(a.sortedItemIds,d)&&(c=a.sortedItemIds[d],g=a.items[c],g.id=c,a.sortedItems.push(g),g.sortedItemButtons=this.getSortedItemButtons(b,a,[c],!1));this.last[b].tuix=a};f.getSortedItemButtons=function(b,a,d,c){var e,g,f,l,h,k=[],p,m;m=c?d.join(","):p=d[0];for(e in a.sortedItemButtons)if(q(a.sortedItemButtons,e)&&(g=a.sortedItemButtons[e],g=_._cl(g),g.itemId=p,g.itemIds=
m,this.itemButtonIsntHidden(g,d,c))){this.buttonIsntDisabled(g,d)&&this.setupButtonLinks(b,g,m);if(g.children)for(f in h=g.children,g.children=[],h)q(h,f)&&(l=h[f],l=_._cl(l),l.itemId=p,l.itemIds=m,this.itemButtonIsntHidden(l,d,c)&&(this.buttonIsntDisabled(l,d)&&this.setupButtonLinks(b,l,m),g.children.push(l)));if(!g.hide_when_children_are_not_visible||g.children&&0<g.children.length)a.itemHasItemButton=!0,k.push(g)}return k};f.setupButtonLinks=function(b,a,d){b=t(b);var c,e,g;if(a.go||a.ajax||a.onclick||
a.confirm)g=this.defineLibVarBeforeCode(),a.onclick&&a.onclick.startsWith(g)||(g=g+"lib.button(this, '"+y(b)+"', '"+y(a.id)+"'",g=d?g+(", '"+y(d)+"'"):g+", undefined",a.go&&(e=this.checkRequests(a.go,!0,d)),a.onclick&&(g+=", function () {"+a.onclick+"}"),a.onclick=g+"); return false;");a.href===h&&e&&(d=e.command,delete e.command,d&&zenario_conductor.commandEnabled(b,d)?(delete e.mode,delete e.path,a.href=zenario_conductor.link(b,d,e)):e.mode&&e.mode!=this.defaultMode&&(c=this.pages[e.mode])&&(c.cID!=
k.cID||c.cType!=k.cType)?(delete e.mode,a.href=k._lTI(c.cID,c.cType,e)):a.href=k._lTI(k.cID,k.cType,e))};f.clickButton=function(b,a){var d=this,c=this.field(a),e=w(zenarioF).clickButton;c.confirm&&!this.hidden(c.confirm,h,a,c)?this.confirm(c.confirm,function(){e.call(d,b,a)}):e.call(this,b,a)};f.button=function(b,a,d,c,e,g){if(!this.loading){a=t(a);var f=this,l,m=!1,n=this.last[a],p,r=0;c!==h?(l=c.split(","),r=l.length,1==r&&(m=n.tuix.items[c]),l=n.tuix.item_buttons[d]):l=n.tuix.collection_buttons[d];
if(g||!(p=l.confirm||l.go&&l.go.confirm||l.ajax&&l.ajax.confirm)||this.hidden(p,m,d,l)){if(e&&(g=e.call(b),g!==h&&!g))return;l.ajax?(g=this.checkRequests(l.ajax.request,!1,c,h,!0),this.runAJAXRequest(a,g,l.go||this.checkRequests(n.request,!0),l.ajax.download)):this.go(a,l.go,c)}else c!==h&&(p=_._ex({},p),1===r?p.message=k._aMF(p.message,m):(p.title=((p.multiple_select_title||p.title)+"").replace(/\[\[item_count\]\]/ig,r),p.message=((p.multiple_select_message||p.message)+"").replace(/\[\[item_count\]\]/ig,
r))),this.confirm(p,function(){f.button(b,a,d,c,e,!0)})}};f.checkAllCheckboxes=function(b){$("#"+this.containerId+" input.zfea_check_item").each(function(a,d){d.checked=b.checked});this.updateItemButtons()};f.clearOnScrollForItemButtons=function(){this.updateItemButtonPositionOnScroll&&$(u).off("scroll",this.updateItemButtonPositionOnScroll)};f.updateItemButtons=function(){this.clearOnScrollForItemButtons();var b=this.containerId,a=B("zfea_check_all_"+b),d=$("#"+b+" tr.zfea_row"),c=$("#"+b+" td.sorted_buttons"),
e=$("#multi_select_buttons_td_"+b),f=$("#multi_select_buttons_"+b),h=$("#"+b+" td.zfea_check_item input"),l=h.filter("input:checked"),m=l.first(),n=l.last(),p=l.length,r,q,s,v,t=[];if(p){if(d.each(function(a,b){var c=$(b);c.height(c.height())}),l.each(function(a,b){var c=$(b);t.push(c.data("item_id"))}),f.html(this.microTemplate(this.mtPrefix+"_button",this.getSortedItemButtons(this.containerId,this.tuix,t,!0))),k._aJQE("#multi_select_buttons_"+b+" "),e.show(),c.hide(),a.checked=p==h.length,b=m.offset().top,
n=n.offset().top,s=$(u).width()/2,a=e.height()-f.outerHeight(!0),v=e.offset().top,r=b-v,q=n-v,0>r&&(r=0),q>a&&(q=a),0<q&&($("body > div:visible:not(.ui-helper-hidden-accessible)").each(function(a,b){var c=$(b);"fixed"==c.css("position")&&c.css("top").match(/^0/)&&c.width()>s&&(v-=c.height())}),this.updateItemButtonPositionOnScroll=function(a){a=k._sT()-v;a<r?a=r:a>q&&(a=q);f.css("margin-top",Math.round(a))},this.updateItemButtonPositionOnScroll(),1<p))$(u).on("scroll",this.updateItemButtonPositionOnScroll)}else e.hide(),
c.show(),a.checked=!1,d.each(function(a,b){$(b).height("")})};f.sparkline=function(){Highcharts.SparkLine=function(a,b,c){var d="string"===typeof a||a.nodeName,e=arguments[d?1:0],e=Highcharts.merge({chart:{renderTo:e.chart&&e.chart.renderTo||this,backgroundColor:null,borderWidth:0,type:"area",margin:[2,0,2,0],width:120,height:40,style:{overflow:"visible"},skipClone:!0},title:{text:""},credits:{enabled:!1},xAxis:{labels:{enabled:!1},title:{text:null},startOnTick:!1,endOnTick:!1,tickPositions:[]},yAxis:{endOnTick:!1,
startOnTick:!1,labels:{enabled:!1},title:{text:null},tickPositions:[0]},legend:{enabled:!1},tooltip:{backgroundColor:null,borderWidth:0,shadow:!1,useHTML:!0,hideDelay:0,shared:!0,padding:0,positioner:function(a,b,c){return{x:c.plotX-a/2,y:c.plotY-b}}},plotOptions:{series:{animation:!1,lineWidth:1,shadow:!1,states:{hover:{enabled:!1}},marker:{radius:1,states:{hover:{radius:2}}},fillOpacity:0.25},column:{negativeColor:"#910000",borderColor:"silver"}}},e);return d?new Highcharts.Chart(a,e,c):new Highcharts.Chart(e,
b)};$("td[data-sparkline]");var b,a,d,c;for(d in this.tuix.sortedColumns)if(q(this.tuix.sortedColumns,d)&&(c=this.tuix.sortedColumns[d],c.sparkline))for(b in this.tuix.sortedItems)if(q(this.tuix.sortedItems,b)){a=this.tuix.sortedItems[b];var e=$(this.get("zfea_"+this.containerId+"_row_"+b+"_col_"+d));a=a[c.id]||{};var f={};a.values?e.highcharts("SparkLine",{colors:[a.colour?a.colour:"#82CAFF"],series:[{data:a.values,pointStart:1}],tooltip:{headerFormat:'<span style="font-size: 10px">'+a.label+":</span><br/>",
pointFormat:"<b>{point.y}</b> "+a.units},chart:f}):$("#"+("zfea_"+this.containerId+"_row_"+b+"_col_"+d)).html(a.no_data_message)}};f.initSparklineChart=function(){var b=this;k._lL(n.s+"libraries/not_to_redistribute/highcharts/highcharts.js",function(){b.sparkline();b.sizeTableListCellsIfNeededAfterDelay()})};f.confirm=function(b,a){if(!this.loading){if(!_._isFu(a)&&a._zenario_confirmed)return delete a._zenario_confirmed,!0;$[n.x]({transition:"none",closeButton:!1,html:this.microTemplate(this.mtPrefix+
"_confirm",b),className:"zfea_colorbox_content"+(b.css_class?" "+b.css_class:"")});_._isFu(a)?$("#zfea_do_it").click(function(){$[n.x].remove();a()}):$("#zfea_do_it").click(function(){$[n.x].remove();a._zenario_confirmed=!0;$(a).click()})}};f.runAJAXRequest=function(b,a,d,c){if(!this.loading){b=t(b);$[n.x].remove();var e=this;c?(url=k._pAL(this[n.m],b,a),u.location=url):(url=k._pAL(this[n.m],b),this.showLoader(),this.ajax(url,a).after(function(a){e.hideLoader();a?e.AJAXErrorHandler(a):e.go(b,d)}))}};
f.phrase=function(b,a){return k._p(k.slots[this.containerId]&&k.slots[this.containerId][n.p],b,a)};f.ajax=function(b,a,d){var c=this,e=k.adminId&&x&&x.zenarioAB&&x.zenarioAB.previewValues;if(e){if(!1===a||a===h)a={};_._isOb(a)?a.overrideSettings=e:a+="&overrideSettings="+A(e)}return k._a(b,a,d,!1,!0,!0,h,h,function(a,b,d){c.AJAXErrorHandler(a,b,d)},function(){$[n.x].remove()})};f.pickerLink=function(b,a){var d;return(d=this.pages[b])?this.showSingleSlotLink(d.containerId,a,!1,d.cID,d.cType):!1};f.AJAXErrorHandler=
function(b,a,d){var c=this,e="",f={};b=m._sDFEM(b);d&&(e+=m.h1(z(b.status+" "+d)));if(404==b.status)e+=m.p(this.hardcodedPhrase.error404);else if(500==b.status)e+=m.p(this.hardcodedPhrase.error500);else if(0==b.status||"timeout"==a)e+=m.p(this.hardcodedPhrase.errorTimedOut);b.responseText&&(e+=m.div(z(b.responseText)));showErrorMessage=function(){f.body=e;f.retry=!!b.zenario_retry;f.continueAnyway=b.zenario_continueAnyway&&b.data;$[n.x]({transition:"none",closeButton:!1,html:c.microTemplate(c.mtPrefix+
"_error",f)});f.retry&&$("#zfea_retry").click(function(){$[n.x].close();k._eS(n.x+"");setTimeout(b.zenario_retry,1)});f.continueAnyway&&$("#zfea_continueAnyway").click(function(){$[n.x].close();k._eS(n.x+"");setTimeout(function(){b.zenario_continueAnyway(b.data)},1)})};0==b.status||"timeout"==a?setTimeout(showErrorMessage,750):showErrorMessage()}},zenario.getContainerIdFromEl,window.zenarioGrid||{});
