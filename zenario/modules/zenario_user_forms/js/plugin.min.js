(function(f){f.recaptcha=function(){onloadCallback()};f.updateRestatementFields=function(a,b){$(a?':input[data-mirror-of="'+a+'"]':":input[data-mirror-of]").each(function(c,d){var a=$(d),e=$("#"+a.data("mirror-of"));"checkbox"==b||"radio"==b?a.prop("checked",e.prop("checked")):a.val(e.val())})};f.initCalculateField=function(a,b,c,d,k,e){c=$("input#"+a+"_field_value_"+c);d=$("input#"+a+"_field_value_"+d);c.on("keyup",function(){f.calculate(a,b,c,d,k,e)});d.on("keyup",function(){f.calculate(a,b,c,d,
k,e)})};f.calculate=function(a,b,c,d,k,e){c=c.val();d=d.val();var g=0;c=Number(c);!isNaN(c)&&isFinite(c)&&(g+=c);d=Number(d);!isNaN(d)&&isFinite(c)&&("-"==k&&(d*=-1),g+=d);g=parseFloat(g.toFixed(2));f.setJSCalculatedField(a,b,g);if(e)for(b in e)e.hasOwnProperty(b)&&$(':input[data-mirror-of="'+a+"_field_value_"+e[b]+'"]').val(g)};f.setJSCalculatedField=function(a,b,c){$("#"+a+"_field_value_"+b).val(c)};f.toggleFieldVisibility=function(a,b,c,d,k){$("#"+a+"_field_"+c+" :input").on("change",function(){var e;
e="checkbox"==k?$(this).is(":checked"):$(this).val();null===d&&""!==e||e==d?$("#"+a+"_field_"+b).show():$("#"+a+"_field_"+b).hide()})};f.initJQueryElements=function(a,b){var c=$("#"+a+"_fullscreen");c.on("click",function(){zenario.enableFullScreen($("#"+a)[0])});$(document).on(zenario.fullScreenChangeEvent,function(){var d=zenario.isFullScreen();c.toggle(!d);$("#"+a).toggleClass("in_fullscreen",d)});b&&zenario.exitFullScreen();$("#"+a+"_user_form input.jquery_form_datepicker").each(function(d,a){zenario.loadDatePicker();
a.id&&(a.value=$.datepicker.formatDate(zenario.dpf,$.datepicker.parseDate("yy-mm-dd",get(a.id+"__0").value)),$("#"+a.id).datepicker({dateFormat:zenario.dpf,altField:"#"+a.id+"__0",altFormat:"yy-mm-dd",showOn:"focus"}))});$("#"+a+"_user_form .autocomplete_json").each(function(){var d=this,c=JSON.parse($(this).html());if(c){var e=[],b;for(b in c)e.push({value:b,label:c[b]});$(this).prev().autocomplete({minLength:0,source:e,select:function(c,e){c.preventDefault();var b="",g="";e.item&&(b=e.item.label,
g=e.item.value);$(d).next().val(g);$(d).prev().val(b);$("#"+a+"_filter_list").val(1);$("#"+a+"_filter_list_id").val($(d).parent().data("id"));$("#"+a+"_filter_list_value").val(g);$("#"+a+"_user_form form").submit()},focus:function(a,c){this.value=c.item.label;a.preventDefault()},change:function(a,c){if(!c.item){var d=$(this).val(),b=e.find(function(a){return a.label.toLowerCase()===d.toLowerCase()});$(this).data("ui-autocomplete")._trigger("select","autocompleteselect",{item:b})}}}).on("click",function(){$(this).autocomplete("search",
"")})}})};f.submitMultiPageForm=!1;f.initMultiPageForm=function(a,b,c,d,k){$("#"+c+" :input:not(textarea)").on("keydown",function(a){13==a.keyCode&&(a.preventDefault(),$(this).parents("fieldset").find("input.next").click())});$("#"+c+" input.next").on("click",function(e){if(!f.submitMultiPageForm){e.preventDefault();var g=$(this).parent(),t=$(this).parent().next(),l=g.prop("id"),m=!1;e=l.match(/\d+$/);var n=$(this).is('input[type="submit"]'),h;h=n?$("#"+c):$("#"+l);m=h.find(":input").serialize();
h.find(':input[type="file"]').each(function(a,c){var d=$(c);m+="&"+d.prop("name")+"="+d.val()});m+="&_pageNo="+e+"&_pageCount="+k;(e=$("#"+b+"_math_captcha_input").val())&&(m+="&captcha_code="+e);zenario.ajax(a,m).after(function(a){a=JSON.parse(a);$("#"+l+" div.form_error").remove();if(_.isEmpty(a))n?(f.submitMultiPageForm=!0,$("#"+c+"__form input:submit").click()):(g.css("visibility","visible"),t.show("slide",{direction:"right"},500),g.hide(),d||$("html, body").animate({scrollTop:$("#"+b).offset().top-
20}));else{var e="",k="",h;for(h in a)"captcha"==h?(e='<div class="form_error">'+a[h]+"</div>",$("#"+b+"_math_captcha div.field_title").after(e)):(k="#"+b+"_field_"+h,e='<div class="form_error">'+a[h].message+"</div>","checkbox"!=a[h].type&&"group"!=a[h].type&&$(k+" div.field_title").length?$(k+" div.field_title").after(e):$(k).append(e));a=b;d&&(a="colorbox");zenario.isFullScreen()||$("#"+a).effect("shake",{distance:10,times:3,duration:300})}})}});$("#"+c+" input.previous").on("click",function(){var a=
$(this).parent(),c=$(this).parent().prev();a.css("visibility","visible");c.show("slide",{direction:"left"},500);a.hide();$("html, body").animate({scrollTop:$("#"+b).offset().top-20})})};f.initFilePickerFields=function(a,b){$("#"+a+" .form_field.field_file_picker").each(function(){var a=this,d=$(this).find(".file_picker_field"),k=$(this).find(".progress_bar"),e=$(this).find(".file_upload_button"),g=d.data("limit"),f=d.data("extensions"),l=0,m=0,a=this,n=$(this).data("id"),h=void 0;if(f){for(var h=
"\\.(",q=f.split(","),r=[],p=0;p<q.length;p++){var s=q[p].replace(/\./i,"").trim();s&&r.push(s)}h+=r.join("|");h=RegExp(h+")$","i")}k.progressbar();d.fileupload({url:b,dataType:"json",maxFileSize:1E7,acceptFileTypes:h,maxNumberOfFiles:g,getNumberOfFiles:function(){return l},submit:function(a,c){l++},start:function(a){k.show()},done:function(d,b){$.each(b.result.files,function(d,b){var f;f='<div class="file_row">';f=b.download_link?f+('<p><a href="'+b.download_link+'" target="_blank">'+b.name+"</a></p>"):
f+("<p>"+b.name+"</p>");f+='<input name="file_picker_'+n+"_"+ ++m+'" type="hidden" value="'+b.id+'" />';f+='<span class="delete_file_button">'+zenario.phrase("zenario_user_forms","Delete")+"</span>";f+="</div>";$(a).find(".files").append($(f));l>=g&&e.hide()});$(a).find(".delete_file_button").off().on("click",function(){$(this).parent().remove();l--;l<g&&e.show()})},always:function(a,b){k.hide()},processfail:function(a,b){alert(b.files[b.index].error)},progressall:function(a,b){var c=parseInt(100*
(b.loaded/b.total),10);k.progressbar("option","value",c)},messages:{acceptFileTypes:zenario.phrase("zenario_user_forms","Allowed file types: [[types]]",{types:f}),maxFileSize:zenario.phrase("zenario_user_forms","File exceeds maximum allowed size of 10MB"),maxNumberOfFiles:zenario.phrase("zenario_user_forms","Maximum number of files exceeded")}});f={};h=$(this).find(".loaded_files").text();f.files=JSON.parse(h);0<f.files.length&&(l=f.files.length,d.fileupload("option","done").call(d,$.Event("done"),
{result:f}))})}})(zenario_user_forms);
