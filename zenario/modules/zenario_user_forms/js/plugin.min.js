zenario_user_forms.recaptcha=function(){onloadCallback()};zenario_user_forms.updateRestatementFields=function(a,d){$(a?':input[data-mirror-of="'+a+'"]':":input[data-mirror-of]").each(function(b,c){var a=$(c),e=$("#"+a.data("mirror-of"));"checkbox"==d||"radio"==d?a.prop("checked",e.prop("checked")):a.val(e.val())})};
zenario_user_forms.initCalculateField=function(a,d,b,c,f,e){b=$("input#"+a+"_field_value_"+b);c=$("input#"+a+"_field_value_"+c);b.on("keyup",function(){zenario_user_forms.calculate(a,d,b,c,f,e)});c.on("keyup",function(){zenario_user_forms.calculate(a,d,b,c,f,e)})};
zenario_user_forms.calculate=function(a,d,b,c,f,e){b=b.val();c=c.val();var g=0;b=Number(b);!isNaN(b)&&isFinite(b)&&(g+=b);c=Number(c);!isNaN(c)&&isFinite(b)&&("-"==f&&(c*=-1),g+=c);g=parseFloat(g.toFixed(2));zenario_user_forms.setJSCalculatedField(a,d,g);if(e)for(d in e)e.hasOwnProperty(d)&&$(':input[data-mirror-of="'+a+"_field_value_"+e[d]+'"]').val(g)};zenario_user_forms.setJSCalculatedField=function(a,d,b){$("#"+a+"_field_value_"+d).val(b)};
zenario_user_forms.toggleFieldVisibility=function(a,d,b,c,f){$("#"+a+"_field_"+b+" :input").on("change",function(){var b;b="checkbox"==f?$(this).is(":checked"):$(this).val();null===c&&""!==b||b==c?$("#"+a+"_field_"+d).show():$("#"+a+"_field_"+d).hide()})};
zenario_user_forms.initJQueryElements=function(a){$("#"+a+" input.jquery_form_datepicker").each(function(a,b){zenario.loadDatePicker();b.id&&(b.value=$.datepicker.formatDate(zenario.dpf,$.datepicker.parseDate("yy-mm-dd",get(b.id+"__0").value)),$("#"+b.id).datepicker({dateFormat:zenario.dpf,altField:"#"+b.id+"__0",altFormat:"yy-mm-dd",showOn:"focus"}))})};zenario_user_forms.submitMultiPageForm=!1;
zenario_user_forms.initMultiPageForm=function(a,d,b,c,f){$("#"+b+" :input:not(textarea)").on("keydown",function(b){13==b.keyCode&&(b.preventDefault(),$(this).parents("fieldset").find("input.next").click())});$("#"+b+" input.next").on("click",function(e){if(!zenario_user_forms.submitMultiPageForm){e.preventDefault();var g=$(this).parent(),k=$(this).parent().next(),l=g.prop("id"),m=!1;e=l.match(/\d+$/);var n=$(this).is('input[type="submit"]'),h;h=n?$("#"+b):$("#"+l);m=h.find(":input").serialize();h.find(':input[type="file"]').each(function(b,
c){var a=$(c);m+="&"+a.prop("name")+"="+a.val()});m+="&_pageNo="+e+"&_pageCount="+f;(e=$("#"+d+"_math_captcha_input").val())&&(m+="&captcha_code="+e);zenario.ajax(a,m).after(function(a){a=JSON.parse(a);$("#"+l+"div.form_error").remove();if(_.isEmpty(a))n?(zenario_user_forms.submitMultiPageForm=!0,$("#"+b+"__form input:submit").click()):(g.css("visibility","visible"),k.show("slide",{direction:"right"},500),g.hide(),c||$("html, body").animate({scrollTop:$("#"+d).offset().top-20}));else{var e="",f="";
for(fieldId in a)"captcha"==fieldId?(e='<div class="form_error">'+a[fieldId]+"</div>",$("#"+d+"_math_captcha div.field_title").after(e)):(f="#"+d+"_field_"+fieldId,e='<div class="form_error">'+a[fieldId].message+"</div>","checkbox"!=a[fieldId].type&&"group"!=a[fieldId].type&&$(f+" div.field_title").length?$(f+" div.field_title").after(e):$(f).append(e));a=d;c&&(a="colorbox");$("#"+a).effect("shake",{distance:10,times:3,duration:300})}})}});$("#"+b+" input.previous").on("click",function(){var b=$(this).parent();
prev=$(this).parent().prev();b.css("visibility","visible");prev.show("slide",{direction:"left"},500);b.hide();$("html, body").animate({scrollTop:$("#"+d).offset().top-20})})};
zenario_user_forms.initFilePickerFields=function(a,d){$("#"+a+" .form_field.field_file_picker").each(function(){var b=this,a=$(this).find(".file_picker_field"),f=$(this).find(".progress_bar"),e=$(this).find(".file_upload_button"),g=a.data("limit"),k=a.data("extensions"),l=0,m=0,b=this,n=$(this).data("id"),h=void 0;if(k){for(var h="\\.(",q=k.split(","),r=[],p=0;p<q.length;p++){var s=q[p].replace(/\./i,"").trim();s&&r.push(s)}h+=r.join("|");h=RegExp(h+")$","i")}f.progressbar();a.fileupload({url:d,dataType:"json",
maxFileSize:1E7,acceptFileTypes:h,maxNumberOfFiles:g,getNumberOfFiles:function(){return l},submit:function(a,b){l++},start:function(a){f.show()},done:function(a,d){$.each(d.result.files,function(a,d){var c;c='<div class="file_row">';c=d.download_link?c+('<p><a href="'+d.download_link+'" target="_blank">'+d.name+"</a></p>"):c+("<p>"+d.name+"</p>");c+='<input name="file_picker_'+n+"_"+ ++m+'" type="hidden" value="'+d.id+'" />';c+='<span class="delete_file_button">'+zenario.phrase("zenario_user_forms",
"Delete")+"</span>";c+="</div>";$(b).find(".files").append($(c));l>=g&&e.hide()});$(b).find(".delete_file_button").off().on("click",function(){$(this).parent().remove();l--;l<g&&e.show()})},always:function(a,b){f.hide()},processfail:function(a,b){alert(b.files[b.index].error)},progressall:function(a,b){var c=parseInt(100*(b.loaded/b.total),10);f.progressbar("option","value",c)},messages:{acceptFileTypes:zenario.phrase("zenario_user_forms","Allowed file types: [[types]]",{types:k}),maxFileSize:zenario.phrase("zenario_user_forms",
"File exceeds maximum allowed size of 10MB"),maxNumberOfFiles:zenario.phrase("zenario_user_forms","Maximum number of files exceeded")}});k={};h=$(this).find(".loaded_files").text();k.files=JSON.parse(h);0<k.files.length&&(l=k.files.length,a.fileupload("option","done").call(a,$.Event("done"),{result:k}))})};
