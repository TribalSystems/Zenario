<div id="organizer_field_details_inner" class="field_details_inner">
	
	<form id="organizer_field_details_form">
	
	<div class="field_details_header">
		<div class="field_details_header_options">
			<input class="form_settings" type="button" value="Form settings"/>
		</div>
		<div id="zenario_field_details_header_content" class="field_details_header_content">
			<div class="field_name">
				<div class="view_mode" <% if (m.just_added) { %>style="display:none;"<% } %>>
					<h5>{{m.name|e}}</h5>
					<% if (!m.field_id) { %>
						<span class="edit_field_name_button">Edit</span>
					<% } %>
				</div>
				<% if (!m.field_id) { %>
					<div class="edit_mode" <% if (!m.just_added) { %>style="display:none;"<% } %>>
						<input name="name" id="field__name" type="text" value="{{m.name|e}}" maxlength="255"/>
						<span class="done_field_name_button">Done</span>
					</div>
				<% } %>
			</div>
			<div class="field_buttons">
				<span class="add_new_field">Add new field</span>
			</div>
			<div class="field_info">
				<span class="field_type_message">{{m.formattedType|e}}</span>
			</div> 
		</div>
	</div>
	<div id="organizer_field_details_tabs" class="field_details_tabs">
		<% if (m.showDetailsTab) { %>
			<div 
				id="field_tab__details"
				class="tab <% if (m.currentFieldTab == 'details') { %>on<% } %>" 
				onclick="zenarioO.pi.showFieldDetailsSection('details');"
			>
				Details
			</div>
		<% } %>
		<% if (m.showAdvancedTab) { %>
			<div 
				id="field_tab__advanced" 
				class="tab <% if (m.currentFieldTab == 'advanced') { %>on<% } %>" 
				onclick="zenarioO.pi.showFieldDetailsSection('advanced');"
			>
				Advanced
			</div>
		<% } %>
		<% if (m.showValuesTab) { %>
			<div 
				id="field_tab__values" 
				class="tab <% if (m.currentFieldTab == 'values') { %>on<% } %>" 
				onclick="zenarioO.pi.showFieldDetailsSection('values');"
			>
				Values
			</div>
		<% } %>
		<% if (m.showTranslationsTab) { %>
			<div 
				id="field_tab__translations" 
				class="tab <% if (m.currentFieldTab == 'translations') { %>on<% } %>" 
				onclick="zenarioO.pi.showFieldDetailsSection('translations');"
			>
				Translations
			</div>
		<% } %>
		<% if (m.showCRMTab) { %>
			<div 
				id="field_tab__crm" 
				class="tab <% if (m.currentFieldTab == 'crm') { %>on<% } %>" 
				onclick="zenarioO.pi.showFieldDetailsSection('crm');"
			>
				CRM
			</div>
		<% } %>
	</div>
	
	<div id="organizer_field_details" class="field_details">
		
		<!-- START Details tab -->
		<% if (m.showDetailsTab) { %>
			<div 
				id="field_section__details" 
				class="section"
				<% if (m.currentFieldTab != 'details') { %>
					style="display:none;"
				<% } %>
			>
				<% if (m.type != 'page_break' && m.type != 'page_end') { %>
					<div class="field">
						<div class="title">
							<% if (m.type == 'repeat_start') { %>
								Section heading:
							<% } else { %>
								Label:
							<% } %>
						</div>
						<div class="value">
							<input name="label" id="field__field_label" type="text" value="{{m.label|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							<% if (m.type == 'repeat_start') { %>
								This will be the heading at the start of the repeating section.
							<% } else { %>
								This will be the field label as seen by the user. 
							<% } %>
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'section_description') { %>
					<div class="field">
						<div class="title">Description:</div>
						<div class="value">
							<textarea id="field__description" name="description">{{m.description|e}}</textarea>
							<div class="note_below">
								This is a description of the section placed under the label.
							</div>
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'centralised_radios' || m.type == 'centralised_select' || (m.type == 'restatement' && m.mirrorFieldType == 'centralised_select')) { %>
					
					<% if (!m.field_id) { %>
						<div class="field" id="field_container__values_source">
							<div class="title">Source:</div>
							<div class="value">
								<select name="values_source">
									{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.values_source_options)}}
								</select>
							</div>
						</div>
					<% } %>
				<% } %>
				<% if (m.type == 'centralised_radios' || m.type == 'centralised_select') { %>
					<% if (!m.field_id) { %>
						<% if (m.show_source_filter) { %>
							<div class="field" id="field_container__values_source_filter">
								<div class="title">{{m.source_filter_label|e}}</div>
								<div class="value">
									<input name="values_source_filter" type="text" maxlength="255" value="{{m.values_source_filter|e}}"/>
								</div>
								<div class="note_below">
									Set a filter for the source
								</div>
							</div>
						<% } %>
						
					<% } %>
					
					<div class="field">
						<div class="title">Filter on field:</div>
						<div class="value">
							<select name="filter_on_field">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.filter_on_field_options)}}
							</select>
						</div>
						<div class="note_below">
							Filter a centralised select list based on the value of another field. 
						</div>
					</div>
					
				<% } %>
				
				
                <% if (m.type != 'page_end') { %>
                    <div class="field" id="field_container__visibility">
                        <div class="title">Visibility:</div>
                        <div class="value">
                            <select name="visibility">
                                {{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.visibility_options)}}
                            </select>
                        </div>
                    </div>
				<% } %>
				
				<% if (m.visibility == 'visible_on_condition') { %>
					<div class="field" id="field_container__visible_condition_field_id">
						<div class="title">Visible on condition field:</div>
						<div class="value">
							<select name="visible_condition_field_id">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.visible_condition_field_id_options)}}
							</select>
						</div>
						<div class="note_below">
							Select a field that this fields visibility will rely on from the current form (the following types of field are allowed: checkbox, radios, select, centralised radios and centralised select)
						</div>
					</div>
					
					<% if (m.visible_condition_field_id) { %>
						<div class="field">
							<div class="title">Visible if:</div>
							<div class="value">
								<select name="visible_condition_field_value">
									{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.visible_condition_field_value_options)}}
								</select>
							</div>
						</div>
					<% } %>
				<% } %>
				
				<% if (m.type == 'repeat_start') { %>
					<div class="field">
						<div class="title">Minimum rows:</div>
						<div class="value">
							<input name="min_rows" id="field__min_rows" type="text" value="{{m.min_rows|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							The number of rows that are always shown and cannot be deleted.
						</div>
					</div>
					
					<div class="field">
						<div class="title">Maximum rows:</div>
						<div class="value">
							<input name="max_rows" id="field__max_rows" type="text" value="{{m.max_rows|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							The maximum number of rows that can be added.
						</div>
					</div>
				<% } %>
				
				
				<% if (m.type != 'page_break' && m.type != 'section_description' && m.type != 'repeat_start' && m.type != 'page_end') { %>
					
					<div class="field" id="field_container__readonly_or_mandatory">
						<div class="title">Mandatory / Read-only:</div>
						<div class="value">
							<select name="readonly_or_mandatory">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.readonly_or_mandatory_options)}}
							</select>
						</div>
						<div class="note_below">
							Choose whether this field is mandatory or read-only.
						</div>
					</div>
					
					<% if (m.readonly_or_mandatory == 'conditional_mandatory') { %>
						<div class="field" id="field_container__mandatory_condition_field_id">
							<div class="title">Mandatory on condition field:</div>
							<div class="value">
								<select name="mandatory_condition_field_id">
									{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.mandatory_condition_field_id_options)}}
								</select>
							</div>
							<div class="note_below">
								Select a field that this field will rely on from the current form (the following types of field are allowed: checkbox, radios, select, centralised radios and centralised select)
							</div>
						</div>
						
						<% if (m.mandatory_condition_field_id) { %>
							<div class="field">
								<div class="title">Mandatory if:</div>
								<div class="value">
									<select name="mandatory_condition_field_value">
										{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.mandatory_condition_field_value_options)}}
									</select>
								</div>
							</div>
						<% } %>
					<% } %>
					
					<% if (m.readonly_or_mandatory == 'mandatory' || m.readonly_or_mandatory == 'conditional_mandatory') { %>
						<div class="field">
							<div class="title">Error message when field is incomplete:</div>
							<div class="value">
								<input name="required_error_message" type="text" value="{{m.required_error_message|e}}" maxlength="255"/>
							</div>
							<div class="note_below">
								Enter an error message when this field is incomplete.
							</div>
						</div>
					<% } %>
					
					
					
				<% } %>
				
				<% if (m.type == 'text') { %>
					<div class="field" id="field_container__field_validation">
						<div class="title">Validation:</div>
						<div class="value">
							<select name="field_validation">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.validation_options)}}
							</select>
						</div>
					</div>
					
					<% if (['email', 'URL', 'integer', 'number', 'floating_point'].indexOf(m.field_validation) != -1) { %>
						<div class="field">
							<div class="title">Error message when validation fails:</div>
							<div class="value">
								<input name="field_validation_error_message" type="text" value="{{m.field_validation_error_message|e}}" maxlength="255"/>
							</div>
							<div class="note_below">
								Enter an error message when validation fails. 
							</div>
						</div>
					<% } %>
				<% } %>
				
				<% if (m.type == 'text' && false) { %>
					<!-- TODO: make changes on preview -->
					<div class="field">
						<div class="title">Width:</div>
						<div class="value">
							<select name="size">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.size_options)}}
							</select>
						</div>
						<div class="note_below">
							Size of the input box on the page.
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'text' || m.type == 'textarea') { %>
					<div class="field">
						<div class="title">Placeholder:</div>
						<div class="value">
							<input name="placeholder" id="field__placeholder" type="text" value="{{m.placeholder|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							Enter a value to be displayed as a placeholder until the user enters something.
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'date') { %>
					<div class="field">
						<div class="value">
							<input id="field__show_month_year_selectors" name="show_month_year_selectors" type="checkbox" 
								<% if (m.show_month_year_selectors) { %> checked="checked" <% } %>
							/>
							<label for="field__show_month_year_selectors" class="title">Show month and year selectors</label>
						</div>
					</div>
				<% } %>
				
				<% if (m.type != 'page_break' && m.type != 'section_description' && m.type != 'repeat_start' && m.type != 'page_end') { %>
					<div class="field">
						<div class="title">Note below field:</div>
						<div class="value">
							<input name="note_to_user" id="field__note_to_user" type="text" value="{{m.note_to_user|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							Enter a note to the user that will be displayed below this field.
						</div>
					</div>
				
				<% } %>
				
				<% if (m.type == 'page_break') { %>
					<div class="field">
						<div class="title">"Next" button text:</div>
						<div class="value">
							<input name="next_button_text" type="text" value="{{m.next_button_text|e}}" maxlength="255"/>
						</div>
					</div>
					
					<div class="field">
						<div class="title">"Back" button text:</div>
						<div class="value">
							<input name="previous_button_text" type="text" value="{{m.previous_button_text|e}}" maxlength="255"/>
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'page_break' || m.type == 'page_end') { %>
				    <div class="field">
						<div class="value">
							<input id="field__hide_in_page_switcher" name="hide_in_page_switcher" type="checkbox" 
								<% if (m.hide_in_page_switcher) { %> checked="checked" <% } %>
							/>
							<label for="field__hide_in_page_switcher" class="title">Hide in page switcher</label>
						</div>
					</div>
				<% } %>
				
				<% if (m.type == 'calculated') { %>
					<div class="field">
						<div class="title">Value prefix:</div>
						<div class="value">
							<input name="value_prefix" type="text" value="{{m.value_prefix|e}}" maxlength="255"/>
						</div>
					</div>
					<div class="field">
						<div class="title">Value postfix:</div>
						<div class="value">
							<input name="value_postfix" type="text" value="{{m.value_postfix|e}}" maxlength="255"/>
						</div>
					</div>
					
					
					<div class="field">
						<div class="value">
							<textarea readonly>{{m.calculation_code_display|e}}</textarea>
							<input type="button" id="edit_field_calculation" value="Edit calculation">
						</div>
					</div>
					
				<% } %>
				
				<% if (m.type == 'restatement') { %>
					<div class="field" id="field_container__restatement_field">
						<div class="title">Field to mirror:</div>
						<div class="value">
							<select name="restatement_field">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.restatement_field_options)}}
							</select>
						</div>
						<div class="note_below">
							You can mirror text, calculated, select lists and centralised select lists.
						</div>
					</div>
				<% } %>
			</div>
		<% } %>
		<!-- END Details tab -->
		
		<!-- START advanced tab -->
		<% if (m.showAdvancedTab) { %>
			<div 
				id="field_section__advanced" 
				class="section" 
				<% if (m.currentFieldTab != 'advanced') { %>
					style="display:none;"
				<% } %>
			>
				<% if (m.dataset_field_id) { %>
					<div class="field">
						<div class="value">
							<input id="field__preload_dataset_field_user_data" name="preload_dataset_field_user_data" type="checkbox" 
								<% if (m.preload_dataset_field_user_data) { %> checked="checked" <% } %>
							/>
							<label for="field__preload_dataset_field_user_data" class="title">Pre-populate with logged in users data</label>
						</div>
					</div>
				<% } else { %>
				
					<% if (m.type != 'checkboxes' && m.type != "section_description" && m.type != "repeat_start") { %>
						<div class="field" id="field_container__default_value_options">
							<div class="title">Pre-populate field:</div>
							<div class="value">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_radio_values', m.default_value_mode_options)}}
							</div>
						</div>
					
						<% if (m.default_value_mode == 'value') { %>
							<% if (['radios', 'centralised_radios', 'select', 'centralised_select', 'checkbox', 'group'].indexOf(m.type) != -1) { %>
								<div class="field">
									<div class="title">Default value:</div>
									<div class="value">
										<select name="default_value_lov">
											{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.default_value_lov_options)}}
										</select>
									</div>
									<div class="note_below">
										Select a value to pre-populate this field.
									</div>
								</div>
							<% } else { %>
								<div class="field">
									<div class="title">Default value:</div>
									<div class="value">
										<input name="default_value_text" type="text" value="{{m.default_value|e}}" maxlength="255"/>
									</div>
									<div class="note_below">
										Enter a value to pre-populate this field.
									</div>
								</div>
							<% } %>
						<% } else if (m.default_value_mode == 'method') { %>
						
							<div class="field">
								<div class="title">Module class name:</div>
								<div class="value">
									<input name="default_value_class_name" type="text" value="{{m.default_value_class_name|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Static method name:</div>
								<div class="value">
									<input name="default_value_method_name" type="text" value="{{m.default_value_method_name|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Parameter 1:</div>
								<div class="value">
									<input name="default_value_param_1" type="text" value="{{m.default_value_param_1|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Parameter 2:</div>
								<div class="value">
									<input name="default_value_param_2" type="text" value="{{m.default_value_param_2|e}}" maxlength="255"/>
								</div>
							</div>
						<% } %>
					<% } %>
				<% } %>
				
				<% if (m.type == 'checkboxes') { %>
					<div class="field">
						<div class="title">Checkbox columns:</div>
						<div class="value">
							<select name="value_field_columns">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.value_field_columns_options)}}
							</select>
						</div>
					</div>
				<% } %>
				
				<div class="field">
					<div class="title">CSS classes:</div>
					<div class="value">
						<input id="field__css_classes" name="css_classes" type="text" value="{{m.css_classes|e}}" maxlength="255"/>
					</div>
					<div class="note_below">
						Enter a list of classes separated by spaces that'll be applied to this field.
					</div>
				</div>
			
				<div class="field">
					<div class="title">Wrapper div class:</div>
					<div class="value">
						<input id="field__div_wrap_class" name="div_wrap_class" type="text" value="{{m.div_wrap_class|e}}" maxlength="255"/>
					</div>
					<div class="note_below">
						Enter a class for a wrapper div around this field. Fields above or below with the same wrapper div class will also be added into this div.
					</div>
				</div>
				
				<% if (m.type != "section_description") { %>
					<div class="field">
						<div class="title">Custom code name:</div>
						<div class="value">
							<input name="custom_code_name" type="text" value="{{m.custom_code_name|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							This is used so a developer can reference this field in a module without having to know the ID. Unique per form.
						</div>
					</div>
				<% } %>
				
				<% if (m.type == "text") { %>
					<div class="field" id="field_container__autocomplete">
						<div class="value">
							<input id="field__autocomplete" name="autocomplete" type="checkbox" 
								<% if (m.autocomplete) { %> checked="checked" <% } %>
							/>
							<label for="field__autocomplete" class="title">Autocomplete</label>
						</div>
						<div class="note_below">
							Show a list of possible options below that match what you type.
						</div>
					</div>
					
					<% if (m.autocomplete) { %>
					
						<div class="field" id="field_container__autocomplete_options">
							<div class="title">Autocomplete values source:</div>
							<div class="value">
								{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_radio_values', m.autocomplete_options_lov)}}
							</div>
						</div>
					    
					    <% if (m.autocomplete_options == 'centralised_list') { %>
							<div class="field" id="field_container__values_source">
								<div class="title">Source:</div>
								<div class="value">
									<select name="values_source">
										{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.values_source_options)}}
									</select>
								</div>
							</div>
							
							<div class="field" id="field_container__filter_on_field">
								<div class="title">Filter on field:</div>
								<div class="value">
									<select name="filter_on_field">
										{{zenarioT.microTemplate('zenario_organizer_admin_box_builder_select_values', m.filter_on_field_options)}}
									</select>
								</div>
								<div class="note_below">
									Filter an autocomplete list based on the value of another field.
								</div>
							</div>
							
							<% if (m.filter_on_field) { %>
								<div class="field">
									<div class="title">No filter placeholder:</div>
									<div class="value">
										<input name="autocomplete_no_filter_placeholder" type="text" value="{{m.autocomplete_no_filter_placeholder|e}}" maxlength="255"/>
									</div>
									<div class="note_below">
										Set this text as a placeholder if a user clicks on this field when no filter's been chosen.
									</div>
								</div>
							<% } %>
							
						<% } else if (m.autocomplete_options == 'method') { %>
							<div class="field">
								<div class="title">Module class name:</div>
								<div class="value">
									<input name="autocomplete_class_name" type="text" value="{{m.autocomplete_class_name|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Static method name:</div>
								<div class="value">
									<input name="autocomplete_method_name" type="text" value="{{m.autocomplete_method_name|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Parameter 1:</div>
								<div class="value">
									<input name="autocomplete_param_1" type="text" value="{{m.autocomplete_param_1|e}}" maxlength="255"/>
								</div>
							</div>
							<div class="field">
								<div class="title">Parameter 2:</div>
								<div class="value">
									<input name="autocomplete_param_2" type="text" value="{{m.autocomplete_param_2|e}}" maxlength="255"/>
								</div>
							</div>
						<% } %>
					<% } %>
				<% } %>
				
			</div>
		<% } %>
		<!-- END advanced tab -->
		
		<!-- START values tab -->
		<% if (m.showValuesTab) { %>
			<div 
				id="field_section__values" 
				class="section <% if (m.field_id) { %> readonly<% } %>" 
				<% if (m.currentFieldTab != 'values') { %>
					style="display:none;"
				<% } %>
			>
				<% if (m.field_id) { %>
					<div class="warning_message">
						You cannot edit a dataset field's values from here. Please go to the dataset editor in order to change these values.
					</div>
				<% } %>
				
				<div id="field_values_list"></div>
				<div class="bottom_buttons">
					<input type="button" id="organizer_add_a_field_value" value="Add a value" <% if (m.field_id) { %> disabled<% } %>/>
				</div>
			</div>
		<% } %>
		<!-- END values tab -->
		
		<!-- START translations tab -->
		<% if (m.showTranslationsTab) { %>
			<div 
				id="field_section__translations" 
				class="section" 
				<% if (m.currentFieldTab != 'translations') { %>
					style="display:none;"
				<% } %>
			>
				{{zenarioT.microTemplate('zenario_organizer_form_builder_translatable_field', m.translatable_fields)}}
				
			</div>
		<% } %>
		<!-- END translations tab -->
		
		<!-- START crm tab -->
		<% if (m.showCRMTab) { %>
			<div 
				id="field_section__crm" 
				class="section" 
				<% if (m.currentFieldTab != 'crm') { %>
					style="display:none;"
				<% } %>
			>
				
				
				<div class="field" id="field_container__send_to_crm">
					<div class="value">
						<input id="field__send_to_crm" name="send_to_crm" type="checkbox" 
							<% if (m._crm_data.send_to_crm) { %> checked="checked" <% } %>
						/>
						<label for="field__send_to_crm" class="title">Send to CRM</label>
					</div>
				</div>
				
				<% if (m._crm_data.send_to_crm) { %>
					<div class="field">
						<div class="title">CRM field name:</div>
						<div class="value">
							<input name="field_crm_name" type="text" value="{{m._crm_data.field_crm_name|e}}" maxlength="255"/>
						</div>
						<div class="note_below">
							This is used to identify the field in the CRM
						</div>
					</div>
					
					<% if (m.type == 'centralised_select' || m.type == 'centralised_radios') { %>
						<div class="centralised_crm_buttons">
							<input type="button" id="organizer_crm_button__set_labels" value="Set option label as CRM value"/>
							<input type="button" id="organizer_crm_button__set_values" value="Set option value as CRM value"/>
						</div>
					<% } %>
					
					<% if (m.hasCRMValues) { %>
						<table>
							<tr>
								<th>Option</th>
								<th>CRM value to be sent</th>
							</tr>
							{{zenarioT.microTemplate('zenario_organizer_form_builder_crm_value', m.crm_values)}}
						</table>
					<% } %>
				<% } %>
				
			</div>
		<% } %>
		<!-- END crm tab -->
	</div>
	
	</form>
	
</div>