# You must use a tab-size of 4 spaces to edit this file.
---
zenario__users:
    panels:
        administrators:
            title: Administrators
            no_items_message: This site has no Administrators. Click "Create" to create one.
            view_mode: list
            db_items:
                table: '[[DB_NAME_PREFIX]]admins AS a'
                id_column: a.id
                custom_where_statement_if_no_refiner: "WHERE status != 'deleted'"
            refiners:
                active:
                    sql: "status != 'deleted'"
                trashed:
                    sql: "status = 'deleted'"
            label_format_for_grid_view: '[[first_name]] [[last_name]] ([[username]][[csuper]])'
            columns:
                username:
                    title: Username
                    db_column: a.username
                    show_by_default: true
                    searchable: true
                first_name:
                    title: First Name
                    db_column: a.first_name
                    show_by_default: true
                    searchable: true
                    width: small
                last_name:
                    title: Last Name
                    db_column: a.last_name
                    show_by_default: true
                    searchable: true
                    width: small
                email:
                    title: Email
                    db_column: a.email
                    searchable: true
                authtype:
                    title: Auth type
                    db_column: a.authtype
                    format: enum
                    values:
                        local: Local
                        super: Multi-site
                    show_by_default: true
                    width: small
                permissions:
                    title: Permissions
                    db_column: |
                        CASE a.permissions
                            WHEN 'specific_actions' THEN
                                IF ((
                                    SELECT 1
                                    FROM [[DB_NAME_PREFIX]]action_admin_link
                                    AS aal
                                    WHERE aal.admin_id = a.id
                                    LIMIT 1
                                ),
                                    'specific_actions',
                                    'no_actions'
                                )
                            WHEN 'specific_languages' THEN
                                IF (a.specific_content_items != '',
                                    IF (a.specific_languages != '',
                                        'specific_content_items_and_languages',
                                        'specific_content_items'
                                    ),
                                    'specific_languages'
                                )
                            ELSE a.permissions
                        END
                    format: enum
                    values:
                        all_permissions: All permissions
                        no_actions: No permissions
                        specific_actions: Specific actions
                        specific_content_items: Specific content items
                        specific_content_items_and_languages: Specific content items and languages
                        specific_languages: Specific languages
                        specific_menu_areas: Specific areas in the menu
                    show_by_default: true
                    width: large
                is_client_account:
                    title: Is client account
                    format: yes_or_no
                    db_column: a.is_client_account
                csuper:
                    db_column: "IF (a.authtype = 'multi-site', ', multi-site', \'\')"
                status:
                    db_column: a.status
                    server_side_only: true
                created_date:
                    title: Creation Date
                    db_column: a.created_date
                    format: date
                last_login:
                    title: Last Login
                    db_column: a.last_login
                    format: date
                    show_by_default: true
                    width: small
                last_login_ip:
                    title: Last Login IP Address
                    db_column: a.last_login_ip
                last_platform:
                    title: Last platform
                    db_column: a.last_platform
                last_browser:
                    title: Last browser
                    db_column: a.last_browser
                last_browser_version:
                    title: Last browser version
                    db_column: a.last_browser_version
                has_permissions:
                    title: Has Permissions
                    db_column: "1"
                    format: yes_or_no
                    
                filename:
                    db_column: f.filename
                    table_join: >
                        LEFT JOIN [[DB_NAME_PREFIX]]files AS f
                        ON a.image_id = f.id
                        AND f.`usage` = 'admin'
                checksum:
                    db_column: f.checksum
                    table_join: >
                        LEFT JOIN [[DB_NAME_PREFIX]]files AS f
                        ON a.image_id = f.id
                        AND f.`usage` = 'admin'
                has_image:
                    format: yes_or_no
                    db_column: f.id IS NOT NULL
                    table_join: >
                        LEFT JOIN [[DB_NAME_PREFIX]]files AS f
                        ON a.image_id = f.id
                        AND f.`usage` = 'admin'
                    width: xxsmall
                
            quick_filter_buttons:
                all:
                    label: 'All'
                    column: authtype
                    remove_filter: true
                local:
                    label: 'Local'
                    column: authtype
                    value: local
                super:
                    label: 'Multi-site'
                    column: authtype
                    value: super

            item:
                css_class: admin_item
            collection_buttons:
                create:
                    priv: _PRIV_CREATE_ADMIN
                    css_class: zenario_create_a_new
                    hide_on_filter: true
                    label: Create a local admininstrator
                    hide_on_refiner: trashed
                    hide_in_select_mode: true
                    admin_box:
                        path: zenario_admin
                        create_another: true
                copy_perms:
                    priv: _PRIV_EDIT_ADMIN
                    label: Copy permissions...
                    admin_box:
                        path: admin_copy_perms
                    disabled_tooltip: |
                        Requires two active, local administrators
                    hide_on_refiner: trashed
                    hide_in_select_mode: true
            item_buttons:
                edit:
                    ord: "1"
                    priv: _PRIV_VIEW_ADMIN
                    label: Properties
                    hide_in_select_mode: true
                    admin_box:
                        path: zenario_admin
                action_dropdown:
                    label: Actions
                    multiple_select: true
                    hide_when_children_are_not_visible: true
                #copy_perms_from:
                #    parent: action_dropdown
                #    priv: _PRIV_EDIT_ADMIN
                #    label: Copy permissions from...
                #    admin_box:
                #        path: admin_copy_perms
                #        key:
                #            id_is_from: true
                #    disabled_tooltip: |
                #        Requires two active, local administrators
                #    traits:
                #        local: true
                #        active: true
                #copy_perms_to:
                #    parent: action_dropdown
                #    priv: _PRIV_EDIT_ADMIN
                #    label: Copy permissions to...
                #    multiple_select: true
                #    admin_box:
                #        path: admin_copy_perms
                #        key:
                #            id_is_to: true
                #    disabled_tooltip: |
                #        Requires two active, local administrators
                #    traits:
                #        local: true
                #        active: true
                #    without_traits:
                #        current_admin: true
                restore_admin:
                    parent: action_dropdown
                    priv: _PRIV_DELETE_ADMIN
                    label: Restore
                    multiple_select: true
                    multiple_select_tooltip: Restore the selected local administrators
                    hide_in_select_mode: true
                    only_show_on_refiner: trashed
                    ajax:
                        confirm:
                            message: 'Are you sure you wish to restore the local administrator "[[username]]"?'
                            multiple_select_message: >
                                Are you sure you wish to restore the selected local
                                administrators?
                            button_message: Restore
                            cancel_button_message: Cancel
                            message_type: warning
                        request:
                            restore: "1"
                    traits:
                        local: true
                        trashed: true
                trash_admin:
                    parent: action_dropdown
                    priv: _PRIV_DELETE_ADMIN
                    label: Trash
                    hide_in_select_mode: true
                    multiple_select: true
                    multiple_select_tooltip: Trash the selected local administrators
                    ajax:
                        confirm:
                            message: 'Are you sure you wish to trash the Local Administrator "[[username]]"?'
                            multiple_select_message: >
                                Are you sure you wish to trash the selected local
                                administrators?
                            button_message: Trash
                            cancel_button_message: Cancel
                            message_type: warning
                        request:
                            trash: "1"
                    traits:
                        local: true
                        active: true
                    without_traits:
                        current_admin: true
            default_sort_column: username
            trash:
                link:
                    path: zenario__users/panels/administrators
                    refiner: trashed
                    branch: true
