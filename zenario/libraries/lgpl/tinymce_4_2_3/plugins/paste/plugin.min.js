(function(G,C){function H(k,p){for(var g,m=[],a=0;a<k.length;++a){if(!(g=D[k[a]]))a:{g=G;for(var d=k[a].split(/[.\/]/),n=0;n<d.length;++n){if(!g[d[n]]){g=void 0;break a}g=g[d[n]]}}if(!g)throw"module definition dependecy not found: "+k[a];m.push(g)}p.apply(null,m)}function A(k,p,g){if("string"!==typeof k)throw"invalid module definition, module id must be defined and be a string";if(p===C)throw"invalid module definition, dependencies must be specified";if(g===C)throw"invalid module definition, definition function must be specified";
H(p,function(){D[k]=g.apply(null,arguments)})}var D={};A("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(k,p,g){function m(a,d){k.each(d,function(d){a=d.constructor==RegExp?a.replace(d,""):a.replace(d[0],d[1])});return a}return{filter:m,innerText:function(a){function d(a){var k=a.name,g=a;if("br"===k)b+="\n";else if(r[k]&&(b+=" "),u[k])b+=" ";else{3==a.type&&(b+=a.value);if(!a.shortEnded&&(a=a.firstChild)){do d(a);while(a=a.next)}y[k]&&g.next&&
(b+="\n","p"==k&&(b+="\n"))}}var n=new g,l=new p({},n),b="",r=n.getShortEndedElements(),u=k.makeMap("script noscript style textarea video audio iframe object"," "),y=n.getBlockElements();a=m(a,[/<!\[[^\]]+\]>/g]);d(l.parse(a));return b},trimHtml:function(a){return a=m(a,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(a,k,g){return k||g?"\u00a0":" "}],/<br>$/i])}}});A("tinymce/pasteplugin/Clipboard",
["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(k,p,g,m){return function(a){function d(c){var f,e=a.dom;f=a.fire("BeforePastePreProcess",{content:c});f=a.fire("PastePreProcess",f);c=f.content;f.isDefaultPrevented()||(a.hasEventListeners("PastePostProcess")&&!f.isDefaultPrevented()&&(c=e.add(a.getBody(),"div",{style:"display:none"},c),f=a.fire("PastePostProcess",{node:c}),e.remove(c),c=f.node.innerHTML),f.isDefaultPrevented()||a.insertContent(c,{merge:!1!==
a.settings.paste_merge_formats,data:{paste:!0}}))}function n(c){c=a.dom.encode(c).replace(/\r\n/g,"\n");var f=a.dom.getParent(a.selection.getStart(),a.dom.isBlock),e=a.settings.forced_root_block,h;e&&(h=a.dom.createHTML(e,a.settings.forced_root_block_attrs),h=h.substr(0,h.length-3)+">");f&&/^(PRE|DIV)$/.test(f.nodeName)||!e?c=m.filter(c,[[/\n/g,"<br>"]]):(c=m.filter(c,[[/\n\n/g,"</p>"+h],[/^(.*<\/p>)(<p>)$/,h+"$1"],[/\n/g,"<br />"]]),-1!=c.indexOf("<p>")&&(c=h+c));d(c)}function l(){function c(a){var c,
e;e=a.startContainer;c=a.getClientRects();if(c.length)return c[0];if(a.collapsed&&1==e.nodeType){for(a=e.childNodes[v.startOffset];a&&3==a.nodeType&&!a.data.length;)a=a.nextSibling;if(a&&("BR"==a.tagName&&(e=f.doc.createTextNode("\ufeff"),a.parentNode.insertBefore(e,a),a=f.createRng(),a.setStartBefore(e),a.setEndAfter(e),c=a.getClientRects(),f.remove(e)),c.length))return c[0]}}var f=a.dom,e=a.getBody(),h=a.dom.getViewPort(a.getWin()).y,b=20,d;v=a.selection.getRng();a.inline&&(d=a.selection.getScrollContainer())&&
0<d.scrollTop&&(h=d.scrollTop);if(v.getClientRects)if(b=c(v))b=h+(b.top-f.getPos(e).y);else if(b=h,h=v.startContainer)3==h.nodeType&&h.parentNode!=e&&(h=h.parentNode),1==h.nodeType&&(b=f.getPos(h,d||e).y);s=f.add(a.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+b+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},w);(k.ie||k.gecko)&&f.setStyle(s,"left","rtl"==f.getStyle(e,"direction",!0)?65535:-65535);f.bind(s,"beforedeactivate focusin focusout",
function(a){a.stopPropagation()});s.focus();a.selection.select(s,!0)}function b(){if(s){for(var c;c=a.dom.get("mcepastebin");)a.dom.remove(c),a.dom.unbind(c);v&&a.selection.setRng(v)}s=v=null}function r(){var c="",f,e,h;f=a.dom.select("div[id=mcepastebin]");for(e=0;e<f.length;e++)h=f[e],h.firstChild&&"mcepastebin"==h.firstChild.id&&(h=h.firstChild),h=h.innerHTML,c!=w&&(c+=h);return c}function u(a){var f={};if(a){if(a.getData){var e=a.getData("Text");e&&0<e.length&&-1==e.indexOf(q)&&(f["text/plain"]=
e)}if(a.types)for(e=0;e<a.types.length;e++){var h=a.types[e];f[h]=a.getData(h)}}return f}function y(c,f){function e(e){function h(c){f&&(a.selection.setRng(f),f=null);d('<img src="'+c.result+'">')}var b,w,r;r=!1;if(e)for(b=0;b<e.length;b++)w=e[b],/^image\/(jpeg|png|gif|bmp)$/.test(w.type)&&(r=new FileReader,r.onload=h.bind(null,r),r.readAsDataURL(w.getAsFile?w.getAsFile():w),c.preventDefault(),r=!0);return r}var h=c.clipboardData||c.dataTransfer;if(a.settings.paste_data_images&&h)return e(h.items)||
e(h.files)}function E(a){a=a.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&a&&a.items&&0===a.items.length}function F(){a.on("keydown",function(c){function f(a){(g.metaKeyPressed(a)&&86==a.keyCode||a.shiftKey&&45==a.keyCode)&&!a.isDefaultPrevented()&&b()}(g.metaKeyPressed(c)&&86==c.keyCode||c.shiftKey&&45==c.keyCode)&&!c.isDefaultPrevented()&&(B=c.shiftKey&&86==c.keyCode,B&&k.webkit&&-1!=navigator.userAgent.indexOf("Version/")||(c.stopImmediatePropagation(),x=(new Date).getTime(),
k.ie&&B?(c.preventDefault(),a.fire("paste",{ieFake:!0})):(b(),l(),a.once("keyup",f),a.once("paste",function(){a.off("keyup",f)}))))});a.on("paste",function(c){var f=(new Date).getTime(),e=u(c.clipboardData||a.getDoc().dataTransfer),f=(new Date).getTime()-f,h=1E3>(new Date).getTime()-x-f,q="text"==t.pasteFormat||B;B=!1;c.isDefaultPrevented()||E(c)?b():y(c)?b():(h||c.preventDefault(),!k.ie||h&&!c.ieFake||(l(),a.dom.bind(s,"paste",function(a){a.stopPropagation()}),a.getDoc().execCommand("Paste",!1,null),
e["text/html"]=r()),setTimeout(function(){var c;"text/html"in e&&0<e["text/html"].length?c=e["text/html"]:(c=r(),c==w&&(q=!0));c=m.trimHtml(c);s&&s.firstChild&&"mcepastebin"===s.firstChild.id&&(q=!0);b();c.length||(q=!0);q&&(c="text/plain"in e&&0<e["text/plain"].length&&-1==c.indexOf("</p>")?e["text/plain"]:m.innerText(c));c==w?h||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):q?n(c):d(c)},0))});a.on("dragstart dragend",function(a){z="dragstart"==a.type});a.on("drop",
function(c){var f=p.getCaretRangeFromPoint(c.clientX,c.clientY,a.getDoc());if(!c.isDefaultPrevented()&&!z&&!y(c,f)&&f&&!1!==a.settings.paste_filter_drop){var e=u(c.dataTransfer),h=e["mce-internal"]||e["text/html"]||e["text/plain"];h&&(c.preventDefault(),a.undoManager.transact(function(){e["mce-internal"]&&a.execCommand("Delete");a.selection.setRng(f);h=m.trimHtml(h);e["text/html"]?d(h):n(h)}))}});a.on("dragover dragend",function(c){a.settings.paste_data_images&&c.preventDefault()})}var t=this,s,v,
x=0,z=!1,w="%MCEPASTEBIN%",B,q="data:text/mce-internal,";t.pasteHtml=d;t.pasteText=n;a.on("preInit",function(){F();a.parser.addNodeFilter("img",function(c,f,e){function h(a){a.attr("data-mce-object")||b===k.transparentSrc||a.remove()}if(!a.settings.paste_data_images&&e.data&&!0===e.data.paste)for(f=c.length;f--;){var b=c[f].attributes.map.src;b&&(0===b.indexOf("webkit-fake-url")?h(c[f]):a.settings.allow_html_data_urls||0!==b.indexOf("data:")||h(c[f]))}})})}});A("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),
function(k,p,g,m,a,d){function n(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function l(a){var b;a=a.replace(/^[\u00a0 ]+/,"");k.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],
function(d){if(d.test(a))return b=!0,!1});return b}function b(b){var u=b.settings;b.on("BeforePastePreProcess",function(y){function E(b){function d(a){var c="";if(3===a.type)return a.value;if(a=a.firstChild){do c+=d(a);while(a=a.next)}return c}function q(a,c){if(3===a.type&&c.test(a.value))return a.value=a.value.replace(c,""),!1;if(a=a.firstChild){do if(!q(a,c))return!1;while(a=a.next)}return!0}function c(a){if(a._listIgnore)a.remove();else if(a=a.firstChild){do c(a);while(a=a.next)}}function f(b,
f,d){var g=b._listLevel||k;g!=k&&(g<k?e&&(e=e.parent.parent):(h=e,e=null));e&&e.name==f?e.append(b):(h=h||e,e=new a(f,1),1<d&&e.attr("start",""+d),b.wrap(e));b.name="li";g>k&&h&&h.lastChild.append(e);k=g;c(b);q(b,/^\u00a0+/);q(b,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);q(b,/^\u00a0+/)}for(var e,h,k=1,r=[],g=b.firstChild;"undefined"!==typeof g&&null!==g;)if(r.push(g),g=g.walk(),null!==g)for(;"undefined"!==typeof g&&g.parent!==b;)g=g.walk();for(g=0;g<r.length;g++)if(b=r[g],"p"==b.name&&b.firstChild){var u=
d(b);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(u))f(b,"ul");else if(l(u)){var u=/([0-9]+)\./.exec(u),t=1;u&&(t=parseInt(u[1],10));f(b,"ol",t)}else b._listLevel?f(b,"ul",1):e=null}else h=e,e=null}function F(d,g){var q={},c,f=b.dom.parseStyle(g);k.each(f,function(a,b){switch(b){case "mso-list":if(c=/\w+ \w+([0-9]+)/i.exec(g))d._listLevel=parseInt(c[1],10);/Ignore/i.test(a)&&d.firstChild&&(d._listIgnore=!0,d.firstChild._listIgnore=!0);break;case "horiz-align":b="text-align";break;case "vert-align":b=
"vertical-align";break;case "font-color":case "mso-foreground":b="color";break;case "mso-background":case "mso-highlight":b="background";break;case "font-weight":case "font-style":"normal"!=a&&(q[b]=a);return;case "mso-element":if(/^(comment|comment-list)$/i.test(a)){d.remove();return}}0===b.indexOf("mso-comment")?d.remove():0!==b.indexOf("mso-")&&("all"==s||v&&v[b])&&(q[b]=a)});/(bold)/i.test(q["font-weight"])&&(delete q["font-weight"],d.wrap(new a("b",1)));/(italic)/i.test(q["font-style"])&&(delete q["font-style"],
d.wrap(new a("i",1)));return(q=b.dom.serializeStyle(q,d.name))?q:null}var t=y.content,s,v,t=t.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),t=t.replace(/<br class="?Apple-interchange-newline"?>/gi,"");(s=u.paste_retain_style_properties)&&(v=k.makeMap(s.split(/[, ]/)));if(!1!==u.paste_enable_default_filters&&n(y.content)){y.wordContent=!0;var t=d.filter(t,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,
"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return 0<b.length?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join("\u00a0"):""}]]),x=u.paste_word_valid_elements;x||(x="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");x=new g({valid_elements:x,valid_children:"-li[p]"});
k.each(x.elements,function(a){a.attributes["class"]||(a.attributes["class"]={},a.attributesOrder.push("class"));a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});var z=new p({},x);z.addAttributeFilter("style",function(a){for(var b=a.length,d;b--;)d=a[b],d.attr("style",F(d,d.attr("style"))),"span"==d.name&&d.parent&&!d.attributes.length&&d.unwrap()});z.addAttributeFilter("class",function(a){for(var b=a.length,d,c;b--;)d=a[b],c=d.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(c)&&
d.remove(),d.attr("class",null)});z.addNodeFilter("del",function(a){for(var b=a.length;b--;)a[b].remove()});z.addNodeFilter("a",function(a){for(var b=a.length,d,c,f;b--;)d=a[b],c=d.attr("href"),f=d.attr("name"),c&&-1!=c.indexOf("#_msocom_")?d.remove():(c&&0===c.indexOf("file://")&&(c=c.split("#")[1])&&(c="#"+c),c||f?f&&!/^_?(?:toc|edn|ftn)/i.test(f)?d.unwrap():d.attr({href:c,name:f}):d.unwrap())});t=z.parse(t);!1!==u.paste_convert_word_fake_lists&&E(t);y.content=(new m({},x)).serialize(t)}})}b.isWordContent=
n;return b});A("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(k,p,g,m){return function(a){function d(b){a.on("BeforePastePreProcess",function(a){a.content=b(a.content)})}function n(b){if(!g.isWordContent(b))return b;var d=[];p.each(a.schema.getBlockElements(),function(a,b){d.push(b)});var k=RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+d.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");b=m.filter(b,
[[k,"$1"]]);return b=m.filter(b,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function l(b){if(g.isWordContent(b))return b;var d=a.settings.paste_webkit_styles;if(!1===a.settings.paste_remove_styles_if_webkit||"all"==d)return b;d&&(d=d.split(/[, ]/));if(d){var k=a.dom,m=a.selection.getNode();b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,b,g,s){a=k.parseStyle(g,"span");g={};if("none"===d)return b+s;for(var n=0;n<d.length;n++){var l=a[d[n]],p=k.getStyle(m,d[n],!0);/color/.test(d[n])&&
(l=k.toHex(l),p=k.toHex(p));p!=l&&(g[d[n]]=l)}return(g=k.serializeStyle(g,"span"))?b+' style="'+g+'"'+s:b+s})}else b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return b=b.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,b,d,g){return b+' style="'+d+'"'+g})}k.webkit&&d(l);k.ie&&d(n)}});A("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(k,p,g,m){var a;k.add("paste",
function(d){function k(){"text"==b.pasteFormat?(this.active(!1),b.pasteFormat="html"):(b.pasteFormat="text",this.active(!0),a||(d.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var l=this,b,r=d.settings;l.clipboard=b=new p(d);l.quirks=new m(d);l.wordFilter=new g(d);d.settings.paste_as_text&&(l.clipboard.pasteFormat="text");if(r.paste_preprocess)d.on("PastePreProcess",function(a){r.paste_preprocess.call(l,l,
a)});if(r.paste_postprocess)d.on("PastePostProcess",function(a){r.paste_postprocess.call(l,l,a)});d.addCommand("mceInsertClipboardContent",function(a,b){b.content&&l.clipboard.pasteHtml(b.content);b.text&&l.clipboard.pasteText(b.text)});if(d.paste_block_drop)d.on("dragend dragover draggesture dragdrop drop drag",function(a){a.preventDefault();a.stopPropagation()});if(!d.settings.paste_data_images)d.on("drop",function(a){var b=a.dataTransfer;b&&b.files&&0<b.files.length&&a.preventDefault()});d.addButton("pastetext",
{icon:"pastetext",tooltip:"Paste as text",onclick:k,active:"text"==l.clipboard.pasteFormat});d.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:b.pasteFormat,onclick:k})})});(function(k){for(var p=0;p<k.length;p++){for(var g=G,m=k[p],a=m.split(/[.\/]/),d=0;d<a.length-1;++d)g[a[d]]===C&&(g[a[d]]={}),g=g[a[d]];g[a[a.length-1]]=D[m]}})(["tinymce/pasteplugin/Utils"])})(this);
