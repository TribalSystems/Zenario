tinymce.PluginManager.add("importcss",function(c){function q(b){var a=tinymce.Env.cacheSuffix;"string"==typeof b&&(b=b.replace("?"+a,"").replace("&"+a,""));return b}function r(b){var a=c.settings,d=!1!==a.skin?a.skin||"lightgray":!1;return d?(a=(a=a.skin_url)?c.documentBaseURI.toAbsolute(a):tinymce.baseURL+"/skins/"+d,b===a+"/content"+(c.inline?".inline":"")+".min.css"):!1}function m(b){return"string"==typeof b?function(a){return-1!==a.indexOf(b)}:b instanceof RegExp?function(a){return b.test(a)}:
b}function s(b,a){function d(b,t){var c=b.href,e;if((c=q(c))&&a(c,t)&&!r(c)){f(b.imports,function(a){d(a,!0)});try{e=b.cssRules||b.rules}catch(l){}f(e,function(a){a.styleSheet?d(a.styleSheet,!0):a.selectorText&&f(a.selectorText.split(","),function(a){g.push(tinymce.trim(a))})})}}var g=[],e={};f(c.contentCSS,function(a){e[a]=!0});a||(a=function(a,b){return b||e[a]});try{f(b.styleSheets,function(a){d(a)})}catch(l){}return g}function n(b){var a,d=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(b);if(d){var g=
d[1],e=d[2].substr(1).split(".").join(" "),l=tinymce.makeMap("a,img");d[1]?(a={title:b},c.schema.getTextBlockElements()[g]?a.block=g:c.schema.getBlockElements()[g]||l[g.toLowerCase()]?a.selector=g:a.inline=g):d[2]&&(a={inline:"span",title:b.substr(1),classes:e});!1!==c.settings.importcss_merge_classes?a.classes=e:a.attributes={"class":e};return a}}var p=this,f=tinymce.each;c.on("renderFormatsMenu",function(b){var a=c.settings,d={},g=a.importcss_selector_converter||n,e=m(a.importcss_selector_filter),
l=b.control;c.settings.importcss_append||l.items().remove();var h=[];tinymce.each(a.importcss_groups,function(a){a=tinymce.extend({},a);a.filter=m(a.filter);h.push(a)});f(s(b.doc||c.getDoc(),m(a.importcss_file_filter)),function(a){if(-1===a.indexOf(".mce-")&&!d[a]&&(!e||e(a))){var b=g.call(p,a),f;if(b){var m=b.name||tinymce.DOM.uniqueId();if(h)for(var k=0;k<h.length;k++)if(!h[k].filter||h[k].filter(a)){h[k].item||(h[k].item={text:h[k].title,menu:[]});f=h[k].item.menu;break}c.formatter.register(m,
b);b=tinymce.extend({},l.settings.itemDefaults,{text:b.title,format:m});f?f.push(b):l.add(b)}d[a]=!0}});f(h,function(a){l.add(a.item)});b.control.renderNew()});p.convertSelectorToFormat=n});
