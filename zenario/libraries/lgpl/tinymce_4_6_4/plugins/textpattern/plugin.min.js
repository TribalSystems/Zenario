(function(){var q={},r=function(c){var b=q[c];if(void 0===b)throw"module ["+c+"] was undefined";if(void 0===b.instance){for(var n=q[c],d=n.deps,l=n.defn,e=d.length,a=Array(e),g=0;g<e;++g)a[g]=r(d[g]);d=l.apply(null,a);if(void 0===d)throw"module ["+c+"] returned undefined";n.instance=d}return b.instance},f=function(c,b,n){if("string"!==typeof c)throw"module id must be a string";if(void 0===b)throw"no dependencies for "+c;if(void 0===n)throw"no definition function for "+c;q[c]={deps:b,defn:n,instance:void 0}};
(function(c,b){f(c,[],function(){return b})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);f("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.PluginManager")});f("tinymce.core.util.Delay",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Delay")});f("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.VK")});f("tinymce.core.dom.TreeWalker",["global!tinymce.util.Tools.resolve"],
function(c){return c("tinymce.dom.TreeWalker")});f("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Tools")});f("tinymce.plugins.textpattern.core.Patterns",[],function(){var c=function(b){return b.sort(function(b,d){return b.start.length>d.start.length?-1:b.start.length<d.start.length?1:0})};return{findPattern:function(b,c){for(var d=0;d<b.length;d++)if(0===c.indexOf(b[d].start)&&(!b[d].end||c.lastIndexOf(b[d].end)===c.length-b[d].end.length))return b[d]},
findEndPattern:function(b,n,d,l){var e,a=c(b);for(e=0;e<a.length;e++){b=a[e];var g;if(g=void 0!==b.end)g=b,g=n.substr(d-g.end.length-l,g.end.length)===g.end&&0<d-l-b.end.length-b.start.length;if(g)return b}}}});f("tinymce.plugins.textpattern.core.Formatter",["tinymce.core.dom.TreeWalker","tinymce.core.util.Tools","tinymce.plugins.textpattern.core.Patterns"],function(c,b,n){return{applyInlineFormat:function(d,b,e){var a,c,p,h,m,k,f;a=d.selection;c=d.dom;if(a.isCollapsed()&&(a=a.getRng(!0),p=a.startContainer,
h=a.startOffset,a=p.data,f=!0===e?1:0,3==p.nodeType&&(k=n.findEndPattern(b,a,h,f),void 0!==k&&(m=Math.max(0,h-f),m=a.lastIndexOf(k.start,m-k.end.length-1),-1!==m&&(e=c.createRng(),e.setStart(p,m),e.setEnd(p,h-f),(k=n.findPattern(b,e.toString()))&&k.end&&!(p.data.length<=k.start.length+k.end.length)&&(b=d.formatter.get(k.format))&&b[0].inline)))))return d.undoManager.transact(function(){var a=p,b=k,e=m,a=0<e?a.splitText(e):a;a.splitText(h-e-f);a.deleteData(0,b.start.length);a.deleteData(a.data.length-
b.end.length,b.end.length);p=a;d.formatter.apply(k.format,{},p)}),p},applyBlockFormat:function(d,l){var e,a,g,f,h,m,k;e=d.selection;a=d.dom;if(e.isCollapsed()&&(a=a.getParent(e.getStart(),"p"))){for(f=new c(a,a);a=f.next();)if(3==a.nodeType){g=a;break}g&&(h=n.findPattern(l,g.data))&&(m=e.getRng(!0),a=m.startContainer,k=m.startOffset,g==a&&(k=Math.max(0,k-h.start.length)),b.trim(g.data).length!=h.start.length&&(h.format&&(f=d.formatter.get(h.format))&&f[0].block&&(g.deleteData(0,h.start.length),d.formatter.apply(h.format,
{},g),m.setStart(a,k),m.collapse(!0),e.setRng(m)),h.cmd&&d.undoManager.transact(function(){g.deleteData(0,h.start.length);d.execCommand(h.cmd)})))}}}});f("tinymce.plugins.textpattern.core.KeyHandler",["tinymce.core.util.VK","tinymce.plugins.textpattern.core.Formatter"],function(c,b){var f=function(d,b,e){for(var a=0;a<d.length;a++)if(e(d[a],b))return!0};return{handleEnter:function(d,c){var e,a;if(a=b.applyInlineFormat(d,c,!1))e=d.dom.createRng(),e.setStart(a,a.data.length),e.setEnd(a,a.data.length),
d.selection.setRng(e);b.applyBlockFormat(d,c)},handleInlineKey:function(d,c){var e,a,g;if(e=b.applyInlineFormat(d,c,!0))g=d.dom,a=e.data.slice(-1),/[\u00a0 ]/.test(a)&&(e.deleteData(e.data.length-1,1),a=g.doc.createTextNode(a),e.nextSibling?g.insertAfter(a,e.nextSibling):e.parentNode.appendChild(a),e=g.createRng(),e.setStart(a,1),e.setEnd(a,1),d.selection.setRng(e))},checkCharCode:function(b,c){return f(b,c,function(b,a){return b.charCodeAt(0)===a.charCode})},checkKeyCode:function(b,l){return f(b,
l,function(b,a){return b===a.keyCode&&!1===c.modifierPressed(a)})}}});f("tinymce.plugins.textpattern.core.Settings",[],function(){var c=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}];return{getPatterns:function(b){return void 0!==
b.textpattern_patterns?b.textpattern_patterns:c}}});f("tinymce.plugins.textpattern.Plugin","tinymce.core.PluginManager tinymce.core.util.Delay tinymce.core.util.VK tinymce.plugins.textpattern.core.Formatter tinymce.plugins.textpattern.core.KeyHandler tinymce.plugins.textpattern.core.Settings".split(" "),function(c,b,f,d,l,e){c.add("textpattern",function(a){var c=e.getPatterns(a.settings),d=",.;:!?".split(""),h=[32];a.on("keydown",function(b){13!==b.keyCode||f.modifierPressed(b)||l.handleEnter(a,c)},
!0);a.on("keyup",function(b){l.checkKeyCode(h,b)&&l.handleInlineKey(a,c)});a.on("keypress",function(e){l.checkCharCode(d,e)&&b.setEditorTimeout(a,function(){l.handleInlineKey(a,c)})});this.setPatterns=function(a){c=a};this.getPatterns=function(){return c}});return function(){}});r("tinymce.plugins.textpattern.Plugin")()})();
