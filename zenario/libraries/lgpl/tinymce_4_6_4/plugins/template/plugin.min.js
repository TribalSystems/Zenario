(function(){var k={},m=function(b){var g=k[b];if(void 0===g)throw"module ["+b+"] was undefined";if(void 0===g.instance){for(var l=k[b],h=l.deps,e=l.defn,c=h.length,r=Array(c),n=0;n<c;++n)r[n]=m(h[n]);h=e.apply(null,r);if(void 0===h)throw"module ["+b+"] returned undefined";l.instance=h}return g.instance},e=function(b,g,e){if("string"!==typeof b)throw"module id must be a string";if(void 0===g)throw"no dependencies for "+b;if(void 0===e)throw"no definition function for "+b;k[b]={deps:g,defn:e,instance:void 0}};
(function(b,g){e(b,[],function(){return g})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);e("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.dom.DOMUtils")});e("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.PluginManager")});e("tinymce.core.util.JSON",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.util.JSON")});e("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],
function(b){return b("tinymce.util.Tools")});e("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(b){return b("tinymce.util.XHR")});e("tinymce.plugins.template.Plugin",["tinymce.core.dom.DOMUtils","tinymce.core.PluginManager","tinymce.core.util.JSON","tinymce.core.util.Tools","tinymce.core.util.XHR"],function(b,e,l,h,k){e.add("template",function(c){function e(a){return function(){var d=c.settings.templates;"function"==typeof d?d(a):"string"==typeof d?k.send({url:d,success:function(c){a(l.parse(c))}}):
a(d)}}function g(a){function d(a){function d(a){if(-1==a.indexOf("<html>")){var f="";h.each(c.contentCSS,function(a){f+='<link type="text/css" rel="stylesheet" href="'+c.documentBaseURI.toAbsolute(a)+'">'});var b=c.settings.body_class||"";-1!=b.indexOf("=")&&(b=c.getParam("body_class","","hash"),b=b[c.id]||"");a="<!DOCTYPE html><html><head>"+f+'</head><body class="'+b+'">'+a+"</body></html>"}a=s(a,"template_preview_replace_values");b=p.find("iframe")[0].getEl().contentWindow.document;b.open();b.write(a);
b.close()}var f=a.control.value();f.url?k.send({url:f.url,success:function(a){e=a;d(e)}}):(e=f.content,d(e));p.find("#description")[0].text(a.control.value().description)}var p,f=[],e;a&&0!==a.length?(h.each(a,function(a){f.push({selected:!f.length,text:a.title,value:{url:a.url,content:a.content,description:a.description}})}),p=c.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",
label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:f,onselect:d}}]},{type:"label",name:"description",label:"Description",text:"\u00a0"},{type:"iframe",flex:1,border:1}],onsubmit:function(){t(!1,e)},minWidth:Math.min(b.DOM.getViewPort().w,c.getParam("template_popup_width",600)),minHeight:Math.min(b.DOM.getViewPort().h,c.getParam("template_popup_height",500))}),p.find("listbox")[0].fire("select")):(a=c.translate("No templates defined."),c.notificationManager.open({text:a,
type:"info"}))}function q(a,d){function b(a,c){a=""+a;if(a.length<c)for(var d=0;d<c-a.length;d++)a="0"+a;return a}d=d||new Date;a=a.replace("%D","%m/%d/%Y");a=a.replace("%r","%I:%M:%S %p");a=a.replace("%Y",""+d.getFullYear());a=a.replace("%y",""+d.getYear());a=a.replace("%m",b(d.getMonth()+1,2));a=a.replace("%d",b(d.getDate(),2));a=a.replace("%H",""+b(d.getHours(),2));a=a.replace("%M",""+b(d.getMinutes(),2));a=a.replace("%S",""+b(d.getSeconds(),2));a=a.replace("%I",""+((d.getHours()+11)%12+1));a=
a.replace("%p",""+(12>d.getHours()?"AM":"PM"));a=a.replace("%B",""+c.translate("January February March April May June July August September October November December".split(" ")[d.getMonth()]));a=a.replace("%b",""+c.translate("Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[d.getMonth()]));a=a.replace("%A",""+c.translate("Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ")[d.getDay()]));a=a.replace("%a",""+c.translate("Sun Mon Tue Wed Thu Fri Sat Sun".split(" ")[d.getDay()]));
return a=a.replace("%%","%")}function m(a){var d=c.dom,b=c.getParam("template_replace_values");h.each(d.select("*",a),function(a){h.each(b,function(c,e){if(d.hasClass(a,e)&&"function"==typeof b[e])b[e](a)})})}function s(a,b){h.each(c.getParam(b),function(b,c){"function"==typeof b&&(b=b(c));a=a.replace(RegExp("\\{\\$"+c+"\\}","g"),b)});return a}function t(a,b){function e(a,b){return RegExp("\\b"+b+"\\b","g").test(a.className)}var f,g,k=c.dom,l=c.selection.getContent();b=s(b,"template_replace_values");
f=k.create("div",null,b);(g=k.select(".mceTmpl",f))&&0<g.length&&(f=k.create("div",null),f.appendChild(g[0].cloneNode(!0)));h.each(k.select("*",f),function(a){e(a,c.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(a.innerHTML=q(c.getParam("template_cdate_format",c.getLang("template.cdate_format"))));e(a,c.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(a.innerHTML=q(c.getParam("template_mdate_format",c.getLang("template.mdate_format"))));e(a,c.getParam("template_selected_content_classes",
"selcontent").replace(/\s+/g,"|"))&&(a.innerHTML=l)});m(f);c.execCommand("mceInsertContent",!1,f.innerHTML);c.addVisual()}c.addCommand("mceInsertTemplate",t);c.addButton("template",{title:"Insert template",onclick:e(g)});c.addMenuItem("template",{text:"Template",onclick:e(g),context:"insert"});c.on("PreProcess",function(a){var b=c.dom;h.each(b.select("div",a.node),function(a){b.hasClass(a,"mceTmpl")&&(h.each(b.select("*",a),function(a){b.hasClass(a,c.getParam("template_mdate_classes","mdate").replace(/\s+/g,
"|"))&&(a.innerHTML=q(c.getParam("template_mdate_format",c.getLang("template.mdate_format"))))}),m(a))})})});return function(){}});m("tinymce.plugins.template.Plugin")()})();
