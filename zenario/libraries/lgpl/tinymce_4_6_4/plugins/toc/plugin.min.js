(function(){var m={},r=function(c){var h=m[c];if(void 0===h)throw"module ["+c+"] was undefined";if(void 0===h.instance){for(var l=m[c],d=l.deps,k=l.defn,s=d.length,n=Array(s),p=0;p<s;++p)n[p]=r(d[p]);d=k.apply(null,n);if(void 0===d)throw"module ["+c+"] returned undefined";l.instance=d}return h.instance},k=function(c,h,l){if("string"!==typeof c)throw"module id must be a string";if(void 0===h)throw"no dependencies for "+c;if(void 0===l)throw"no definition function for "+c;m[c]={deps:h,defn:l,instance:void 0}};
(function(c,h){k(c,[],function(){return h})})("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve);k("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.PluginManager")});k("tinymce.core.util.I18n",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.I18n")});k("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(c){return c("tinymce.util.Tools")});k("tinymce.plugins.toc.Plugin",["tinymce.core.PluginManager",
"tinymce.core.util.I18n","tinymce.core.util.Tools"],function(c,h,l){c.add("toc",function(d){function c(){var a=this;a.disabled(d.readonly||!(e&&n(e).length));d.on("LoadContent SetContent change",function(){a.disabled(d.readonly||!(e&&n(e).length))})}function k(a){var b,d=[];for(b=1;b<=a;b++)d.push("h"+b);return d.join(",")}function n(a){var b=k(a.depth),b=q(b);b.length&&/^h[1-9]$/i.test(a.headerTag)&&(b=b.filter(function(b,c){return!d.dom.hasClass(c.parentNode,a.className)}));return l.map(b,function(a){a.id||
(a.id=r());return{id:a.id,level:parseInt(a.nodeName.replace(/^H/i,""),10),title:q.text(a)}})}function p(a){var b=m(a);return'<div class="'+a.className+'" contenteditable="false">'+b+"</div>"}function m(a){var b="",c=n(a),f;a:{var g=9;for(f=0;f<c.length;f++)if(c[f].level<g&&(g=c[f].level),1==g){f=g;break a}f=g}f-=1;var e;if(!c.length)return"";a=a.headerTag;g=h.translate("Table of Contents");e="</"+a+">";a="<"+a+' contenteditable="true">'+d.dom.encode(g)+e;b+=a;for(a=0;a<c.length;a++){g=c[a];e=c[a+
1]&&c[a+1].level;if(f===g.level)b+="<li>";else for(;f<g.level;f++)b+="<ul><li>";b+='<a href="#'+g.id+'">'+g.title+"</a>";if(e!==g.level&&e)for(f=g.level;f>e;f--)b+="</li></ul><li>";else b+="</li>",e||(b+="</ul>");f=g.level}return b}var q=d.$,e,r=function(a){var b=0;return function(){var c=(new Date).getTime().toString(32);return a+c+(b++).toString(32)}}("mcetoc_");d.on("PreInit",function(){var a=d.settings,b=parseInt(a.toc_depth,10)||0;e={depth:1<=b&&9>=b?b:3,headerTag:a.toc_header&&d.schema.isValidChild("div",
a.toc_header)?a.toc_header:"h2",className:a.toc_class?d.dom.encode(a.toc_class):"mce-toc"}});d.on("PreProcess",function(a){a=q("."+e.className,a.node);a.length&&(a.removeAttr("contentEditable"),a.find("[contenteditable]").removeAttr("contentEditable"))});d.on("SetContent",function(){var a=q("."+e.className);a.length&&(a.attr("contentEditable",!1),a.children(":first-child").attr("contentEditable",!0))});d.addCommand("mceInsertToc",function(){var a=q("."+e.className);!a.length||0<d.dom.getParents(a[0],
".mce-offscreen-selection").length?d.insertContent(p(e)):d.execCommand("mceUpdateToc")});d.addCommand("mceUpdateToc",function(){var a=q("."+e.className);a.length&&d.undoManager.transact(function(){a.html(m(e))})});d.addButton("toc",{tooltip:"Table of Contents",cmd:"mceInsertToc",icon:"toc",onPostRender:c});d.addButton("tocupdate",{tooltip:"Update",cmd:"mceUpdateToc",icon:"reload"});d.addContextToolbar(function(a){return a&&d.dom.is(a,"."+e.className)&&d.getBody().contains(a)},"tocupdate");d.addMenuItem("toc",
{text:"Table of Contents",context:"insert",cmd:"mceInsertToc",onPostRender:c})});return function(){}});r("tinymce.plugins.toc.Plugin")()})();
