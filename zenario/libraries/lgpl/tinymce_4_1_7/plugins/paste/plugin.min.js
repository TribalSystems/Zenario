(function(G,C){function H(l,p){for(var k,a=[],g=0;g<l.length;++g){if(!(k=D[l[g]]))a:{k=G;for(var d=l[g].split(/[.\/]/),q=0;q<d.length;++q){if(!k[d[q]]){k=void 0;break a}k=k[d[q]]}}if(!k)throw"module definition dependecy not found: "+l[g];a.push(k)}p.apply(null,a)}function z(l,p,k){if("string"!==typeof l)throw"invalid module definition, module id must be defined and be a string";if(p===C)throw"invalid module definition, dependencies must be specified";if(k===C)throw"invalid module definition, definition function must be specified";
H(p,function(){D[l]=k.apply(null,arguments)})}var D={};z("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(l,p,k){function a(a,d){l.each(d,function(d){a=d.constructor==RegExp?a.replace(d,""):a.replace(d[0],d[1])});return a}return{filter:a,innerText:function(g){function d(a){var g=a.name,k=a;if("br"===g)e+="\n";else if(s[g]&&(e+=" "),m[g])e+=" ";else{3==a.type&&(e+=a.value);if(!a.shortEnded&&(a=a.firstChild)){do d(a);while(a=a.next)}x[g]&&k.next&&
(e+="\n","p"==g&&(e+="\n"))}}var q=new k,n=new p({},q),e="",s=q.getShortEndedElements(),m=l.makeMap("script noscript style textarea video audio iframe object"," "),x=q.getBlockElements();g=a(g,[/<!\[[^\]]+\]>/g]);d(n.parse(g));return e},trimHtml:function(g){return g=a(g,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(a,g,k){return g||k?"\u00a0":" "}],/<br>$/i])}}});z("tinymce/pasteplugin/Clipboard",
["tinymce/Env","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(l,p,k){return function(a){function g(b){var f,c=a.dom;f=a.fire("BeforePastePreProcess",{content:b});f=a.fire("PastePreProcess",f);b=f.content;f.isDefaultPrevented()||(a.hasEventListeners("PastePostProcess")&&!f.isDefaultPrevented()&&(b=c.add(a.getBody(),"div",{style:"display:none"},b),f=a.fire("PastePostProcess",{node:b}),c.remove(b),b=f.node.innerHTML),f.isDefaultPrevented()||a.insertContent(b,{merge:!1!==a.settings.paste_merge_formats}))}
function d(b){b=a.dom.encode(b).replace(/\r\n/g,"\n");var f=a.dom.getParent(a.selection.getStart(),a.dom.isBlock),c=a.settings.forced_root_block,h;c&&(h=a.dom.createHTML(c,a.settings.forced_root_block_attrs),h=h.substr(0,h.length-3)+">");f&&/^(PRE|DIV)$/.test(f.nodeName)||!c?b=k.filter(b,[[/\n/g,"<br>"]]):(b=k.filter(b,[[/\n\n/g,"</p>"+h],[/^(.*<\/p>)(<p>)$/,h+"$1"],[/\n/g,"<br />"]]),-1!=b.indexOf("<p>")&&(b=h+b));g(b)}function q(){function b(b){var a,c;c=b.startContainer;a=b.getClientRects();if(a.length)return a[0];
if(b.collapsed&&1==c.nodeType){for(b=c.childNodes[t.startOffset];b&&3==b.nodeType&&!b.data.length;)b=b.nextSibling;if(b&&("BR"==b.tagName&&(c=f.doc.createTextNode("\ufeff"),b.parentNode.insertBefore(c,b),b=f.createRng(),b.setStartBefore(c),b.setEndAfter(c),a=b.getClientRects(),f.remove(c)),a.length))return a[0]}}var f=a.dom,c=a.getBody(),h=a.dom.getViewPort(a.getWin()).y,g=20,d;t=a.selection.getRng();a.inline&&(d=a.selection.getScrollContainer())&&0<d.scrollTop&&(h=d.scrollTop);if(t.getClientRects)if(g=
b(t))g=h+(g.top-f.getPos(c).y);else if(g=h,h=t.startContainer)3==h.nodeType&&h.parentNode!=c&&(h=h.parentNode),1==h.nodeType&&(g=f.getPos(h,d||c).y);r=f.add(a.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+g+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},v);(l.ie||l.gecko)&&f.setStyle(r,"left","rtl"==f.getStyle(c,"direction",!0)?65535:-65535);f.bind(r,"beforedeactivate focusin focusout",function(b){b.stopPropagation()});
r.focus();a.selection.select(r,!0)}function n(){if(r){for(var b;b=a.dom.get("mcepastebin");)a.dom.remove(b),a.dom.unbind(b);t&&a.selection.setRng(t)}r=t=null}function e(){var b="",f,c,h;f=a.dom.select("div[id=mcepastebin]");for(c=0;c<f.length;c++)h=f[c],h.firstChild&&"mcepastebin"==h.firstChild.id&&(h=h.firstChild),h=h.innerHTML,b!=v&&(b+=h);return b}function s(b){var a={};if(b){if(b.getData){var c=b.getData("Text");c&&0<c.length&&(a["text/plain"]=c)}if(b.types)for(c=0;c<b.types.length;c++){var h=
b.types[c];a[h]=b.getData(h)}}return a}function m(b,f){function c(c){function h(){f&&(a.selection.setRng(f),f=null);g('<img src="'+e.result+'">')}var d,v,e;if(c)for(d=0;d<c.length;d++)if(v=c[d],/^image\/(jpeg|png|gif)$/.test(v.type))return e=new FileReader,e.onload=h,e.readAsDataURL(v.getAsFile?v.getAsFile():v),b.preventDefault(),!0}var h=b.clipboardData||b.dataTransfer;if(a.settings.paste_data_images&&h)return c(h.items)||c(h.files)}function x(b){b=b.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&
b&&b.items&&0===b.items.length}function E(b){var f=a.getDoc(),c;if(f.caretPositionFromPoint)b=f.caretPositionFromPoint(b.clientX,b.clientY),c=f.createRange(),c.setStart(b.offsetNode,b.offset),c.collapse(!0);else if(f.caretRangeFromPoint)c=f.caretRangeFromPoint(b.clientX,b.clientY);else if(f.body.createTextRange){c=f.body.createTextRange();try{c.moveToPoint(b.clientX,b.clientY),c.collapse(!0)}catch(h){c.collapse(b.clientY<f.body.clientHeight)}}return c}function F(){a.on("keydown",function(b){function f(b){(p.metaKeyPressed(b)&&
86==b.keyCode||b.shiftKey&&45==b.keyCode)&&!b.isDefaultPrevented()&&n()}(p.metaKeyPressed(b)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)&&!b.isDefaultPrevented()&&(B=b.shiftKey&&86==b.keyCode,B&&l.webkit&&-1!=navigator.userAgent.indexOf("Version/")||(b.stopImmediatePropagation(),w=(new Date).getTime(),l.ie&&B?(b.preventDefault(),a.fire("paste",{ieFake:!0})):(n(),q(),a.once("keyup",f),a.once("paste",function(){a.off("keyup",f)}))))});a.on("paste",function(b){var f=(new Date).getTime(),c=s(b.clipboardData||
a.getDoc().dataTransfer),f=(new Date).getTime()-f,h=1E3>(new Date).getTime()-w-f,A="text"==u.pasteFormat||B;B=!1;b.isDefaultPrevented()||x(b)?n():m(b)?n():(h||b.preventDefault(),!l.ie||h&&!b.ieFake||(q(),a.dom.bind(r,"paste",function(b){b.stopPropagation()}),a.getDoc().execCommand("Paste",!1,null),c["text/html"]=e()),setTimeout(function(){var b;"text/html"in c&&0<c["text/html"].length?b=c["text/html"]:(b=e(),b==v&&(A=!0));b=k.trimHtml(b);r&&r.firstChild&&"mcepastebin"===r.firstChild.id&&(A=!0);n();
b.length||(A=!0);A&&(b="text/plain"in c&&0<c["text/plain"].length&&-1==b.indexOf("</p>")?c["text/plain"]:k.innerText(b));b==v?h||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):A?d(b):g(b)},0))});a.on("dragstart dragend",function(b){y="dragstart"==b.type});a.on("drop",function(b){var f=E(b);if(!b.isDefaultPrevented()&&!y&&!m(b,f)&&f&&!1!==a.settings.paste_filter_drop){var c=s(b.dataTransfer),h=c["mce-internal"]||c["text/html"]||c["text/plain"];h&&(b.preventDefault(),
a.undoManager.transact(function(){c["mce-internal"]&&a.execCommand("Delete");a.selection.setRng(f);h=k.trimHtml(h);c["text/html"]?g(h):d(h)}))}});a.on("dragover dragend",function(b){var f,c=b.dataTransfer;if(a.settings.paste_data_images&&c)for(f=0;f<c.types.length;f++)if("Files"==c.types[f])return b.preventDefault(),!1})}var u=this,r,t,w=0,y=!1,v="%MCEPASTEBIN%",B;u.pasteHtml=g;u.pasteText=d;a.on("preInit",function(){F();a.parser.addNodeFilter("img",function(b){if(!a.settings.paste_data_images)for(var f=
b.length;f--;){var c=b[f].attributes.map.src;c&&/^(data:image|webkit\-fake\-url)/.test(c)&&(b[f].attr("data-mce-object")||c===l.transparentSrc||b[f].remove())}})})}});z("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),function(l,p,k,a,g,d){function q(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||
/id="?docs\-internal\-guid\-/.test(a)}function n(a){var g;a=a.replace(/^[\u00a0 ]+/,"");l.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],function(d){if(d.test(a))return g=!0,!1});return g}function e(e){var m=e.settings;e.on("BeforePastePreProcess",
function(x){function E(a){function d(b){var a="";if(3===b.type)return b.value;if(b=b.firstChild){do a+=d(b);while(b=b.next)}return a}function b(a,c){if(3===a.type&&c.test(a.value))return a.value=a.value.replace(c,""),!1;if(a=a.firstChild){do if(!b(a,c))return!1;while(a=a.next)}return!0}function f(b){if(b._listIgnore)b.remove();else if(b=b.firstChild){do f(b);while(b=b.next)}}function c(a,c,d){var m=a._listLevel||k;m!=k&&(m<k?h&&(h=h.parent.parent):(e=h,h=null));h&&h.name==c?h.append(a):(e=e||h,h=
new g(c,1),1<d&&h.attr("start",""+d),a.wrap(h));a.name="li";m>k&&e&&e.lastChild.append(h);k=m;f(a);b(a,/^\u00a0+/);b(a,/^\s*([\u2022\u00b7\u00a7\u00d8\u25CF]|\w+\.)/);b(a,/^\u00a0+/)}for(var h,e,k=1,l=[],m=a.firstChild;"undefined"!==typeof m&&null!==m;)if(l.push(m),m=m.walk(),null!==m)for(;"undefined"!==typeof m&&m.parent!==a;)m=m.walk();for(m=0;m<l.length;m++)if(a=l[m],"p"==a.name&&a.firstChild){var s=d(a);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*/.test(s))c(a,"ul");else if(n(s)){var s=
/([0-9]+)\./.exec(s),r=1;s&&(r=parseInt(s[1],10));c(a,"ol",r)}else a._listLevel?c(a,"ul",1):h=null}else e=h,h=null}function F(a,d){var b={},f,c=e.dom.parseStyle(d);l.each(c,function(c,e){switch(e){case "mso-list":if(f=/\w+ \w+([0-9]+)/i.exec(d))a._listLevel=parseInt(f[1],10);/Ignore/i.test(c)&&a.firstChild&&(a._listIgnore=!0,a.firstChild._listIgnore=!0);break;case "horiz-align":e="text-align";break;case "vert-align":e="vertical-align";break;case "font-color":case "mso-foreground":e="color";break;
case "mso-background":case "mso-highlight":e="background";break;case "font-weight":case "font-style":"normal"!=c&&(b[e]=c);return;case "mso-element":if(/^(comment|comment-list)$/i.test(c)){a.remove();return}}0===e.indexOf("mso-comment")?a.remove():0!==e.indexOf("mso-")&&("all"==r||t&&t[e])&&(b[e]=c)});/(bold)/i.test(b["font-weight"])&&(delete b["font-weight"],a.wrap(new g("b",1)));/(italic)/i.test(b["font-style"])&&(delete b["font-style"],a.wrap(new g("i",1)));return(b=e.dom.serializeStyle(b,a.name))?
b:null}var u=x.content,r,t;(r=m.paste_retain_style_properties)&&(t=l.makeMap(r.split(/[, ]/)));if(!1!==m.paste_enable_default_filters&&q(x.content)){x.wordContent=!0;var u=d.filter(u,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,e){return 0<e.length?e.replace(/./," ").slice(Math.floor(e.length/
2)).split("").join("\u00a0"):""}]]),w=m.paste_word_valid_elements;w||(w="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");w=new k({valid_elements:w,valid_children:"-li[p]"});l.each(w.elements,function(a){a.attributes["class"]||(a.attributes["class"]={},a.attributesOrder.push("class"));a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});
var y=new p({},w);y.addAttributeFilter("style",function(a){for(var e=a.length,b;e--;)b=a[e],b.attr("style",F(b,b.attr("style"))),"span"==b.name&&b.parent&&!b.attributes.length&&b.unwrap()});y.addAttributeFilter("class",function(a){for(var e=a.length,b,f;e--;)b=a[e],f=b.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel|MsoCaption)$/i.test(f)&&b.remove(),b.attr("class",null)});y.addNodeFilter("del",function(a){for(var e=a.length;e--;)a[e].remove()});y.addNodeFilter("a",function(a){for(var e=
a.length,b,f,c;e--;)b=a[e],f=b.attr("href"),c=b.attr("name"),f&&-1!=f.indexOf("#_msocom_")?b.remove():(f&&0===f.indexOf("file://")&&(f=f.split("#")[1])&&(f="#"+f),f||c?c&&!/^_?(?:toc|edn|ftn)/i.test(c)?b.unwrap():b.attr({href:f,name:c}):b.unwrap())});u=y.parse(u);!1!==m.paste_convert_word_fake_lists&&E(u);x.content=(new a({},w)).serialize(u)}})}e.isWordContent=q;return e});z("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],
function(l,p,k,a){return function(g){function d(a){g.on("BeforePastePreProcess",function(d){d.content=a(d.content)})}function q(e){if(!k.isWordContent(e))return e;var d=[];p.each(g.schema.getBlockElements(),function(a,e){d.push(e)});var m=RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+d.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");e=a.filter(e,[[m,"$1"]]);return e=a.filter(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function n(a){if(k.isWordContent(a))return a;
var d=g.settings.paste_webkit_styles;if(!1===g.settings.paste_remove_styles_if_webkit||"all"==d)return a;d&&(d=d.split(/[, ]/));if(d){var m=g.dom,l=g.selection.getNode();a=a.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,e,g,k){a=m.parseStyle(g,"span");g={};if("none"===d)return e+k;for(var n=0;n<d.length;n++){var p=a[d[n]],q=m.getStyle(l,d[n],!0);/color/.test(d[n])&&(p=m.toHex(p),q=m.toHex(q));q!=p&&(g[d[n]]=p)}return(g=m.serializeStyle(g,"span"))?e+' style="'+g+'"'+k:e+k})}else a=a.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,
"$1$3");return a=a.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,d,e,g){return d+' style="'+e+'"'+g})}l.webkit&&d(n);l.ie&&d(q)}});z("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(l,p,k,a){var g;l.add("paste",function(d){function l(){"text"==e.pasteFormat?(this.active(!1),e.pasteFormat="html"):(e.pasteFormat="text",this.active(!0),g||(d.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),
g=!0))}var n=this,e,s=d.settings;n.clipboard=e=new p(d);n.quirks=new a(d);n.wordFilter=new k(d);d.settings.paste_as_text&&(n.clipboard.pasteFormat="text");if(s.paste_preprocess)d.on("PastePreProcess",function(a){s.paste_preprocess.call(n,n,a)});if(s.paste_postprocess)d.on("PastePostProcess",function(a){s.paste_postprocess.call(n,n,a)});d.addCommand("mceInsertClipboardContent",function(a,d){d.content&&n.clipboard.pasteHtml(d.content);d.text&&n.clipboard.pasteText(d.text)});if(d.paste_block_drop)d.on("dragend dragover draggesture dragdrop drop drag",
function(a){a.preventDefault();a.stopPropagation()});if(!d.settings.paste_data_images)d.on("drop",function(a){var d=a.dataTransfer;d&&d.files&&0<d.files.length&&a.preventDefault()});d.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:l,active:"text"==n.clipboard.pasteFormat});d.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:e.pasteFormat,onclick:l})})});(function(l){for(var p=0;p<l.length;p++){for(var k=G,a=l[p],g=a.split(/[.\/]/),d=0;d<g.length-1;++d)k[g[d]]===
C&&(k[g[d]]={}),k=k[g[d]];k[g[g.length-1]]=D[a]}})(["tinymce/pasteplugin/Utils","tinymce/pasteplugin/WordFilter"])})(this);
