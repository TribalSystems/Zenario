tinymce.PluginManager.add("visualchars",function(b){function f(a){var c,d;c=b.getBody();var f=b.selection,g,h;e=!e;k.state=e;b.fire("VisualChars",{state:e});a&&(h=f.getBookmark());if(e)for(d=[],tinymce.walk(c,function(a){3==a.nodeType&&a.nodeValue&&-1!=a.nodeValue.indexOf("\u00a0")&&d.push(a)},"childNodes"),a=0;a<d.length;a++){c=d[a].nodeValue;c=c.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mce-nbsp">$1</span>');for(g=b.dom.create("div",null,c);c=g.lastChild;)b.dom.insertAfter(c,d[a]);b.dom.remove(d[a])}else for(d=
b.dom.select("span.mce-nbsp",c),a=d.length-1;0<=a;a--)b.dom.remove(d[a],1);f.moveToBookmark(h)}function g(){var a=this;b.on("VisualChars",function(b){a.active(b.state)})}var k=this,e;b.addCommand("mceVisualChars",f);b.addButton("visualchars",{title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g});b.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g,selectable:!0,context:"view",prependToContext:!0});b.on("beforegetcontent",function(a){e&&
"raw"!=a.format&&!a.draft&&(e=!0,f(!1))})});
