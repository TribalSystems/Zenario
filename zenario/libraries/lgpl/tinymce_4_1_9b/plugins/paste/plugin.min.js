(function(G,C){function H(h,p){for(var f,m=[],a=0;a<h.length;++a){if(!(f=D[h[a]]))a:{f=G;for(var d=h[a].split(/[.\/]/),n=0;n<d.length;++n){if(!f[d[n]]){f=void 0;break a}f=f[d[n]]}}if(!f)throw"module definition dependecy not found: "+h[a];m.push(f)}p.apply(null,m)}function A(h,p,f){if("string"!==typeof h)throw"invalid module definition, module id must be defined and be a string";if(p===C)throw"invalid module definition, dependencies must be specified";if(f===C)throw"invalid module definition, definition function must be specified";
H(p,function(){D[h]=f.apply(null,arguments)})}var D={};A("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(h,p,f){function m(a,d){h.each(d,function(d){a=d.constructor==RegExp?a.replace(d,""):a.replace(d[0],d[1])});return a}return{filter:m,innerText:function(a){function d(a){var h=a.name,f=a;if("br"===h)b+="\n";else if(r[h]&&(b+=" "),u[h])b+=" ";else{3==a.type&&(b+=a.value);if(!a.shortEnded&&(a=a.firstChild)){do d(a);while(a=a.next)}y[h]&&f.next&&
(b+="\n","p"==h&&(b+="\n"))}}var n=new f,l=new p({},n),b="",r=n.getShortEndedElements(),u=h.makeMap("script noscript style textarea video audio iframe object"," "),y=n.getBlockElements();a=m(a,[/<!\[[^\]]+\]>/g]);d(l.parse(a));return b},trimHtml:function(a){return a=m(a,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(a,h,f){return h||f?"\u00a0":" "}],/<br>$/i])}}});A("tinymce/pasteplugin/Clipboard",
["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(h,p,f,m){return function(a){function d(c){var g,e=a.dom;g=a.fire("BeforePastePreProcess",{content:c});g=a.fire("PastePreProcess",g);c=g.content;g.isDefaultPrevented()||(a.hasEventListeners("PastePostProcess")&&!g.isDefaultPrevented()&&(c=e.add(a.getBody(),"div",{style:"display:none"},c),g=a.fire("PastePostProcess",{node:c}),e.remove(c),c=g.node.innerHTML),g.isDefaultPrevented()||a.insertContent(c,{merge:!1!==
a.settings.paste_merge_formats}))}function n(c){c=a.dom.encode(c).replace(/\r\n/g,"\n");var g=a.dom.getParent(a.selection.getStart(),a.dom.isBlock),e=a.settings.forced_root_block,k;e&&(k=a.dom.createHTML(e,a.settings.forced_root_block_attrs),k=k.substr(0,k.length-3)+">");g&&/^(PRE|DIV)$/.test(g.nodeName)||!e?c=m.filter(c,[[/\n/g,"<br>"]]):(c=m.filter(c,[[/\n\n/g,"</p>"+k],[/^(.*<\/p>)(<p>)$/,k+"$1"],[/\n/g,"<br />"]]),-1!=c.indexOf("<p>")&&(c=k+c));d(c)}function l(){function c(a){var c,e;e=a.startContainer;
c=a.getClientRects();if(c.length)return c[0];if(a.collapsed&&1==e.nodeType){for(a=e.childNodes[v.startOffset];a&&3==a.nodeType&&!a.data.length;)a=a.nextSibling;if(a&&("BR"==a.tagName&&(e=g.doc.createTextNode("\ufeff"),a.parentNode.insertBefore(e,a),a=g.createRng(),a.setStartBefore(e),a.setEndAfter(e),c=a.getClientRects(),g.remove(e)),c.length))return c[0]}}var g=a.dom,e=a.getBody(),k=a.dom.getViewPort(a.getWin()).y,b=20,d;v=a.selection.getRng();a.inline&&(d=a.selection.getScrollContainer())&&0<d.scrollTop&&
(k=d.scrollTop);if(v.getClientRects)if(b=c(v))b=k+(b.top-g.getPos(e).y);else if(b=k,k=v.startContainer)3==k.nodeType&&k.parentNode!=e&&(k=k.parentNode),1==k.nodeType&&(b=g.getPos(k,d||e).y);s=g.add(a.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+b+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},w);(h.ie||h.gecko)&&g.setStyle(s,"left","rtl"==g.getStyle(e,"direction",!0)?65535:-65535);g.bind(s,"beforedeactivate focusin focusout",
function(a){a.stopPropagation()});s.focus();a.selection.select(s,!0)}function b(){if(s){for(var c;c=a.dom.get("mcepastebin");)a.dom.remove(c),a.dom.unbind(c);v&&a.selection.setRng(v)}s=v=null}function r(){var c="",g,e,k;g=a.dom.select("div[id=mcepastebin]");for(e=0;e<g.length;e++)k=g[e],k.firstChild&&"mcepastebin"==k.firstChild.id&&(k=k.firstChild),k=k.innerHTML,c!=w&&(c+=k);return c}function u(a){var g={};if(a){if(a.getData){var e=a.getData("Text");e&&0<e.length&&-1==e.indexOf(q)&&(g["text/plain"]=
e)}if(a.types)for(e=0;e<a.types.length;e++){var k=a.types[e];g[k]=a.getData(k)}}return g}function y(c,g){function e(e){function k(c){g&&(a.selection.setRng(g),g=null);d('<img src="'+c.result+'">')}var b,w,r;r=!1;if(e)for(b=0;b<e.length;b++)w=e[b],/^image\/(jpeg|png|gif|bmp)$/.test(w.type)&&(r=new FileReader,r.onload=k.bind(null,r),r.readAsDataURL(w.getAsFile?w.getAsFile():w),c.preventDefault(),r=!0);return r}var k=c.clipboardData||c.dataTransfer;if(a.settings.paste_data_images&&k)return e(k.items)||
e(k.files)}function E(a){a=a.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&a&&a.items&&0===a.items.length}function F(){a.on("keydown",function(c){function g(a){(f.metaKeyPressed(a)&&86==a.keyCode||a.shiftKey&&45==a.keyCode)&&!a.isDefaultPrevented()&&b()}(f.metaKeyPressed(c)&&86==c.keyCode||c.shiftKey&&45==c.keyCode)&&!c.isDefaultPrevented()&&(B=c.shiftKey&&86==c.keyCode,B&&h.webkit&&-1!=navigator.userAgent.indexOf("Version/")||(c.stopImmediatePropagation(),x=(new Date).getTime(),
h.ie&&B?(c.preventDefault(),a.fire("paste",{ieFake:!0})):(b(),l(),a.once("keyup",g),a.once("paste",function(){a.off("keyup",g)}))))});a.on("paste",function(c){var g=(new Date).getTime(),e=u(c.clipboardData||a.getDoc().dataTransfer),g=(new Date).getTime()-g,k=1E3>(new Date).getTime()-x-g,q="text"==t.pasteFormat||B;B=!1;c.isDefaultPrevented()||E(c)?b():y(c)?b():(k||c.preventDefault(),!h.ie||k&&!c.ieFake||(l(),a.dom.bind(s,"paste",function(a){a.stopPropagation()}),a.getDoc().execCommand("Paste",!1,null),
e["text/html"]=r()),setTimeout(function(){var c;"text/html"in e&&0<e["text/html"].length?c=e["text/html"]:(c=r(),c==w&&(q=!0));c=m.trimHtml(c);s&&s.firstChild&&"mcepastebin"===s.firstChild.id&&(q=!0);b();c.length||(q=!0);q&&(c="text/plain"in e&&0<e["text/plain"].length&&-1==c.indexOf("</p>")?e["text/plain"]:m.innerText(c));c==w?k||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):q?n(c):d(c)},0))});a.on("dragstart dragend",function(a){z="dragstart"==a.type});a.on("drop",
function(c){var g=p.getCaretRangeFromPoint(c.clientX,c.clientY,a.getDoc());if(!c.isDefaultPrevented()&&!z&&!y(c,g)&&g&&!1!==a.settings.paste_filter_drop){var e=u(c.dataTransfer),k=e["mce-internal"]||e["text/html"]||e["text/plain"];k&&(c.preventDefault(),a.undoManager.transact(function(){e["mce-internal"]&&a.execCommand("Delete");a.selection.setRng(g);k=m.trimHtml(k);e["text/html"]?d(k):n(k)}))}});a.on("dragover dragend",function(c){a.settings.paste_data_images&&c.preventDefault()})}var t=this,s,v,
x=0,z=!1,w="%MCEPASTEBIN%",B,q="data:text/mce-internal,";t.pasteHtml=d;t.pasteText=n;a.on("preInit",function(){F();a.parser.addNodeFilter("img",function(c){if(!a.settings.paste_data_images)for(var g=c.length;g--;){var e=c[g].attributes.map.src;e&&/^(data:image|webkit\-fake\-url)/.test(e)&&(c[g].attr("data-mce-object")||e===h.transparentSrc||c[g].remove())}})})}});A("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),
function(h,p,f,m,a,d){function n(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function l(a){var b;a=a.replace(/^[\u00a0 ]+/,"");h.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],
function(d){if(d.test(a))return b=!0,!1});return b}function b(b){var u=b.settings;b.on("BeforePastePreProcess",function(y){function E(b){function d(a){var c="";if(3===a.type)return a.value;if(a=a.firstChild){do c+=d(a);while(a=a.next)}return c}function q(a,c){if(3===a.type&&c.test(a.value))return a.value=a.value.replace(c,""),!1;if(a=a.firstChild){do if(!q(a,c))return!1;while(a=a.next)}return!0}function c(a){if(a._listIgnore)a.remove();else if(a=a.firstChild){do c(a);while(a=a.next)}}function g(b,
g,d){var f=b._listLevel||h;f!=h&&(f<h?e&&(e=e.parent.parent):(k=e,e=null));e&&e.name==g?e.append(b):(k=k||e,e=new a(g,1),1<d&&e.attr("start",""+d),b.wrap(e));b.name="li";f>h&&k&&k.lastChild.append(e);h=f;c(b);q(b,/^\u00a0+/);q(b,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);q(b,/^\u00a0+/)}for(var e,k,h=1,r=[],f=b.firstChild;"undefined"!==typeof f&&null!==f;)if(r.push(f),f=f.walk(),null!==f)for(;"undefined"!==typeof f&&f.parent!==b;)f=f.walk();for(f=0;f<r.length;f++)if(b=r[f],"p"==b.name&&b.firstChild){var u=
d(b);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(u))g(b,"ul");else if(l(u)){var u=/([0-9]+)\./.exec(u),t=1;u&&(t=parseInt(u[1],10));g(b,"ol",t)}else b._listLevel?g(b,"ul",1):e=null}else k=e,e=null}function F(d,f){var q={},c,g=b.dom.parseStyle(f);h.each(g,function(a,b){switch(b){case "mso-list":if(c=/\w+ \w+([0-9]+)/i.exec(f))d._listLevel=parseInt(c[1],10);/Ignore/i.test(a)&&d.firstChild&&(d._listIgnore=!0,d.firstChild._listIgnore=!0);break;case "horiz-align":b="text-align";break;case "vert-align":b=
"vertical-align";break;case "font-color":case "mso-foreground":b="color";break;case "mso-background":case "mso-highlight":b="background";break;case "font-weight":case "font-style":"normal"!=a&&(q[b]=a);return;case "mso-element":if(/^(comment|comment-list)$/i.test(a)){d.remove();return}}0===b.indexOf("mso-comment")?d.remove():0!==b.indexOf("mso-")&&("all"==s||v&&v[b])&&(q[b]=a)});/(bold)/i.test(q["font-weight"])&&(delete q["font-weight"],d.wrap(new a("b",1)));/(italic)/i.test(q["font-style"])&&(delete q["font-style"],
d.wrap(new a("i",1)));return(q=b.dom.serializeStyle(q,d.name))?q:null}var t=y.content,s,v,t=t.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),t=t.replace(/<br class="?Apple-interchange-newline"?>/gi,"");(s=u.paste_retain_style_properties)&&(v=h.makeMap(s.split(/[, ]/)));if(!1!==u.paste_enable_default_filters&&n(y.content)){y.wordContent=!0;var t=d.filter(t,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,
"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return 0<b.length?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join("\u00a0"):""}]]),x=u.paste_word_valid_elements;x||(x="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");x=new f({valid_elements:x,valid_children:"-li[p]"});
h.each(x.elements,function(a){a.attributes["class"]||(a.attributes["class"]={},a.attributesOrder.push("class"));a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});var z=new p({},x);z.addAttributeFilter("style",function(a){for(var b=a.length,d;b--;)d=a[b],d.attr("style",F(d,d.attr("style"))),"span"==d.name&&d.parent&&!d.attributes.length&&d.unwrap()});z.addAttributeFilter("class",function(a){for(var b=a.length,d,c;b--;)d=a[b],c=d.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(c)&&
d.remove(),d.attr("class",null)});z.addNodeFilter("del",function(a){for(var b=a.length;b--;)a[b].remove()});z.addNodeFilter("a",function(a){for(var b=a.length,d,c,g;b--;)d=a[b],c=d.attr("href"),g=d.attr("name"),c&&-1!=c.indexOf("#_msocom_")?d.remove():(c&&0===c.indexOf("file://")&&(c=c.split("#")[1])&&(c="#"+c),c||g?g&&!/^_?(?:toc|edn|ftn)/i.test(g)?d.unwrap():d.attr({href:c,name:g}):d.unwrap())});t=z.parse(t);!1!==u.paste_convert_word_fake_lists&&E(t);y.content=(new m({},x)).serialize(t)}})}b.isWordContent=
n;return b});A("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(h,p,f,m){return function(a){function d(b){a.on("BeforePastePreProcess",function(a){a.content=b(a.content)})}function n(b){if(!f.isWordContent(b))return b;var d=[];p.each(a.schema.getBlockElements(),function(a,b){d.push(b)});var h=RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+d.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");b=m.filter(b,
[[h,"$1"]]);return b=m.filter(b,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function l(b){if(f.isWordContent(b))return b;var d=a.settings.paste_webkit_styles;if(!1===a.settings.paste_remove_styles_if_webkit||"all"==d)return b;d&&(d=d.split(/[, ]/));if(d){var h=a.dom,m=a.selection.getNode();b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,b,f,s){a=h.parseStyle(f,"span");f={};if("none"===d)return b+s;for(var n=0;n<d.length;n++){var l=a[d[n]],p=h.getStyle(m,d[n],!0);/color/.test(d[n])&&
(l=h.toHex(l),p=h.toHex(p));p!=l&&(f[d[n]]=l)}return(f=h.serializeStyle(f,"span"))?b+' style="'+f+'"'+s:b+s})}else b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return b=b.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,b,d,f){return b+' style="'+d+'"'+f})}h.webkit&&d(l);h.ie&&d(n)}});A("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(h,p,f,m){var a;h.add("paste",
function(d){function h(){"text"==b.pasteFormat?(this.active(!1),b.pasteFormat="html"):(b.pasteFormat="text",this.active(!0),a||(d.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var l=this,b,r=d.settings;l.clipboard=b=new p(d);l.quirks=new m(d);l.wordFilter=new f(d);d.settings.paste_as_text&&(l.clipboard.pasteFormat="text");if(r.paste_preprocess)d.on("PastePreProcess",function(a){r.paste_preprocess.call(l,l,
a)});if(r.paste_postprocess)d.on("PastePostProcess",function(a){r.paste_postprocess.call(l,l,a)});d.addCommand("mceInsertClipboardContent",function(a,b){b.content&&l.clipboard.pasteHtml(b.content);b.text&&l.clipboard.pasteText(b.text)});if(d.paste_block_drop)d.on("dragend dragover draggesture dragdrop drop drag",function(a){a.preventDefault();a.stopPropagation()});if(!d.settings.paste_data_images)d.on("drop",function(a){var b=a.dataTransfer;b&&b.files&&0<b.files.length&&a.preventDefault()});d.addButton("pastetext",
{icon:"pastetext",tooltip:"Paste as text",onclick:h,active:"text"==l.clipboard.pasteFormat});d.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:b.pasteFormat,onclick:h})})});(function(h){for(var p=0;p<h.length;p++){for(var f=G,m=h[p],a=m.split(/[.\/]/),d=0;d<a.length-1;++d)f[a[d]]===C&&(f[a[d]]={}),f=f[a[d]];f[a[a.length-1]]=D[m]}})(["tinymce/pasteplugin/Utils"])})(this);
