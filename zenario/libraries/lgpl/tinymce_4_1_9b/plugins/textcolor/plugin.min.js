tinymce.PluginManager.add("textcolor",function(b){function u(c){var d;b.dom.getParents(b.selection.getStart(),function(b){if(b=b.style["forecolor"==c?"color":"background-color"])d=b});return d}function v(){var c,d=[],e;e=b.settings.textcolor_map||"000000;Black;993300;Burnt orange;333300;Dark olive;003300;Dark green;003366;Dark azure;000080;Navy Blue;333399;Indigo;333333;Very dark gray;800000;Maroon;FF6600;Orange;808000;Olive;008000;Green;008080;Teal;0000FF;Blue;666699;Grayish blue;808080;Gray;FF0000;Red;FF9900;Amber;99CC00;Yellow green;339966;Sea green;33CCCC;Turquoise;3366FF;Royal blue;800080;Purple;999999;Medium gray;FF00FF;Magenta;FFCC00;Gold;FFFF00;Yellow;00FF00;Lime;00FFFF;Aqua;00CCFF;Sky blue;993366;Red violet;FFFFFF;White;FF99CC;Pink;FFCC99;Peach;FFFF99;Light yellow;CCFFCC;Pale green;CCFFFF;Pale cyan;99CCFF;Light sky blue;CC99FF;Plum".split(";");
for(c=0;c<e.length;c+=2)d.push({text:e[c+1],color:"#"+e[c]});return d}function n(){function c(a,b){var c="transparent"==a;return'<td class="mce-grid-cell'+(c?" mce-colorbtn-trans":"")+'"><div id="'+m+"-"+f++ +'" data-mce-color="'+(a?a:"")+'" role="option" tabIndex="-1" style="'+(a?"background-color: "+a:"")+'" title="'+tinymce.translate(b)+'">'+(c?"&#215;":"")+"</div></td>"}var d,e,a,g,h,l,m=this._id,f=0;d=v();d.push({text:tinymce.translate("No color"),color:"transparent"});a='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';
g=d.length-1;for(l=0;l<p;l++){a+="<tr>";for(h=0;h<k;h++)e=l*k+h,e>g?a+="<td></td>":(e=d[e],a+=c(e.color,e.text));a+="</tr>"}if(b.settings.color_picker_callback){a+='<tr><td colspan="'+k+'" class="mce-custom-color-btn"><div id="'+m+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+m+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>";a+="<tr>";for(h=0;h<
k;h++)a+=c("","Custom color");a+="</tr>"}return a+"</tbody></table>"}function q(c,d){b.undoManager.transact(function(){b.focus();b.formatter.apply(c,{value:d});b.nodeChanged()})}function r(c){b.undoManager.transact(function(){b.focus();b.formatter.remove(c,{value:null},null,!0);b.nodeChanged()})}function s(c){function d(b){a.hidePanel();a.color(b);q(a.settings.format,b)}function e(a,b){a.style.background=b;a.setAttribute("data-mce-color",b)}var a=this.parent(),g;tinymce.DOM.getParent(c.target,".mce-custom-color-btn")&&
(a.hidePanel(),b.settings.color_picker_callback.call(b,function(b){var c=a.panel.getEl().getElementsByTagName("table")[0],g,f,c=tinymce.map(c.rows[c.rows.length-1].childNodes,function(a){return a.firstChild});for(f=0;f<c.length&&(g=c[f],g.getAttribute("data-mce-color"));f++);if(f==k)for(f=0;f<k-1;f++)e(c[f],c[f+1].getAttribute("data-mce-color"));e(g,b);d(b)},u(a.settings.format)));(g=c.target.getAttribute("data-mce-color"))?(this.lastId&&document.getElementById(this.lastId).setAttribute("aria-selected",
!1),c.target.setAttribute("aria-selected",!0),this.lastId=c.target.id,"transparent"==g?(a.hidePanel(),a.resetColor(),r(a.settings.format)):d(g)):null!==g&&a.hidePanel()}function t(){this._color?q(this.settings.format,this._color):r(this.settings.format)}var k,p;p=b.settings.textcolor_rows||5;k=b.settings.textcolor_cols||8;b.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:n,onclick:s},onclick:t});b.addButton("backcolor",
{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:n,onclick:s},onclick:t})});
