tinymce.PluginManager.add("insertdatetime",function(c){function e(a,b){function d(a,b){a=""+a;if(a.length<b)for(var c=0;c<b-a.length;c++)a="0"+a;return a}b=b||new Date;a=a.replace("%D","%m/%d/%Y");a=a.replace("%r","%I:%M:%S %p");a=a.replace("%Y",""+b.getFullYear());a=a.replace("%y",""+b.getYear());a=a.replace("%m",d(b.getMonth()+1,2));a=a.replace("%d",d(b.getDate(),2));a=a.replace("%H",""+d(b.getHours(),2));a=a.replace("%M",""+d(b.getMinutes(),2));a=a.replace("%S",""+d(b.getSeconds(),2));a=a.replace("%I",
""+((b.getHours()+11)%12+1));a=a.replace("%p",""+(12>b.getHours()?"AM":"PM"));a=a.replace("%B",""+c.translate(l[b.getMonth()]));a=a.replace("%b",""+c.translate(m[b.getMonth()]));a=a.replace("%A",""+c.translate(n[b.getDay()]));a=a.replace("%a",""+c.translate(p[b.getDay()]));return a=a.replace("%%","%")}function f(a){var b=e(a);if(c.settings.insertdatetime_element&&(b='<time datetime="'+(/%[HMSIp]/.test(a)?e("%Y-%m-%dT%H:%M"):e("%Y-%m-%d"))+'">'+b+"</time>",a=c.dom.getParent(c.selection.getStart(),
"time"))){c.dom.setOuterHTML(a,b);return}c.insertContent(b)}var p="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),n="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),m="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),l="January February March April May June July August September October November December".split(" "),g=[],k,h;c.addCommand("mceInsertDate",function(){f(c.getParam("insertdatetime_dateformat",c.translate("%Y-%m-%d")))});c.addCommand("mceInsertTime",
function(){f(c.getParam("insertdatetime_timeformat",c.translate("%H:%M:%S")))});c.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){f(k||h)},menu:g});tinymce.each(c.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(a){h||(h=a);g.push({text:e(a),onclick:function(){k=a;f(a)}})});c.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:g,context:"insert"})});
